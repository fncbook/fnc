{"kind":"Article","sha256":"1834d428180db3e53ea62ba9b2a45ece809daddb0f4dbbca06de2a2b6c594d9b","slug":"precond","location":"/chapter8/precond.md","dependencies":[{"url":"/chapter8","label":"demo-precond-diagonal-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},{"url":"/chapter8-1","label":"demo-precond-diagonal-python","kind":"Notebook","slug":"chapter8-1","location":"/python/chapter8.md","title":"Chapter 8"}],"frontmatter":{"title":"Preconditioning","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"8.8.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"precond.md","url":"/fnc/build/precond-f6a01bd59677a10a22372aa3505f8367.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"An important aspect of MINRES and CG (and, by extension, GMRES) is that the convergence of a Krylov method can be expected to deteriorate as the condition number of the matrix increases. Even moderately large condition numbers can make the convergence impractically slow. Therefore it’s common for these methods to be used with a technique to reduce the relevant condition number.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xbnFsnvROm"}],"key":"rEmGnMglgJ"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Preconditioning","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"kQQPU5NTlv"}],"key":"CbYAEm7mTV"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Given a linear system ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"xpAf8QoSTZ"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{x}=\\mathbf{b}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>=</mo><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{x}=\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"aVdg5KpOPF"},{"type":"text","value":", a ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"EfnpeIS1P7"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"preconditioner","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"fAhUBodri2"}],"key":"GMZpjAtjTd"},{"type":"text","value":" is a matrix ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"i0xKglcUeH"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"rrDxfh8AxF"},{"type":"text","value":" or equivalent linear transformation that modifies the system to be","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"NAuBZFMFob"}],"key":"zhq7f9QCh9"},{"type":"math","value":"(\\mathbf{M}^{-1} \\mathbf{A}) \\mathbf{x} = \\mathbf{M}^{-1}\\mathbf{b}.","label":"precond","identifier":"precond","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">x</mi><mo>=</mo><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">b</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">(\\mathbf{M}^{-1} \\mathbf{A}) \\mathbf{x} = \\mathbf{M}^{-1}\\mathbf{b}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span><span class=\"mclose\">)</span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">b</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"8.8.1","html_id":"precond","key":"PJfmC8Vwlm"}],"indexEntries":[{"entry":"GMRES","subEntry":{"value":"preconditioning in","kind":"entry"},"emphasis":false},{"entry":"preconditioning","emphasis":true}],"label":"index-R4JXC3qqAb","identifier":"index-r4jxc3qqab","html_id":"index-r4jxc3qqab","enumerator":"8.8.1","key":"nBdUeU8P1X"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"More specifically, ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"hOMsxeVpQO"},{"type":"crossReference","kind":"equation","identifier":"precond","label":"precond","children":[{"type":"text","value":"(","key":"nRyVpH2Tzn"},{"type":"text","value":"8.8.1","key":"R5nZ3JSLlX"},{"type":"text","value":")","key":"m89H5RXzcK"}],"template":"(%s)","enumerator":"8.8.1","resolved":true,"html_id":"precond","key":"DCzACBbj0N"},{"type":"text","value":" is known as ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"DBkEpbDJmv"},{"type":"emphasis","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"left preconditioning","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"JvQablzKNR"}],"key":"WInNhiu2kG"},{"type":"text","value":", but it is the simplest and most common type.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"EXrfwLLhsd"}],"key":"vLJ5xeBWC7"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"As usual, we do not want to actually compute ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"z2k8VcgsIv"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"pnn8niWH8W"},{"type":"text","value":" for a given ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"niNdWr7F4I"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"ysJkFdR5zm"},{"type":"text","value":". Instead, we have a linear system with the matrix ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"EaGjlMPeoD"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"AWQKMuRSlZ"},{"type":"text","value":". In a Krylov method, the operation “let ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"YVyT0RFNYm"},{"type":"inlineMath","value":"\\mathbf{v}=\\mathbf{A}\\mathbf{u}","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}=\\mathbf{A}\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Au</span></span></span></span>","key":"ls08kgwtE9"},{"type":"text","value":"” becomes a two-step process:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"I6y9POA35s"}],"key":"ma54QTMtLP"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":26,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Set ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"qukI8IJTVa"},{"type":"inlineMath","value":"\\mathbf{y}=\\mathbf{A}\\mathbf{u}","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo>=</mo><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}=\\mathbf{A}\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Au</span></span></span></span>","key":"PEar6pYUYj"},{"type":"text","value":".","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"V66UziYZDW"}],"key":"lcw4A5KPxV"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Solve ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"QduUt32jA3"},{"type":"inlineMath","value":"\\mathbf{M}\\mathbf{v}=\\mathbf{y}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\mathbf{v}=\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">Mv</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"vC8gDE2kb9"},{"type":"text","value":" for ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"vhkRKpZNu6"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"rSh71O0gTy"},{"type":"text","value":".","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"hZCjdRk7yi"}],"key":"nlQjoSS08a"}],"key":"p2es3zw55z"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"As an implementation detail, it is common to provide the Krylov solver with code that does step 2; if the matrix ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"xg6SOcFFnQ"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"r2hDsnLbnb"},{"type":"text","value":" is given, the default is to use sparse factorization.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"tT94MuHJDw"}],"indexEntries":[{"entry":"sparse matrix","emphasis":false},{"entry":"LU factorization","emphasis":false}],"label":"index-TYpAYBnSWQ","identifier":"index-typaybnswq","html_id":"index-typaybnswq","key":"C9zvLaP8Fw"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"There are competing objectives in the choice of ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"mb0N1m1LeS"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"vjvZIGIJ2X"},{"type":"text","value":". On one hand, we want ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"nb2pxN0LKc"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}\\approx \\mathbf{I}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi><mo>≈</mo><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}\\approx \\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"HGKDyQVg22"},{"type":"text","value":" in some sense because that makes ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"AWpBZmkOA6"},{"type":"crossReference","kind":"equation","identifier":"precond","label":"precond","children":[{"type":"text","value":"(","key":"a69U4Kqyv6"},{"type":"text","value":"8.8.1","key":"FBuYvPj4Tm"},{"type":"text","value":")","key":"OLhSWdpEFv"}],"template":"(%s)","enumerator":"8.8.1","resolved":true,"html_id":"precond","key":"nP9kLJ6cMt"},{"type":"text","value":" easy to solve by Krylov iteration. Hence ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"eXrfHEfesv"},{"type":"inlineMath","value":"\\mathbf{M}\\approx \\mathbf{A}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>≈</mo><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\approx \\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"lTLAj19v0u"},{"type":"text","value":". On the other hand, we desire that solving the system ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"uaReSAevL9"},{"type":"inlineMath","value":"\\mathbf{M}\\mathbf{v}=\\mathbf{y}","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\mathbf{v}=\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">Mv</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"vFq1mD7kMo"},{"type":"text","value":" be relatively fast.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"ymdQjIsdP6"}],"key":"jcEmXoRnEI"},{"type":"proof","kind":"observation","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Good preconditioning is a matter of finding an easily inverted (i.e., quickly solvable) approximation of the original matrix.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"fG6Q1Npod8"}],"key":"sNrPqKFWIF"}],"enumerator":"8.8.1","key":"HkpDCzCGYm"},{"type":"heading","depth":2,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Diagonal preconditioning","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"yvCbhGByL8"}],"identifier":"diagonal-preconditioning","label":"Diagonal preconditioning","html_id":"diagonal-preconditioning","implicit":true,"enumerator":"8.8.1","key":"BXiuZfoVE2"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"One of the simplest choices for the preconditioner ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"BIngw5E9ZF"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"TC3Ip9zlx3"},{"type":"text","value":" is a diagonal matrix. This definitely meets the requirement of being fast to invert: the solution of ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"nY4vSvRiCl"},{"type":"inlineMath","value":"\\mathbf{M}\\mathbf{v}=\\mathbf{y}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mi mathvariant=\"bold\">v</mi><mo>=</mo><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}\\mathbf{v}=\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">Mv</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"l1wSS9Y5TW"},{"type":"text","value":" is just ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Ha0hvSvkxy"},{"type":"inlineMath","value":"v_i=y_i/M_{ii}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant=\"normal\">/</mi><msub><mi>M</mi><mrow><mi>i</mi><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">v_i=y_i/M_{ii}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ii</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RaflIhNyim"},{"type":"text","value":". The only question is whether it can be chosen in such a way that ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"WqF1JkVMdm"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"vy7B2Czysx"},{"type":"text","value":" is much more amenable to Krylov iterations than ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"WFtOOgIQy0"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"OPHfKIqrly"},{"type":"text","value":" is. This may be the case when the rows of ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"NpAWaQUZY9"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"PfhyMiRMCD"},{"type":"text","value":" differ greatly in scale, or when ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"n8p8xTFG6A"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"c5eNebavTO"},{"type":"text","value":" is diagonally dominant (see ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"TyQBcW5l51"},{"type":"crossReference","kind":"equation","identifier":"diag-dominant","label":"diag-dominant","children":[{"type":"text","value":"(","key":"siU0XJ4kOR"},{"type":"text","value":"2.9.1","key":"bZyyEKP0Zo"},{"type":"text","value":")","key":"sXkHkPVDH6"}],"template":"(%s)","enumerator":"2.9.1","resolved":true,"html_id":"diag-dominant","remote":true,"url":"/structure","dataUrl":"/structure.json","key":"A78pHkqPVx"},{"type":"text","value":").","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"PfkyMyIVP6"}],"key":"CpdqVGkn5z"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-precond-diagonal-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Diagonal preconditioning","position":{"start":{"line":853,"column":1},"end":{"line":853,"column":1}},"key":"BKIe3PodQ9"}],"key":"VvvoGhS84Y"},{"type":"paragraph","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"children":[{"type":"text","value":"Here is an SPD matrix that arises from solving partial differential equations.","position":{"start":{"line":854,"column":1},"end":{"line":854,"column":1}},"key":"CJJ0I3Uick"}],"key":"Yn4nlPh7Tc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = matrixdepot(\"wathen\", 60)\nn = size(A, 1)\n@show n, nnz(A);","key":"aOy4ZI9erT"},{"type":"output","id":"HVZnE-4_AgtevbpcEFT4S","data":[{"output_type":"stream","name":"stdout","text":"(n, nnz(A)) = (11041, 170161)"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"mta85clPBp"}],"data":{},"key":"PPYxnahEdD"},{"type":"paragraph","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"children":[{"type":"text","value":"There is an easy way to use the diagonal elements of ","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"key":"LOp9d5m3iL"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"kewe2ghOBd"},{"type":"text","value":", or any other vector, as a diagonal preconditioner.","position":{"start":{"line":865,"column":1},"end":{"line":865,"column":1}},"key":"gHGjewyXQ8"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"DiagonalPreconditioner","kind":"entry"},"emphasis":true}],"key":"EItiRRUUiW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = ones(n)\nM = DiagonalPreconditioner(diag(A));","key":"Soyf6KHWBv"},{"type":"output","id":"Ob9Ko48LAiPyN4QGQl7zV","data":[],"key":"n4Wgigc51t"}],"data":{},"key":"d8UQYzVWRV"},{"type":"paragraph","position":{"start":{"line":872,"column":1},"end":{"line":872,"column":1}},"children":[{"type":"text","value":"We now compare CG with and without the preconditioner.","position":{"start":{"line":872,"column":1},"end":{"line":872,"column":1}},"key":"wY96vTVpar"}],"key":"WmoV25KHRG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plain(b) = cg(A, b, maxiter=200, reltol=1e-4, log=true)\ntime_plain = @elapsed x, hist1 = plain(b)\nprec(b) = cg(A, b, Pl=M, maxiter=200, reltol=1e-4, log=true)\ntime_prec = @elapsed x, hist2 = prec(b)\n@show time_plain, time_prec\n\nrr = hist1[:resnorm]\nplot(0:length(rr)-1, rr / rr[1], yscale=:log10, label=\"plain\")\nrr = hist2[:resnorm]\nplot!(0:length(rr)-1, rr / rr[1], yscale=:log10, label=\"preconditioned\")\ntitle!(\"Diagonal preconditioning in CG\")","visibility":"hide","key":"mTHBWCEQgc"},{"type":"output","id":"8-Lvvprj92AWBhQIxR3tn","data":[{"output_type":"stream","name":"stdout","text":"(time_plain, time_prec) = (0.115779791, 0.188047458)"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":74,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f533a509604bf461c85d26c758a3c384","path":"/fnc/build/f533a509604bf461c85d26c758a3c384.png"},"text/html":{"content_type":"text/html","hash":"31bf338d85490c4c95f0ddc0b6d64f47","path":"/fnc/build/31bf338d85490c4c95f0ddc0b6d64f47.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"12a6c2a2b188d986d1b76a6ceee778bd","path":"/fnc/build/12a6c2a2b188d986d1b76a6ceee778bd.svg"}}}],"visibility":"show","key":"bamO1rXxWT"}],"data":{"tags":[]},"visibility":"show","key":"YmVYSEa0Dl"},{"type":"paragraph","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"children":[{"type":"text","value":"The diagonal preconditioner cut down substantially on the number of iterations. The effect on the total time is less dramatic, but this is not a large version of the problem.","position":{"start":{"line":890,"column":1},"end":{"line":890,"column":1}},"key":"TuC3gU93os"}],"key":"UC8f3Njf6e"}],"key":"d4vsF3e3WS"}],"key":"WsHX6OGT3N"}],"key":"Bfj2UntXej"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"label":"demo-precond-diagonal-matlab"},"key":"L1rRkRSw22"}],"key":"Erz7jntAX2"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-precond-diagonal-python","kind":"Notebook","slug":"chapter8-1","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Diagonal preconditioning","position":{"start":{"line":821,"column":1},"end":{"line":821,"column":1}},"key":"avfrGdaDlA"}],"key":"KJsyuztFV7"},{"type":"paragraph","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"children":[{"type":"text","value":"Here is an SPD matrix that arises from solving partial differential equations.","position":{"start":{"line":822,"column":1},"end":{"line":822,"column":1}},"key":"c4sAJYQtsA"}],"key":"x9IEYlL5iq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = matrixdepot(\"wathen\", 60)\nn = size(A, 1)\n@show n, nnz(A);","key":"uvwKlUnJ3A"},{"type":"output","id":"OHCeyKc-qZXYHMnLBPU59","data":[],"key":"dAuAwvYlDY"}],"data":{},"key":"T45FQqSyJz"},{"type":"paragraph","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"children":[{"type":"text","value":"There is an easy way to use the diagonal elements of ","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"xZyaTCPTZY"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"pLh390ndkf"},{"type":"text","value":", or any other vector, as a diagonal preconditioner.","position":{"start":{"line":833,"column":1},"end":{"line":833,"column":1}},"key":"F1ncw3npBR"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"DiagonalPreconditioner","kind":"entry"},"emphasis":true}],"key":"KIK7Qye1UV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = ones(n)\nM = DiagonalPreconditioner(diag(A));","key":"YARKChMA9q"},{"type":"output","id":"zZxJbn8sr_7WALdyCDLGr","data":[],"key":"vVYP4DLD6b"}],"data":{},"key":"p7eI4fQ0wS"},{"type":"paragraph","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"children":[{"type":"text","value":"We now compare CG with and without the preconditioner.","position":{"start":{"line":840,"column":1},"end":{"line":840,"column":1}},"key":"NhjQC9ElI4"}],"key":"OjiXce6gTm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plain(b) = cg(A, b, maxiter=200, reltol=1e-4, log=true)\ntime_plain = @elapsed x, hist1 = plain(b)\nprec(b) = cg(A, b, Pl=M, maxiter=200, reltol=1e-4, log=true)\ntime_prec = @elapsed x, hist2 = prec(b)\n@show time_plain, time_prec\n\nrr = hist1[:resnorm]\nplot(0:length(rr)-1, rr / rr[1], yscale=:log10, label=\"plain\")\nrr = hist2[:resnorm]\nplot!(0:length(rr)-1, rr / rr[1], yscale=:log10, label=\"preconditioned\")\ntitle!(\"Diagonal preconditioning in CG\")","visibility":"hide","key":"AoFjO6Bju1"},{"type":"output","id":"HQOq0XYgkLzXKA8xLCNBq","data":[],"visibility":"show","key":"g0Xm0aK0Fv"}],"data":{"tags":[]},"visibility":"show","key":"MfYhcydI6e"},{"type":"paragraph","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"children":[{"type":"text","value":"The diagonal preconditioner cut down substantially on the number of iterations. The effect on the total time is less dramatic, but this is not a large version of the problem.","position":{"start":{"line":858,"column":1},"end":{"line":858,"column":1}},"key":"Nz59iPeyEP"}],"key":"wiD4u9DL1H"}],"key":"HzhbNSecd3"}],"key":"gISVhjXV9c"}],"key":"v1fsDwDgLY"}],"key":"LtFkQkTPxF"}],"label":"demo-precond-diagonal","identifier":"demo-precond-diagonal","html_id":"demo-precond-diagonal","enumerator":"8.8.1","key":"ZkfQbRiy8T"},{"type":"heading","depth":2,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"Incomplete factorization","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"pi3PD1Og3y"}],"identifier":"incomplete-factorization","label":"Incomplete factorization","html_id":"incomplete-factorization","implicit":true,"enumerator":"8.8.2","key":"xwLkLzt1s2"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Another general-purpose technique is the ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"FQ2eylwxEq"},{"type":"strong","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"incomplete ","key":"OcsbdTbG8z"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"mkT8ibDkGJ"}],"key":"Sz9L94qMh5"},{"type":"text","value":" factorization","key":"JTJU6dhF4v"}],"key":"fSHGqxYlcl"},{"type":"text","value":". Since true factorization of a sparse matrix usually leads to an undesirable amount of fill-in, incomplete ","key":"FLEa0lKyS8"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"IXGffcykSu"}],"key":"fUgmpNKtJR"},{"type":"text","value":" sacrifices exact factors by dropping elements smaller than an adjustable threshold.","key":"MYQ6ADZu7N"}],"indexEntries":[{"entry":"LU factorization","subEntry":{"value":"incomplete","kind":"entry"},"emphasis":true}],"label":"index-BHUrUEAXGJ","identifier":"index-bhurueaxgj","html_id":"index-bhurueaxgj","key":"w7YC9vRR0S"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter8","label":"demo-precond-gmres-julia","kind":"Notebook","slug":"chapter8","location":"/julia/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Incomplete ","key":"iembodda2a"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"dHsjYMDNuy"}],"key":"N4pNsU1AlY"},{"type":"text","value":" preconditioning","key":"aJBUmkkMPW"}],"key":"XJ5EecRJvZ"},{"type":"paragraph","position":{"start":{"line":896,"column":1},"end":{"line":896,"column":1}},"children":[{"type":"text","value":"Here is a nonsymmetric matrix arising from a probabilistic model in computational chemistry.","position":{"start":{"line":896,"column":1},"end":{"line":896,"column":1}},"key":"TpO5cJRAJl"}],"key":"MB3q5gitkr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = sparse(matrixdepot(\"Watson/chem_master1\"))\nn = size(A, 1)\n@show n, nnz(A), issymmetric(A)","key":"BboZSJJnla"},{"type":"output","id":"pn3jaXIKvDkwKi8uZjYmb","data":[{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mdownloading: https://sparse.tamu.edu/MM/Watson/chem_master1.tar.gz\n"},{"output_type":"stream","name":"stdout","text":"(n, nnz(A), issymmetric(A)) = (40401, 201201, false)"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"text/plain":{"content":"(40401, 201201, false)","content_type":"text/plain"}}}],"key":"XTEyxNofWM"}],"data":{},"key":"gft2NFtn7h"},{"type":"paragraph","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"children":[{"type":"text","value":"Without a preconditioner, GMRES makes essentially no progress after 100 iterations.","position":{"start":{"line":904,"column":1},"end":{"line":904,"column":1}},"key":"fGdmYLAF7P"}],"key":"f5HjH7ZRc5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"b = rand(40000)\nconst GMRES = IterativeSolvers.gmres\nx, history = GMRES(A, b, maxiter=100, reltol=1e-5, log=true)\nresnorm = history[:resnorm]\n@show resnorm[end] / resnorm[1];","key":"zVklsouQAu"},{"type":"output","id":"HIBalm-OvmKi-KyOjnCen","data":[{"output_type":"stream","name":"stdout","text":"resnorm[end] / resnorm[1] = 0.9683267081406279\n"}],"key":"ZAbzY8dHiF"}],"data":{},"key":"SkA0VXR378"},{"type":"paragraph","position":{"start":{"line":917,"column":1},"end":{"line":917,"column":1}},"children":[{"type":"text","value":"The following version of incomplete ","key":"ac87OrbQQB"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"XFJ8MqvLQY"}],"key":"SEUgj4WRme"},{"type":"text","value":" factorization drops all sufficiently small values (i.e., replaces them with zeros). This keeps the number of nonzeros in the factors under control.","key":"scZnvcgrvP"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"ilu","kind":"entry"},"emphasis":true}],"key":"iQ0KSWc4y2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"iLU = ilu(A, τ=0.25)\n@show nnz(iLU) / nnz(A);","key":"IEcDhCD8Bz"},{"type":"output","id":"r_GkdgdmGCvTLfBZoSzyd","data":[{"output_type":"stream","name":"stdout","text":"nnz(iLU) / nnz(A) = 9.654509669435043"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"bMpPtUxgP7"}],"data":{},"key":"AUYayFP4NA"},{"type":"paragraph","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"children":[{"type":"text","value":"The result is almost 10 times as dense as ","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"GU1gdMtBbP"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"f2xQdu9L1e"},{"type":"text","value":" and yet still not a true factorization of it. However, it’s close enough for an approximate inverse in a preconditioner. The actual preconditioning matrix is ","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"A2o0dSwWXn"},{"type":"inlineMath","value":"\\mathbf{M}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"RkbqLPcdyo"},{"type":"text","value":", but we just supply the factorization to ","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"VLah9yVT7C"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"aIJ1a86bi5"},{"type":"text","value":".","position":{"start":{"line":924,"column":1},"end":{"line":924,"column":1}},"key":"FGyExwPuxi"}],"key":"H6GbR2DFWr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"_, history = GMRES(A, b, Pl=iLU, maxiter=100, reltol=1e-5, log=true)\nhistory","key":"qx7hFrt4YP"},{"type":"output","id":"_NyEolnyd0CPOqzkJlKDh","data":[{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"Converged after 7 iterations.","content_type":"text/plain"}}}],"key":"AZyxChXLKj"}],"data":{},"key":"KiHD84i9VJ"},{"type":"paragraph","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"UF0K3Tnu21"},{"type":"text","value":"τ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"gaZJnayMel"},{"type":"text","value":" parameter in ","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"d6OZgd0RoD"},{"type":"inlineCode","value":"ilu","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"KmnKnsyaWa"},{"type":"text","value":" balances the accuracy of the i","key":"Y4ZyRoxxAV"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"Cxi3AGRX9P"}],"key":"S53n627eJS"},{"type":"text","value":" factorization with the time needed to compute it and invert it. As ","key":"XzR9J9OwZ5"},{"type":"inlineMath","value":"\\tau\\to 0","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"mVe4tmdCBv"},{"type":"text","value":", more of the elements are kept, making the preconditioner more effective but slower per iteration.","position":{"start":{"line":931,"column":1},"end":{"line":931,"column":1}},"key":"cyADtt0bQY"}],"key":"F68q5AnxfH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(0:40, resnorm[1:41] / resnorm[1], label=\"no preconditioning\",\n    xaxis=(\"iteration number\"), yaxis=(:log10, \"residual norm\"),\n    leg=:bottomright, title=\"Incomplete LU preconditioning\")\nfor τ in [2, 1, 0.25, 0.1]\n    t = @elapsed iLU = ilu(A; τ)\n    t += @elapsed _, history = GMRES(A, b, Pl=iLU, maxiter=100,\n        reltol=1e-5, log=true)\n    resnorm = history[:resnorm]\n    label = \"τ = $τ, time = $(round(t,digits=3))\"\n    plot!(0:length(resnorm)-1, resnorm / resnorm[1]; label)\nend\nplt","visibility":"hide","key":"slRWAYkbi7"},{"type":"output","id":"MUbX-qfKurYKJxiXtP0JV","data":[{"output_type":"execute_result","execution_count":79,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d67c718ed13dce5722822060ccc56d62","path":"/fnc/build/d67c718ed13dce5722822060ccc56d62.png"},"text/html":{"content_type":"text/html","hash":"d155b246b3e8a8c99e19ec24c2cfa6cc","path":"/fnc/build/d155b246b3e8a8c99e19ec24c2cfa6cc.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e2887eaa6021d335a7f174ef18902aee","path":"/fnc/build/e2887eaa6021d335a7f174ef18902aee.svg"}}}],"visibility":"show","key":"C1Cm5ndSAr"}],"data":{"tags":[]},"visibility":"show","key":"y5ztYoPjo1"},{"type":"paragraph","position":{"start":{"line":950,"column":1},"end":{"line":950,"column":1}},"children":[{"type":"text","value":"In any given problem, it’s impossible to know in advance where the right balance lies between fidelity and speed for the preconditioner.","position":{"start":{"line":950,"column":1},"end":{"line":950,"column":1}},"key":"WfD36sQp5t"}],"key":"DVA8FixLWr"}],"key":"gE6MidfMTC"}],"key":"BsoIT9UWSJ"}],"key":"DsHEzdZvZ3"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"label":"demo-precond-gmres-matlab"},"key":"NfGOJE1BKE"}],"key":"wltgqvHYCr"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter8-1","label":"demo-precond-gmres-python","kind":"Notebook","slug":"chapter8-1","location":"/python/chapter8.md","title":"Chapter 8"},"children":[{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Incomplete ","key":"mzgebXiYwP"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"h7JAELIR6G"}],"key":"FBFk488RuX"},{"type":"text","value":" preconditioning","key":"qYDqdyj4bK"}],"key":"DYTnIo5iy9"},{"type":"paragraph","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"children":[{"type":"text","value":"Here is a nonsymmetric matrix arising from a probabilistic model in computational chemistry.","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"key":"ziQKFv2iY7"}],"key":"Rq536xjA7y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = sparse(matrixdepot(\"Watson/chem_master1\"))\nn = size(A, 1)\n@show n, nnz(A), issymmetric(A)","key":"wDwsMUV0L8"},{"type":"output","id":"JJnPIGsiAZVUt2-sPkvNh","data":[],"key":"y6UNHeQp23"}],"data":{},"key":"ttkAm8PVZV"},{"type":"paragraph","position":{"start":{"line":872,"column":1},"end":{"line":872,"column":1}},"children":[{"type":"text","value":"Without a preconditioner, GMRES makes essentially no progress after 100 iterations.","position":{"start":{"line":872,"column":1},"end":{"line":872,"column":1}},"key":"Bvx6Gb5k0D"}],"key":"xD0kd6rmxN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"b = rand(40000)\nconst GMRES = IterativeSolvers.gmres\nx, history = GMRES(A, b, maxiter=100, reltol=1e-5, log=true)\nresnorm = history[:resnorm]\n@show resnorm[end] / resnorm[1];","key":"NTvtCW5e9w"},{"type":"output","id":"Iq8a6QZ5woSdBMVsnQxcf","data":[],"key":"eV0uAzZHGp"}],"data":{},"key":"a9hHXPHn4M"},{"type":"paragraph","position":{"start":{"line":885,"column":1},"end":{"line":885,"column":1}},"children":[{"type":"text","value":"The following version of incomplete ","key":"MAAwRy505e"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"eElcGDeANb"}],"key":"glvJECSsHE"},{"type":"text","value":" factorization drops all sufficiently small values (i.e., replaces them with zeros). This keeps the number of nonzeros in the factors under control.","key":"WxK5XxPQGT"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"ilu","kind":"entry"},"emphasis":true}],"key":"EBt772dJRO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"iLU = ilu(A, τ=0.25)\n@show nnz(iLU) / nnz(A);","key":"L0PDiyY6Vb"},{"type":"output","id":"nRJLbM4ZSaZmKLWN2mPG8","data":[],"key":"zbGEPAwnWa"}],"data":{},"key":"i6AJbkTpgC"},{"type":"paragraph","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"children":[{"type":"text","value":"The result is almost 10 times as dense as ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"fhUtipU6qO"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"t8vGMdq8FJ"},{"type":"text","value":" and yet still not a true factorization of it. However, it’s close enough for an approximate inverse in a preconditioner. The actual preconditioning matrix is ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"xK4Dn6nx36"},{"type":"inlineMath","value":"\\mathbf{M}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"nihWicRTIi"},{"type":"text","value":", but we just supply the factorization to ","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"dxmGsc5IUt"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"zabPydmZ5U"},{"type":"text","value":".","position":{"start":{"line":892,"column":1},"end":{"line":892,"column":1}},"key":"xZvBK1OubI"}],"key":"kxAhu6d1aT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"_, history = GMRES(A, b, Pl=iLU, maxiter=100, reltol=1e-5, log=true)\nhistory","key":"nVcSQ2V3Po"},{"type":"output","id":"LPIXZ3aVMlKXDb1gOwEd6","data":[],"key":"z9C9VT2HXq"}],"data":{},"key":"kP0lM3v7aB"},{"type":"paragraph","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"FoKqc4Fio4"},{"type":"text","value":"τ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"tSp3P8oX1h"},{"type":"text","value":" parameter in ","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"gzI7GyjwuV"},{"type":"inlineCode","value":"ilu","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"iZGICNkvwy"},{"type":"text","value":" balances the accuracy of the i","key":"p912Q73Yvr"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"RgK5P2aDuw"}],"key":"yso9KT3KAH"},{"type":"text","value":" factorization with the time needed to compute it and invert it. As ","key":"fyzJloM2jx"},{"type":"inlineMath","value":"\\tau\\to 0","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"idrVvAUq9Y"},{"type":"text","value":", more of the elements are kept, making the preconditioner more effective but slower per iteration.","position":{"start":{"line":899,"column":1},"end":{"line":899,"column":1}},"key":"WxgFxiKdqn"}],"key":"FnYx2Ul5oG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt = plot(0:40, resnorm[1:41] / resnorm[1], label=\"no preconditioning\",\n    xaxis=(\"iteration number\"), yaxis=(:log10, \"residual norm\"),\n    leg=:bottomright, title=\"Incomplete LU preconditioning\")\nfor τ in [2, 1, 0.25, 0.1]\n    t = @elapsed iLU = ilu(A; τ)\n    t += @elapsed _, history = GMRES(A, b, Pl=iLU, maxiter=100,\n        reltol=1e-5, log=true)\n    resnorm = history[:resnorm]\n    label = \"τ = $τ, time = $(round(t,digits=3))\"\n    plot!(0:length(resnorm)-1, resnorm / resnorm[1]; label)\nend\nplt","visibility":"hide","key":"pJQnC33NEF"},{"type":"output","id":"YNwtOyHTchkFxg5IGogZu","data":[],"visibility":"show","key":"UYNt3rGfyZ"}],"data":{"tags":[]},"visibility":"show","key":"mhvitjAbUy"},{"type":"paragraph","position":{"start":{"line":918,"column":1},"end":{"line":918,"column":1}},"children":[{"type":"text","value":"In any given problem, it’s impossible to know in advance where the right balance lies between fidelity and speed for the preconditioner.","position":{"start":{"line":918,"column":1},"end":{"line":918,"column":1}},"key":"VZwZDBh6b5"}],"key":"cPZuCBprq7"}],"key":"TpEPLRnx1E"}],"key":"kvZ16rrJa2"}],"key":"hQNGNpzFf0"}],"key":"rG40huDy2i"}],"label":"demo-precond-gmres","identifier":"demo-precond-gmres","html_id":"demo-precond-gmres","enumerator":"8.8.2","key":"MvSgsy6S0O"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"In practice, good preconditioning is often as important, if not more important, than the specific choice of Krylov method. Effective preconditioning may require deep understanding of the underlying application, however, which limits our ability to go into further details. For instance, the linear system may be some approximation of a continuous mathematical model, and then ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"OkQyHsUqyr"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"N5MqD1rDSz"},{"type":"text","value":" can be derived by using a cruder form of the approximation. Krylov methods offer a natural way to exploit these and other approximate inverses.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"wLKcRBfGjw"}],"key":"C8OvswMGOf"},{"type":"heading","depth":2,"position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"Iii1xrrsrU"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"8.8.3","key":"BPhHH9JImq"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":104,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":104,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"✍ Suppose ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"fyxsI8joWz"},{"type":"inlineMath","value":"\\mathbf{M}=\\mathbf{R}^T\\mathbf{R}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>=</mo><msup><mi mathvariant=\"bold\">R</mi><mi>T</mi></msup><mi mathvariant=\"bold\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}=\\mathbf{R}^T\\mathbf{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathbf\">R</span></span></span></span>","key":"TPQPnkFJyw"},{"type":"text","value":". Show that the eigenvalues of ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"Gl7AP7Izag"},{"type":"inlineMath","value":"\\mathbf{R}^{-T}\\mathbf{A}\\mathbf{R}^{-1}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">R</mi><mrow><mo>−</mo><mi>T</mi></mrow></msup><mi mathvariant=\"bold\">A</mi><msup><mi mathvariant=\"bold\">R</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{R}^{-T}\\mathbf{A}\\mathbf{R}^{-1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span><span class=\"mord\"><span class=\"mord mathbf\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ZOz7CEBZN6"},{"type":"text","value":" are the same as the eigenvalues of ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"m6fgtOwZ3f"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"AtzXXzK8tU"},{"type":"text","value":". (This observation underlies preconditioning variants for SPD matrices.)","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"xr5jV5JZev"}],"key":"K62j2gIPga"}],"key":"WK406ziTH4"},{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"⌨ The object returned by ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"dQnGwq2T3t"},{"type":"inlineCode","value":"ilu","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"rtq0VJGQAQ"},{"type":"text","value":" stores the factors in a way that optimizes sparse triangular substitution. You can recover the factors themselves via","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"NEPmESr1j1"}],"key":"GJ1LHn9XqI"},{"type":"code","lang":"julia","value":"iLU = ilu(A,τ=0.1)   # for example\nL, U = I+iLU.L, iLU.U'","position":{"start":{"line":108,"column":1},"end":{"line":111,"column":1}},"key":"zW0fwTAJQJ"},{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"In this problem, use ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"iZWeZyrn31"},{"type":"inlineCode","value":"A = 1.5I + sprand(800,800,0.005)","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"XFaHbnIrOB"},{"type":"text","value":".","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"lFD9cWFosZ"}],"key":"cQwTms8FEo"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"strong","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"FgUJOOFaDi"}],"key":"v2HagCxU4c"},{"type":"text","value":" Using ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"XkxWl1nyPx"},{"type":"inlineMath","value":"\\tau=0.3","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.3</span></span></span></span>","key":"uXcoCyye2e"},{"type":"text","value":" for the factorization, plot the eigenvalues of ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"QXgTkaV4Wk"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"zhJLY6NAQX"},{"type":"text","value":" and of ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"aXbNEBq8wn"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"d94ZXYZTIL"},{"type":"text","value":" in the complex plane on side-by-side subplots. Do they support the notion that ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"UZN9KVc9PX"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"eBljeLyeFM"},{"type":"text","value":" is “more like” an identity matrix than ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"lJN5e2yX73"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"JPgtgfDCI0"},{"type":"text","value":" is? (Hint: the matrices are small enough to convert to standard dense form for the use of ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"GK8u2QJtZv"},{"type":"inlineCode","value":"eigvals","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"YZvnYLmxWT"},{"type":"text","value":".)","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"pmLlrHCN5I"}],"key":"JjTj5Nfsww"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"strong","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"qtUdMhGluh"}],"key":"dtsy4PMQlN"},{"type":"text","value":" Repeat part (a) for ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"BlhYfFIXIS"},{"type":"inlineMath","value":"\\tau=0.03","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.03</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.03</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.03</span></span></span></span>","key":"MZGAmCG7Q1"},{"type":"text","value":". Is ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"dLjqeG9qp8"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"PDwLUzhz40"},{"type":"text","value":" more accurate than in part (a), or less?","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"drjGzW69hi"}],"key":"QONUgQiJ4q"}],"key":"b67T7Pi3Tc"},{"type":"listItem","spread":true,"position":{"start":{"line":119,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"⌨ (Continuation of ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"QhwfNpuzzr"},{"type":"link","url":"problem-gmres-surround","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"Exercise 8.5.5","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"CxcdDd6OZF"}],"urlSource":"problem-gmres-surround","key":"vgpW7krLWU"},{"type":"text","value":".) Let ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"c7HNW578LY"},{"type":"inlineMath","value":"\\mathbf{B}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">B</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{B}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">B</span></span></span></span>","key":"jWqVWvrfyh"},{"type":"text","value":" be ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"mq4CtGOVze"},{"type":"inlineCode","value":"diagm(1:100)","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"HuY9obW7jT"},{"type":"text","value":",  let ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"NJbQWE7fIh"},{"type":"inlineMath","value":"\\mathbf{I}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">I</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{I}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">I</span></span></span></span>","key":"tfpqRtpqbS"},{"type":"text","value":" be ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"fHj46qWkoi"},{"type":"inlineCode","value":"I(100)","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"JbSyudX3NA"},{"type":"text","value":", and let ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"p3hJzzVcgi"},{"type":"inlineMath","value":"\\mathbf{Z}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Z</span></span></span></span>","key":"EEWY9F9txG"},{"type":"text","value":" be a ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"CvqTqGUfwf"},{"type":"inlineMath","value":"100\\times 100","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>100</mn><mo>×</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">100\\times 100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">100</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"G85iBfktAo"},{"type":"text","value":" matrix of zeros. Define","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"A76XmU9lTT"}],"key":"uEbtm51w32"},{"type":"math","value":"\\mathbf{A} = \\begin{bmatrix}\n      \\mathbf{B} & \\mathbf{I} \\\\ \\mathbf{Z} & -\\mathbf{B}\n    \\end{bmatrix}","position":{"start":{"line":121,"column":1},"end":{"line":125,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi mathvariant=\"bold\">B</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi mathvariant=\"bold\">I</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi mathvariant=\"bold\">Z</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mi mathvariant=\"bold\">B</mi></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} = \\begin{bmatrix}\n      \\mathbf{B} &amp; \\mathbf{I} \\\\ \\mathbf{Z} &amp; -\\mathbf{B}\n    \\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">B</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">Z</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">I</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathbf\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"8.8.2","key":"EIaAnSW6ZG"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"and let ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"zIcjI6PUcy"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"suM3xa19ha"},{"type":"text","value":" be a 200-vector of ones. The matrix ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"QUVlydUCPQ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"hizlH9sG04"},{"type":"text","value":" is difficult for GMRES.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"g8sJqLP38S"}],"key":"nFKHghD4g0"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"strong","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"K8K68z31J4"}],"key":"iYDXLmsoci"},{"type":"text","value":" Design a diagonal preconditioner ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"dLbIuxsEN0"},{"type":"inlineMath","value":"\\mathbf{M}","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span></span></span></span>","key":"slJwommKzz"},{"type":"text","value":", with all diagonal elements equal to ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"AlZVxmNseK"},{"type":"text","value":"1","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"mxsLUVnWMM"},{"type":"text","value":" or ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"KnaSMCUKnN"},{"type":"text","value":"-1","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"wSsM8lxikB"},{"type":"text","value":", such that ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"dD985YiFia"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"W3oI8ZzjqM"},{"type":"text","value":" has all positive eigenvalues. Apply ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"wMvRf445mk"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"lEPbSrd8Ey"},{"type":"text","value":" without restarts using this preconditioner and a tolerance of ","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"OPR7deNbc5"},{"type":"span","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"10","key":"oOxMWmwWFX"},{"type":"superscript","children":[{"type":"text","value":"-10","key":"T3oi8NieOd"}],"key":"JRTYeZXvro"}],"key":"rr0NvyPl6H"},{"type":"text","value":" for 100 iterations. Plot the convergence curve.","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"cDH6rVmNbr"}],"key":"aqlm4uOtvt"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"strong","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"EvqL85Zeuy"}],"key":"xiXPxL14BB"},{"type":"text","value":" Now design another diagonal preconditioner such that all the eigenvalues of ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"gtGQ8S1ZE8"},{"type":"inlineMath","value":"\\mathbf{M}^{-1}\\mathbf{A}","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">M</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}^{-1}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"lJIOLy4a2P"},{"type":"text","value":" are ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"RP0zSsdm20"},{"type":"text","value":"1","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"adzawbDLYA"},{"type":"text","value":", and apply preconditioned ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"pYuxaX1a2M"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"Fwx9jmHuZQ"},{"type":"text","value":" again. How many iterations are apparently needed for convergence?","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"mhIyBgJXqo"}],"key":"C4Pe1Fs9Kd"}],"key":"jWaWMGxtjw"},{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"⌨ Let ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"qUTzyZMeLe"},{"type":"inlineCode","value":"A = matrixdepot(\"Bai/rdb2048\")","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"YCHdhqlh5P"},{"type":"text","value":", and let ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"BHNBnfT5zx"},{"type":"inlineCode","value":"b","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"tvyNps2nIB"},{"type":"text","value":" be a vector of 2048 ones. In the steps below, use GMRES for up to 300 iterations without restarts and with a stopping tolerance of ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"opFK8dkDbF"},{"type":"span","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"10","key":"oda4F6oti2"},{"type":"superscript","children":[{"type":"text","value":"-4","key":"ahtTH1QWmE"}],"key":"Vx4S63WhP8"}],"key":"puf7vsU9oA"},{"type":"text","value":".","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"dNKEoB7w5X"}],"key":"dultQGSLSD"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"strong","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"vzYqdiOvKy"}],"key":"cP8Qu9aivQ"},{"type":"text","value":" Time the GMRES solution without preconditioning. Verify that convergence was achieved.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"MG7ixT3bwv"}],"key":"pWqdEEW50C"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"ZlBqW2670g"}],"key":"SQlYHvXEOq"},{"type":"text","value":" Show that diagonal preconditioning is not helpful for this problem.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"TpiUeBp00b"}],"key":"qweRzQNYjC"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"xM8QdbHLN2"}],"key":"oKC1rDl5q4"},{"type":"text","value":" To two digits, find a value of ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"n9qm3pJAEy"},{"type":"text","value":"τ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"QdPx7SsFvQ"},{"type":"text","value":" in i","key":"mDvEEqJ6x6"},{"type":"abbreviation","title":"lower triangular times upper triangular","children":[{"type":"text","value":"LU","key":"KmT0Y8cXqY"}],"key":"MRcu3Lpa1g"},{"type":"text","value":" such that the preconditioned method transitions from effective and faster than part (a) to ineffective.","key":"I1JDISP1If"}],"key":"tm5BRK92DJ"}],"key":"ypV2dlMdLC"}],"label":"problem-precond-spd","identifier":"problem-precond-spd","html_id":"problem-precond-spd","key":"zDPH9UvAbd"}],"key":"llu9T8n2Jp"}],"key":"LdV4P6cOEY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Matrix-free iterations","url":"/matrixfree","group":"Preface"},"next":{"title":"Next steps","url":"/next-7","group":"Preface"}}},"domain":"http://localhost:3000"}