

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Fitting functions to data &#8212; Fundamentals of Numerical Computation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/proof.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1]}}, "HTML-CSS": {"availableFonts": [], "preferredFont": null, "webFont": "TeX"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The normal equations" href="normaleqns.html" />
    <link rel="prev" title="Overdetermined linear systems" href="overview.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../intro/overview.html">Introduction</a>
  </li>
  <li class="">
    <a href="../linsys/overview.html">Square linear systems</a>
  </li>
  <li class="active">
    <a href="overview.html">Overdetermined linear systems</a>
  <ul class="nav sidenav_l2">
    <li class="active">
      <a href="">Fitting functions to data</a>
    </li>
    <li class="">
      <a href="normaleqns.html">The normal equations</a>
    </li>
    <li class="">
      <a href="qr.html">The QR factorization</a>
    </li>
    <li class="">
      <a href="house.html">Computing QR factorizations</a>
    </li>
    <li class="">
      <a href="next.html">Next steps</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../nonlineqn/overview.html">Roots of nonlinear equations</a>
  </li>
  <li class="">
    <a href="../localapprox/overview.html">Piecewise interpolation</a>
  </li>
  <li class="">
    <a href="../ivp/overview.html">Initial-value problems for ODEs</a>
  </li>
  <li class="">
    <a href="../appendix/linear-algebra.html">Review: Linear algebra</a>
  </li>
  <li class="">
    <a href="../appendix/demos.html">All demo notebooks</a>
  </li>
  <li class="">
    <a href="../refs.html">References</a>
  </li>
  <li class="">
    <a href="../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/leastsq/fitting.md"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#the-least-squares-formulation" class="nav-link">The least squares formulation</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#change-of-variables" class="nav-link">Change of variables</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#exercises" class="nav-link">Exercises</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="fitting-functions-to-data">
<h1>Fitting functions to data<a class="headerlink" href="#fitting-functions-to-data" title="Permalink to this headline">¶</a></h1>
<div class="demo sidebar" id="index-0">
<p class="sidebar-title">Demo</p>
<p><a class="reference internal" href="demos/fitting-tempinterp.html"><span class="doc">Interpolating temperature data</span></a></p>
</div>
<p>In <a class="reference internal" href="../linsys/polyinterp.html"><span class="doc">Polynomial interpolation</span></a> we saw how a polynomial can be used to interpolate data—that is, derive a continuous function that evaluates to give a set of prescribed values. But interpolation may not be appropriate in many applications.</p>
<p id="index-1">In many cases we can get better results by relaxing the interpolation requirement. In the polynomial case this allows us to lower the degree of the polynomial, which limits the number of local max and min points. Let <span class="math notranslate nohighlight">\((t_i,y_i)\)</span> for <span class="math notranslate nohighlight">\(i=1,\ldots,m\)</span> be the given points. We will represent the data by the polynomial</p>
<div class="math notranslate nohighlight" id="equation-vanderls">
<span class="eqno">(57)<a class="headerlink" href="#equation-vanderls" title="Permalink to this equation">¶</a></span>\[y \approx f(t) = c_1 + c_2t + \cdots + c_{n-1} t^{n-2} + c_n t^{n-1},\]</div>
<p>with <span class="math notranslate nohighlight">\(n&lt;m\)</span>. Just as in <a class="reference internal" href="../linsys/polyinterp.html#equation-vandersystem">(26)</a>, we can express a vector of <span class="math notranslate nohighlight">\(f\)</span>-values by a matrix-vector multiplication:</p>
<div class="math notranslate nohighlight" id="equation-vandersystemrect">
<span class="eqno">(58)<a class="headerlink" href="#equation-vandersystemrect" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{bmatrix}
f(t_1)                               \\
f(t_2)                               \\
f(t_3)                               \\
\vdots                               \\
f(t_m)
\end{bmatrix} =
\begin{bmatrix}
1      &amp; t_1    &amp; \cdots &amp; t_1^{n-1} \\
1      &amp; t_2    &amp; \cdots &amp; t_2^{n-1} \\
1      &amp; t_3    &amp; \cdots &amp; t_3^{n-1} \\
\vdots &amp; \vdots &amp;        &amp; \vdots    \\
1      &amp; t_m    &amp; \cdots &amp; t_m^{n-1} \\
\end{bmatrix}
\begin{bmatrix}
c_1                                  \\
c_2                                  \\
\vdots                               \\
c_n
\end{bmatrix}.\end{split}\]</div>
<div class="demo sidebar" id="index-2">
<p class="sidebar-title">Demo</p>
<p><a class="reference internal" href="demos/fitting-tempfit.html"><span class="doc">Fitting temperature data</span></a></p>
</div>
<p>Note that <span class="math notranslate nohighlight">\(\mathbf{V}\)</span> has the same structure as the Vandermonde matrix in <a class="reference internal" href="../linsys/polyinterp.html#equation-vandersystem">(26)</a> but is <span class="math notranslate nohighlight">\(m\times n\)</span>, thus taller than it is wide. It’s impossible in general to satisfy <span class="math notranslate nohighlight">\(m\)</span> conditions with <span class="math notranslate nohighlight">\(n&lt;m\)</span> variables, so rather than solving a linear system <span class="math notranslate nohighlight">\(\mathbf{V} \mathbf{c} = \mathbf{y}\)</span>, we have to find an approximation <span class="math notranslate nohighlight">\(\mathbf{V} \mathbf{c} \approx \mathbf{y}\)</span>. Below we specify precisely what is meant by this, but first we note that MATLAB conveniently uses the same backslash notation to solve the problem for both square and rectangular matrices.</p>
<div class="section" id="the-least-squares-formulation">
<h2>The least squares formulation<a class="headerlink" href="#the-least-squares-formulation" title="Permalink to this headline">¶</a></h2>
<p>In the most general terms, our fitting functions take the form</p>
<div class="math notranslate nohighlight" id="equation-fitbasis">
<span class="eqno">(59)<a class="headerlink" href="#equation-fitbasis" title="Permalink to this equation">¶</a></span>\[f(t) = c_1 f_1(t) + \cdots + c_n f_n(t),\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>The essential feature of a linear least squares problem is that the fit depends only <em>linearly</em> on the unknown parameters.</p>
</div>
<p>where <span class="math notranslate nohighlight">\(f_1,\ldots,f_n\)</span> are all known functions with no undetermined parameters. This leaves only <span class="math notranslate nohighlight">\(c_1,\ldots,c_n\)</span> to be determined. The essential feature of a linear least squares problem is that the fit depends only <em>linearly</em> on the unknown parameters. For instance, a function of the form <span class="math notranslate nohighlight">\(f(t)=c_1 + c_2 e^{c_3 t}\)</span> is not of this type.</p>
<p>At each observation <span class="math notranslate nohighlight">\((t_i,y_i)\)</span>, we define a residual, <span class="math notranslate nohighlight">\(y_i - f(t_i)\)</span>. A sensible formulation of the fitting criterion is to minimize</p>
<div class="math notranslate nohighlight">
\[  R(c_1,\ldots,c_n) = \sum_{i=1}^m\, [ y_i - f(t_i) ]^2,\]</div>
<p>over all possible choices of parameters <span class="math notranslate nohighlight">\(c_1,\ldots,c_n\)</span>. We can apply linear algebra to write the problem in the form <span class="math notranslate nohighlight">\(R=\mathbf{r}^T \mathbf{r}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r} =
\begin{bmatrix}
y_1 \\ y_2 \\ \vdots \\y_{m-1} \\ y_m
\end{bmatrix} -
\begin{bmatrix}
f_1(t_1) &amp; f_2(t_1) &amp; \cdots &amp; f_n(t_1) \\[1mm]
f_1(t_2) &amp; f_2(t_2) &amp; \cdots &amp; f_n(t_2) \\[1mm]
&amp; \vdots \\
f_1(t_{m-1}) &amp; f_2(t_{m-1}) &amp; \cdots &amp; f_n(t_{m-1}) \\[1mm]
f_1(t_m) &amp; f_2(t_m) &amp; \cdots &amp; f_n(t_m) \\[1mm]
\end{bmatrix}
\begin{bmatrix}
c_1 \\ c_2 \\ \vdots \\ c_n
\end{bmatrix}.\end{split}\]</div>
<p id="index-3">Recalling that <span class="math notranslate nohighlight">\(\mathbf{r}^T\mathbf{r}=\| \mathbf{r} \|_2^2\)</span>, and renaming the variables to standardize the statement, we arrive at the general <a class="reference internal" href="overview.html#term-linear-least-squares-problem"><span class="xref std std-term">linear least squares problem</span></a>:</p>
<div class="proof proof-type-definition" id="id1">

    <div class="proof-title">
        <span class="proof-type">Definition 21</span>
        
    </div><div class="proof-content">
<p>Given <span class="math notranslate nohighlight">\(\mathbf{A}\in\mathbb{R}^{m \times n}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\in\mathbb{R}^m\)</span>, with <span class="math notranslate nohighlight">\(m&gt;n\)</span>, find</p>
<div class="math notranslate nohighlight" id="equation-linls">
<span class="eqno">(60)<a class="headerlink" href="#equation-linls" title="Permalink to this equation">¶</a></span>\[\operatorname{argmin}_{\mathbf{x}\in \mathbb{R}^n}  \| \mathbf{b}-\mathbf{A} \mathbf{x} \|_2^2.\]</div>
</div></div><p>The notation <strong>argmin</strong> above means to find an <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> that produces the minimum value.</p>
<p id="index-4">While we could choose to minimize in any vector norm, the 2-norm is the most common and convenient choice. <em>For the rest of this chapter we exclusively use the 2-norm.</em> An <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> that achieves the minimum residual is considered to be a solution of the problem. In the edge case <span class="math notranslate nohighlight">\(m=n\)</span> for a nonsingular <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>, the definitions of the linear least squares and linear systems problems coincide: the solution of  <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span>  implies <span class="math notranslate nohighlight">\(\mathbf{r}=\boldsymbol{0}\)</span>, which is a global minimum of <span class="math notranslate nohighlight">\(\| \mathbf{r} \|_2^2 \ge 0\)</span>.</p>
</div>
<div class="section" id="change-of-variables">
<h2>Change of variables<a class="headerlink" href="#change-of-variables" title="Permalink to this headline">¶</a></h2>
<p id="index-5">The most familiar and common case of a polynomial least squares fit is the straight line, <span class="math notranslate nohighlight">\(f(t) = c_1 + c_2 t\)</span>. Certain other fit functions can be transformed into this situation. For example, suppose we want to fit data using <span class="math notranslate nohighlight">\(g(t)= a_1 e^{a_2 t}\)</span>. Then</p>
<div class="math notranslate nohighlight" id="equation-exptransfit">
<span class="eqno">(61)<a class="headerlink" href="#equation-exptransfit" title="Permalink to this equation">¶</a></span>\[\log y \approx \log g(t) = (\log a_1) + a_2 t = c_1 + c_2 t.\]</div>
<p id="index-6">While the fit of the <span class="math notranslate nohighlight">\(y_i\)</span> to <span class="math notranslate nohighlight">\(f(t)\)</span> is nonlinearly dependent on fitting parameters, the fit of <span class="math notranslate nohighlight">\(\log y_i\)</span> to a straight line is a linear problem. Similarly, the power-law relationship <span class="math notranslate nohighlight">\(y\approx f(t)=a_1 t^{a_2}\)</span> is equivalent to</p>
<div class="math notranslate nohighlight" id="equation-powtransfit">
<span class="eqno">(62)<a class="headerlink" href="#equation-powtransfit" title="Permalink to this equation">¶</a></span>\[\log y \approx (\log a_1) + a_2 (\log t).\]</div>
<div class="demo sidebar">
<p class="sidebar-title">Demo</p>
<p><a class="reference internal" href="demos/fitting-pirate.html"><span class="doc">Convergence to \pi</span></a></p>
</div>
<p>Thus the variable <span class="math notranslate nohighlight">\(z=\log y\)</span> can be fit linearly in terms of the variable <span class="math notranslate nohighlight">\(s=\log t\)</span>. In practice these two cases—exponential fit and power-law—are easily detected by using log-linear or log-log plots, respectively.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>✍ Suppose <span class="math notranslate nohighlight">\(f(x)\)</span> is a differentiable nonnegative real function. Use calculus to prove that the local minimizers of <span class="math notranslate nohighlight">\(f(x)\)</span> and <span class="math notranslate nohighlight">\([f(x)]^2\)</span> are the same values of <span class="math notranslate nohighlight">\(x\)</span>.</p>
</li>
<li id="problem-fitcensus"><p>⌨  Here are counts of the U.S. population from the census performed every ten years, beginning with 1790 and ending with 2010.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="mf">3.929</span><span class="p">,</span> <span class="mf">5.308</span><span class="p">,</span> <span class="mf">7.240</span><span class="p">,</span> <span class="mf">9.638</span><span class="p">,</span> <span class="mf">12.87</span><span class="p">,</span> <span class="mf">17.07</span><span class="p">,</span> <span class="mf">23.19</span><span class="p">,</span> <span class="mf">31.44</span><span class="p">,</span> <span class="mf">39.82</span><span class="p">,</span> <span class="mf">50.19</span><span class="p">,</span> <span class="mf">62.95</span><span class="p">,</span> <span class="mf">76.21</span><span class="p">,</span>
<span class="mf">92.22</span><span class="p">,</span> <span class="mf">106.0</span><span class="p">,</span> <span class="mf">122.8</span><span class="p">,</span> <span class="mf">132.2</span><span class="p">,</span> <span class="mf">150.7</span><span class="p">,</span> <span class="mf">179.3</span><span class="p">,</span> <span class="mf">203.3</span><span class="p">,</span> <span class="mf">226.5</span><span class="p">,</span> <span class="mf">248.7</span><span class="p">,</span> <span class="mf">281.4</span><span class="p">,</span> <span class="mf">308.7</span>
</pre></div>
</div>
<p><strong>(a)</strong> Find a best-fitting cubic polynomial for the data. Plot the data as points superimposed on a (smooth) graph of the cubic over the full range of time. Label the axes. What does the fit predict for the population in the years 2000,2010,2020?</p>
<p>**(b)**Repeat (a) but use a fitting function of the form <span class="math notranslate nohighlight">\(y(t)\approx a e^{b t}\)</span>.</p>
<p>**(c)**Look up the actual U.S. population in 2000 and 2010 and compare to the predictions of parts (a) and (b).</p>
 <!-- load census;
 t = cdate - 1790;  y = pop;
 A = zeros(length(t),3);
 for j = 0:2
     A(:,3-j) = t.^j;
 end
<p>c = A\y;</p>
<p>tt = linspace(0,t(end),200)’;
yy = polyval(c,tt);
plot(t,y,’o’,tt,yy)
xlabel(‘year since 1790’), ylabel(‘population (millions)’)</p>
<p>pop2000 = polyval(c,210)
pop2010 = polyval(c,220) –&gt;</p>
 <!-- load census;
 t = cdate - 1790;  y = pop;
 A = [t.^1 t.^0];
 c = A\log(y);
 a = exp(c(2)), b = c(1)
<p>tt = linspace(0,t(end),200)’;
yy = a<em>exp(b</em>tt);
plot(t,y,’o’,tt,yy)
xlabel(‘year since 1790’), ylabel(‘population (millions)’)</p>
<p>pop2000 = a<em>exp(210</em>b)
pop2010 = a<em>exp(220</em>b) –&gt;</p>
</li>
<li><p>⌨  In this problem you are trying to find an approximation to the periodic function <span class="math notranslate nohighlight">\(f(t)=e^{\sin(t-1)}\)</span> over one period, <span class="math notranslate nohighlight">\(0\le t \le 2\pi\)</span>. In Julia, let <code class="docutils literal notranslate"><span class="pre">t=LinRange(0,2pi,200)</span></code> and let <code class="docutils literal notranslate"><span class="pre">b</span></code> be a column vector of evaluations of <span class="math notranslate nohighlight">\(f\)</span> at those values.</p>
<p><strong>(a)</strong> Find the coefficients of the least-squares fit</p>
<div class="math notranslate nohighlight">
\[  f(t) \approx c_1 + c_2t + \cdots + c_7 t^6.\]</div>
<p><strong>(b)</strong> Find the coefficients of the least-squares fit</p>
<div class="math notranslate nohighlight">
\[f(t) \approx d_1 + d_2\cos(t) + d_3\sin(t) + d_4\cos(2t) +
d_5\sin(2t).\]</div>
<p><strong>(c)</strong> Plot the original function <span class="math notranslate nohighlight">\(f(t)\)</span> and the two approximations from (a) and (b) together on a well-labeled graph.</p>
 <!-- clear all; format compact;
 t = linspace(0,2*pi,200)';  b = exp(sin(t-1));
 p = 7;  % degree of polynomial fit is p-1
 A = zeros(length(t),p+1);
 for j=1:p+1
     A(:,j) = t.^(j-1);
 end
 disp(' ')
 disp('Part (a) coefficients: ')
 c = (A'*A)\(A'*b)
 p = A*c;  % evaluate polynomial at all t values in one line! -->
 <!-- A = ones(length(t),5);
 A(:,2) = cos(t);
 A(:,3) = sin(t);
 A(:,4) = cos(2*t);
 A(:,5) = sin(2*t);
<p>disp(‘ ‘)
disp(‘Part (b) coefficients: ‘)
d = (A’*A)(A’<em>b)
trig = A</em>d;  % again, compute the fits at all t values in one line! –&gt;</p>
 <!-- plot(t,p,'-',t,trig,'--',t,b,'-.')
 axis([0 2*pi 0 3])
 xlabel('t');
 legend('6th degree poly','trig fit','actual','Location','NorthEast');
 title('Problem 3.1.4 -- Fit of Periodic Function'); -->
</li>
<li><p>⌨ Define the following data in Julia.</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="o">:.</span><span class="mi">5</span><span class="o">:</span><span class="mi">10</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tanh</span><span class="o">.</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>(a)</strong> Fit the data to a cubic polynomial. Plot the data together with the polynomial fit.</p>
<p><strong>(b)</strong> Fit the data to the function <span class="math notranslate nohighlight">\(c_1 + c_2z + c_3z^2 + c_4z^3\)</span>, where <span class="math notranslate nohighlight">\(z=t^2/(1+t^2)\)</span>. Plot the data together with the fit. What feature of <span class="math notranslate nohighlight">\(z\)</span> makes this fit much better than the original cubic?</p>
   <!-- t = (0:.5:10)';
   y = tanh(t);
   plot(t,y,'o')
   z = t.^2./(1+t.^2);
   A = [ t.^0 t t.^2 t.^3 ];
   c = A\y
   hold on
   plot(t,A*c) -->
</li>
<li><p>⌨  One series for finding <span class="math notranslate nohighlight">\(\pi\)</span> is</p>
<div class="math notranslate nohighlight">
\[\frac{\pi}{2} = 1 + \frac{1}{3} + \frac{1\cdot 2}{3\cdot5} + \frac{1\cdot 2\cdot 3}{3\cdot 5\cdot 7} + \cdots.\]</div>
<p>Define <span class="math notranslate nohighlight">\(s_k\)</span> to be the sum of the first <span class="math notranslate nohighlight">\(k\)</span> terms (that is, up to <span class="math notranslate nohighlight">\(j=k=1\)</span>) and let <span class="math notranslate nohighlight">\(e_k=|\pi-2s_k|\)</span>. Do a numerical experiment to determine which is a better fit: <span class="math notranslate nohighlight">\(e_k\approx a b^k\)</span>, or <span class="math notranslate nohighlight">\(e_k\approx a k^b\)</span>. Then determine the parameters in that fit.</p>
 <!-- a = 2;   % first term
 p = a;
 for j = 1:40
     a = a*j/(2*j+1);    % next term
     p(j+1) = p(j) + a;
 end
 e = abs(pi-p'); -->
 <!-- subplot(1,2,1),semilogy(e)
 subplot(1,2,2),loglog(e) -->
 <!-- A = [ (0:40)', ones(41,1) ];
 c = A\log(e) -->
 <!-- b = exp(c(1))
 a = exp(c(2)) -->
</li>
<li><p>⌨  Kepler found that the orbital period <span class="math notranslate nohighlight">\(\tau\)</span> of a planet depends on its mean distance <span class="math notranslate nohighlight">\(R\)</span> from the sun according to <span class="math notranslate nohighlight">\(\tau=c R^{\alpha}\)</span> for a simple rational number <span class="math notranslate nohighlight">\(\alpha\)</span>. Validate Kepler’s result by using a linear least squares fit and the following table.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Planet</p></th>
<th class="text-align:center head"><p>Distance from sun in Mkm</p></th>
<th class="text-align:center head"><p>Orbital period in days</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mercury</p></td>
<td class="text-align:center"><p>57.59</p></td>
<td class="text-align:center"><p>87.99</p></td>
</tr>
<tr class="row-odd"><td><p>Venus</p></td>
<td class="text-align:center"><p>108.11</p></td>
<td class="text-align:center"><p>224.7</p></td>
</tr>
<tr class="row-even"><td><p>Earth</p></td>
<td class="text-align:center"><p>149.57</p></td>
<td class="text-align:center"><p>365.26</p></td>
</tr>
<tr class="row-odd"><td><p>Mars</p></td>
<td class="text-align:center"><p>227.84</p></td>
<td class="text-align:center"><p>686.98</p></td>
</tr>
<tr class="row-even"><td><p>Jupiter</p></td>
<td class="text-align:center"><p>778.14</p></td>
<td class="text-align:center"><p>4332.4</p></td>
</tr>
<tr class="row-odd"><td><p>Saturn</p></td>
<td class="text-align:center"><p>1427</p></td>
<td class="text-align:center"><p>10759</p></td>
</tr>
<tr class="row-even"><td><p>Uranus</p></td>
<td class="text-align:center"><p>2870.3</p></td>
<td class="text-align:center"><p>30684</p></td>
</tr>
<tr class="row-odd"><td><p>Neptune</p></td>
<td class="text-align:center"><p>4499.9</p></td>
<td class="text-align:center"><p>60188</p></td>
</tr>
<tr class="row-even"><td><p>Pluto</p></td>
<td class="text-align:center"><p>5909</p></td>
<td class="text-align:center"><p>90710</p></td>
</tr>
</tbody>
</table>
</li>
<li><p>✍ Show that finding a best fit of the form</p>
<div class="math notranslate nohighlight">
\[y(t) \approx \frac{a}{t+b}\]</div>
<p>can be transformed into a linear fitting problem (with different undetermined coefficients) by rewriting the equation.</p>
</li>
<li><p>✍ Show how to find the constants <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> in a data fitting problem of the form <span class="math notranslate nohighlight">\(y(t)\approx t/(at+b)\)</span> by transforming it into a linear least squares fitting problem.</p></li>
</ol>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="overview.html" title="previous page">Overdetermined linear systems</a>
    <a class='right-next' id="next-link" href="normaleqns.html" title="next page">The normal equations</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-172898555-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>