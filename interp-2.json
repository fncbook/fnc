{"kind":"Notebook","sha256":"b2bbd725a7738b3829d348cf9ea7ee2e3d76e9874dbbf1a6e718f78eabfca1a5","slug":"interp-2","location":"/chapter9/section5/python/interp.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"interp.ipynb","url":"/build/interp-094418569b9dbaf92f4b981181df5ce3.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:02:59.368334Z","iopub.status.busy":"2025-01-10T16:02:59.368221Z","iopub.status.idle":"2025-01-10T16:02:59.741207Z","shell.execute_reply":"2025-01-10T16:02:59.740924Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"kduRw1kSP7"},{"type":"output","id":"7LLYK2Jxky9DobNLwgn1V","data":[],"visibility":"show","key":"zLuIhNhyny"}],"visibility":"remove","key":"fSdamYRKZ9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Gwunif64Mw"},{"type":"text","value":"9.5.1","key":"npSVjSsFqv"}],"key":"iGrs7F9qJT"}],"identifier":"demo-trig-interp","label":"demo-trig-interp","kind":"proof:example","template":"Example %s","enumerator":"9.5.1","resolved":true,"html_id":"demo-trig-interp","remote":true,"url":"/trig","dataUrl":"/trig.json","key":"b9OuM3ERDM"}],"key":"q5xuyKZ8hR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will get a cardinal function without using an explicit formula, just by passing data that is 1 at one node and 0 at the others.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xddb019A06"}],"key":"VkFn4sgtLO"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"ZwdISzM8gF"}],"key":"L3bEYLRq2s"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The operator ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Jq04uhWd5n"},{"type":"inlineCode","value":"÷","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XfJS7BmQ3G"},{"type":"text","value":", typed as ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tHZYSYeRcw"},{"type":"inlineCode","value":"\\div","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xJmg1F7X4v"},{"type":"text","value":" then ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lPgYZlNcUD"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"tZgD4rdVpz"}],"key":"Nt6knGmjNC"},{"type":"text","value":", returns the quotient without remainder of two integers.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HLAMkRkFrl"}],"key":"C2FTu0kzWy"}],"class":"dropdown","key":"z01sRFxkkV"}],"key":"hYdxLbFHQz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:02:59.742845Z","iopub.status.busy":"2025-01-10T16:02:59.742680Z","iopub.status.idle":"2025-01-10T16:02:59.846843Z","shell.execute_reply":"2025-01-10T16:02:59.846538Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"N = 7\nn = int((N - 1) / 2)\nt = 2 * arange(-n, n + 1) / N\ny = zeros(N)\ny[n] = 1\n\np = FNC.triginterp(t, y)\nx = linspace(-1, 1, 600)\nplot(x, p(x))\nplot(t, y, \"ko\")\n\nxlabel(\"x\"),  ylabel(\"tau(x)\")\ntitle(\"Trig cardinal function\");","key":"Z0QvHosc6T"},{"type":"output","id":"T-_vJ_87dZ3-pXf44JYfV","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fb00190277c8965c014ca999b7ddd102","path":"/build/fb00190277c8965c014ca999b7ddd102.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"jnUCgSheVX"}],"key":"sqNNiLGf44"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is a 2-periodic function and one of its interpolants.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qf99mg0AW4"}],"key":"IxPR6KaO34"}],"key":"SOLpVAZNDT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:02:59.848370Z","iopub.status.busy":"2025-01-10T16:02:59.848236Z","iopub.status.idle":"2025-01-10T16:03:00.046534Z","shell.execute_reply":"2025-01-10T16:03:00.046241Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: exp(sin(pi * x) - 2 * cos(pi * x))\n\nplot(x, f(x), label=\"periodic function\")\ny = f(t)\n\np = FNC.triginterp(t, y)\nplot(x, p(x), label=\"trig interpolant\")\nplot(t, y, \"ko\", label=\"nodes\")\n\nxlabel(\"$x$\"),  ylabel(\"$p(x)$\")\nlegend(),  title(\"Trig interpolation\");","key":"JVBocbR9dm"},{"type":"output","id":"haOkE21xmoA_z8wDNtJ5N","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"09dfe3433bca50bda96dc613b2fb2556","path":"/build/09dfe3433bca50bda96dc613b2fb2556.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"UqZa7Oxyg5"}],"key":"fyB2XvbMDU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The convergence of the interpolant is spectral. We let ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XFuLpYS39L"},{"type":"inlineMath","value":"N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"t5mm5eJaR1"},{"type":"text","value":" go needlessly large here in order to demonstrate that unlike polynomials, trigonometric interpolation is stable on equally spaced nodes. Note that when ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UYxRu8E7XO"},{"type":"inlineMath","value":"N","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"dow4Pv9RCd"},{"type":"text","value":" is even, the value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HIZmuA24Tz"},{"type":"inlineMath","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"nxBsqEi6G5"},{"type":"text","value":" is not an integer but works fine for defining the nodes.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lQwOZsAlq0"}],"key":"eYn7oLpjxB"}],"key":"TA7wnN2NTm"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-10T16:03:00.047973Z","iopub.status.busy":"2025-01-10T16:03:00.047841Z","iopub.status.idle":"2025-01-10T16:03:04.051348Z","shell.execute_reply":"2025-01-10T16:03:04.051075Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"N = arange(2, 62, 2)\nerr = zeros(N.size)\n\nx = linspace(-1, 1, 1601)    # for measuring error\nfor k in range(N.size):\n    n = (N[k] - 1) / 2\n    t = 2 * arange(-n, n + 1) / N[k]\n    p = FNC.triginterp(t, f(t))\n    err[k] = max(abs(f(x) - p(x)))\n\nsemilogy(N, err, \"-o\")\nxlabel(\"N\"),  ylabel(\"max error\")\ntitle(\"Convergence of trig interpolation\");","visibility":"hide","key":"z8tuTy80CN"},{"type":"output","id":"Eexk3NJMIH7mffWt8ZyCL","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"38e318a2a4767780cf5bfa0460961802","path":"/build/38e318a2a4767780cf5bfa0460961802.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"VTC4HeDcNX"}],"visibility":"show","key":"jFtbsIWJGO"}],"key":"slpnjFIfAS"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Approx","url":"/approx-2","group":"Chapter 9"},"next":{"title":"Fft","url":"/fft-2","group":"Chapter 9"}}},"domain":"http://localhost:3000"}