{"kind":"Notebook","sha256":"cc4bc1a264a870589452d2fc7ca5767c672e9425a6554b0e92de12d89b68d998","slug":"solve-3","location":"/chapter12/section1/julia/solve.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1.11.2","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"solve.ipynb","url":"/build/solve-bfb147a60f6a6881a97e26a2e9c060db.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"zRij3aT3VN"},{"type":"text","value":"12.1.2","key":"i9FMOIfUnF"}],"key":"LyfYxkSN72"}],"identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"sUfUDLflVE"}],"key":"TctU6JrDE6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OPdYpFPQV0"}],"key":"JvTG9DXQTW"}],"key":"C0njPf72YC"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:46.697000Z","iopub.status.busy":"2025-01-14T15:30:44.066000Z","iopub.execute_input":"2025-01-14T15:30:46.209000Z","shell.execute_reply":"2025-01-14T15:30:46.686000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ρc = 1080;  ρm = 380;  q_m = 10000;\ndQ0 = ρ -> 4q_m * ρc^2 * (ρc-ρm) * ρm * (ρm-ρ) / (ρ*(ρc-2*ρm) + ρc*ρm)^3;","key":"g2FPRH95Lf"},{"type":"output","id":"1C8uXYGIEAQjscZZ-yMlx","data":[],"key":"BASdeJoHqy"}],"key":"oXvPiiUMr3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WNAsFW27j5"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"dcXEKGBJbN"},{"type":"text","value":" points.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ang6NygUhD"}],"key":"gsId129jS3"}],"key":"Imq6gWd7Fd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:49.546000Z","iopub.status.busy":"2025-01-14T15:30:46.787000Z","iopub.execute_input":"2025-01-14T15:30:46.792000Z","shell.execute_reply":"2025-01-14T15:30:49.543000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x, Dₓ, Dₓₓ = FNC.diffper(800, [0, 4]);","key":"UjAYeWttcU"},{"type":"output","id":"5uHHXEX10q9mnhAiItjrx","data":[],"key":"BEhTef8gex"}],"key":"obDvW6xEYA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"fd0FiCmFHP"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Jn9V6JlnXP"}],"key":"ageajxSoPN"},{"type":"text","value":" resulting from the method of lines.","key":"xxUxhLY60N"}],"key":"CdIikjSsFN"}],"key":"E1eycE5lpR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:30:49.577000Z","iopub.status.busy":"2025-01-14T15:30:49.568000Z","iopub.execute_input":"2025-01-14T15:30:49.569000Z","shell.execute_reply":"2025-01-14T15:30:49.575000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ode = (ρ, ϵ, t) -> -dQ0.(ρ) .* (Dₓ*ρ) + ϵ * (Dₓₓ*ρ);","key":"MbiZ5p0wi2"},{"type":"output","id":"Z497Jg3BtLOqF4cCGuos8","data":[],"key":"CtTus2YHNP"}],"key":"XYMNkkmr1T"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"BLgDC6m1dr"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"Sd8XUrOxxE"}],"key":"FfkqM4vnYR"},{"type":"text","value":".","key":"P4Trj8YP01"}],"key":"bzQzNPExUS"}],"key":"a6ucHxmDuY"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:32:29.202000Z","iopub.status.busy":"2025-01-14T15:30:49.596000Z","iopub.execute_input":"2025-01-14T15:30:49.596000Z","shell.execute_reply":"2025-01-14T15:32:29.201000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nρ_init = @. 400 + 10 * exp( -20*(x-3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 1.), 0.02)\nsol = solve(IVP, Rodas4P());","key":"L9DmzLozGi"},{"type":"output","id":"uhop4St2fZq-k4e5wmwBV","data":[],"key":"pCwO6JeKki"}],"key":"EoQjn7Gan0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:33:16.775000Z","iopub.status.busy":"2025-01-14T15:32:29.217000Z","iopub.execute_input":"2025-01-14T15:32:29.220000Z","shell.execute_reply":"2025-01-14T15:33:16.770000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft, \n    title=\"Traffic flow\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in 0:0.2:1\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"Ss5Q5EzIpH"},{"type":"output","id":"7qVeb9rSPG_mwtuM_3Gge","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7abd9c7be7bbcd6482ecf213933ba178","path":"/build/7abd9c7be7bbcd6482ecf213933ba178.png"},"text/html":{"content_type":"text/html","hash":"fefc4e88258649b97ecdd8026f826906","path":"/build/fefc4e88258649b97ecdd8026f826906.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"261f02789ad7788212091af6dbca47ab","path":"/build/261f02789ad7788212091af6dbca47ab.svg"}}}],"visibility":"show","key":"Q7qzRaDLOv"}],"visibility":"show","key":"UhiUQiJ35s"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BEEZjthY79"}],"key":"nVSTFIOtk2"}],"key":"JgKRkR85ee"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:12.611000Z","iopub.status.busy":"2025-01-14T15:33:16.837000Z","iopub.execute_input":"2025-01-14T15:33:16.839000Z","shell.execute_reply":"2025-01-14T15:34:12.608000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,0.9,91) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,410], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic flow, t=%.2f\",t))\nend\nmp4(anim, \"traffic-fade.mp4\")","visibility":"hide","key":"kqukCwWXA4"},{"type":"output","id":"fIGlgp56VxLzWK81f-wtF","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-fade.mp4\n"},{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-fade.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"04ba6f64d6095f98be3ec71671dfc10c","path":"/build/04ba6f64d6095f98be3ec71671dfc10c.html"}}}],"visibility":"show","key":"eUhfjYjegO"}],"visibility":"show","key":"GS5Xtm2GAw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vHCbQnT2N9"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"G0RyT1WjZn"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TcySGJ97t7"}],"key":"ikPPJLhh5n"}],"key":"T7X8xTPGGD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:37:53.555000Z","iopub.status.busy":"2025-01-14T15:34:12.640000Z","iopub.execute_input":"2025-01-14T15:34:12.642000Z","shell.execute_reply":"2025-01-14T15:37:53.549000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ρ_init = @. 400 + 80 * exp( -16*(x - 3)^2 )\nIVP = ODEProblem(ode, ρ_init, (0., 0.5), 0.02)\nsol = solve(IVP, Rodas4P());","key":"AY8Qhb3Z0u"},{"type":"output","id":"DswWsSY7cN4FGShKJBlLm","data":[],"key":"TEByzzuqmx"}],"key":"meR0XFWRuT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:37:55.523000Z","iopub.status.busy":"2025-01-14T15:37:53.580000Z","iopub.execute_input":"2025-01-14T15:37:53.582000Z","shell.execute_reply":"2025-01-14T15:37:55.519000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    legend=:topleft,\n    title=\"Traffic jam\",\n    xaxis=(L\"x\"),  yaxis=(\"car density\"))\nfor t in range(0, 0.5, 11)\n    plot!(x, sol(t), label=@sprintf(\"t=%.1f\", t))\nend\nplt","visibility":"hide","key":"Ih55YHZIqP"},{"type":"output","id":"IeXN9x2pR0cb1u42kPF-Q","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4c4dd2a590aa9b7216ff23592fd28913","path":"/build/4c4dd2a590aa9b7216ff23592fd28913.png"},"text/html":{"content_type":"text/html","hash":"4b1a296d0862be11d2f73922115272cc","path":"/build/4b1a296d0862be11d2f73922115272cc.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"9b3f0969634b12e1fcc2c0e3d9c18a23","path":"/build/9b3f0969634b12e1fcc2c0e3d9c18a23.svg"}}}],"visibility":"show","key":"k6ONCZcpW7"}],"visibility":"show","key":"oRSQ88SMVl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:38:28.213000Z","iopub.status.busy":"2025-01-14T15:37:55.547000Z","iopub.execute_input":"2025-01-14T15:37:55.551000Z","shell.execute_reply":"2025-01-14T15:38:28.213000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.5, 101) \n    plot(x, sol(t);\n        xaxis=(L\"x\"),  yaxis=([400,480], \"density\"),\n        dpi=150,  title=@sprintf(\"Traffic jam, t=%.2f\",t))\nend\nmp4(anim,\"traffic-jam.mp4\")","visibility":"hide","key":"zWbIajnDCW"},{"type":"output","id":"iUQ2CkuMQz_d7WSP7_64B","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-jam.mp4\n"},{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section1/julia/traffic-jam.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"5e6c0173dc440b6138780c5c63c24a23","path":"/build/5e6c0173dc440b6138780c5c63c24a23.html"}}}],"visibility":"show","key":"zjQGCTaW98"}],"visibility":"show","key":"KEfd7KgQS0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FYod7bxUpo"}],"key":"orVvMPqHo3"}],"key":"DHfRIOERzg"}],"key":"wa9QttGXr7"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Advection","url":"/advection","group":"Chapter 12"},"next":{"title":"Cfl","url":"/cfl","group":"Chapter 12"}}},"domain":"http://localhost:3000"}