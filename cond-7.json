{"kind":"Notebook","sha256":"2c385810fabd3995c7bd520f560e612211da5486c135827e42f474ba142a7ad2","slug":"cond-7","location":"/chapter5/section1/python/cond.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"myst","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"cond.ipynb","url":"/fnc/build/cond-cfa2394071f54e1e820064d6ba002f99.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"jOybJPWbjA"},{"type":"output","id":"smLYtXpC6PSHwiRUPr1Zb","data":[],"visibility":"show","key":"e7LsC96D5u"}],"visibility":"remove","key":"rnIBI4VTd6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"hcE09SHGgi"},{"type":"text","value":"5.1.4","key":"feqQhgCY3x"}],"key":"rltzaQK8qr"}],"identifier":"demo-interp-cond","label":"demo-interp-cond","kind":"proof:example","template":"Example %s","enumerator":"5.1.4","resolved":true,"html_id":"demo-interp-cond","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"NwQNHtQJJV"}],"key":"piRrTJAAgi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cyy4XTPDtq"},{"type":"crossReference","kind":"proof:example","identifier":"demo-interpolation-global","label":"demo-interpolation-global","children":[{"type":"text","value":"Demo ","key":"r8SsCs41Zu"},{"type":"text","value":"5.1.1","key":"OKepbzZcHB"}],"template":"Example %s","enumerator":"5.1.1","resolved":true,"html_id":"demo-interpolation-global","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"Rx5KDI0sgu"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QrKxkYRbOL"},{"type":"crossReference","kind":"proof:example","identifier":"demo-interpolation-pwise","label":"demo-interpolation-pwise","children":[{"type":"text","value":"Demo ","key":"HlS376Zf8k"},{"type":"text","value":"5.1.3","key":"MEyMdZWdmG"}],"template":"Example %s","enumerator":"5.1.3","resolved":true,"html_id":"demo-interpolation-pwise","remote":true,"url":"/interpolation","dataUrl":"/interpolation.json","key":"r6XWhHogrY"},{"type":"text","value":" we saw a big difference between polynomial interpolation and piecewise polynomial interpolation of some arbitrarily chosen data. The same effects can be seen clearly in the cardinal functions, which are closely tied to the condition numbers.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ClxkPmj2Kx"}],"key":"BqmJftcxOi"}],"key":"HlEetbcNG6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.interpolate import interp1d\nn = 18\nt = linspace(-1, 1, n + 1)\ny = zeros(n + 1)\ny[9] = 1.0\np = interp1d(t, y, kind=\"cubic\")\n\nscatter(t, y, label=\"data\")\ntt = linspace(-1, 1, 400)\nplot(tt, p(tt), label=\"cardinal function\")\ntitle(\"Cubic spline cardinal function\")\nlegend();","key":"s5PTti4kw6"},{"type":"output","id":"idm7qUgCWM8OQapI4vQAT","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a0c421efea7e1172fae95c493a53bd20","path":"/fnc/build/a0c421efea7e1172fae95c493a53bd20.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"D1hS6W9kgD"}],"key":"qJ5EjHPHIL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The piecewise cubic cardinal function is nowhere greater than one in absolute value. This happens to be true for all the cardinal functions, ensuring a good condition number for any interpolation with these functions. But the story for global polynomials is very different.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KIGCtYWqOO"}],"key":"ecygOHaIkI"}],"key":"kA2FL0mO3b"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy import polyfit, poly1d\np = poly1d(polyfit(t, y, n))\nscatter(t, y, label=\"data\")\nplot(tt, p(tt), label=\"cardinal function\")\nxlabel(\"$x$\")\nylabel(\"$y$\")\ntitle(\"Polynomial cardinal function\")\nlegend();","key":"A9M2vNgskb"},{"type":"output","id":"z5T1oNyJjND7oFzij_b0k","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1c76cefdcc891d5ed1675c9b677926c3","path":"/fnc/build/1c76cefdcc891d5ed1675c9b677926c3.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"taOZPEIySm"}],"key":"R1mBbSBnhc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the figure we can see that the condition number for polynomial interpolation on these nodes is at least 500.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LGGotIa8cz"}],"key":"uhbjw06HQN"}],"key":"kCAp86PpC2"}],"key":"YAMrcSr7Si"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Pwise","url":"/pwise-2","group":"Chapter 5"},"next":{"title":"Hat","url":"/hat-2","group":"Chapter 5"}}},"domain":"http://localhost:3000"}