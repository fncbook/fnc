{"kind":"Notebook","sha256":"82f590fe29fc4ce80a5965fe271853f9706f9957c75ad1bd093da07cbf1bc423","slug":"tempfit","location":"/chapter3/section1/julia/tempfit.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"tempfit.ipynb","url":"/build/tempfit-79e7c08bb9684af393b3747885704e01.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"JujEP7brnP"},{"type":"text","value":"3.1.2","key":"UvDFEgKWVx"}],"key":"gyQ8XgTwZZ"}],"identifier":"demo-fitting-tempfit","label":"demo-fitting-tempfit","kind":"proof:example","template":"ExampleÂ %s","enumerator":"3.1.2","resolved":true,"html_id":"demo-fitting-tempfit","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"D1AiEq5ngG"}],"key":"B9wlo0TWxN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here are the 5-year temperature averages again.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JiXnWFgyFN"}],"key":"uWyk1Co0AK"}],"key":"D7mXlMLDG5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:33:36.077000Z","iopub.status.busy":"2025-01-14T15:33:10.310000Z","iopub.execute_input":"2025-01-14T15:33:12.505000Z","shell.execute_reply":"2025-01-14T15:33:36.072000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\nt = @. (year - 1950) / 10\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n          0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]","key":"r7lzECz56d"},{"type":"output","id":"Ey5VJxhsij6_9pptH3ogW","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n -0.048\n -0.018\n -0.036\n -0.012\n -0.004\n  0.118\n  0.21\n  0.332\n  0.334\n  0.456","content_type":"text/plain"}}}],"key":"NGrxLeOl2r"}],"key":"hz8bO7PNyn"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The standard best-fit line results from using a linear polynomial that meets the least-squares criterion.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"z9IpwpG8bV"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-W6FvcpLHkM","identifier":"index-w6fvcplhkm","html_id":"index-w6fvcplhkm","key":"LjFiRtMXf9"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"HE2SlkxzYm"}],"key":"cZRrFY7sMS"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Backslash solves overdetermined linear systems in a least-squares sense.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O8LENT18c1"}],"key":"sNVmSna22S"}],"class":"dropdown","key":"VlrlzdtMp4"}],"key":"UEOemXp3JE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:33:52.947000Z","iopub.status.busy":"2025-01-14T15:33:36.089000Z","iopub.execute_input":"2025-01-14T15:33:36.090000Z","shell.execute_reply":"2025-01-14T15:33:52.943000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials\nV = [ t.^0 t ]    # Vandermonde-ish matrix\n@show size(V)\nc = V \\ temp\np = Polynomial(c)","key":"viOYZYZivD"},{"type":"output","id":"T0gSGSaGUNDYejkAfphY_","data":[{"name":"stdout","output_type":"stream","text":"size(V) = (10, 2)"},{"name":"stdout","output_type":"stream","text":"\n"},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"Polynomial(-0.18773333333333356 + 0.11670303030303034*x)","content_type":"text/plain"},"text/html":{"content":"&#45;0.18773333333333356 &#43; 0.11670303030303034&#8729;x","content_type":"text/html"},"text/latex":{"content":"$-0.18773333333333356 + 0.11670303030303034\\cdot x$","content_type":"text/latex"}}}],"key":"eq1IUgcH8X"}],"key":"E61C3PxyYi"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:32.596000Z","iopub.status.busy":"2025-01-14T15:33:52.995000Z","iopub.execute_input":"2025-01-14T15:33:52.996000Z","shell.execute_reply":"2025-01-14T15:34:32.593000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"f = yr -> p((yr - 1955) / 10)\nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", leg=:bottomright)\nplot!(f, 1955, 2000, label=\"linear fit\")","key":"I2Om4KMfJh"},{"type":"output","id":"EgF-Sk_a4bxIqW1r7oxF2","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c154bb9e7191c4921546b7c6472887e0","path":"/build/c154bb9e7191c4921546b7c6472887e0.png"},"text/html":{"content_type":"text/html","hash":"2107dd5ae92cc75c9874d242325e4a2b","path":"/build/2107dd5ae92cc75c9874d242325e4a2b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"5d8406359c80359085ede8c482fbd8b5","path":"/build/5d8406359c80359085ede8c482fbd8b5.svg"}}}],"key":"bPxuV3Hkgi"}],"key":"ez2X5JRojr"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we use a global cubic polynomial, the points are fit more closely.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b0FlqOOOBN"}],"key":"d1x6aQfkjH"}],"key":"TaXVvp8Gt1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:33.127000Z","iopub.status.busy":"2025-01-14T15:34:32.611000Z","iopub.execute_input":"2025-01-14T15:34:32.613000Z","shell.execute_reply":"2025-01-14T15:34:33.124000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t[i]^j for i in 1:length(t), j in 0:3 ]   \n@show size(V);","key":"Eh5AdK3NWt"},{"type":"output","id":"s6ONwqeNhoEk8oMiRkGKD","data":[{"name":"stdout","output_type":"stream","text":"size(V) = (10, 4)"},{"name":"stdout","output_type":"stream","text":"\n"}],"key":"KY0Cyk1nSA"}],"key":"ckqdK6lwWz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we solve the new least-squares problem to redefine the fitting polynomial.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aUWR7rbhN5"}],"key":"THbNOG6u0x"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"wXYklLRDSl"}],"key":"j1ykPznPnk"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The definition of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BjiBETXji8"},{"type":"inlineCode","value":"f","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ybUmjotA9S"},{"type":"text","value":" above is in terms of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ejXTLn0Pcu"},{"type":"inlineCode","value":"p","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mtFjrBOan3"},{"type":"text","value":". When ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"PGDZ0HxACL"},{"type":"inlineCode","value":"p","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"u3UIxFBqAf"},{"type":"text","value":" is changed, then ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tDP2kIi5lP"},{"type":"inlineCode","value":"f","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GLrYhaohGf"},{"type":"text","value":" calls the new version.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"w7KXKLwdpp"}],"key":"g1PZ0I7lQi"}],"class":"dropdown","key":"wCyF2m6mtg"}],"key":"UVAb8uU8sX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:34:33.309000Z","iopub.status.busy":"2025-01-14T15:34:33.130000Z","iopub.execute_input":"2025-01-14T15:34:33.130000Z","shell.execute_reply":"2025-01-14T15:34:33.305000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"p = Polynomial( V \\ temp )\nplot!(f, 1955, 2000, label=\"cubic fit\")","key":"ERCHK4c9C0"},{"type":"output","id":"YG8DA2bN5q4duraznf884","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3b4ac1918b5ad83106e92af6f49b2c14","path":"/build/3b4ac1918b5ad83106e92af6f49b2c14.png"},"text/html":{"content_type":"text/html","hash":"39a609d784339b74db9cc456e8960c12","path":"/build/39a609d784339b74db9cc456e8960c12.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"023926d84245a157f2a0cea49c8572c6","path":"/build/023926d84245a157f2a0cea49c8572c6.svg"}}}],"key":"njl2VYLpRd"}],"key":"x8wUFuMipi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we were to continue increasing the degree of the polynomial, the residual at the data points would get smaller, but overfitting would increase.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IVoRQ0hda5"}],"key":"WSq8bPLJIN"}],"key":"FsQf53bVyI"}],"key":"mtV1Tm7GLe"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Tempinterp","url":"/tempinterp","group":"Chapter 3"},"next":{"title":"Pirate","url":"/pirate","group":"Chapter 3"}}},"domain":"http://localhost:3000"}