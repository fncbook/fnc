{"kind":"Article","sha256":"2655df5205fc51ef6df57b1c6cae9bfe6e1e1ee7530399241ef0d3ed1dc09ff4","slug":"upwind","location":"/chapter12/section2/upwind.md","dependencies":[],"frontmatter":{"title":"Upwinding and stability","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"12.2.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"thumbnail":"/build/cflpicture-77c47afca8a500b901145f3a91870863.svg","exports":[{"format":"md","filename":"upwind.md","url":"/build/upwind-4a47d702229e34a7fa39ca44642efc45.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Let’s focus on the constant-velocity linear advection equation,","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"w3fWchi96i"}],"indexEntries":[{"entry":"advection equation","emphasis":false}],"label":"index-iywRFVMz0R","identifier":"index-iywrfvmz0r","html_id":"index-iywrfvmz0r","key":"MtuLjWmUmn"},{"type":"math","value":"  u_t + c u_x = 0, \\quad u(0,x)=u_0(x).","label":"advectioncc","identifier":"advectioncc","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><mi>c</mi><msub><mi>u</mi><mi>x</mi></msub><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>u</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  u_t + c u_x = 0, \\quad u(0,x)=u_0(x).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"12.2.1","html_id":"advectioncc","key":"Uvts0PqxBY"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"For now, we suppose there are no boundaries. Keep in mind that ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"rpziJZpfMM"},{"type":"inlineMath","value":"c","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"oBCdSzjvYV"},{"type":"text","value":" is a velocity, not a speed: if ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"QAghKqymBF"},{"type":"inlineMath","value":"c>0","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"DvYHrbGH4V"},{"type":"text","value":", solutions travel rightward, and if ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Ye8zQ9k0Qj"},{"type":"inlineMath","value":"c<0","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&lt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"OGFuvgiFOb"},{"type":"text","value":", they travel leftward.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"tSQUaPA3N9"}],"key":"X600qhkQ57"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"eQ35hcY8ok"},{"type":"link","kind":"numref","identifier":"section-advection-traffic","label":"section-advection-traffic","url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"bTWeFK5XqE"}],"key":"Ey96gCp7hD"},{"type":"text","value":" we argued that ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"AIPu0iMQwC"},{"type":"inlineMath","value":"u(x,t)=\\psi(x-ct)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>ψ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>c</mi><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,t)=\\psi(x-ct)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">ψ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"xS0mfzGbeb"},{"type":"text","value":" is a solution of ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"nTlapR86UU"},{"type":"crossReference","kind":"equation","identifier":"advectioncc","label":"advectioncc","children":[{"type":"text","value":"(","key":"zYkwIUW9jk"},{"type":"text","value":"12.2.1","key":"YNcOqEwa5q"},{"type":"text","value":")","key":"B2x4tJlIpj"}],"template":"(%s)","enumerator":"12.2.1","resolved":true,"html_id":"advectioncc","key":"jy3cUZyECT"},{"type":"text","value":". It’s therefore clear that ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"mCPblv4rlu"},{"type":"inlineMath","value":"u(x,t)=u_0(x-ct)","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>u</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><mi>c</mi><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,t)=u_0(x-ct)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"iQbFOQa7oh"},{"type":"text","value":".","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"zCqkfLrzEb"}],"indexEntries":[{"entry":"domain of dependence","emphasis":true},{"entry":"upwind direction","emphasis":true}],"label":"index-sPojbDmics","identifier":"index-spojbdmics","html_id":"index-spojbdmics","key":"WQifQ1HScy"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Domain of dependence","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"BU28iuWbHd"}],"key":"sRop9KWGur"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"PdQa83AEDo"},{"type":"inlineMath","value":"u(x,t)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"CDKES4O0qH"},{"type":"text","value":" be the solution of an evolutionary ","key":"FO8YygMWyy"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"A1lohZ6Z7T"}],"key":"SRM0eu9rKr"},{"type":"text","value":" with initial condition ","key":"gEQCGoCgXK"},{"type":"inlineMath","value":"u_0(x)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_0(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"UyuZNpOa8c"},{"type":"text","value":". The  ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"oknYxoks2c"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"domain of dependence","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"QeASXZtCIT"}],"key":"jjwTbUHrST"},{"type":"text","value":" of the solution at ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"JaqkalH1PH"},{"type":"inlineMath","value":"(x,t)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"X4bNtLsCJL"},{"type":"text","value":" is the set of all ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"RBJoRwf6Fn"},{"type":"inlineMath","value":"x","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"UdkLW6c7qx"},{"type":"text","value":" such that ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Gs0RTVZul5"},{"type":"inlineMath","value":"u_0(x)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>0</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_0(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"lqmWiUds3x"},{"type":"text","value":" can possibly affect ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"R4VJeIbhpL"},{"type":"inlineMath","value":"u(x,t)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"Na11lqioFx"},{"type":"text","value":". If this domain of dependence lies entirely in one direction relative to ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"tphZ8KgcXl"},{"type":"inlineMath","value":"x","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"hbwKo0sNfw"},{"type":"text","value":", then that direction is called the ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"X2dHz2pMuV"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"upwind","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"aTTJxfvASi"}],"key":"RfmmI6si7D"},{"type":"text","value":" direction of the ","key":"cVmdLwjlYy"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"hkOVmMbmnX"}],"key":"JOXposqwCQ"},{"type":"text","value":", and its opposite is the ","key":"BMzNh7zvnz"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"downwind","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"nfMipeHXR0"}],"key":"IGFLGoJ1H4"},{"type":"text","value":" direction.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"D33pAKvtb7"}],"key":"vLLUgHW2Ps"}],"label":"definition-upwind-domdep","identifier":"definition-upwind-domdep","html_id":"definition-upwind-domdep","enumerator":"12.2.1","key":"sM8RySEIfU"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"In the advection equation, the domain of dependence at ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"tIBb7dcZqq"},{"type":"inlineMath","value":"(x,t)","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"cEaejQbtX2"},{"type":"text","value":" is the single point ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"oTA8UjQdoT"},{"type":"inlineMath","value":"\\{x-ct\\}","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><mi>x</mi><mo>−</mo><mi>c</mi><mi>t</mi><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{x-ct\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">}</span></span></span></span>","key":"eulEOQTdr9"},{"type":"text","value":", and the upwind direction is to the left or to the right of ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"TA1Hd3BtrJ"},{"type":"inlineMath","value":"x","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"h4goKSE1y9"},{"type":"text","value":" if ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"QM92myh72L"},{"type":"inlineMath","value":"c","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"fcivaL9wyy"},{"type":"text","value":" is positive or negative, respectively.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"OfnGvyM02P"}],"key":"cmFm7iDjPl"},{"type":"paragraph","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Any numerical method we choose has an analogous property.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"QpjoyCUWx7"}],"key":"fwqqlaQ60i"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Numerical domain of dependence","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"qP7L0lhb53"}],"key":"W5VrFm99Qc"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"KgbnzK7T8Y"},{"type":"inlineMath","value":"U_{i,j}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"niT3jej5Lz"},{"type":"text","value":" be the approximate solution of an evolutionary ","key":"l2FeqR49vN"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"kY5RzBFff2"}],"key":"ntyO0esOCR"},{"type":"text","value":" at ","key":"tMiEEmZSOr"},{"type":"inlineMath","value":"x=x_i","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x=x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zxk9V1Ajfi"},{"type":"text","value":", ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"aRv8SNjFQ9"},{"type":"inlineMath","value":"t=t_j","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9012em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Q1D0zS5WOe"},{"type":"text","value":" from a numerical method, when the initial condition is given by ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"ihU1EafL1X"},{"type":"inlineMath","value":"U_{i,0}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"aQ7Vg8tWdA"},{"type":"text","value":" for all ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"MFWLrwqnVf"},{"type":"inlineMath","value":"i","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"PLcE6un3Z0"},{"type":"text","value":". The ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"NOTLJo2UQ7"},{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"numerical domain of dependence","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"lqjSnU77gb"}],"key":"gIYbhVeSyl"},{"type":"text","value":" of the method at ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"jq4GjHW2za"},{"type":"inlineMath","value":"(x_i,t_j)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_i,t_j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"sOb9ewK1yE"},{"type":"text","value":" is the set of all ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"I6LivHq7gs"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WYXRAfXFAJ"},{"type":"text","value":" such that ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"FmeAXJ07lT"},{"type":"inlineMath","value":"U_{i,0}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DLIVO8F7nE"},{"type":"text","value":" can possibly affect ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"cJrNXWJS10"},{"type":"inlineMath","value":"U_{i,j}","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SjtBBXMwY6"},{"type":"text","value":".","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"d7BbMWpIrJ"}],"key":"vKDBP9TO4a"}],"label":"definition-upwind-numdomdep","identifier":"definition-upwind-numdomdep","html_id":"definition-upwind-numdomdep","enumerator":"12.2.2","key":"mZRgTOhlgD"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"lORHXWLGUT"},{"type":"crossReference","kind":"equation","identifier":"advectioncc","label":"advectioncc","children":[{"type":"text","value":"(","key":"d5lEWQ3A4U"},{"type":"text","value":"12.2.1","key":"xl06eFM0B7"},{"type":"text","value":")","key":"XYQgLxHJkc"}],"template":"(%s)","enumerator":"12.2.1","resolved":true,"html_id":"advectioncc","key":"AE6f141h1f"},{"type":"text","value":", suppose we discretize ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"eCgSKIlJNp"},{"type":"inlineMath","value":"u_x","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cYsHZ3EkPL"},{"type":"text","value":" by a centered difference,","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"CyG54Ws6FJ"}],"key":"idK5scRlfF"},{"type":"math","value":"  u_x(x_i,t_j) \\approx \\frac{U_{i+1,j}-U_{i-1,j}}{2h}.","label":"cflcentral","identifier":"cflcentral","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>≈</mo><mfrac><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>U</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><mrow><mn>2</mn><mi>h</mi></mrow></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  u_x(x_i,t_j) \\approx \\frac{U_{i+1,j}-U_{i-1,j}}{2h}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"12.2.2","html_id":"cflcentral","key":"o0dZgsDzg2"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"If we use the Euler time discretization, then","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"oaTP10qRbi"}],"key":"r6yWsdW9t2"},{"type":"math","value":"  \\mathbf{u}_{j+1} = (\\mathbf{I} - c \\tau \\mathbf{D}_x) \\mathbf{u}_j,","label":"cflcenteuler","identifier":"cflcenteuler","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">u</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">I</mi><mo>−</mo><mi>c</mi><mi>τ</mi><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"bold\">u</mi><mi>j</mi></msub><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{u}_{j+1} = (\\mathbf{I} - c \\tau \\mathbf{D}_x) \\mathbf{u}_j,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7305em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"12.2.3","html_id":"cflcenteuler","key":"k14KvDtvpt"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"rXPieClW1u"},{"type":"text","value":"τ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"ZulcQoRXM0"},{"type":"text","value":" is the time step. Because the matrix in this time step is tridiagonal, the entry ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"FqA49jU0NE"},{"type":"inlineMath","value":"U_{i,j}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LzQHXNp5Em"},{"type":"text","value":" can depend directly only on ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"uvMxhyi42A"},{"type":"inlineMath","value":"U_{i-1,j}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i-1,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"yWLvhjv5Gf"},{"type":"text","value":", ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"Tjh4PTJ3BU"},{"type":"inlineMath","value":"U_{i,j}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"viPg0ccL6o"},{"type":"text","value":", and ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"XIE5gTlXHV"},{"type":"inlineMath","value":"U_{i+1,j}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i+1,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ysviWdl7mA"},{"type":"text","value":". Going back another time step, the dependence extends to space positions ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"mNyzd2rs2j"},{"type":"inlineMath","value":"i-2","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>−</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i-2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"Jh6jF4FmOn"},{"type":"text","value":" and ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"A50wnzXqbA"},{"type":"inlineMath","value":"i+2","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">i+2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7429em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"uuxMlKQFaB"},{"type":"text","value":", and so on. When we reach the initial time, the dependence of ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"wEUhnFECGG"},{"type":"inlineMath","value":"U_{i,j}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fqiJ6LPwk6"},{"type":"text","value":" reaches from ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"ixU1fvNvdZ"},{"type":"inlineMath","value":"x_{i-j}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>−</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{i-j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Yyxjzk224O"},{"type":"text","value":" to ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"LQCqVudkvs"},{"type":"inlineMath","value":"x_{i+j}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{i+j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Hmszj9AwPp"},{"type":"text","value":", or between ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"vsmrEuOLMQ"},{"type":"inlineMath","value":"x_i-jh","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>j</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">x_i-jh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">jh</span></span></span></span>","key":"UtnApFUWBq"},{"type":"text","value":" and ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"KpWcx1q2RQ"},{"type":"inlineMath","value":"x_i+jh","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>j</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">x_i+jh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">jh</span></span></span></span>","key":"INROf0aunQ"},{"type":"text","value":". If we ignore boundaries, the situation is illustrated in ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"NtK4u0TsHQ"},{"type":"crossReference","kind":"figure","identifier":"figure-cflpicture","label":"figure-cflpicture","children":[{"type":"text","value":"Figure ","key":"QlqRkDwWFR"},{"type":"text","value":"12.2.1","key":"rKwOcjcStk"}],"template":"Figure %s","enumerator":"12.2.1","resolved":true,"html_id":"figure-cflpicture","key":"TEyLKR0SEq"},{"type":"text","value":". As ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"OdzMC45ooQ"},{"type":"inlineMath","value":"\\tau,h\\rightarrow 0","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo separator=\"true\">,</mo><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau,h\\rightarrow 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"TV6V1UHuNW"},{"type":"text","value":", the numerical domain of dependence fills in the shaded region in the figure, but that region itself does not change.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"ruq9mvdfQ1"}],"key":"Jm2kO8y0jz"}],"label":"example-upwind-centered","identifier":"example-upwind-centered","html_id":"example-upwind-centered","enumerator":"12.2.1","key":"FVwPExc6Az"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/build/cflpicture-77c47afca8a500b901145f3a91870863.svg","alt":"Numerical domain of dependence for the explicit time stepping scheme in Example {number}. If  \\tau and h are infinitesimally small, the shaded region is filled in.","width":"450px","data":{"altTextIsAutoGenerated":true},"urlSource":"cflpicture.svg","key":"cnfv3Uvxgo"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"captionNumber","kind":"figure","label":"figure-cflpicture","identifier":"figure-cflpicture","html_id":"figure-cflpicture","enumerator":"12.2.1","children":[{"type":"text","value":"Figure ","key":"syhgMcKX9r"},{"type":"text","value":"12.2.1","key":"NPYt36FwK6"},{"type":"text","value":":","key":"pbHOcH4wWn"}],"template":"Figure %s:","key":"JJHU1VxnwK"},{"type":"text","value":"Numerical domain of dependence for the explicit time stepping scheme in ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"xvU6e3bPco"},{"type":"crossReference","kind":"proof:example","identifier":"example-upwind-centered","label":"example-upwind-centered","children":[{"type":"text","value":"Example ","key":"oPePid6VPb"},{"type":"text","value":"12.2.1","key":"yC8sTEbMmA"}],"template":"Example %s","enumerator":"12.2.1","resolved":true,"html_id":"example-upwind-centered","key":"kq8HVYD6CH"},{"type":"text","value":". If  ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"OAW8SYJPcp"},{"type":"text","value":"τ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Dgs5qXBvJz"},{"type":"text","value":" and ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Rt8LYIuau0"},{"type":"inlineMath","value":"h","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"wuu2MXKFkd"},{"type":"text","value":" are infinitesimally small, the shaded region is filled in.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"LuNdXC9Las"}],"key":"NYr1913tbJ"}],"key":"Gz2Li0gjpS"}],"label":"figure-cflpicture","identifier":"figure-cflpicture","enumerator":"12.2.1","html_id":"figure-cflpicture","key":"dzuuwElve9"},{"type":"heading","depth":2,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"The CFL condition","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"WSk6SO9S8W"}],"identifier":"the-cfl-condition","label":"The CFL condition","html_id":"the-cfl-condition","implicit":true,"enumerator":"12.2.1","key":"yTFghMPDZh"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"We now state an important principle about a required relationship between the domains of dependence.","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"hvQXCp1qXM"}],"key":"FNkHmvEZk6"},{"type":"proof","kind":"theorem","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Courant–Friedrichs–Lewy (CFL) condition","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"lcKuqkgGtF"}],"key":"m5Q8NyUIi9"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"In order for a numerical method for an advection equation to converge to the correct solution, the limiting numerical domain of dependence must contain the exact domain of dependence.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"Ni3FrITh1y"}],"key":"MquWmkBJzE"}],"label":"theorem-upwind-cfl","identifier":"theorem-upwind-cfl","html_id":"theorem-upwind-cfl","indexEntries":[{"entry":"CFL condition","emphasis":true}],"enumerator":"12.2.1","key":"r1anTmVWL3"},{"type":"admonition","kind":"caution","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Caution","key":"K4NF5kqytM"}],"key":"SydSJsE6Hd"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"The CFL condition is a ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"R6VmnA7o4Z"},{"type":"emphasis","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"necessary","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"wHzH1409d5"}],"key":"bcXDlYGO4v"},{"type":"text","value":" criterion for convergence, but not a ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"XZKZCxZmuC"},{"type":"emphasis","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"sufficient","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"Zbis9MsGVH"}],"key":"C2Wm973wdz"},{"type":"text","value":" one. For instance, we could define ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"o3qQMCITmw"},{"type":"inlineMath","value":"U_{i,j}","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Ikyjyw4M36"},{"type":"text","value":" to be any weighted convergent sum of all values of ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"WmxlY89lTi"},{"type":"inlineMath","value":"U_{i,0}","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mn>0</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zCdwnyZi9J"},{"type":"text","value":". While that would make the numerical domain of dependence equal to the entire real line, this method has nothing to do with solving any ","key":"ZUW3ecUETx"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"OLx7zJUbGZ"}],"key":"JgpSJR5G2W"},{"type":"text","value":" correctly!","key":"dxfu1Ds5Xd"}],"key":"u6SPAo3vg2"}],"key":"T6cX6DcgZO"},{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Although we will not provide the rigor behind this theorem, its conclusion is not difficult to justify. If the CFL condition does not hold, the exact solution at ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"NkX04GhGJD"},{"type":"inlineMath","value":"(x,t)","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"BmasCkziGz"},{"type":"text","value":" could be affected by a change in the initial data while having no effect on the numerical solution. Hence there is no way for the method to get the solution correct for all problems. By contradiction, then, the CFL criterion is necessary for convergence.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"Z3WW07WTAl"}],"key":"YxdJ5ygucj"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"Returning to ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"nLfocaYwFQ"},{"type":"crossReference","kind":"proof:example","identifier":"example-upwind-centered","label":"example-upwind-centered","children":[{"type":"text","value":"Example ","key":"BpAnWgjzoP"},{"type":"text","value":"12.2.1","key":"PQl2uiYcIa"}],"template":"Example %s","enumerator":"12.2.1","resolved":true,"html_id":"example-upwind-centered","key":"jCnatfqWP0"},{"type":"text","value":", the numerical domain of dependence depicted in ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"ucywYXjHzp"},{"type":"crossReference","kind":"figure","identifier":"figure-cflpicture","label":"figure-cflpicture","children":[{"type":"text","value":"Figure ","key":"K7N0QFlG9K"},{"type":"text","value":"12.2.1","key":"LUnqEXtb3H"}],"template":"Figure %s","enumerator":"12.2.1","resolved":true,"html_id":"figure-cflpicture","key":"IIwfRYLShm"},{"type":"text","value":" contains the exact domain of dependence ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"iYmTyfsCgM"},{"type":"inlineMath","value":"\\{x_i-c t_j\\}","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>c</mi><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{x_i-c t_j\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span>","key":"aueQo4KlE0"},{"type":"text","value":" only if ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"os9rVqsAsO"},{"type":"inlineMath","value":"x_i-j h \\le x_i -c t_j \\le x_i+jh","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>j</mi><mi>h</mi><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>c</mi><msub><mi>t</mi><mi>j</mi></msub><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>j</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">x_i-j h \\le x_i -c t_j \\le x_i+jh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">jh</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9221em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">jh</span></span></span></span>","key":"OMI4h7elAh"},{"type":"text","value":", or ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"zX28D9lnHP"},{"type":"inlineMath","value":"|c j\\tau|\\le j h","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi>c</mi><mi>j</mi><mi>τ</mi><mi mathvariant=\"normal\">∣</mi><mo>≤</mo><mi>j</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">|c j\\tau|\\le j h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">jh</span></span></span></span>","key":"MAgyOPgbYT"},{"type":"text","value":". That is,","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Nmgpqu2pKp"}],"key":"VbvJyYpvI0"},{"type":"math","value":"  \\frac{h}{\\tau} \\ge |c|, \\quad  \\tau,h\\rightarrow 0.","label":"cfl-speed","identifier":"cfl-speed","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mi>h</mi><mi>τ</mi></mfrac><mo>≥</mo><mi mathvariant=\"normal\">∣</mi><mi>c</mi><mi mathvariant=\"normal\">∣</mi><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi>τ</mi><mo separator=\"true\">,</mo><mi>h</mi><mo>→</mo><mn>0.</mn></mrow><annotation encoding=\"application/x-tex\">  \\frac{h}{\\tau} \\ge |c|, \\quad  \\tau,h\\rightarrow 0.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">c</span><span class=\"mord\">∣</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.</span></span></span></span></span>","enumerator":"12.2.4","html_id":"cfl-speed","key":"fJ0WNWPiUc"}],"label":"example-upwind-centeredcfl","identifier":"example-upwind-centeredcfl","html_id":"example-upwind-centeredcfl","enumerator":"12.2.2","key":"salSgYHz93"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"Equation ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"th8Y2HpbER"},{"type":"crossReference","kind":"equation","identifier":"cfl-speed","label":"cfl-speed","children":[{"type":"text","value":"(","key":"seGCDwNzxd"},{"type":"text","value":"12.2.4","key":"Eu3LJCPugY"},{"type":"text","value":")","key":"sAeyO0mBP5"}],"template":"(%s)","enumerator":"12.2.4","resolved":true,"html_id":"cfl-speed","key":"Oh85kqNljZ"},{"type":"text","value":" is the implication of the CFL condition for the stated discretization. Notice that ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"NZXu30OVR1"},{"type":"inlineMath","value":"h/\\tau","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mi mathvariant=\"normal\">/</mi><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">h/\\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span>","key":"aOqziz88WU"},{"type":"text","value":" is the speed at which information moves in the numerical method; thus, it is common to restate the CFL condition in terms of speeds.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"nowM0uj5XH"}],"key":"kmhRhaOFJy"},{"type":"proof","kind":"observation","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"The CFL condition required that the maximum propagation speed in the numerical method be at least as large as the maximum speed in the original ","key":"B3o3OMM8RL"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"ZBe08w8YQX"}],"key":"mnbSztdrwv"},{"type":"text","value":" problem.","key":"QU5v9ehv92"}],"key":"h0abyLpNXk"}],"enumerator":"12.2.1","key":"lkaNlBUpSO"},{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"We can rearrange ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"MndB6GQtXu"},{"type":"crossReference","kind":"equation","identifier":"cfl-speed","label":"cfl-speed","children":[{"type":"text","value":"(","key":"LuMaH9k6aG"},{"type":"text","value":"12.2.4","key":"XoMQwBLKLV"},{"type":"text","value":")","key":"qyc5RoKreT"}],"template":"(%s)","enumerator":"12.2.4","resolved":true,"html_id":"cfl-speed","key":"eXT1KwsC0T"},{"type":"text","value":" to imply a necessary time step restriction ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"ToZ98dUS33"},{"type":"inlineMath","value":"\\tau \\le h/|c|","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>≤</mo><mi>h</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∣</mi><mi>c</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\tau \\le h/|c|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mord\">/∣</span><span class=\"mord mathnormal\">c</span><span class=\"mord\">∣</span></span></span></span>","key":"kwQszRcvKL"},{"type":"text","value":". This restriction for advection is much less severe than the ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"hvGw0CbhCE"},{"type":"inlineMath","value":"\\tau = O(h^2)","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\tau = O(h^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"soRmjWMuIk"},{"type":"text","value":" restriction we derived for Euler in the heat equation in ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"upfL8WFmDJ"},{"type":"link","kind":"numref","identifier":"section-diffusion-stiffness","label":"section-diffusion-stiffness","url":"/stiffness","internal":true,"dataUrl":"/stiffness.json","children":[{"type":"text","value":"Stiffness","key":"kmLkRHr56X"}],"key":"Rkrsq5bvcQ"},{"type":"text","value":", which is our first indication that advection is less stiff than diffusion.","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"kZcU5UKo1u"}],"key":"skgzykPE1Y"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"The CFL condition in action","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"evpY7kcRrJ"}],"key":"RTcRvESUet"},{"type":"include","file":"julia/cfl.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"dxNFMHVIwH"},{"type":"text","value":"12.2.3","key":"pM9rddvIvL"}],"key":"LZqJt8a9ED"}],"identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","key":"UYpq2wtfJr"}],"key":"j7qG5VR7P6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For time stepping, we use the adaptive explicit method ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LGFSt9yGLT"},{"type":"inlineCode","value":"RK4","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"akrJVsbveA"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TXNIugROpi"}],"key":"CsKvSzjaou"}],"key":"ywyZ3ELSwZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:33.812000Z","iopub.status.busy":"2025-01-14T15:18:29.844000Z","iopub.execute_input":"2025-01-14T15:18:30.244000Z","shell.execute_reply":"2025-01-14T15:18:33.799000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nm = 400;\nx, Dₓ = FNC.diffper(m, [0, 1])\nu_init = x -> exp( -80 * (x - 0.5)^2 )\node = (u, c, t) -> -c * (Dₓ*u)\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4());","key":"dTm6HKqdZC"},{"type":"output","id":"Yv4u-Y0tEdmL6K-Mq84DF","data":[],"key":"PINlSiovfd"}],"key":"Sjw9TjiKPB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:42.701000Z","iopub.status.busy":"2025-01-14T15:18:33.847000Z","iopub.execute_input":"2025-01-14T15:18:33.850000Z","shell.execute_reply":"2025-01-14T15:18:42.700000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 2, 81);\nU = reduce(hcat, u(t) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Linear advection\",  right_margin=3Plots.mm)","visibility":"hide","key":"dFSBD5VmFq"},{"type":"output","id":"5ecQbSyj-F5NwhdciA1Vv","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5265900b137297ac6f67467b0300043d","path":"/build/5265900b137297ac6f67467b0300043d.png"},"text/html":{"content_type":"text/html","hash":"7ddab68f698085bfaad895d1bb6b11c5","path":"/build/7ddab68f698085bfaad895d1bb6b11c5.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"02ef3d753165c94d3641541df75a0a91","path":"/build/02ef3d753165c94d3641541df75a0a91.svg"}}}],"visibility":"show","key":"w0CEiNw5uB"}],"visibility":"show","key":"OaeY8UmGd9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hcat3X36LR"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"oemNP3OqME"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ENM7MgKODU"}],"key":"voOT2YE1Am"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"A3F4J0JgnU"},{"type":"inlineMath","value":"h","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"XlXToRO90C"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"V0nhgtZMB1"},{"type":"inlineMath","value":"m","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"mhIlD01Wgq"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jpcMsCWuAG"}],"key":"yi2SreM07Q"}],"key":"Ae3HUoqfsd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:19:21.559000Z","iopub.status.busy":"2025-01-14T15:18:42.718000Z","iopub.execute_input":"2025-01-14T15:18:42.718000Z","shell.execute_reply":"2025-01-14T15:19:21.558000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"println(\"Number of time steps for m = 400: $(length(u.t))\")\n\nm = 800;\nx, Dₓ = FNC.diffper(m, [0, 1])\nIVP = ODEProblem(ode, u_init.(x), (0., 2.), 2.)\nu = solve(IVP, RK4())\nprintln(\"Number of time steps for m = 800: $(length(u.t))\")","key":"AfksITZLOq"},{"type":"output","id":"cVw6lld8TkZsvEJVSv6fy","data":[{"name":"stdout","output_type":"stream","text":"Number of time steps for m = 400: 565\nNumber of time steps for m = 800: 1128\n"}],"key":"luhPrqeUtx"}],"key":"s4cUoPmQjk"}],"key":"yaQD16WP9g"}],"key":"xDTrq6Mkvt"}],"key":"Dcsq8DKL8N"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"The CFL condition in action","position":{"start":{"line":114,"column":1},"end":{"line":114,"column":1}},"key":"ysjY2lLpYE"}],"key":"WFJDnaTbHM"},{"type":"include","file":"matlab/cfl.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"fjd4Qv23E2"},{"type":"text","value":"12.2.3","key":"nJ3HpDu1mY"}],"key":"iZZN0WA082"}],"identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","key":"mCs4iS7dwF"}],"key":"Rxixvot3Pp"}],"key":"kFh8TFFooe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, Dx] = diffper(400, [0, 1]);\nc = 2;  \nivp = ode(ODEFcn = @(t, u) -c * (Dx*u));\nivp.RelativeTolerance = 1e-5;\nivp.InitialTime = 0;\nu_init = exp( -80*(x - 0.5).^2 );\nivp.InitialValue = u_init;\n\n[u, sol] = solutionFcn(ivp, 0, 2);","key":"QlHIgaF0QT"},{"type":"output","id":"-7XWwgzC7GeUIGiTfxroG","data":[],"key":"SIZVOEI3QI"}],"key":"OdWJtrgXQK"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nt = linspace(0, 2, 81);\ncontour(x, t, u(t)', 12)\nxlabel('x'),  ylabel('t')\ntitle('Linear advection')","visibility":"hide","key":"XebbmQaYxK"},{"type":"output","id":"TMbyIAGxUGO2hnUMeTjgJ","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c065717bf2a2b44728a64d3385b8d380","path":"/build/c065717bf2a2b44728a64d3385b8d380.png"}}}],"visibility":"show","key":"bfltqCdutQ"}],"visibility":"show","key":"QvKImUbnWY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T9xeXeir7Z"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"TXnnMroNXq"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hZsaStF7QO"}],"key":"cj5FR58mmB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t0JUPNnGb7"},{"type":"inlineMath","value":"h","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"gXqYSaCGIh"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cTeaqH9to5"},{"type":"inlineMath","value":"m","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"PHZdPWoiek"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"z8XXy0awVu"}],"key":"Ta7rsWifwy"}],"key":"C1aAvva2jt"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"num_steps_400 = length(sol.Time) - 1\n\n[x, Dx] = diffper(800, [0, 1]);\nivp.ODEFcn = @(t, u) -c * (Dx*u);\nivp.InitialValue = exp( -80*(x - 0.5).^2 );\n[u, sol] = solutionFcn(ivp, 0, 2);\n\nnum_steps_800 = length(sol.Time) - 1\nratio = num_steps_800 / num_steps_400","key":"zogT3IHXaU"},{"type":"output","id":"WbQ-PmJuaVqzCEQo4WL3d","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"num_steps_400 = 1139","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>num_steps_400 = 1139</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"num_steps_800 = 2489","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>num_steps_800 = 2489</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"ratio = 2.1853","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>ratio = 2.1853</pre></body></html>","content_type":"text/html"}}}],"key":"hh9z01CheF"}],"key":"CdCaktjYCf"}],"key":"NvliUBmH98"}],"key":"PJY2ejh3mZ"}],"key":"Qmj854h62R"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"The CFL condition in action","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"xP4Lv4VFjV"}],"key":"cP0B9gbiCk"},{"type":"include","file":"python/cfl.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:36:58.840025Z","iopub.status.busy":"2025-01-09T21:36:58.839938Z","iopub.status.idle":"2025-01-09T21:36:59.272072Z","shell.execute_reply":"2025-01-09T21:36:59.271791Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"B35OyusIQb"},{"type":"output","id":"J3__YHVlA60dE-t8uLdgx","data":[],"visibility":"show","key":"QdpMsYD1N9"}],"visibility":"remove","key":"fIZUsdJVh4"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"v0btnCsmQ3"},{"type":"text","value":"12.2.3","key":"md5FPEbM2V"}],"key":"z0ux2gzNru"}],"identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","template":"Example %s","enumerator":"12.2.3","resolved":true,"html_id":"demo-upwind-cfl","key":"ocxhPMPm6h"}],"key":"DUZbtgozUs"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For time stepping, we use the adaptive explicit method ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CCp3iGcNfm"},{"type":"inlineCode","value":"RK45","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xPzyuIZgHW"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sDeSLJ3ykw"}],"key":"ym7v829nse"}],"key":"Lv7e7thWpN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:36:59.273642Z","iopub.status.busy":"2025-01-09T21:36:59.273493Z","iopub.status.idle":"2025-01-09T21:36:59.447020Z","shell.execute_reply":"2025-01-09T21:36:59.446688Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nx, Dx, Dxx = FNC.diffper(400, [0, 1])\nu_init = exp(-80 * (x - 0.5) ** 2)\nc = 2\node = lambda t, u: -c * (Dx @ u)\nsol = solve_ivp(ode, (0, 2), u_init, method=\"RK45\", dense_output=True)\nu = sol.sol","key":"CoDYbWa80X"},{"type":"output","id":"79cZKd6D2PUWQviTc1ss6","data":[],"key":"E1e76ivKdT"}],"key":"AtJATOnoI1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:36:59.448483Z","iopub.status.busy":"2025-01-09T21:36:59.448380Z","iopub.status.idle":"2025-01-09T21:36:59.631057Z","shell.execute_reply":"2025-01-09T21:36:59.630750Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 2, 81)\nU = vstack([u(tj) for tj in t])\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Linear advection\");","visibility":"hide","key":"MWGFqF6yR9"},{"type":"output","id":"Ec78LCz17vpmp_l9BgpSv","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c7fcc525b10651df607cfaeb3692e2db","path":"/build/c7fcc525b10651df607cfaeb3692e2db.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"W5DvJkjdVp"}],"visibility":"show","key":"AJ234P4q5k"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y5mmLKsRsQ"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"AWZw5yrSfJ"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yycAUw8n6F"}],"key":"EJJ263I3Rv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iYEPwdPDMj"},{"type":"inlineMath","value":"h","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"cwLrwtKJQd"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AjVe9VJiMq"},{"type":"inlineMath","value":"m","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"HsXfcnIudm"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tXSivFJTbL"}],"key":"sKSuR9T6VO"}],"key":"aUEFJjpjIV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:36:59.632869Z","iopub.status.busy":"2025-01-09T21:36:59.632743Z","iopub.status.idle":"2025-01-09T21:37:00.318375Z","shell.execute_reply":"2025-01-09T21:37:00.318049Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"{len(sol.t) - 1} time steps taken for m = 400\")\nx, Dx, Dxx = FNC.diffper(800, [0, 1])\nu_init = exp(-80 * (x - 0.5) ** 2)\nsol = solve_ivp(ode, (0, 2), u_init, method=\"RK45\", dense_output=True)\nprint(f\"{len(sol.t) - 1} time steps taken for m = 800\")","key":"ERJmTRRGE3"},{"type":"output","id":"CDQ8Co1iaMxDEKbVY-EgG","data":[{"name":"stdout","output_type":"stream","text":"1416 time steps taken for m = 400\n"},{"name":"stdout","output_type":"stream","text":"2906 time steps taken for m = 800\n"}],"key":"Hf7feUjgui"}],"key":"uWg8ModBfW"}],"key":"hE9ZHCHzRT"}],"key":"p9PIp6FtdT"}],"key":"LsGi2QgDaP"}],"key":"uW5IzHtAoU"}],"label":"demo-upwind-cfl","identifier":"demo-upwind-cfl","html_id":"demo-upwind-cfl","enumerator":"12.2.3","key":"W2x0FXPpMd"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"Consider what happens in ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"j6VSGDCRJI"},{"type":"crossReference","kind":"proof:example","identifier":"example-upwind-centered","label":"example-upwind-centered","children":[{"type":"text","value":"Example ","key":"RIDdMW69QY"},{"type":"text","value":"12.2.1","key":"nIAvr0kABg"}],"template":"Example %s","enumerator":"12.2.1","resolved":true,"html_id":"example-upwind-centered","key":"MPEN6yp4BS"},{"type":"text","value":" if we replace Euler by backward Euler. Instead of ","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"X7n0kNZNZT"},{"type":"crossReference","kind":"equation","identifier":"cflcenteuler","label":"cflcenteuler","children":[{"type":"text","value":"(","key":"RyxNK0khb8"},{"type":"text","value":"12.2.3","key":"hS38inWChS"},{"type":"text","value":")","key":"PCJ0pkT8bV"}],"template":"(%s)","enumerator":"12.2.3","resolved":true,"html_id":"cflcenteuler","key":"fBPqd1EbqR"},{"type":"text","value":", we get","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"rrr0KyWCRy"}],"key":"H6fCTEj9ru"},{"type":"math","value":"\\begin{align*}\n\t(\\mathbf{I} + c \\tau \\mathbf{D}_x)\\mathbf{u}_{j+1} &=  \\mathbf{u}_j, \\\\\n\t\\mathbf{u}_{j+1} &= (\\mathbf{I} + c \\tau \\mathbf{D}_x)^{-1} \\mathbf{u}_j.\n\\end{align*}","position":{"start":{"line":138,"column":1},"end":{"line":140,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">I</mi><mo>+</mo><mi>c</mi><mi>τ</mi><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"bold\">u</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant=\"bold\">u</mi><mi>j</mi></msub><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi mathvariant=\"bold\">u</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">I</mi><mo>+</mo><mi>c</mi><mi>τ</mi><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi mathvariant=\"bold\">u</mi><mi>j</mi></msub><mi mathvariant=\"normal\">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align*}\n\t(\\mathbf{I} + c \\tau \\mathbf{D}_x)\\mathbf{u}_{j+1} &amp;=  \\mathbf{u}_j, \\\\\n\t\\mathbf{u}_{j+1} &amp;= (\\mathbf{I} + c \\tau \\mathbf{D}_x)^{-1} \\mathbf{u}_j.\n\\end{align*}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0241em;vertical-align:-1.2621em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7621em;\"><span style=\"top:-3.9221em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathbf\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.3979em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2621em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7621em;\"><span style=\"top:-3.9221em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.3979em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">I</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2621em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"12.2.5","key":"rfjGbNDbrf"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"The inverse of a tridiagonal matrix is not necessarily tridiagonal, and in fact ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"sC7dK1icKR"},{"type":"inlineMath","value":"U_{i,j+1}","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DSh2Cmwc3W"},{"type":"text","value":" depends on ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"KukW96poZP"},{"type":"emphasis","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"all","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"LjXukzR055"}],"key":"rTRJV3s98s"},{"type":"text","value":" of the data at time level ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"bigoOeLMD3"},{"type":"inlineMath","value":"j","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"I37plIytct"},{"type":"text","value":". Thus the numerical domain of dependence includes the entire real line, and the CFL condition is always satisfied.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"EZRnyfQuR4"}],"key":"VN1B1QpM2g"}],"label":"example-upwind-be","identifier":"example-upwind-be","html_id":"example-upwind-be","enumerator":"12.2.4","key":"lMaEZa8YcP"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"crossReference","kind":"proof:example","identifier":"example-upwind-be","label":"example-upwind-be","children":[{"type":"text","value":"Example ","key":"Uk6wNJUZC1"},{"type":"text","value":"12.2.4","key":"Rdw7NFCp1t"}],"template":"Example %s","enumerator":"12.2.4","resolved":true,"html_id":"example-upwind-be","key":"d8JoUlu7bh"},{"type":"text","value":" is a special case of a more general conclusion.","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"b78v8UWDHV"}],"key":"cM7e9xVuXk"},{"type":"proof","kind":"observation","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"An explicit time discretization must obey ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"mUmdpDPLiy"},{"type":"inlineMath","value":"\\tau = O(h)","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\tau = O(h)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span></span></span></span>","key":"R0IrH4fbdh"},{"type":"text","value":" as ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"MGwcN27M2y"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"iR3rRmg0N5"},{"type":"text","value":" in order to solve ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"Suv262Zn5N"},{"type":"crossReference","kind":"equation","identifier":"advectioncc","label":"advectioncc","children":[{"type":"text","value":"(","key":"OWd22OG1uH"},{"type":"text","value":"12.2.1","key":"WLOaU9pdCA"},{"type":"text","value":")","key":"aPoYZPFkTr"}],"template":"(%s)","enumerator":"12.2.1","resolved":true,"html_id":"advectioncc","key":"svg2wqtBaJ"},{"type":"text","value":", while an implicit method is typically unrestricted by the CFL condition.","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"h3phOiEcz9"}],"key":"XDRV0bpSLg"}],"enumerator":"12.2.2","key":"oCZn5LV2hN"},{"type":"heading","depth":2,"position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"Upwinding","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"k9rx4jsDoq"}],"identifier":"upwinding","label":"Upwinding","html_id":"upwinding","implicit":true,"enumerator":"12.2.2","key":"KLcrGaPm54"},{"type":"paragraph","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"There are other ways to discretize the ","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"bZOxrAOGIi"},{"type":"inlineMath","value":"u_x","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cV1F4jhhxc"},{"type":"text","value":" term in the advection equation ","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"mBwJTuENu8"},{"type":"crossReference","kind":"equation","identifier":"advectioncc","label":"advectioncc","children":[{"type":"text","value":"(","key":"B1yKtdE656"},{"type":"text","value":"12.2.1","key":"tCzgySQYJk"},{"type":"text","value":")","key":"olwDxxCZv5"}],"template":"(%s)","enumerator":"12.2.1","resolved":true,"html_id":"advectioncc","key":"K3ShGSxBis"},{"type":"text","value":". The implications of the CFL criterion may differ greatly depending on which is chosen.","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"sIy8pckjzo"}],"key":"Z6PUiRq2si"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"Suppose we use the backward difference","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"InDYdLFNlV"}],"key":"H8X0WcBmhz"},{"type":"math","value":"  u_x(x_i,t_j)  \\approx \\frac{U_{i,j}-U_{i-1,j}}{h}","label":"cflbackward ","identifier":"cflbackward","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>≈</mo><mfrac><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>U</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><mi>h</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">  u_x(x_i,t_j)  \\approx \\frac{U_{i,j}-U_{i-1,j}}{h}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"12.2.6","html_id":"cflbackward","key":"canPnUSWvk"},{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"together with an explicit scheme in time. Then ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"KVu8WlT09Z"},{"type":"inlineMath","value":"U_{i,j}","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">U_{i,j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"S9DJz5gJvp"},{"type":"text","value":" depends only on points to the left of ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"JQKP7oOv2R"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RtzKOuzwAZ"},{"type":"text","value":"., i.e., the upwind direction of the numerical method is to the left. But if ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"gfVWrWRE7z"},{"type":"inlineMath","value":"c<0","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&lt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"wCtzfrbFve"},{"type":"text","value":",\nthe upwind direction of the ","key":"psO4NCmmXw"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"qfECZzccFN"}],"key":"kQVirqw0RH"},{"type":"text","value":" is to the right. Hence it is impossible to satisfy the CFL condition.","key":"zJLMGIiwkQ"}],"key":"QxEzI0IwdM"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"Pairing the forward difference","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"NysfSFjB5l"}],"key":"mTxXFDqCwJ"},{"type":"math","value":"  u_x(x_i,t_j)  \\approx \\frac{U_{i+1,j}-U_{i,j}}{h}","label":"cflforward","identifier":"cflforward","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>≈</mo><mfrac><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>U</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub></mrow><mi>h</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">  u_x(x_i,t_j)  \\approx \\frac{U_{i+1,j}-U_{i,j}}{h}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"12.2.7","html_id":"cflforward","key":"BncSyGvHIF"},{"type":"paragraph","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"with explicit time stepping leads to the inverse conclusion: its upwind direction is to the right, and it must fail if ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"Uf85hIix9R"},{"type":"inlineMath","value":"c>0","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"HG4MTgooUp"},{"type":"text","value":".","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"Becxbx0JCz"}],"key":"s8xKMbKDqH"}],"label":"example-upwind-onesided","identifier":"example-upwind-onesided","html_id":"example-upwind-onesided","enumerator":"12.2.5","key":"fjAhVrEwE4"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"It’s clear that when the domain of dependence and the numerical method both have a directional preference, they must agree.","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"cmi7LgBuNW"}],"key":"XpX6sVjmWe"},{"type":"proof","kind":"observation","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Upwinding","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"WSX71TipY8"}],"key":"XdES6WA7XR"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"If a numerical method has an upwinding direction, it must be the same as the upwind direction of the ","key":"DPMFqOcWaO"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"PpKT9gIkj9"}],"key":"rjzVKjRU9r"},{"type":"text","value":".","key":"IRdhMao3dH"}],"key":"NpvX6V2gYa"}],"enumerator":"12.2.3","key":"ivDRzl0i9R"},{"type":"paragraph","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"It might seem like one should always use a centered difference scheme so that upwinding is not an issue. However, at a shock front, this requires differencing across a jump in the solution, which causes its own difficulties.","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"wsz5Wt2Pw6"}],"key":"NWo0evl4zc"},{"type":"heading","depth":2,"position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"Inflow boundary condition","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"lLhZd6N15q"}],"identifier":"inflow-boundary-condition","label":"Inflow boundary condition","html_id":"inflow-boundary-condition","implicit":true,"enumerator":"12.2.3","key":"AZJa8U4a6d"},{"type":"paragraph","position":{"start":{"line":191,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"Now suppose that ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"ncCALbvlAM"},{"type":"crossReference","kind":"equation","identifier":"advectioncc","label":"advectioncc","children":[{"type":"text","value":"(","key":"DQd2HhBUfc"},{"type":"text","value":"12.2.1","key":"VmDhpjSYXW"},{"type":"text","value":")","key":"NRhO2TpdYl"}],"template":"(%s)","enumerator":"12.2.1","resolved":true,"html_id":"advectioncc","key":"IPGNoexV3V"},{"type":"text","value":" is posed on the finite domain ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"tqhsTWH1tj"},{"type":"inlineMath","value":"x \\in [a,b]","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">x \\in [a,b]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span></span></span></span>","key":"ZnimkZRrGE"},{"type":"text","value":".\nSince the ","key":"JBVayj9uP0"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"sw49Ico1DL"}],"key":"w3w3swx0RE"},{"type":"text","value":" has only a first-order derivative in ","key":"v7WvUI9w0A"},{"type":"inlineMath","value":"x","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"dFebfIXpHX"},{"type":"text","value":", we should have only one boundary condition. Should it be specified at the left end, or the right end?","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"jsJFuD5YDn"}],"indexEntries":[{"entry":"boundary conditions","subEntry":{"value":"inflow","kind":"entry"},"emphasis":true}],"label":"index-ku51JXkMKZ","identifier":"index-ku51jxkmkz","html_id":"index-ku51jxkmkz","key":"vCcKtyQVr3"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"If we impose a condition at the downwind side of the domain, there is no way for that boundary information to propagate into the interior of the domain as time advances. On the other hand, for points close to the upwind boundary, the domain of dependence eventually wants to move past the left boundary. This is impossible, so instead the domain of dependence has to stay there.","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"GorsS7balw"}],"key":"GaK0zsOq16"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"In summary, we require an ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"FStRglNCcT"},{"type":"strong","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"inflow","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"g8KfxvI2Bq"}],"key":"I8aS2fW8zb"},{"type":"text","value":" condition on the ","key":"hc2XMPBvOx"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"EL6K2BLLY7"}],"key":"BUJbdXHl9a"},{"type":"text","value":". For ","key":"mGmkjz59aT"},{"type":"inlineMath","value":"c>0","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"vBctFNXMqB"},{"type":"text","value":" this is at the left end, and for ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"Ic1pOWsz9z"},{"type":"inlineMath","value":"c<0","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">c&lt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"eMapBwlyzo"},{"type":"text","value":" it is at the right end. This requirement is true of the exact ","key":"wp1KAwgt1O"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"SzUHtasDSs"}],"key":"TOtIiMwl0M"},{"type":"text","value":" as well as any discretization of it.","key":"ruFRVTRLOe"}],"key":"nvQfbnNvUw"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Upwind versus downwind","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"qiqheiz5Mc"}],"key":"dTYRbOaLGs"},{"type":"include","file":"julia/direction.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"keBceBymNm"},{"type":"text","value":"12.2.6","key":"kdNrCwrete"}],"key":"seNhjtd8ED"}],"identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","template":"Example %s","enumerator":"12.2.6","resolved":true,"html_id":"demo-upwind-direction","key":"uzm7yNIBXo"}],"key":"E3Vc4Ho1Wy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PyGWnza08N"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"KQPW6YwoVq"},{"type":"text","value":" with velocity ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mta0VRjrQM"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"iFSdRh49fe"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JN2Pmerb40"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"ojITaUbuAo"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e5zvny4xED"}],"key":"sVAtnLwSXh"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"X47QDMFJ3R"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"GQJKI2uGqJ"},{"type":"text","value":"11.5.2","key":"LrAyRck0Js"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"fktaKjnRyn"},{"type":"text","value":". Since ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TOaovXvSSx"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"sztM5oumZs"},{"type":"text","value":", we define the ","key":"MOcoggGvkf"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"GjUndi6wnb"}],"key":"ORp4pkTeld"},{"type":"text","value":" interior problem ","key":"S4rLAIYwjw"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"ctXB1cFGhW"},{"type":"text","value":"11.5.4","key":"E4tzNMxOv5"},{"type":"text","value":")","key":"d3OwkO7lfS"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"M7Zl7hTpBe"},{"type":"text","value":" for ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nwuYIpjwm2"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"bCYqUtxB85"},{"type":"text","value":" without ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NPa0YuQKEm"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"j7TFOHfS1e"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Le6oPJuNxx"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"bi00jKbRde"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IwEUTF35GU"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iVtJo2LVXh"},{"type":"text","value":" first.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IU8TtwjE2B"}],"key":"cOJiC5RRur"}],"key":"NmKIhx9H3s"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:01.059000Z","iopub.status.busy":"2025-01-14T15:17:57.443000Z","iopub.execute_input":"2025-01-14T15:17:57.909000Z","shell.execute_reply":"2025-01-14T15:18:01.050000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m = 100\nx, Dₓ = FNC.diffmat2(m, [0, 1])\n\ninterior = 1:m\nextend = v -> [v; 0]\n\nfunction ode!(f, v, c, t)\n    u = extend(v)\n    uₓ = Dₓ * u\n    @. f = -c * uₓ[interior]\nend;","key":"C4mLio9NjO"},{"type":"output","id":"nRcyCLFOPlyjxGlL6H7ef","data":[],"key":"V09CgWxubx"}],"key":"FgWflQ5hVZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FMzTwwgzAP"}],"key":"eBBl91Mg2f"}],"key":"B89qfgoOys"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:10.954000Z","iopub.status.busy":"2025-01-14T15:18:01.066000Z","iopub.execute_input":"2025-01-14T15:18:01.066000Z","shell.execute_reply":"2025-01-14T15:18:10.953000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\ninit = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 1), -1)\nu = solve(ivp);","key":"dkKnZs82yS"},{"type":"output","id":"1Ot3SX5tBnnDy5dZIUBHN","data":[],"key":"I17eUVK2UH"}],"key":"V51XjZKnSp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:21.296000Z","iopub.status.busy":"2025-01-14T15:18:10.969000Z","iopub.execute_input":"2025-01-14T15:18:10.969000Z","shell.execute_reply":"2025-01-14T15:18:21.294000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.75, 80)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U';\n    color=:blues,  clims=(0, 1), \n    xaxis=(L\"x\"),  yaxis=(L\"t\"),\n    title=\"Advection with inflow BC\")","key":"WP7rggh8ui"},{"type":"output","id":"D_CiMnX6XpltT7n590VV6","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c7f82719144bc873536174a4854acfc","path":"/build/0c7f82719144bc873536174a4854acfc.png"},"text/html":{"content_type":"text/html","hash":"18d73f21bb8de3606e7dc907c699f7e5","path":"/build/18d73f21bb8de3606e7dc907c699f7e5.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"920aedc3150a2806fb8c1347be490c86","path":"/build/920aedc3150a2806fb8c1347be490c86.svg"}}}],"key":"H1Uot5LfJy"}],"key":"wpUhgmoNvY"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b8fN8MeJUq"}],"key":"o8dS4mkEnS"}],"key":"xa8mPOQmJL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:36.883000Z","iopub.status.busy":"2025-01-14T15:18:21.310000Z","iopub.execute_input":"2025-01-14T15:18:21.310000Z","shell.execute_reply":"2025-01-14T15:18:36.883000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 1, 161) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t), \n        xaxis=(L\"x\"),  yaxis=(L\"u(x, t)\", (0, 1)), \n        title=\"Advection equation with inflow BC\",  dpi=150)\nend\nmp4(anim,\"upwind-inflow.mp4\")","visibility":"hide","key":"Otg1VLleeK"},{"type":"output","id":"n7vX3vtQnm77G_nVnhmeT","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section2/julia/upwind-inflow.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section2/julia/upwind-inflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"fae1f6fec0a2c561d66f7b48b0f6bf00","path":"/build/fae1f6fec0a2c561d66f7b48b0f6bf00.html"}}}],"visibility":"show","key":"o4My2QErIl"}],"visibility":"show","key":"XmVcPs9Sei"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If instead of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fMPFXFpDNe"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"NWME3xWL6J"},{"type":"text","value":" we were to try to impose the downwind condition ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zO0lyDmqLz"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"bf038SDjZD"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jk4bkOrjyy"}],"key":"aEdzSyw0sG"}],"key":"w0YHLZEWEE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:36.999000Z","iopub.status.busy":"2025-01-14T15:18:36.890000Z","iopub.execute_input":"2025-01-14T15:18:36.890000Z","shell.execute_reply":"2025-01-14T15:18:36.999000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"interior = 2:m+1\nextend = v -> [0; v]\n\ninit = @. exp( -80*(x[interior] - 0.5)^2 )\nivp = ODEProblem(ode!, init, (0., 0.25), -1)\nu = solve(ivp);","key":"FuW2V68OoR"},{"type":"output","id":"5Xnfdy_lPJf-LtOqaD_zY","data":[],"key":"dkcAcdRo8O"}],"key":"LVxQmzMjx6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:38.142000Z","iopub.status.busy":"2025-01-14T15:18:37.004000Z","iopub.execute_input":"2025-01-14T15:18:37.004000Z","shell.execute_reply":"2025-01-14T15:18:38.141000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 0.2, 61)\nU = reduce(hcat, extend(u(t)) for t in t)\ncontour(x, t, U'; \n    color=:redsblues,  clims=(-1, 1),\n    xaxis=(L\"x\"),  yaxis=(L\"t\"), \n    title=\"Advection with outflow BC\",  right_margin=3Plots.mm)","visibility":"hide","key":"H3hNxDXdJr"},{"type":"output","id":"hoMVYIa7HYtt7DU9-_Mst","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"440d5ae8360f79119c4ce53b78480983","path":"/build/440d5ae8360f79119c4ce53b78480983.png"},"text/html":{"content_type":"text/html","hash":"10af3ffbcb1c85a8b8482b497d897be3","path":"/build/10af3ffbcb1c85a8b8482b497d897be3.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"f1c97c87e0ea3001201860282846dc12","path":"/build/f1c97c87e0ea3001201860282846dc12.svg"}}}],"visibility":"show","key":"cmDB2PRGkl"}],"visibility":"show","key":"iPKvyVwZA8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SRwc0s2DeR"}],"key":"fkBI2ydgtu"}],"key":"vrupToctpe"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:42.971000Z","iopub.status.busy":"2025-01-14T15:18:38.155000Z","iopub.execute_input":"2025-01-14T15:18:38.156000Z","shell.execute_reply":"2025-01-14T15:18:42.970000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.2, 41) \n    plot(x, extend(u(t));\n        label=@sprintf(\"t = %.4f\", t),\n        xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\", (0, 1)), \n        title=\"Advection equation with outflow BC\",  dpi=150)\nend\nmp4(anim,\"upwind-outflow.mp4\")","visibility":"hide","key":"raov2BxoaU"},{"type":"output","id":"eFH53Kgf4Rxl4mPtyyx04","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section2/julia/upwind-outflow.mp4\n"},{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section2/julia/upwind-outflow.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"026386b9931417a3f006ca7f77f92ec4","path":"/build/026386b9931417a3f006ca7f77f92ec4.html"}}}],"visibility":"show","key":"tUQqMQ42vY"}],"visibility":"show","key":"FobgirOvcj"}],"key":"sXHaUarbOK"}],"key":"jx6ttUumcG"}],"key":"Vb9m1S5wvS"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Upwind versus downwind","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"u1YRu57tEe"}],"key":"dRpb6PKcWd"},{"type":"include","file":"matlab/direction-a.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#demo-upwind-directiona","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo %s","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IJKTtPqpMS"}],"key":"uHp54UFGB4"}],"urlSource":"#demo-upwind-directiona","key":"RZNsqX5ZJu"}],"key":"pe6IVHgo7i"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ulp5JKRvSD"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"FGfGK2Jarg"},{"type":"text","value":" with velocity ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UzHJBs2Kwo"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"k3o8drFTR8"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X2Sj4lz03M"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"iKE7yoAeUP"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qufZsBISsz"}],"key":"r0BeZHzokP"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"olQ8o1qJIE"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"vEy8brjA0z"},{"type":"text","value":"11.5.2","key":"mqQU2Y7CaK"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"fCwhdakECA"},{"type":"text","value":". Since ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Qckx48tNde"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"OwGRFgx0qJ"},{"type":"text","value":", we define the ","key":"meiMmwfxBr"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Xa8n2w3nQB"}],"key":"iyFLRVQAtx"},{"type":"text","value":" interior problem ","key":"wEULLqSegA"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"T64GU6mgTV"},{"type":"text","value":"11.5.4","key":"bLNbVM1zeQ"},{"type":"text","value":")","key":"saUWh5PJ9c"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"UOw6VZzfY8"},{"type":"text","value":" for ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EWKnWPSNNn"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"tnATGJZxYV"},{"type":"text","value":" without ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ujAproXdeq"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TcKdVSWQcW"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sHipKXdmAf"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ilNtoWQ4wo"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DzTx0CnoYu"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hNq1RMVP7M"},{"type":"text","value":" first.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ovaI337kkY"}],"key":"kwjOYNdXDi"}],"key":"oIc1UaLfC6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 100;  c = -1;\n[x, Dx] = diffmat2(m, [0, 1]);\nchop = @(u) u(1:m);  \nextend = @(v) [v; 0];\nodefun = @(t, v) -c * chop( Dx * extend(v) );\nivp = ode(ODEFcn = odefun);\nivp.RelativeTolerance = 1e-5;\nivp.InitialTime = 0;","key":"W07KMu9KHc"},{"type":"output","id":"zkfCpD1sPPj9U7oJID6UA","data":[],"key":"oBx8FOlIci"}],"key":"vXtk0G8K0C"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ViSWvnS7Pu"}],"key":"rhAsp6PDbH"}],"key":"Mr0F6rnj5m"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"u_init = exp( -80*(x - 0.5).^2 );\nivp.InitialValue = chop(u_init);\nsol = solutionFcn(ivp, 0, 1);\nu = @(t) [sol(t); zeros(1, length(t))];    % extend to zero at right","key":"zfB5faaMdb"},{"type":"output","id":"9dh1akYHzfJXNEooV4P9y","data":[],"key":"Lcme96R9Ge"}],"key":"m7mcHYjhH1"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 1, 81);\nclf,  contour(x, t, u(t)', 0.15:0.2:1)\nxlabel x,  ylabel t\ntitle('Advection with inflow BC') ","key":"Abo1TH5atB"},{"type":"output","id":"OC1BRW6r8s9G48o5wmHhb","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0f94ac8f00bcfcfc3ed360f580664dbb","path":"/build/0f94ac8f00bcfcfc3ed360f580664dbb.png"}}}],"key":"HluaQh42Rc"}],"key":"V0kyohcX4E"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LHWCQi3r3q"}],"key":"RUsUbFXD5d"}],"key":"O2eEtcRhYC"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on\naxis([0, 1, -0.05, 1.05])\ntitle('Advection with inflow BC') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"advection-inflow.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:length(t)\n    cla, plot(x, u(t(frame)))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.08, 0.85, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"snpvJ8s9CP"},{"type":"output","id":"hWBiuBdmrKW-tHEHTC_vK","data":[],"visibility":"remove","key":"MolPON2BQr"}],"visibility":"show","key":"zlIZadp17O"}],"key":"pBqn8CJGTZ"},{"type":"image","url":"/build/advection-inflow-5390f8f5a8c482782070345eeb66ba33.mp4","alt":"Advection with inflow BC","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"urlSource":"../../matlab/advection-inflow.mp4","key":"OT5SB9gOjS"},{"type":"include","file":"matlab/direction-b.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"#demo-upwind-directionb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo %s","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GlabI1CCGk"}],"key":"YpJp9Jjapu"}],"urlSource":"#demo-upwind-directionb","key":"hoautMsoIG"}],"key":"QZpVWsqajx"}],"key":"pKTDDFXqSt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If instead of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zNVanuGvRG"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"DPtWfwwFno"},{"type":"text","value":" we were to try to impose the downwind condition ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XbHMUEpgZ3"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"JwWs0SA8FT"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vZbwVubsK1"}],"key":"Qx5JixRE8A"}],"key":"jwvCMA3D9r"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"chop = @(u) u(2:m+1);  \nextend = @(v) [0; v];\nivp.ODEFcn = @(t, v) -c * chop( Dx * extend(v) );\nivp.InitialValue = chop(u_init);\nsol = solutionFcn(ivp, 0, 1);\nu = @(t) [zeros(1, length(t)); sol(t)];","key":"pyralFJUlF"},{"type":"output","id":"fY-QX3TmqKmYJ9tvTR2VQ","data":[],"key":"d4RwqXQmWA"}],"key":"RmSX1cSqXd"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"contour(x, t, u(t)', 0.15:0.2:1)\nxlabel x,  ylabel t\ntitle('Advection with outflow BC')","visibility":"hide","key":"PFY2tqheQH"},{"type":"output","id":"EOMgd2s1-fg5JjIj4hOM3","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4ec2864289c3ad5119c4de57fdbaf6d5","path":"/build/4ec2864289c3ad5119c4de57fdbaf6d5.png"}}}],"visibility":"show","key":"ppg8otraEb"}],"visibility":"show","key":"LEjM0ltkra"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mdhjwegRUV"}],"key":"RswXsgmrg7"}],"key":"h8oj8rSxfM"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(x, u(0))\nhold on\naxis([0, 1, -0.05, 1.05])\ntitle('Advection with outflow BC') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"advection-outflow.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = 1:45\n    cla, plot(x, u(t(frame)))\n    str = sprintf(\"t = %.2f\", t(frame));\n    text(0.08, 0.85, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\nclose(gcf)","visibility":"hide","key":"i7fknoYLEw"},{"type":"output","id":"8pJXvLyBRWpQqSfqiBsJk","data":[],"visibility":"remove","key":"ZKQ0KNU34a"}],"visibility":"show","key":"jHNv7N0Pfs"}],"key":"OOVSMtZpie"},{"type":"image","url":"/build/advection-outflow-fe2e963e99a1e37f270e1aade877c7b4.mp4","alt":"Advection with outflow BC","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"urlSource":"../../matlab/advection-outflow.mp4","key":"RJRIO4LolG"}],"key":"A8sPsoYyhY"}],"key":"W6rftiqm4c"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Upwind versus downwind","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"c1a6gdA01j"}],"key":"oAue0XXPqN"},{"type":"include","file":"python/direction-a.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:43.010934Z","iopub.status.busy":"2025-01-09T21:38:43.010757Z","iopub.status.idle":"2025-01-09T21:38:43.448363Z","shell.execute_reply":"2025-01-09T21:38:43.448068Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"MlqPRouBzr"},{"type":"output","id":"tOVEn0SVRNVTUSSfe4OAt","data":[],"visibility":"show","key":"jQpPw8dEa2"}],"visibility":"remove","key":"E4LH3zEEC8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"nMQqsPtfP7"},{"type":"text","value":"12.2.6","key":"CdwOYJOXyS"}],"key":"YdGNst6yzZ"}],"identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","template":"Example %s","enumerator":"12.2.6","resolved":true,"html_id":"demo-upwind-direction","key":"cdPH5pXHGQ"}],"key":"i9tmk5LTR2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yBgQgaU3N0"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"cjMtVrGcAH"},{"type":"text","value":" with velocity ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ihDLdb92lW"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"k3dfvqhEno"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dtlzZ3hxMU"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"yBw7jDAeLi"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BiDBOP64BM"}],"key":"BdPh72Dppu"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fYLEsSer1p"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"SNwwIYRYum"},{"type":"text","value":"11.5.2","key":"Yzcz9EtkQu"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"QhGRFe73SN"},{"type":"text","value":". Since ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O5LvlptQ1m"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"zs9wBre7n9"},{"type":"text","value":", we define the ","key":"pB2RzMM0r7"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"VB2WIFg1Wx"}],"key":"eXwPkMhzvf"},{"type":"text","value":" interior problem ","key":"MKcokIDij1"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"vXiPRrIaTt"},{"type":"text","value":"11.5.4","key":"PBi5cxlCx2"},{"type":"text","value":")","key":"W8OtrF1JK7"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"Mw91LNkp3Y"},{"type":"text","value":" for ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NydZX2ddCo"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"dq8jYakZrC"},{"type":"text","value":" without ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MM84BIL5rL"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"RWKe32BdJi"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HiGueHnZle"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"wQE9GD83IX"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gaN1mewirf"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IHrlW9Mt4I"},{"type":"text","value":" first.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZsWyRUrSVO"}],"key":"TXHoHPaAc6"}],"key":"y75C9VX3NL"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:43.449982Z","iopub.status.busy":"2025-01-09T21:38:43.449832Z","iopub.status.idle":"2025-01-09T21:38:43.452212Z","shell.execute_reply":"2025-01-09T21:38:43.451942Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"m = 80\nx, Dx, Dxx = FNC.diffmat2(m, [0, 1])\nchop = lambda u : u[:-1]    # remove right end\nextend = lambda v: hstack([v, 0])\n\node = lambda t, v: -c * chop( Dx @ extend(v) )\nc = -1","key":"bAsBJ2b9nx"},{"type":"output","id":"anmiCJ0A267O0YR0thOpv","data":[],"key":"eh1YNnVcWf"}],"key":"FW87g2QTA2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yH4pmIJLaQ"}],"key":"TSvfqUAVnk"}],"key":"CDPM2uIcvb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:43.453436Z","iopub.status.busy":"2025-01-09T21:38:43.453325Z","iopub.status.idle":"2025-01-09T21:38:43.460155Z","shell.execute_reply":"2025-01-09T21:38:43.459760Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nu_init = exp(-80 * (x - 0.5) ** 2)\nsol = solve_ivp(ode, (0, 1), chop(u_init), method=\"RK45\", dense_output=True)\nu = lambda t: extend(sol.sol(t))","key":"PP3mpJ7meb"},{"type":"output","id":"usyCaJhvhZWA06dDcG52t","data":[],"key":"voZSbBz34N"}],"key":"d2uVIZb5iI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:43.461636Z","iopub.status.busy":"2025-01-09T21:38:43.461521Z","iopub.status.idle":"2025-01-09T21:38:43.614880Z","shell.execute_reply":"2025-01-09T21:38:43.614632Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 1, 80)\nU = [u(tj) for tj in t]\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Advection with inflow BC\");","key":"xPOUBLTmKa"},{"type":"output","id":"sevBUNJ0Flizn16P68VKd","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7aba6eaa0e0b6a07cbf0f237d0047585","path":"/build/7aba6eaa0e0b6a07cbf0f237d0047585.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"ovei8uI2jh"}],"key":"CkCXTB1jAg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qYvlO4Fpj4"}],"key":"LFVv57b8IX"}],"key":"sMkwF6VcTH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:43.616184Z","iopub.status.busy":"2025-01-09T21:38:43.616053Z","iopub.status.idle":"2025-01-09T21:38:45.525332Z","shell.execute_reply":"2025-01-09T21:38:45.524953Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-0.1, 1.1)\nax.set_title(\"Advection with inflow BC\")\n\ndef snapshot(t):\n    curve.set_ydata(u(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = FuncAnimation(fig, snapshot, frames=linspace(0, 1, 101))\nanim.save(\"advection-inflow.mp4\", fps=30)\nclose()","visibility":"hide","key":"kadAOnwxR2"},{"type":"output","id":"hJBrprm8E0J_Q5it4plDo","data":[],"visibility":"show","key":"lIOcxfsJh2"}],"visibility":"show","key":"TJEmNpirFE"}],"key":"eWmUdxtT4Q"},{"type":"image","url":"/build/advection-inflow-2714d6d3a512f8ee991c9d75528c9e1e.mp4","alt":"Advection with inflow BC","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"urlSource":"python/advection-inflow.mp4","key":"FhZal2PxRt"},{"type":"include","file":"python/direction-b.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:46.528078Z","iopub.status.busy":"2025-01-09T21:38:46.527995Z","iopub.status.idle":"2025-01-09T21:38:46.868182Z","shell.execute_reply":"2025-01-09T21:38:46.867890Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"Ty8Hj64t5x"},{"type":"output","id":"xPJfdWqCff-OtNX441hTJ","data":[],"visibility":"show","key":"KYZ3BTWiol"}],"visibility":"remove","key":"aIujbrDPRG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If, instead of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UWejK2f5PV"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"IYmQew8Rgu"},{"type":"text","value":", we were to try to impose the downwind condition ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z0x9m2tsAX"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Dflw0jSNzk"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bvYrRIhQ93"}],"key":"qMrqPyHgq7"}],"key":"BTniSiI0yI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:46.869764Z","iopub.status.busy":"2025-01-09T21:38:46.869631Z","iopub.status.idle":"2025-01-09T21:38:46.874778Z","shell.execute_reply":"2025-01-09T21:38:46.874526Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nm = 80\nc = -1\nx, Dx, Dxx = FNC.diffmat2(m, [0, 1])\nu_init = exp(-80 * (x - 0.5) ** 2)\node = lambda t, v: -c * chop( Dx @ extend(v) )","visibility":"show","key":"Oux1vGlhAS"},{"type":"output","id":"zZY__uDf6jm3HdDZGHbBh","data":[],"visibility":"show","key":"s9gpXg8h9b"}],"visibility":"remove","key":"GwLuA4mUfO"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"chop = lambda u : u[1:]    # remove left end\nextend = lambda v: hstack([0, v])\nsol = solve_ivp(ode, (0, 1), chop(u_init), method=\"RK45\", dense_output=True)\nu = lambda t: extend(sol.sol(t))","key":"DQKMSAisqL"},{"type":"output","id":"Oenw0TLcsJVGkMLOUbZ0Z","data":[],"key":"pbiMHAFOJt"}],"key":"O3GMzVuMN2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:46.876001Z","iopub.status.busy":"2025-01-09T21:38:46.875904Z","iopub.status.idle":"2025-01-09T21:38:47.026335Z","shell.execute_reply":"2025-01-09T21:38:47.026060Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 1, 80)\nU = [u(tj) for tj in t]\nclf\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Outflow boundary condition\");","visibility":"hide","key":"l0GQ3HlK0P"},{"type":"output","id":"Tb_PfJuhJD49czOpDhcrD","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f18b8b89cfdcad19962bd04fd12d0010","path":"/build/f18b8b89cfdcad19962bd04fd12d0010.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"visibility":"show","key":"XIugHKD7JY"}],"visibility":"show","key":"exEpnkp5hc"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dzp6QrspIp"}],"key":"osaiYWti1T"}],"key":"QOKGLDc9qG"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T21:38:47.030224Z","iopub.status.busy":"2025-01-09T21:38:47.030101Z","iopub.status.idle":"2025-01-09T21:38:48.054848Z","shell.execute_reply":"2025-01-09T21:38:48.054514Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-0.1, 1.1)\nax.set_title(\"Advection with outflow BC\")\ndef snapshot(t):\n    curve.set_ydata(u(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = FuncAnimation(fig, snapshot, frames=linspace(0, 0.5, 51))\nanim.save(\"advection-outflow.mp4\", fps=30)\nclose()","visibility":"hide","key":"Qgn2thIyrx"},{"type":"output","id":"Yq-wxfLN2zQAPuft25Rlu","data":[],"visibility":"show","key":"fllnTF46yu"}],"visibility":"show","key":"JTQ51sYgAJ"}],"key":"h4pn0OYxSS"},{"type":"image","url":"/build/advection-outflow-158ee5a2a6009a4e87aa9d492b023cb7.mp4","alt":"Advection with outflow BC","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"urlSource":"python/advection-outflow.mp4","key":"FZGIXiGaHA"}],"key":"AUyORrGtxe"}],"key":"QWRDr3HJ7O"}],"key":"o7VZfdqJIw"}],"label":"demo-upwind-direction","identifier":"demo-upwind-direction","html_id":"demo-upwind-direction","enumerator":"12.2.6","key":"IWHXSVmRw0"},{"type":"heading","depth":2,"position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"iipI1SQdnH"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"12.2.4","key":"Bdc0o9c9cz"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":246,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":246,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"✍ Suppose you want to model the weather, including winds up to speed ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"rfcaBDNacQ"},{"type":"text","value":"200","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"t9SNrFyR4Y"},{"type":"text","value":" km/hr, using an explicit method with a second-order centered spatial discretization. If the shortest time step you can take is 4 hr, what is the CFL limit on the spatial resolution of the model? Is this a lower bound or an upper bound?","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"Knplcg5Vzk"}],"key":"KB59alJNFn"}],"key":"fG6rLhkOBB"},{"type":"listItem","spread":true,"position":{"start":{"line":249,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"✍ Suppose you want to model the traffic on a high-speed freeway using an explicit method with a second-order centered spatial discretization. Derive a CFL condition on the allowable time step, stating your assumptions carefully.","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"Z5fQhya5oM"}],"key":"BwnOcItVjL"}],"key":"nyXj7U6G5n"},{"type":"listItem","spread":true,"position":{"start":{"line":251,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"✍ For the heat equation, the domain of dependence at any ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"hegnhGstGO"},{"type":"inlineMath","value":"(x,t)","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"kBqtjhDEqn"},{"type":"text","value":" with ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"AIo5eIA65l"},{"type":"inlineMath","value":"t>0","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">t&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"YVo8Xo72zk"},{"type":"text","value":" is all of ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"b1PGUInUUh"},{"type":"inlineMath","value":"x \\in (-\\infty,\\infty)","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mi mathvariant=\"normal\">∞</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x \\in (-\\infty,\\infty)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">∞</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∞</span><span class=\"mclose\">)</span></span></span></span>","key":"TYPoxKmbSY"},{"type":"text","value":". Show that the CFL condition implies that ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"J337pP4dOW"},{"type":"inlineMath","value":"\\tau/h\\to 0","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mi mathvariant=\"normal\">/</mi><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau/h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"j7exIOxfbg"},{"type":"text","value":" is required for convergence as ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"WVLJz4pPtY"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"APx9NINpRX"},{"type":"text","value":".","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"HmdPrz1otR"}],"key":"jzVjrIjHO7"}],"key":"Nb5DrPxY33"},{"type":"listItem","spread":true,"position":{"start":{"line":253,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"✍ Suppose you wish to solve ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"tft4uZzfSZ"},{"type":"inlineMath","value":"u_t = u u_x","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><mi>u</mi><msub><mi>u</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_t = u u_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tqHOVegnlG"},{"type":"text","value":" for ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"Zf2ltYtjvb"},{"type":"inlineMath","value":"x\\in[-1,1]","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">x\\in[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"mHBaXsCSKL"},{"type":"text","value":".","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"RVsBrIGhtQ"}],"key":"jlR7tHjK7l"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"ZCFxoUVSt9"}],"key":"WfHwF5cUnY"},{"type":"text","value":" If ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"kyQRcMDoYH"},{"type":"inlineMath","value":"u(x,0) = -2+\\sin(\\pi x)","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>2</mn><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,0) = -2+\\sin(\\pi x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"tXG1uhClxz"},{"type":"text","value":",  which end of the domain is the inflow?","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"hXeId6yv31"}],"key":"dKyogE5Yw3"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"strong","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"pouEVzzWBg"}],"key":"PMxpAccU77"},{"type":"text","value":" Does the answer to part (a) change if ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"a7qbjYUiZE"},{"type":"inlineMath","value":"u(x,0) = 1 + e^{-16x^2}","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>16</mn><msup><mi>x</mi><mn>2</mn></msup></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u(x,0) = 1 + e^{-16x^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9869em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9869em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">16</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"haQ9Njqaqm"},{"type":"text","value":"?","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"gcdIg0MOnS"}],"key":"QGcP2Mqnq3"}],"key":"BXyWkqMQSA"}],"key":"AlJxvhfoo8"}],"key":"IoaM0tiMVz"}],"key":"MFJBtzbPB2"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Traffic flow","url":"/traffic","group":"Preface"},"next":{"title":"Absolute stability","url":"/absstab-advection","group":"Preface"}}},"domain":"http://localhost:3000"}