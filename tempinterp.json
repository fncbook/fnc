{"kind":"Notebook","sha256":"bef5b6eaae33f007d7b8fba8c3212b24635497d05f48034a89f48da7876d1aa7","slug":"tempinterp","location":"/chapter3/section1/julia/tempinterp.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"tempinterp.ipynb","url":"/build/tempinterp-168a48760d51f198e66a857e17b19ff5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"sUxmMPHd7F"},{"type":"text","value":"3.1.1","key":"YU9BSc53Eb"}],"key":"uyOMkjN37J"}],"identifier":"demo-fitting-tempinterp","label":"demo-fitting-tempinterp","kind":"proof:example","template":"Example %s","enumerator":"3.1.1","resolved":true,"html_id":"demo-fitting-tempinterp","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"guaaaAXgfI"}],"key":"frlXoIzgYh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here are 5-year averages of the worldwide temperature anomaly as compared to the 1951–1980 average (source: NASA).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tz7QZKp9LU"}],"key":"pTWbzMqZAh"}],"key":"JsGKiqS82Q"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:27:03.966000Z","iopub.status.busy":"2025-01-14T15:26:36.320000Z","iopub.execute_input":"2025-01-14T15:26:38.003000Z","shell.execute_reply":"2025-01-14T15:27:03.907000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n       0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]\n    \nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", \n    legend=:bottomright)","key":"FKIR8mvVfa"},{"type":"output","id":"SwHrQIbNNAfv66ysV53ue","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00c2a210fc24ac3df4cd7443eddef9ff","path":"/build/00c2a210fc24ac3df4cd7443eddef9ff.png"},"text/html":{"content_type":"text/html","hash":"224cdb457e64b2084746dc148452f358","path":"/build/224cdb457e64b2084746dc148452f358.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a0b126c4e037dedf1987a8ac3c2bacc2","path":"/build/a0b126c4e037dedf1987a8ac3c2bacc2.svg"}}}],"key":"UWr1gS4T5K"}],"key":"D3C3xtuLbz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A polynomial interpolant can be used to fit the data. Here we build one using a Vandermonde matrix. First, though, we express time as decades since 1950, as it improves the condition number of the matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RSWxs8HeQL"}],"key":"i7V9lUOFWj"}],"key":"N1h45Zqghp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:27:16.695000Z","iopub.status.busy":"2025-01-14T15:27:03.991000Z","iopub.execute_input":"2025-01-14T15:27:03.991000Z","shell.execute_reply":"2025-01-14T15:27:16.694000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"t = @. (year - 1950) / 10\nn = length(t)\nV = [ t[i]^j for i in 1:n, j in 0:n-1 ]\nc = V \\ temp","key":"Dhwl8jvM9n"},{"type":"output","id":"qyRj5PJ_QlIkFxxamxGjK","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n  -14.114000001832462\n   76.36173810552113\n -165.45597224550528\n  191.96056669514388\n -133.27347224319684\n   58.015577787494486\n  -15.962888891734785\n    2.6948063497166928\n   -0.2546666667177082\n    0.010311111113288083","content_type":"text/plain"}}}],"key":"bj6bDiDeri"}],"key":"rR10XHBW3P"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The coefficients in vector ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"y1a29BrpMA"},{"type":"inlineCode","value":"c","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BkFc6VcGgg"},{"type":"text","value":" are used to create a polynomial. Then we create a function that evaluates the polynomial after changing the time variable as we did for the Vandermonde matrix.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"X6eNwbITRI"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"plotting functions","kind":"entry"},"emphasis":false}],"label":"index-x3RgzVJNga","identifier":"index-x3rgzvjnga","html_id":"index-x3rgzvjnga","key":"pPIAthBQLy"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"UdUc5OU5ZZ"}],"key":"PnKwDQ8kcP"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"If you ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"e4pyPpgDaw"},{"type":"inlineCode","value":"plot","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ngAk1QTOuO"},{"type":"text","value":" a function, then the points are chosen automatically to make a smooth curve.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PCfVuDZsax"}],"key":"ODGpXkqjV8"}],"class":"dropdown","key":"r9qSwfdU9O"}],"key":"jBR3h3e6Mj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:27:21.666000Z","iopub.status.busy":"2025-01-14T15:27:16.702000Z","iopub.execute_input":"2025-01-14T15:27:16.704000Z","shell.execute_reply":"2025-01-14T15:27:21.631000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials\np = Polynomial(c)\nf = yr -> p((yr - 1950) / 10)\nplot!(f, 1955, 2000, label=\"interpolant\")","key":"D74K6NQzTx"},{"type":"output","id":"EYWloa818J2uddRA5K7gq","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ba5e97290c4348f6eb39f4c9b0de1ee","path":"/build/7ba5e97290c4348f6eb39f4c9b0de1ee.png"},"text/html":{"content_type":"text/html","hash":"18999746cf6869d316bd44a2e48a6b55","path":"/build/18999746cf6869d316bd44a2e48a6b55.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"dce115a8e1f7fbd86dde395291a6c235","path":"/build/dce115a8e1f7fbd86dde395291a6c235.svg"}}}],"key":"p2zelYAoH4"}],"key":"tDKSopuxQN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see, the interpolant does represent the data, in a sense. However it’s a crazy-looking curve for the application. Trying too hard to reproduce all the data exactly is known as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r2teMdlbOi"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"overfitting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nDamcvOQMT"}],"key":"TSlw2I0Oib"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oNatCJeUd4"}],"key":"XolJcKXcJw"}],"key":"EP4rbZumC3"}],"key":"BkEW9OIEyL"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Cholesky","url":"/cholesky","group":"Chapter 2"},"next":{"title":"Tempfit","url":"/tempfit","group":"Chapter 3"}}},"domain":"http://localhost:3000"}