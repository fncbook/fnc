{"kind":"Notebook","sha256":"ba5f82badfc69200e7957b2792aecf384d02768b31693936d93db2d9d12903c5","slug":"rayleigh-2","location":"/chapter7/section4/python/rayleigh.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"rayleigh.ipynb","url":"/fnc/build/rayleigh-74893ecaa461575b3acf0f686ca0c52f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:39.936150Z","iopub.status.busy":"2025-01-11T16:31:39.935844Z","iopub.status.idle":"2025-01-11T16:31:40.268629Z","shell.execute_reply":"2025-01-11T16:31:40.268300Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"Q3VRnMYw8W"},{"type":"output","id":"F9FC2CMQjzIqfu-klJTUr","data":[],"visibility":"show","key":"MgMdqh8WSZ"}],"visibility":"remove","key":"ulWJ58Tv79"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"VExAGj8y8t"},{"type":"text","value":"7.4.1","key":"WZTJocNHCt"}],"key":"VBImxBOQYo"}],"identifier":"demo-symm-eig-rayleigh","label":"demo-symm-eig-rayleigh","kind":"proof:example","template":"Example %s","enumerator":"7.4.1","resolved":true,"html_id":"demo-symm-eig-rayleigh","remote":true,"url":"/symm-eig","dataUrl":"/symm-eig.json","key":"K1EkaGfFEM"}],"key":"oECF5OC6Qm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will use a symmetric matrix with a known ","key":"Orkws4l1lV"},{"type":"abbreviation","title":"eigenvalue decomposition","children":[{"type":"text","value":"EVD","key":"T3WYunDpX8"}],"key":"ttuz1rnk5E"},{"type":"text","value":" and eigenvalues equal to the integers from 1 to 20.","key":"ofK0D0F49x"}],"key":"PspDy9iXMr"}],"key":"Kd97tCtgjA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:40.270344Z","iopub.status.busy":"2025-01-11T16:31:40.270212Z","iopub.status.idle":"2025-01-11T16:31:40.273804Z","shell.execute_reply":"2025-01-11T16:31:40.273525Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import qr\nn = 20\nd = arange(n) + 1\nD = diag(d)\nV, _ = qr(random.randn(n, n))    # get a random orthogonal V\nA = V @ D @ V.T","key":"p1Z4oleYR7"},{"type":"output","id":"Be8zmTJ-kEKoHZY6MieJi","data":[],"key":"kdrE5yyfD1"}],"key":"W64mJ02MQe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Rayleigh quotient is a scalar-valued function of a vector.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SgwuruiBRK"}],"key":"nqcrCTNR4f"}],"key":"MGX6OhjHRM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:40.275015Z","iopub.status.busy":"2025-01-11T16:31:40.274937Z","iopub.status.idle":"2025-01-11T16:31:40.276465Z","shell.execute_reply":"2025-01-11T16:31:40.276265Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"R = lambda x: dot(x, A @ x) / dot(x, x)","key":"T2Ndk7efxx"},{"type":"output","id":"8Bep9PejKT84-0If6Xk9r","data":[],"key":"HbkPzTmso2"}],"key":"jHggXtZCrz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Rayleigh quotient evaluated at an eigenvector gives the corresponding eigenvalue.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LHXhNSQ5RR"}],"key":"ayIFEal7sb"}],"key":"zmbkmzQ3u3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:40.277592Z","iopub.status.busy":"2025-01-11T16:31:40.277515Z","iopub.status.idle":"2025-01-11T16:31:40.279197Z","shell.execute_reply":"2025-01-11T16:31:40.278959Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(R(V[:, 6]))","key":"rOHnM6Nf0k"},{"type":"output","id":"mcXngzMFZeNtxz339rhHb","data":[{"name":"stdout","output_type":"stream","text":"6.999999999999998\n"}],"key":"VcyxXY4fMy"}],"key":"bXH3VvWpQO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If the input to he Rayleigh quotient is within a small ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s5pyG90vhf"},{"type":"text","value":"δ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tyS1GTkZCk"},{"type":"text","value":" of an eigenvector, its output is within ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qZ1unJFA2s"},{"type":"inlineMath","value":"O(\\delta^2)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>δ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\delta^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"HExkaEC4gV"},{"type":"text","value":" of the corresponding eigenvalue. In this experiment, we observe that each additional digit of accuracy in an approximate eigenvector gives two more digits to the eigenvalue estimate coming from the Rayleigh quotient.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cBUBMu6mFm"}],"key":"P3ni7IppGc"}],"key":"wByGwQRUYE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:31:40.280424Z","iopub.status.busy":"2025-01-11T16:31:40.280335Z","iopub.status.idle":"2025-01-11T16:31:40.282744Z","shell.execute_reply":"2025-01-11T16:31:40.282491Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"results = PrettyTable([\"perturbation size\", \"R.Q. - λ\"])\nfor delta in 1 / 10 ** arange(1, 6):\n    e = random.randn(n)\n    e = delta * e / norm(e)\n    x = V[:, 5] + e\n    quotient = R(x)\n    results.add_row([delta, quotient - d[5]])\n\nprint(results)","key":"MeWhKmLuzX"},{"type":"output","id":"9JF8JKatf-bvRubmVSD9v","data":[{"name":"stdout","output_type":"stream","text":"+-------------------+------------------------+\n| perturbation size |        R.Q. - λ        |\n+-------------------+------------------------+\n|        0.1        |  0.05263797010715443   |\n|        0.01       | 0.0004916572103024208  |\n|       0.001       | 3.360606208424599e-06  |\n|       0.0001      | 4.2867250193978634e-08 |\n|       1e-05       |  1.17729825888091e-10  |\n+-------------------+------------------------+\n"}],"key":"O41169t0OV"}],"key":"DdxoD59AiL"}],"key":"BmmVFG1djU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Props","url":"/props-2","group":"Chapter 7"},"next":{"title":"Hello","url":"/hello-2","group":"Chapter 7"}}},"domain":"http://localhost:3000"}