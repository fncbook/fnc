{"kind":"Notebook","sha256":"51344886e44525d650eae037c25fdbd46d3f16d8946372fe5251f2d379bd2731","slug":"converge-3","location":"/chapter4/section5/julia/converge.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"converge.ipynb","url":"/fnc/build/converge-cc258ccc616c3ae6f74b23eb717cce8c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"hdVGySDFaK"},{"type":"text","value":"4.5.3","key":"tB9CTBXNiN"}],"key":"FXfMye0BSB"}],"identifier":"demo-newtonsys-converge","label":"demo-newtonsys-converge","kind":"proof:example","template":"Example %s","enumerator":"4.5.3","resolved":true,"html_id":"demo-newtonsys-converge","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"MSTl5iH0X3"}],"key":"CMRnrcDMME"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A system of nonlinear equations is defined by its residual and Jacobian.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"byLvXHlSNk"}],"key":"dCiul42H9a"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"THrS6syiZM"}],"key":"Y8QC53zEQo"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Be careful when coding a Jacobian all in one statement. Spaces separate columns, so ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gdoAOqBlen"},{"type":"inlineCode","value":"x[3]-1","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bJhTBLZOJp"},{"type":"text","value":" is not the same as ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jLuu7mG89n"},{"type":"inlineCode","value":"x[3] - 1","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wji2a66YSe"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kyhSddvGEt"}],"key":"VDBJMzfHBQ"}],"class":"dropdown","key":"Ff4EDvlDGg"}],"key":"XaEuQJyuZA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:21:20.557000Z","iopub.status.busy":"2025-01-14T15:21:19.815000Z","iopub.execute_input":"2025-01-14T15:21:20.385000Z","shell.execute_reply":"2025-01-14T15:21:20.556000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"function func(x)\n    [exp(x[2] - x[1]) - 2,\n        x[1] * x[2] + x[3],\n        x[2] * x[3] + x[1]^2 - x[2]\n    ]\nend;\n\nfunction jac(x)\n    [\n        -exp(x[2] - x[1]) exp(x[2] - x[1]) 0\n        x[2] x[1] 1\n        2*x[1] x[3]-1 x[2]\n    ]\nend;","key":"UobJdoJu88"},{"type":"output","id":"caOAf1BR2OudX54vc3a5M","data":[],"key":"QfqQcX1TeZ"}],"key":"PaBTgYZGxw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will use a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qm5fx8e3aa"},{"type":"inlineCode","value":"BigFloat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lbvn0XvkOI"},{"type":"text","value":" starting value, and commensurately small stopping tolerances, in order to get a sequence long enough to measure convergence.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G13AhRP01r"}],"key":"w8PCGGTztX"}],"key":"YbbkGvFaCM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:21:30.437000Z","iopub.status.busy":"2025-01-14T15:21:20.559000Z","iopub.execute_input":"2025-01-14T15:21:20.559000Z","shell.execute_reply":"2025-01-14T15:21:30.436000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = BigFloat.([0, 0, 0])\nϵ = eps(BigFloat)\nx = FNC.newtonsys(func, jac, x₁, xtol=ϵ, ftol=ϵ);","key":"lMPqIBYulf"},{"type":"output","id":"muM57-_5GQ4qDNouHBYMK","data":[],"key":"b56M1PsF0o"}],"key":"zSGF0UsxlD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s compute the residual of the last result in order to check the quality.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HnE1l4ks5z"}],"key":"HeX2kKtpSg"}],"key":"x6VIBvpvrJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:21:33.122000Z","iopub.status.busy":"2025-01-14T15:21:30.465000Z","iopub.execute_input":"2025-01-14T15:21:30.465000Z","shell.execute_reply":"2025-01-14T15:21:33.122000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]\n@show residual = norm(func(r));","key":"iX03PF15uQ"},{"type":"output","id":"_g9Psm_pDTIE4NHRFIe8Y","data":[{"name":"stdout","output_type":"stream","text":"residual = norm(func(r)) = 0.0"},{"name":"stdout","output_type":"stream","text":"\n"}],"key":"kgEgMr7cJq"}],"key":"DNcSp9g3dX"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We take the sequence of norms of errors, applying the log so that we can look at the exponents.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eT1zbGwVAk"}],"key":"KQ1IZe6xm5"}],"key":"zjIQRM9NHa"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:21:35.472000Z","iopub.status.busy":"2025-01-14T15:21:33.129000Z","iopub.execute_input":"2025-01-14T15:21:33.129000Z","shell.execute_reply":"2025-01-14T15:21:35.471000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = [Float64(log(norm(r - x[k]))) for k in 1:length(x)-1]\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"log error\", \"ratio\"] [eachindex(logerr) logerr ratios]","key":"cC2URabr56"},{"type":"output","id":"N-FJ3IdKk7SosCK3ClOi9","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">iteration</th>\n      <th style = \"text-align: right;\">log error</th>\n      <th style = \"text-align: right;\">ratio</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">1.0</td>\n      <td style = \"text-align: right;\">-0.642465</td>\n      <td style = \"text-align: right;\">NaN</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">2.0</td>\n      <td style = \"text-align: right;\">-0.509988</td>\n      <td style = \"text-align: right;\">0.793799</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">3.0</td>\n      <td style = \"text-align: right;\">-1.88491</td>\n      <td style = \"text-align: right;\">3.69598</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">4.0</td>\n      <td style = \"text-align: right;\">-4.58533</td>\n      <td style = \"text-align: right;\">2.43266</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">5.0</td>\n      <td style = \"text-align: right;\">-10.5971</td>\n      <td style = \"text-align: right;\">2.31109</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">6.0</td>\n      <td style = \"text-align: right;\">-22.5988</td>\n      <td style = \"text-align: right;\">2.13254</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">7.0</td>\n      <td style = \"text-align: right;\">-45.8704</td>\n      <td style = \"text-align: right;\">2.02977</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">8.0</td>\n      <td style = \"text-align: right;\">-93.3004</td>\n      <td style = \"text-align: right;\">2.034</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"spbCw89O7a"}],"key":"XXRhYaWTmt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ratio is neatly converging toward 2, which is expected for quadratic convergence.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iqmkFvxDnw"}],"key":"M5D7gBUT9D"}],"key":"CBWZEODSfc"}],"key":"zP2Il8HKSk"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Iqi","url":"/iqi","group":"Chapter 4"},"next":{"title":"Levenberg","url":"/levenberg","group":"Chapter 4"}}},"domain":"http://localhost:3000"}