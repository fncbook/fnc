{"kind":"Notebook","sha256":"fc62e06af670597cdba2d7f277440597a2aa1c3163f2d5f69c5252bf1beb66aa","slug":"bauerfike-2","location":"/chapter7/section2/python/bauerfike.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"myst","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"bauerfike.ipynb","url":"/fnc/build/bauerfike-c8147178416df9e4e028de8f3c5bad32.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"s38KDCDKUU"},{"type":"output","id":"FzkcBT9AcL4WOQ5bStoMb","data":[],"visibility":"show","key":"arocdKcaJM"}],"visibility":"remove","key":"xBeZqwpRSR"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"dqrRfYKO3B"},{"type":"text","value":"7.2.3","key":"mzHv4UGQAN"}],"key":"A4gclwF90Z"}],"identifier":"demo-evd-bauerfike","label":"demo-evd-bauerfike","kind":"proof:example","template":"Example %s","enumerator":"7.2.3","resolved":true,"html_id":"demo-evd-bauerfike","remote":true,"url":"/evd","dataUrl":"/evd.json","key":"uEygSVpfvM"}],"key":"uYpTS0uwBD"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We first define a hermitian matrix. Note that we add the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EJpQbJQ6hI"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"conjugate","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MP9vlEWA9Z"}],"key":"FzTsfp9TsI"},{"type":"text","value":" transpose of a matrix to itself.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"x5gFoMLBQe"}],"key":"powxlvXWgI"}],"key":"qlfvp5Nb30"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"n = 7\nA = random.randn(n, n) + 1j * random.randn(n, n)\nA = (A + conj(A.T)) / 2","key":"WfDdRSOI7w"},{"type":"output","id":"HReLlWh7KJC7h554dn_oC","data":[],"key":"Oe3y8fkMQ3"}],"key":"OzIqC9xAQd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We confirm that the matrix ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dkXF020kMz"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"KuyY0StQj5"},{"type":"text","value":" is normal by checking that ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HPfcbLNcJN"},{"type":"inlineMath","value":"\\kappa(\\mathbf{V}) = 1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\kappa(\\mathbf{V}) = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"z8OEANn8vL"},{"type":"text","value":" (to within roundoff).","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iVgPrbhyml"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"cond","kind":"entry"},"emphasis":false}],"label":"index-Oah5m0DCog","identifier":"index-oah5m0dcog","html_id":"index-oah5m0dcog","key":"Adngu75GbU"}],"key":"TSxk3EKh5H"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import eig, cond\nd, V = eig(A)\nprint(f\"eigenvector matrix has condition number {cond(V):.5f}\")","key":"VFyoXK4d6f"},{"type":"output","id":"a39HpHqVOBrRMR_X_LiOM","data":[{"name":"stdout","output_type":"stream","text":"eigenvector matrix has condition number 1.00000\n"}],"key":"iCDzzqWnKB"}],"key":"H5UusYRcqj"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we perturb ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GHqE4P3J08"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"rJBN7CrPxO"},{"type":"text","value":" and measure the effect on the eigenvalues. Note that the Bauer–Fike theorem uses absolute differences, not relative ones. Since the ordering of eigenvalues can change, we look at all pairwise differences and take the minima.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nUJSHynBSj"}],"key":"tyXxqI6f5j"}],"key":"wUe8S8F91B"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"E = random.randn(n, n) + 1j * random.randn(n, n)\nE = 1e-8 * E / norm(E, 2)\ndd, _ = eig(A + E)\ndist = array([min([abs(x - y) for x in dd]) for y in d])\nprint(dist)","key":"cATB3aWcJ6"},{"type":"output","id":"LkaMAiEHMF5fA3cHJcYiy","data":[{"name":"stdout","output_type":"stream","text":"[2.61227484e-09 3.05959487e-09 2.66433126e-09 2.64200133e-09\n 1.76157014e-09 1.14083548e-09 5.98333817e-10]\n"}],"key":"DHEOOXVwL0"}],"key":"PqPLbhjob3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As promised, the perturbations in the eigenvalues do not exceed the normwise perturbation to the original matrix.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J1JTjjB4mX"}],"key":"UUAc8WNeBE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we see what happens for a triangular matrix.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZT3ifzx26k"}],"key":"P6TEbIoDPm"}],"key":"iQzOXVuhT0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"n = 20\nx = arange(n) + 1\nA = triu(outer(x, ones(n)))\nprint(A[:5, :5])","key":"l7MZhdwR5w"},{"type":"output","id":"G_E6pzasOC4LbCg4AeGJg","data":[{"name":"stdout","output_type":"stream","text":"[[1. 1. 1. 1. 1.]\n [0. 2. 2. 2. 2.]\n [0. 0. 3. 3. 3.]\n [0. 0. 0. 4. 4.]\n [0. 0. 0. 0. 5.]]\n"}],"key":"j6i6Lruwri"}],"key":"I9wnCBzwYB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This matrix is not at all close to normal.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DOselzsIcL"}],"key":"g6XU6WcAir"}],"key":"BgRfwdzSbq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"d, V = eig(A)\nprint(f\"eigenvector matrix has condition number {cond(V):.2e}\")","key":"wqccKCgFw4"},{"type":"output","id":"0hMhedwX6-ALp-005Z_dh","data":[{"name":"stdout","output_type":"stream","text":"eigenvector matrix has condition number 6.15e+09\n"}],"key":"M88T8O6psC"}],"key":"fYRkZa8pRz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As a result, the eigenvalues can change by a good deal more.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BMx09toHjC"}],"key":"uyMi0PlRRQ"}],"key":"FmHj2RMx1p"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"E = random.randn(n, n) + 1j * random.randn(n, n)\nE = 1e-8 * E / norm(E, 2)\ndd, _ = eig(A + E)\ndist = array([min([abs(x - y) for x in dd]) for y in d])\nprint(f\"Maximum eigenvalue change is {max(dist):.2e}\")\nprint(f\"The Bauer-Fike upper bound is {cond(V) * norm(E, 2):.2e}\")","key":"gywJQW9zKg"},{"type":"output","id":"zSrftdjmn8GwiIu0nq_T_","data":[{"name":"stdout","output_type":"stream","text":"Maximum eigenvalue change is 5.40e-01\nThe Bauer-Fike upper bound is 6.15e+01\n"}],"key":"Y1JvdLaJEL"}],"key":"nX1rL9BZIl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we plot the eigenvalues of many perturbations, we get a cloud of points that roughly represents all the possible eigenvalues when representing this matrix with single-precision accuracy.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P67xRZNg3n"}],"key":"nJzop2vTvE"}],"key":"yBwyvkPiNS"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"clf\nscatter(d, zeros(n), 18)\naxis(\"equal\") \nfor _ in range(100):\n    E = random.randn(n, n) + 1j * random.randn(n, n)\n    E = finfo(np.float32).eps * E / norm(E, 2)\n    dd, _ = eig(A + E)\n    scatter(real(dd), imag(dd), 2, 'k')","key":"Qwri0N4rgv"},{"type":"output","id":"0EgDHeeHPL-DVrQlmOD6M","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c017d4a8c114ad73da8de02dd8083dbc","path":"/fnc/build/c017d4a8c114ad73da8de02dd8083dbc.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"Tj1VBN0Jst"}],"key":"GmIib4RpAs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The plot shows that some eigenvalues are much more affected than others. This situation is not unusual, but it is not explained by the Bauer–Fike theorem.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AJN5UpPem9"}],"key":"z0gmFUEqKQ"}],"key":"jPOK3Dm6CQ"}],"key":"Cx9nGbTsRE"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Eigen","url":"/eigen-2","group":"Chapter 7"},"next":{"title":"Francisqr","url":"/francisqr-2","group":"Chapter 7"}}},"domain":"http://localhost:3000"}