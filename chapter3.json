{"kind":"Notebook","sha256":"f52090f7b3e8c81989c11c68e508435683bb6b98fb57bd71234c1bb72788fb8d","slug":"chapter3","location":"/julia/chapter3.md","dependencies":[],"frontmatter":{"title":"Chapter 3","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter3.md","url":"/fnc/build/chapter3-326a6b48ca2000f702e27bebb9a24575.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Julia implementations","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"wiPB5kl0J6"}],"key":"F5wqLAZX68"},{"type":"heading","depth":2,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZXu6W7PMGZ"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"bTEE2i2A6O"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by the normal equations","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"pAGUrP8IXo"}],"key":"a1ZOW0ynuy"},{"type":"include","file":"../julia/package/src/chapter03.jl","literal":true,"filter":{"lines":[[1,13]]},"children":[{"type":"code","value":"\"\"\"\n    lsnormal(A,b)\n\nSolve a linear least-squares problem by the normal equations.\nReturns the minimizer of ||b-Ax||.\n\"\"\"\nfunction lsnormal(A,b)\n    N = A'*A;  z = A'*b;\n    R = cholesky(N).U\n    w = forwardsub(R',z)                   # solve R'z=c\n    x = backsub(R,w)                       # solve Rx=z\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"lsnormal.jl","key":"KRM87CtXuz"}],"key":"fJDfZrOJlL"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"sDRTen5ucb"}],"key":"wRLmU1oDDx"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"The syntax on line 9 is a ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"K18RYmxymW"},{"type":"emphasis","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"field reference","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"QgUkh7aMZN"}],"key":"Ox5Vv8S9Eg"},{"type":"text","value":" to extract the matrix we want from the structure returned by ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xauuFWszBX"},{"type":"inlineCode","value":"cholesky","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"MXKCPFtIB0"},{"type":"text","value":".","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"reVk3uUTlR"}],"key":"qwKICUY76i"}],"class":"dropdown","key":"bQPmLb7lVd"}],"label":"function-lsnormal-julia","identifier":"function-lsnormal-julia","html_id":"function-lsnormal-julia","key":"lmeMNG02pd"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by ","key":"aSrxU46qDq"},{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"KqOAXjVuWF"}],"key":"HjEHPm8sLR"},{"type":"text","value":" factorization","key":"MHZ6GITWD2"}],"key":"z2oK3U0y8B"},{"type":"include","file":"../julia/package/src/chapter03.jl","literal":true,"filter":{"lines":[[16,27]]},"children":[{"type":"code","value":"\"\"\"\n    lsqrfact(A,b)\n\nSolve a linear least-squares problem by QR factorization. Returns\nthe minimizer of ||b-Ax||.\n\"\"\"\nfunction lsqrfact(A,b)\n    Q,R = qr(A)\n    c = Q'*b\n    x = backsub(R,c)\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"lsqrfact.jl","key":"RYp0UbA1FG"}],"key":"mx2k3wL3Vr"}],"label":"function-lsqrfact-julia","identifier":"function-lsqrfact-julia","html_id":"function-lsqrfact-julia","key":"HayxNwf4DC"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"qvhQBm3UT3"}],"key":"sSNsWKYR9g"},{"type":"text","value":" factorization by Householder reflections","key":"nDxo1RxWDW"}],"key":"tC8sEbgOrT"},{"type":"include","file":"../julia/package/src/chapter03.jl","literal":true,"filter":{"lines":[[29,53]]},"children":[{"type":"code","value":"\"\"\"\n    qrfact(A)\n\nQR factorization by Householder reflections. Returns Q and R.\n\"\"\"\nfunction qrfact(A)\n    m,n = size(A)\n    Qt = diagm(ones(m))\n    R = float(copy(A))\n    for k in 1:n\n        z = R[k:m,k]\n        w = [ -sign(z[1])*norm(z) - z[1]; -z[2:end] ]\n        nrmw = norm(w)\n        if nrmw < eps() continue; end    # skip this iteration\n        v = w / nrmw;\n        # Apply the reflection to each relevant column of R and Q\n        for j in k:n\n            R[k:m,j] -= v*( 2*(v'*R[k:m,j]) )\n        end\n        for j in 1:m\n            Qt[k:m,j] -= v*( 2*(v'*Qt[k:m,j]) )\n        end\n    end\n    return Qt',triu(R)\nend","lang":"julia","showLineNumbers":true,"filename":"qrfact.jl","key":"gBjqzBcbZl"}],"key":"EkwqvZ1f6r"}],"label":"function-qrfact-julia","identifier":"function-qrfact-julia","html_id":"function-qrfact-julia","key":"CgvpcaM8jK"},{"type":"heading","depth":2,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"IenFqQn26E"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"WxYGdipnFO"}],"key":"p9HekN09RD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"import Pkg; Pkg.activate(\"/Users/driscoll/Documents/GitHub/fnc\")\nusing FundamentalsNumericalComputation\nFNC.init_format()","visibility":"show","key":"V8t8mJNvRr"},{"type":"output","id":"BTtcSRB1w4UBygEMHtYar","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"},{"output_type":"stream","name":"stdout","text":"EOFError("},{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mverify download of index files...\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mreading database\n"},{"output_type":"stream","name":"stdout","text":")\n"},{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mrecreating database file\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/download.jl:59\u001b[39m\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mreading index files\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39madding metadata...\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39madding svd data...\n"},{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mwriting database\n\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mexception during initialization: 'KeyError(MatrixDepot)'\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ MatrixDepot ~/.julia/packages/MatrixDepot/4S7Oa/src/MatrixDepot.jl:125\u001b[39m\n"}],"visibility":"show","key":"u3Imw0M3UO"}],"data":{"tags":[]},"visibility":"remove","key":"ePfcc6obKh"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Section 3.1","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"woPmJXU8i5"}],"identifier":"section-3-1","label":"Section 3.1","html_id":"section-3-1","implicit":true,"key":"nl2Jbn0ly8"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Interpolating temperature data","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"Z3GF8rLFNX"}],"key":"P7ujsVPl4B"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"Here are 5-year averages of the worldwide temperature anomaly as compared to the 1951–1980 average (source: NASA).","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"ba5gnVPgGI"}],"key":"FVQUuBZzxt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n       0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]\n    \nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", leg=:bottomright)","key":"XpOLCREmZR"},{"type":"output","id":"a8eGoyvAbQ4VCcvGn3ZKd","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00c2a210fc24ac3df4cd7443eddef9ff","path":"/fnc/build/00c2a210fc24ac3df4cd7443eddef9ff.png"},"text/html":{"content_type":"text/html","hash":"0bdd98fd2047afb0d1583f9e5a1d3dbb","path":"/fnc/build/0bdd98fd2047afb0d1583f9e5a1d3dbb.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ee07bbc19861f7856fbfb4da527fc2e4","path":"/fnc/build/ee07bbc19861f7856fbfb4da527fc2e4.svg"}}}],"key":"HX8W8ZpvUB"}],"data":{},"key":"nnvih9M6vk"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"A polynomial interpolant can be used to fit the data. Here we build one using a Vandermonde matrix. First, though, we express time as decades since 1950, as it improves the condition number of the matrix.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"kveM0K0EDs"}],"key":"w1LDcYwoXq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = @. (year - 1950) / 10\nn = length(t)\nV = [ t[i]^j for i in 1:n, j in 0:n-1 ]\nc = V \\ temp","key":"az6mGDi390"},{"type":"output","id":"nfU2B0i6JfMhj11Qmi1s4","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n  -14.114000001832462\n   76.36173810552113\n -165.45597224550528\n  191.96056669514388\n -133.27347224319684\n   58.015577787494486\n  -15.962888891734785\n    2.6948063497166928\n   -0.2546666667177082\n    0.010311111113288083","content_type":"text/plain"}}}],"key":"tuDz2POGoj"}],"data":{},"key":"j0cEn8hrKR"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"The coefficients in vector ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"IZzp0fNqny"},{"type":"inlineCode","value":"c","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"vcHr3J0wyN"},{"type":"text","value":" are used to create a polynomial. Then we create a function that evaluates the polynomial after changing the time variable as we did for the Vandermonde matrix.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"d1rlxv9uEK"}],"key":"V8FfA8q8rK"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"If you ","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"XHdMqahO8D"},{"type":"inlineCode","value":"plot","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"RCIyWFBYoa"},{"type":"text","value":" a function, then the points are chosen automatically to make a smooth curve.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"Mqr1BJyT6h"}],"key":"zdFKgZJIXf"}],"key":"W1wp3n4nd0"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"plotting functions","kind":"entry"},"emphasis":false}],"label":"index-hbz5M0vyJJ","identifier":"index-hbz5m0vyjj","html_id":"index-hbz5m0vyjj","key":"HZCOlNRu9F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"p = Polynomial(c)\nf = yr -> p((yr - 1950) / 10)\nplot!(f, 1955, 2000, label=\"interpolant\")","key":"YKJtbzF4JB"},{"type":"output","id":"etxkd7eMNLChIq603HzTa","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ba5e97290c4348f6eb39f4c9b0de1ee","path":"/fnc/build/7ba5e97290c4348f6eb39f4c9b0de1ee.png"},"text/html":{"content_type":"text/html","hash":"d098614a761513781b95a0dbe0ac9f98","path":"/fnc/build/d098614a761513781b95a0dbe0ac9f98.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"d0a577e2d0955fed96bc7b71415243c1","path":"/fnc/build/d0a577e2d0955fed96bc7b71415243c1.svg"}}}],"key":"PTfliJJBN5"}],"data":{},"key":"SVsqh4Uplb"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"As you can see, the interpolant does represent the data, in a sense. However it’s a crazy-looking curve for the application. Trying too hard to reproduce all the data exactly is known as ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"oanap2mb2y"},{"type":"emphasis","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"overfitting","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"ff2P2mILLA"}],"key":"zNmxd7ESzx"},{"type":"text","value":".","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"wSOwm9clgQ"}],"key":"YAwl40oeXd"}],"label":"demo-fitting-tempinterp-julia","identifier":"demo-fitting-tempinterp-julia","html_id":"demo-fitting-tempinterp-julia","key":"EnVSt01Eye"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Fitting temperature data","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"XpfRyN2CEG"}],"key":"HMdKcKFxzP"},{"type":"paragraph","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"text","value":"Here are the 5-year temperature averages again.","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"BL8atWfQZw"}],"key":"BjSkoXsCcR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\nt = @. (year-1950)/10\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n          0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]","key":"lSUzrMnUJD"},{"type":"output","id":"tenTYusqXhcWn0g_VFRIy","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n -0.048\n -0.018\n -0.036\n -0.012\n -0.004\n  0.118\n  0.21\n  0.332\n  0.334\n  0.456","content_type":"text/plain"}}}],"key":"v3jJrjEngV"}],"data":{},"key":"jdbWLeCLzB"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"The standard best-fit line results from using a linear polynomial that meets the least-squares criterion.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"lLuAK344Dx"}],"key":"rt2gLsZbBg"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Backslash solves overdetermined linear systems in a least-squares sense.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"x4GpDjfkKN"}],"key":"phOzvFCEuJ"}],"key":"ja1mQ6vZFZ"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-x7QVrUMvDI","identifier":"index-x7qvrumvdi","html_id":"index-x7qvrumvdi","key":"WeVrk3fzNW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t.^0 t ]    # Vandermonde-ish matrix\n@show size(V)\nc = V \\ temp\np = Polynomial(c)","key":"lWmetiN9ps"},{"type":"output","id":"7xD7ovexPks2fEJ_DzsGD","data":[{"output_type":"stream","name":"stdout","text":"size(V) = (10, 2)"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"Polynomial(-0.18773333333333356 + 0.11670303030303034*x)","content_type":"text/plain"},"text/html":{"content":"&#45;0.18773333333333356 &#43; 0.11670303030303034&#8729;x","content_type":"text/html"},"text/latex":{"content":"$-0.18773333333333356 + 0.11670303030303034\\cdot x$","content_type":"text/latex"}}}],"key":"mklK2zOHzS"}],"data":{},"key":"sUuXgBG6z9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = yr -> p((yr - 1955) / 10)\nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", leg=:bottomright)\nplot!(f, 1955, 2000, label=\"linear fit\")","key":"FiaLfBMltw"},{"type":"output","id":"8fjMP2-FU_fKQ7i0p4tOC","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c154bb9e7191c4921546b7c6472887e0","path":"/fnc/build/c154bb9e7191c4921546b7c6472887e0.png"},"text/html":{"content_type":"text/html","hash":"96d93c8ddf0e8ec4b772378a579c5474","path":"/fnc/build/96d93c8ddf0e8ec4b772378a579c5474.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"4074de47e487e4628605c6916b2f40b2","path":"/fnc/build/4074de47e487e4628605c6916b2f40b2.svg"}}}],"key":"Ne8QgPUVdB"}],"data":{},"key":"D0wKLV25ZO"},{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"If we use a global cubic polynomial, the points are fit more closely.","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"rnJ0usi8oU"}],"key":"rlO5pfSpy9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t[i]^j for i in 1:length(t), j in 0:3 ]   \n@show size(V);","key":"puQMnG1map"},{"type":"output","id":"_f2oWBdk22iUd9ZrCyqIE","data":[{"output_type":"stream","name":"stdout","text":"size(V) = (10, 4)"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"fDA0k5LKFz"}],"data":{},"key":"FCeckx6Ida"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"Now we solve the new least-squares problem to redefine the fitting polynomial.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"jKMKz4QXe0"}],"key":"vQZLHbw4xh"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"The definition of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"uvKhvDKEt6"},{"type":"inlineCode","value":"f","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"uwIREZftP9"},{"type":"text","value":" above is in terms of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"bionhA4JL8"},{"type":"inlineCode","value":"p","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"wni98G2FPA"},{"type":"text","value":". When ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"YWQ8q4AG4Y"},{"type":"inlineCode","value":"p","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"iz29fQXnCZ"},{"type":"text","value":" is changed, then ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"HnU9rstyKH"},{"type":"inlineCode","value":"f","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"u83rMcjtRi"},{"type":"text","value":" calls the new version.","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"tGO3AdOyJN"}],"key":"HVfqa8tO8J"}],"key":"WN5V0dUumd"}],"key":"XZ4U2SLO5J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"p = Polynomial( V \\ temp )\nplot!(f, 1955, 2000, label=\"cubic fit\")","key":"v2GXHLRcQ0"},{"type":"output","id":"JKoy32iRl7oFmjc9koRpj","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3b4ac1918b5ad83106e92af6f49b2c14","path":"/fnc/build/3b4ac1918b5ad83106e92af6f49b2c14.png"},"text/html":{"content_type":"text/html","hash":"4f59eb8c1363170a204ad5172db51468","path":"/fnc/build/4f59eb8c1363170a204ad5172db51468.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e40a64b043f46d147a0ed2be2b6450bc","path":"/fnc/build/e40a64b043f46d147a0ed2be2b6450bc.svg"}}}],"key":"FEKJAebUbj"}],"data":{},"key":"nNEsX1e6Mo"},{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"If we were to continue increasing the degree of the polynomial, the residual at the data points would get smaller, but overfitting would increase.","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"RqZadGB5z8"}],"key":"lszYgBJ3I3"}],"label":"demo-fitting-tempfit-julia","identifier":"demo-fitting-tempfit-julia","html_id":"demo-fitting-tempfit-julia","key":"WjZVrJNcqu"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Fitting a power law","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"xFt4dNEMh0"}],"key":"aLnjOIjKJ9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"a = [1/k^2 for k=1:100] \ns = cumsum(a)        # cumulative summation\np = @. sqrt(6*s)\n\nscatter(1:100, p, title=\"Sequence convergence\",\n    xlabel=L\"k\", ylabel=L\"p_k\")","key":"QLVrMuSPuw"},{"type":"output","id":"lCiD5zt8tL1aXVEgmNndX","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b5ae30c8e60d81af034b3247485abc4f","path":"/fnc/build/b5ae30c8e60d81af034b3247485abc4f.png"},"text/html":{"content_type":"text/html","hash":"eb1a5a7878d827a7fb6ff422a5442480","path":"/fnc/build/eb1a5a7878d827a7fb6ff422a5442480.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"753958ee5d727da89335c31d7f2f4bd4","path":"/fnc/build/753958ee5d727da89335c31d7f2f4bd4.svg"}}}],"key":"o0I7sD9Ts4"}],"data":{},"key":"ZBgGAJ7tPV"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"This graph suggests that maybe ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"gKpNdEaRPG"},{"type":"inlineMath","value":"p_k\\to \\pi","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>→</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">p_k\\to \\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"hfV9U6zwca"},{"type":"text","value":", but it’s far from clear how close the sequence gets. It’s more informative to plot the sequence of errors, ","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"weYStSQPrp"},{"type":"inlineMath","value":"\\epsilon_k= |\\pi-p_k|","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>π</mi><mo>−</mo><msub><mi>p</mi><mi>k</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k= |\\pi-p_k|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>","key":"XgfadlghdP"},{"type":"text","value":". By plotting the error sequence on a log-log scale, we can see a nearly linear relationship.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"O8sGXp6eSd"}],"key":"p7XJjDIFGK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = @. abs(π - p)    # error sequence\nscatter(1:100, ϵ, title=\"Convergence of errors\",\n    xaxis=(:log10,L\"k\"), yaxis=(:log10,\"error\"))","key":"RktURsa4E1"},{"type":"output","id":"VjIsgGLO_RSBTr2XuHi0G","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"424cd0e0b45b848a740763ee21943940","path":"/fnc/build/424cd0e0b45b848a740763ee21943940.png"},"text/html":{"content_type":"text/html","hash":"f059abba52105c33b46747e19d6fc383","path":"/fnc/build/f059abba52105c33b46747e19d6fc383.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"1b0bd410933493dd0b04f7f69ad4e3ee","path":"/fnc/build/1b0bd410933493dd0b04f7f69ad4e3ee.svg"}}}],"key":"VSK0RDl85R"}],"data":{},"key":"bd4mTMMnvP"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"The straight line on the log-log scale suggests a power-law relationship where ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"NQSJCgZokJ"},{"type":"inlineMath","value":"\\epsilon_k\\approx a k^b","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>a</mi><msup><mi>k</mi><mi>b</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k\\approx a k^b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6331em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span></span></span></span>","key":"tGOBdUio1W"},{"type":"text","value":", or ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"d759fPkyjF"},{"type":"inlineMath","value":"\\log \\epsilon_k \\approx b (\\log k) + \\log a","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>b</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">\\log \\epsilon_k \\approx b (\\log k) + \\log a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"V4mKuHIHDu"},{"type":"text","value":".","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"a5e87rEkGF"}],"key":"RSGvqb4jQ6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"k = 1:100\nV = [ k.^0 log.(k) ]     # fitting matrix\nc = V \\ log.(ϵ)          # coefficients of linear fit","key":"dDkFEZKCQK"},{"type":"output","id":"hQx0VwCYxfPvedvu412R5","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.18237524972829994\n -0.9674103233127929","content_type":"text/plain"}}}],"key":"fy4hrqFJrR"}],"data":{},"key":"zlFqgs0h1l"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"In terms of the parameters ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"BKFTPsEDsc"},{"type":"inlineMath","value":"a","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"BFY1eTWHV6"},{"type":"text","value":" and ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"L1jKYvRfqd"},{"type":"inlineMath","value":"b","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"bYsu24eptG"},{"type":"text","value":" used above, we have","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"Cu9RDQPWDt"}],"key":"nbH9NXaeZg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"a, b = exp(c[1]), c[2];\n@show b;","key":"BwgYkaEbMw"},{"type":"output","id":"wbfyOazXVXaCrWm5nAu9A","data":[{"output_type":"stream","name":"stdout","text":"b = -0.9674103233127929\n"}],"key":"qrBflginDS"}],"data":{},"key":"A8wYkcjWa6"},{"type":"paragraph","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"It’s tempting to conjecture that the slope ","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"YYeLlrfghH"},{"type":"inlineMath","value":"b\\to -1","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>→</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">b\\to -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"C97l4I58Vp"},{"type":"text","value":" asymptotically. Here is how the numerical fit compares to the original convergence curve.","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"GLzdkeJZQi"}],"key":"c1g9DO1RXe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!(k, a * k.^b, l=:dash, label=\"power-law fit\")","key":"Lnv57nBFfY"},{"type":"output","id":"eJTU0Ay03DUfM3IdbDokT","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b38e6613a40a415ae05e9f35a39ee12","path":"/fnc/build/5b38e6613a40a415ae05e9f35a39ee12.png"},"text/html":{"content_type":"text/html","hash":"349178bc933498b2c518d4f3db023301","path":"/fnc/build/349178bc933498b2c518d4f3db023301.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"2655592dc1003ee3546ed90b74660db6","path":"/fnc/build/2655592dc1003ee3546ed90b74660db6.svg"}}}],"key":"NMbSnMY3U9"}],"data":{},"key":"DGrg7lhSrj"}],"label":"demo-fitting-pirate-julia","identifier":"demo-fitting-pirate-julia","html_id":"demo-fitting-pirate-julia","key":"BI8GGqllmx"},{"type":"heading","depth":3,"position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Section 3.2","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"re9FN9FYlg"}],"identifier":"section-3-2","label":"Section 3.2","html_id":"section-3-2","implicit":true,"key":"WSK0KiDw4s"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Instability in the normal equations","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"VkKw9lzLZ0"}],"key":"gE9K6Ty09v"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Because the functions ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"MOqzXMTzwI"},{"type":"inlineMath","value":"\\sin^2(t)","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1219em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">sin</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8719em;\"><span style=\"top:-3.1208em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"Ss7HGUxKy7"},{"type":"text","value":", ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"bNfIoM20ty"},{"type":"inlineMath","value":"\\cos^2(t)","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>cos</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\cos^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">cos</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"xjfi0We016"},{"type":"text","value":", and ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"MGNSfotrzT"},{"type":"text","value":"1","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"o3HTv3b68h"},{"type":"text","value":" are linearly dependent, we should find that the following matrix is somewhat ill-conditioned.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"C2xZLvlyQ1"}],"key":"zK9uo04xEZ"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"The local variable scoping rule for loops applies to comprehensions as well.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"T7kcju1bHW"}],"key":"dd5UlIMPzV"}],"key":"X3E3RecxYc"}],"key":"f3m2UYx8kq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, 400)\nf = [ x->sin(x)^2, x->cos((1+1e-7)*x)^2, x->1. ]\nA = [ f(t) for t in t, f in f ]\n@show κ = cond(A);","key":"fmrlcjae8v"},{"type":"output","id":"Be0kAbZecnfpS9KnaXOE5","data":[{"output_type":"stream","name":"stdout","text":"κ = cond(A) = 1.8253225426741675e7\n"}],"key":"GrUmpCZc4x"}],"data":{},"key":"VgogXhtXSd"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"Now we set up an artificial linear least-squares problem with a known exact solution that actually makes the residual zero.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"QBMnAhhawT"}],"key":"iL5XemxnJs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [1., 2, 1]\nb = A * x;","key":"l1S7dZxrLx"},{"type":"output","id":"3-JEc8vxuidtH6dC_qsFZ","data":[],"key":"LCUucOTYf9"}],"data":{},"key":"tMBdGjTJGn"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"Using backslash to find the least-squares solution, we get a relative error that is well below ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"ge147sHQDR"},{"type":"text","value":"κ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"JLKqMMVBp8"},{"type":"text","value":" times machine epsilon.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"Tb2s30vj5a"}],"key":"PlZbLeML13"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x_BS = A \\ b\n@show observed_error = norm(x_BS - x) / norm(x);\n@show error_bound = κ * eps();","key":"ODyXQp0JAZ"},{"type":"output","id":"qScYytYFQQUlA_6oHdAvO","data":[{"output_type":"stream","name":"stdout","text":"observed_error = norm(x_BS - x) / norm(x) = 1.0163949045357309e-10\nerror_bound = κ * eps() = 4.053030228488391e-9\n"}],"key":"UUySWn7Wbq"}],"data":{},"key":"CagS5xoFob"},{"type":"paragraph","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"If we formulate and solve via the normal equations, we get a much larger relative error. With ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"Bzwm3f9nN5"},{"type":"inlineMath","value":"\\kappa^2\\approx 10^{14}","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>κ</mi><mn>2</mn></msup><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa^2\\approx 10^{14}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span></span></span></span></span></span></span></span></span></span></span></span>","key":"dnc95VDYUu"},{"type":"text","value":", we may not be left with more than about 2 accurate digits.","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"eYN8oDZeF3"}],"key":"YXBPj1Okv6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"N = A' * A\nx_NE = N \\ (A'*b)\n@show observed_err = norm(x_NE - x) / norm(x);\n@show digits = -log10(observed_err);","key":"fc8YiIEqbc"},{"type":"output","id":"zrY5dXfGHBBHyCviHi0rC","data":[{"output_type":"stream","name":"stdout","text":"observed_err = norm(x_NE - x) / norm(x) = 0.021745909192780664\ndigits = -(log10(observed_err)) = 1.6626224298403076\n"}],"key":"bVtKpwNZsV"}],"data":{},"key":"LY7RGGNCWl"}],"label":"demo-normaleqns-instab-julia","identifier":"demo-normaleqns-instab-julia","html_id":"demo-normaleqns-instab-julia","key":"kFkfShTaTG"},{"type":"heading","depth":3,"position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"Section 3.3","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"usyru68j8x"}],"identifier":"section-3-3","label":"Section 3.3","html_id":"section-3-3","implicit":true,"key":"LFCz9jz7Op"},{"type":"details","children":[{"type":"summary","children":[{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"Vs0Lg5v2ZK"}],"key":"FB6NvR55iE"},{"type":"text","value":" factorization","key":"cKwYtmVHKy"}],"key":"wxufrpVAQ5"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"Julia provides access to both the thin and full forms of the ","key":"FD6Ssj807J"},{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"VTA8LmBP12"}],"key":"Fj8taAvYW6"},{"type":"text","value":" factorization.","key":"PNZiVrwPyX"}],"key":"dNKCtleHf1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.:9., 6, 4)\n@show m,n = size(A);","key":"r6Pop808UJ"},{"type":"output","id":"G3rgrN9HlXp0vBGNKMF3F","data":[{"output_type":"stream","name":"stdout","text":"(m, n) = size(A) = (6, 4)"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"IwJBFp5qPC"}],"data":{},"key":"A3rthPYSsF"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Here is a standard call:","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"k2H6BDjrxW"}],"key":"iJSbd2ROLf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q,R = qr(A);\nQ","key":"BePZeDh9gK"},{"type":"output","id":"apnLXToZSymvdl_LuyIwI","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"6×6 LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}","content_type":"text/plain"}}}],"key":"tnNXkQdkSy"}],"data":{},"key":"aO5j84RSth"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"R","key":"IRS7E5jCKS"},{"type":"output","id":"YoUnFbnxbLge0eQyy3hgs","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -11.4891  -11.228    -11.9243   -11.7502\n   0.0       3.15148    7.65153    5.41593\n   0.0       0.0       -5.22156   -1.80908\n   0.0       0.0        0.0        6.42859","content_type":"text/plain"}}}],"key":"AmZwrtMWDC"}],"data":{},"key":"Pm80vdfPTC"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"If you look carefully, you see that we seemingly got a full ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"HADaXVHypp"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"rnQZZD0PLe"},{"type":"text","value":" but a thin ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"eZGwLI4HUs"},{"type":"inlineMath","value":"\\mathbf{R}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">R</span></span></span></span>","key":"r2zIZNwG1Y"},{"type":"text","value":". However, the ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"W29naZjKYl"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"b3AdCdaTlz"},{"type":"text","value":" above is not a standard matrix type. If you convert it to a true matrix, then it reverts to the thin form.","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"Tvd6YvcjRM"}],"key":"PUo6FoZt3K"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"To enter the accented character ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"pkh0iZntaw"},{"type":"inlineCode","value":"Q̂","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"oORKRHchx6"},{"type":"text","value":", type ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"k1eMksqQA7"},{"type":"inlineCode","value":"Q\\hat","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"O9W3DEVj26"},{"type":"text","value":" followed by ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"VXLrFak63f"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"k4AjIHEYya"}],"key":"LYn24xNKND"},{"type":"text","value":".","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"FBsJEnKifY"}],"key":"WIfz8FoyZr"}],"key":"mhrOqEBXEO"}],"key":"IPb0Gkmfz9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂ = Matrix(Q)","key":"H1QO1dk9rB"},{"type":"output","id":"6KOtztN-HqtdIB3i5LDfK","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n -0.435194   0.0360581  -0.293917  -0.441877\n -0.609272  -0.26683    -0.531739   0.361523\n -0.174078   0.649046   -0.183479   0.0167114\n -0.522233  -0.274042    0.599521  -0.399402\n -0.261116   0.0216349   0.436493   0.716222\n -0.261116   0.656258    0.21737   -0.0356509","content_type":"text/plain"}}}],"key":"u8qjBZoey2"}],"data":{},"key":"qthVxRsoQj"},{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"We can test that ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"VPEdbO9NmP"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"PXVACu7jG9"},{"type":"text","value":" is an orthogonal matrix:","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"M74k0fGRWc"}],"key":"kYFBb9O4SR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(Q' * Q - I)","key":"Akl7YNeDCx"},{"type":"output","id":"eAGFR34QTAi7vdpPQMYS5","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"1.0329312990145141e-15","content_type":"text/plain"}}}],"key":"Q8AHRZ4pZR"}],"data":{},"key":"rmT7L2IqbK"},{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"The thin ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"nOBppLtEDf"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"LdcqkrgiSV"},{"type":"text","value":" cannot be an orthogonal matrix, because it is not square, but it is still ONC:","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"xig5y5meyo"}],"key":"Lw4w6Qv9fp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂' * Q̂ - I","key":"HUnEDEjaWz"},{"type":"output","id":"GEP9--8Bn1kYXZ_oep70X","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -7.77156e-16   2.6556e-17   -1.17809e-16  -1.97323e-16\n  2.6556e-17    6.66134e-16   2.22366e-16  -2.57488e-16\n -1.17809e-16   2.22366e-16   0.0          -3.9026e-17\n -1.97323e-16  -2.57488e-16  -3.9026e-17   -1.11022e-16","content_type":"text/plain"}}}],"key":"mKhkdfTglP"}],"data":{},"key":"hjXQBcIDjv"}],"label":"demo-qr-qrfact-julia","identifier":"demo-qr-qrfact-julia","html_id":"demo-qr-qrfact-julia","key":"Hdhr8DaDjz"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stability of least-squares via ","key":"wqQkMLNccc"},{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"qhRkGhjVhz"}],"key":"wBKSbgs7YJ"}],"key":"X4GaC2B8Gu"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"We’ll repeat the experiment of ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"iTBE1GGhaA"},{"type":"crossReference","kind":"proof:example","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","children":[{"type":"text","value":"Demo ","key":"xS5VlhYrkf"},{"type":"text","value":"3.2.1","key":"IzlhpTI6mM"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"deD2lMvSHb"},{"type":"text","value":", which exposed instability in the normal equations.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"FlhkV25BKq"}],"key":"C28nSXCtiR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, 400)\nf = [ x->sin(x)^2, x->cos((1+1e-7)*x)^2, x->1. ]\nA = [ f(t) for t in t, f in f ]\nx = [1., 2, 1]\nb = A * x;","key":"PIo4YmPcFF"},{"type":"output","id":"MP3n4MpSynMRi3rAh1X9s","data":[],"key":"lDyKwACvYf"}],"data":{},"key":"r4byFg9coW"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"The error in the solution by ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"aNZMbdOiq2"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lsqrfact","label":"function-lsqrfact","children":[{"type":"text","value":"Function ","key":"Wl0yw0oloN"},{"type":"text","value":"3.3.2","key":"Ffg7Jmsx3I"}],"template":"Algorithm %s","enumerator":"3.3.2","resolved":true,"html_id":"function-lsqrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"ktYV4zdU3U"},{"type":"text","value":" is similar to the bound predicted by the condition number.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"ZWo2kvJZ8z"}],"key":"miUaAD9aCe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"observed_error = norm(FNC.lsqrfact(A,b) - x) / norm(x);\n@show observed_error;\n@show error_bound = cond(A) * eps();","key":"m0uPYuqMi4"},{"type":"output","id":"SENTT1IHS-n2uAURD8Cg6","data":[{"output_type":"stream","name":"stdout","text":"observed_error = 4.665273501889628e-9"},{"output_type":"stream","name":"stdout","text":"\nerror_bound = cond(A) * eps() = 4.053030228488391e-9\n"}],"key":"ksViEPefyl"}],"data":{},"key":"NzGWkYNUCl"}],"label":"demo-qr-stable-julia","identifier":"demo-qr-stable-julia","html_id":"demo-qr-stable-julia","key":"AI5AjZEgS0"},{"type":"heading","depth":3,"position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"Section 3.4","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"Jhkb2qmcS4"}],"identifier":"section-3-4","label":"Section 3.4","html_id":"section-3-4","implicit":true,"key":"xAba8sodSP"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Householder ","key":"lV8hObCyJD"},{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"cJpZ685Mob"}],"key":"HTlWtUlZvV"},{"type":"text","value":" factorization","key":"MRsSunpLUB"}],"key":"HjlSHmfn32"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"We will use Householder reflections to produce a ","key":"SolxYdQn6j"},{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"Z0yKJVjQiI"}],"key":"xPjBVetMRk"},{"type":"text","value":" factorization of a random matrix.","key":"W1vU0mwTgK"}],"key":"NdXXBKlIrp"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"rMMHP2JezC"},{"type":"inlineCode","value":"rand","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"Le9GLq1dIZ"},{"type":"text","value":" function can select randomly from within the interval ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"piUB82O0Kc"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"rLsuE88Mm8"},{"type":"text","value":", or from a vector or range that you specify.","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"t6T20PSv1M"}],"key":"pazq7m5f6J"}],"key":"LH7NB3yILk"}],"key":"GMCy68dzWc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(float(1:9),6,4)\nm,n = size(A)","key":"wc2zJ86t05"},{"type":"output","id":"0VaC73m9YykBHW5y3JXUM","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"(6, 4)","content_type":"text/plain"}}}],"key":"WnafZJ6xu2"}],"data":{},"key":"HFymI9xQwE"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"Our first step is to introduce zeros below the diagonal in column 1 by using ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"ItZGTyHhug"},{"type":"crossReference","kind":"equation","identifier":"hhvector","label":"hhvector","children":[{"type":"text","value":"(","key":"MwAR9nJB5d"},{"type":"text","value":"3.4.4","key":"OwGjwwfThb"},{"type":"text","value":")","key":"QIzmeq6Tlo"}],"template":"(%s)","enumerator":"3.4.4","resolved":true,"html_id":"hhvector","remote":true,"url":"/house","dataUrl":"/house.json","key":"J79vPg1jEH"},{"type":"text","value":" and ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"jcDHeKgOQf"},{"type":"crossReference","kind":"equation","identifier":"hhreflect","label":"hhreflect","children":[{"type":"text","value":"(","key":"Qotl7KaNR6"},{"type":"text","value":"3.4.1","key":"RrcT5j4mBQ"},{"type":"text","value":")","key":"hzARUXOVS2"}],"template":"(%s)","enumerator":"3.4.1","resolved":true,"html_id":"hhreflect","remote":true,"url":"/house","dataUrl":"/house.json","key":"VkCM5UGM8c"},{"type":"text","value":".","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"u0JKiKRqpw"}],"key":"rJILHzJrGx"},{"type":"code","lang":"","value":":::{card}\n`I` can stand for an identity matrix of any size, inferred from the context when needed.","position":{"start":{"line":336,"column":1},"end":{"line":339,"column":1}},"key":"SufSpRmo96"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"normalize","kind":"entry"},"emphasis":false},{"entry":"Julia","subEntry":{"value":"I","kind":"entry"},"emphasis":true}],"label":"index-CnIvIwTGXK","identifier":"index-cniviwtgxk","html_id":"index-cniviwtgxk","key":"Xz0RE7nhln"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = A[:, 1];\nv = normalize(z - norm(z) * [1; zeros(m-1)])\nP₁ = I - 2v * v'   # reflector","key":"AKSFhWit7V"},{"type":"output","id":"CAIIFuIc0vRf4yWZFUld5","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Float64}:\n 0.27735   0.3698     0.27735    0.64715    0.27735    0.46225\n 0.3698    0.810763  -0.141928  -0.331165  -0.141928  -0.236546\n 0.27735  -0.141928   0.893554  -0.248374  -0.106446  -0.17741\n 0.64715  -0.331165  -0.248374   0.420462  -0.248374  -0.413956\n 0.27735  -0.141928  -0.106446  -0.248374   0.893554  -0.17741\n 0.46225  -0.236546  -0.17741   -0.413956  -0.17741    0.704317","content_type":"text/plain"}}}],"key":"shYyYIrAbQ"}],"data":{},"key":"r2adii3twz"},{"type":"paragraph","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"children":[{"type":"text","value":"We check that this reflector introduces zeros as it should:","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"H0X099UJWQ"}],"key":"tznAb4oruC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"P₁ * z","key":"r8JWmPgjt8"},{"type":"output","id":"LzHFuoj_dpWalS356gBke","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n 10.816653826391967\n  1.8041124150158794e-15\n  1.3877787807814457e-15\n  3.164135620181696e-15\n  1.0547118733938987e-15\n  1.6653345369377348e-15","content_type":"text/plain"}}}],"key":"yzTWXvtnkf"}],"data":{},"key":"IKGWQJ5OR5"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"Now we replace ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"WLTJwzD2TL"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"YZOOTD5gQv"},{"type":"text","value":" by ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"nRpG6gII5J"},{"type":"inlineMath","value":"\\mathbf{P}\\mathbf{A}","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"wxIV8tU5Er"},{"type":"text","value":".","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"Q3bmQgQVmY"}],"key":"fkR4IIWHiM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = P₁ * A","key":"OOWky2ZAoE"},{"type":"output","id":"42HORc0su3mxxIX1SPQUX","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 10.8167       13.1279   9.70725   10.1695\n  1.80411e-15   2.30554  4.63808   -1.69229\n  1.38778e-15   3.72916  0.728559  -0.519218\n  3.16414e-15  -7.9653   4.36664   -1.21151\n  1.05471e-15   2.72916  4.72856    5.48078\n  1.66533e-15   1.88193  0.547598  -3.86536","content_type":"text/plain"}}}],"key":"Q7j7IiYA11"}],"data":{},"key":"xJd6CmhsXK"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"We are set to put zeros into column 2. We must not use row 1 in any way, lest it destroy the zeros we just introduced. So we leave it out of the next reflector.","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"D8wans2OOk"}],"key":"RI390qb6Nk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = A[2:m, 2]\nv = normalize(z - norm(z) * [1; zeros(m-2)])\nP₂ = I - 2v * v'","key":"IR3Y45AR5A"},{"type":"output","id":"r3Mq-51NtbiYZEZL8EYiQ","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"5×5 Matrix{Float64}:\n  0.238232   0.385334   -0.823056   0.282004    0.19446\n  0.385334   0.805082    0.416337  -0.14265    -0.0983659\n -0.823056   0.416337    0.110724   0.304693    0.210105\n  0.282004  -0.14265     0.304693   0.895603   -0.0719884\n  0.19446   -0.0983659   0.210105  -0.0719884   0.950359","content_type":"text/plain"}}}],"key":"iuLYjcHaxK"}],"data":{},"key":"lbpdTBxata"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"We now apply this reflector to rows 2 and below only.","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"dGT2RFhOBP"}],"key":"rMj6Oy6w2S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[2:m, :] = P₂ * A[2:m, :]\nA","key":"v6YNhvSYRD"},{"type":"output","id":"3UEzbg9ZPRbuXq-EIQBVH","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 10.8167       13.1279        9.70725   10.1695\n -1.01843e-15   9.67771      -0.768353   1.18786\n  2.81554e-15   3.04661e-16   3.46336   -1.97612\n  1.14501e-16  -1.02093e-15  -1.47477    1.90036\n  2.09961e-15   2.78022e-16   6.73       4.41456\n  2.38586e-15   3.96633e-16   1.92772   -4.60059","content_type":"text/plain"}}}],"key":"qrYJ1X1xhR"}],"data":{},"key":"WlJ5jPNWkr"},{"type":"paragraph","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"We need to iterate the process for the last two columns.","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"MjqoFBLYmI"}],"key":"hAz3yBFEjf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"for j in 3:n\n    z = A[j:m, j]\n    v = normalize(z - norm(z) * [1; zeros(m-j)])\n    P = I - 2v * v'\n    A[j:m, :] = P * A[j:m, :]\nend","key":"yjG3EqCkqN"},{"type":"output","id":"SBn_mjIs4XL03h6Dw6DSv","data":[],"key":"OjgCP9LeTt"}],"data":{},"key":"ecTaSCjuiM"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"We have now reduced the original to an upper triangular matrix using four orthogonal Householder reflections:","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"nwtSThWO5y"}],"key":"H0X3xBganQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"R = triu(A)","key":"DCU5Fr6Lbj"},{"type":"output","id":"2DX4mH6v4PkWRMNXDhCI5","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 10.8167  13.1279    9.70725   10.1695\n  0.0      9.67771  -0.768353   1.18786\n  0.0      0.0       7.94851    1.40841\n  0.0      0.0       0.0        6.79607\n  0.0      0.0       0.0        0.0\n  0.0      0.0       0.0        0.0","content_type":"text/plain"}}}],"key":"vrnka3Idh4"}],"data":{},"key":"USlyQE38dc"}],"label":"demo-house-qr-julia","identifier":"demo-house-qr-julia","html_id":"demo-house-qr-julia","key":"ecSsMskOuv"}],"key":"rzDtDwPR6h"}],"key":"BoywCWtFIY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 2","url":"/chapter2","group":"Julia codes"},"next":{"title":"Chapter 4","url":"/chapter4","group":"Julia codes"}}},"domain":"http://localhost:3000"}