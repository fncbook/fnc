{"kind":"Notebook","sha256":"87132884659b5537c3965b29464a5d025db91e4b53c82add75cee3c5afdad3f3","slug":"chapter3","location":"/julia/chapter3.md","dependencies":[],"frontmatter":{"title":"Chapter 3","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/julia/chapter3.md","exports":[{"format":"md","filename":"chapter3.md","url":"/2025-02-11/build/chapter3-010917b0581db12df9c8a6ff02108fd8.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fuwfgdSlzB"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"MGJHdKBeMY"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by the normal equations","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"PQSwolyqWT"}],"key":"oM9CZkc8Gu"},{"type":"include","file":"FNCFunctions/src/chapter03.jl","literal":true,"filter":{"startAfter":"# begin lsnormal","endBefore":"# end lsnormal"},"children":[{"type":"code","value":"\"\"\"\n    lsnormal(A, b)\n\nSolve a linear least-squares problem by the normal equations.\nReturns the minimizer of ||b-Ax||.\n\"\"\"\nfunction lsnormal(A, b)\n    N = A' * A\n    z = A' * b\n    R = cholesky(N).U\n    w = forwardsub(R', z)                   # solve R'z=c\n    x = backsub(R, w)                       # solve Rx=z\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"lsnormal.jl","key":"fS3OosFRd4"}],"key":"kJIS3l6ezi"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"jIn0qWuxaL"}],"key":"SCpmJewG7X"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"The syntax on line 9 is a ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"A1aBlZMDp6"},{"type":"emphasis","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"field reference","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"bPIyp3rsMu"}],"key":"hHXfuxSQpi"},{"type":"text","value":" to extract the matrix we want from the structure returned by ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"kQeL4pG1zh"},{"type":"inlineCode","value":"cholesky","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"NcFpDq0pAC"},{"type":"text","value":".","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"i8GGn1Mf1h"}],"key":"MPsvD8O3ad"}],"class":"dropdown","key":"RgsWXqdTHJ"}],"label":"function-lsnormal-julia","identifier":"function-lsnormal-julia","html_id":"function-lsnormal-julia","key":"L92qBGpSyS"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by QR factorization","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"gHMGtnw9lZ"}],"key":"i1TB6FKkAm"},{"type":"include","file":"FNCFunctions/src/chapter03.jl","literal":true,"filter":{"startAfter":"# begin lsqrfact","endBefore":"# end lsqrfact"},"children":[{"type":"code","value":"\"\"\"\n    lsqrfact(A, b)\n\nSolve a linear least-squares problem by QR factorization. Returns\nthe minimizer of ||b-Ax||.\n\"\"\"\nfunction lsqrfact(A, b)\n    Q, R = qr(A)\n    c = Q' * b\n    x = backsub(R, c)\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"lsqrfact.jl","key":"Zxl53dJJdV"}],"key":"HzuwRZm40a"}],"label":"function-lsqrfact-julia","identifier":"function-lsqrfact-julia","html_id":"function-lsqrfact-julia","key":"KyM8IEs5Px"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"QR factorization by Householder reflections","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"maJr8zeTzM"}],"key":"R3DyH5ylV6"},{"type":"include","file":"FNCFunctions/src/chapter03.jl","literal":true,"filter":{"startAfter":"# begin qrfact","endBefore":"# end qrfact"},"children":[{"type":"code","value":"\"\"\"\n    qrfact(A)\n\nQR factorization by Householder reflections. Returns Q and R.\n\"\"\"\nfunction qrfact(A)\n    m, n = size(A)\n    Qt = diagm(ones(m))\n    R = float(copy(A))\n    for k in 1:n\n        z = R[k:m, k]\n        w = [-sign(z[1]) * norm(z) - z[1]; -z[2:end]]\n        nrmw = norm(w)\n        if nrmw < eps()\n            continue    # already in place; skip this iteration\n        end\n        v = w / nrmw\n        # Apply the reflection to each relevant column of R and Q\n        for j in k:n\n            R[k:m, j] -= v * (2 * (v' * R[k:m, j]))\n        end\n        for j in 1:m\n            Qt[k:m, j] -= v * (2 * (v' * Qt[k:m, j]))\n        end\n    end\n    return Qt', triu(R)\nend","lang":"julia","showLineNumbers":true,"filename":"qrfact.jl","key":"E79PbgPT9I"}],"key":"OHsYeHLeoX"}],"label":"function-qrfact-julia","identifier":"function-qrfact-julia","html_id":"function-qrfact-julia","key":"u9esHEyb1p"},{"type":"heading","depth":2,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"lvPpqEWgfJ"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"izDuvBLq0v"}],"key":"SmlXiYqHpy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"ounqh2Tz7J"},{"type":"output","id":"MWCmRFNF6aKxAgwPu-Kmt","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"},{"output_type":"stream","name":"stderr","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mWaiting for another process (pid: 52527) to finish precompiling FNCFunctions [ab0dfefa-d313-416d-841c-e73335ae36c8]. Pidfile: /Users/driscoll/.julia/compiled/v1.11/FNCFunctions/j0Zi9_elche.ji.pidfile\n"},{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mTimed out waiting for `Base.active_repl_backend.ast_transforms` to become available. Autoloads will not work.\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ BasicAutoloads ~/.julia/packages/BasicAutoloads/08hIo/src/BasicAutoloads.jl:117\u001b[39m\n\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mIf you have a slow startup file, consider moving `register_autoloads` to the end of it.\n"}],"visibility":"show","key":"O3VT3ugiDS"}],"data":{"tags":[]},"visibility":"remove","key":"mXcuTX9aq8"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"3.1 ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"foW80kTks5"},{"type":"link","identifier":"section-leastsq-fitting","label":"section-leastsq-fitting","kind":"narrative","position":{"start":{"line":61,"column":5},"end":{"line":61,"column":29}},"url":"/fitting","internal":true,"dataUrl":"/fitting.json","children":[{"type":"text","value":"Fitting functions to data","key":"HtsUmEon9N"}],"key":"e33RrVVD92"}],"identifier":"id-3-1","label":"3.1 ","html_id":"id-3-1","implicit":true,"key":"lTfQotGXM9"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempinterp","label":"demo-fitting-tempinterp","kind":"proof:example","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":25}},"children":[{"type":"text","value":"Example ","key":"PG835BB5K0"},{"type":"text","value":"3.1.1","key":"ukb3MjSkCD"}],"template":"Example %s","enumerator":"3.1.1","resolved":true,"html_id":"demo-fitting-tempinterp","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"PDzq6xuMIx"}],"key":"Ng7vWcbzHC"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"Here are 5-year averages of the worldwide temperature anomaly as compared to the 1951–1980 average (source: NASA).","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"GXvnOcT9WO"}],"key":"ud9vN22wyb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n       0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]\n    \nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", \n    legend=:bottomright)","key":"jrdOhmVslp"},{"type":"output","id":"6XUXq4Bjn8PhRI0gPRXfN","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00c2a210fc24ac3df4cd7443eddef9ff","path":"/2025-02-11/build/00c2a210fc24ac3df4cd7443eddef9ff.png"},"text/html":{"content_type":"text/html","hash":"9d6e54f431d4204f305fd4000fb0cae8","path":"/2025-02-11/build/9d6e54f431d4204f305fd4000fb0cae8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"37c48a22a9fb5df6295b894a6df42a14","path":"/2025-02-11/build/37c48a22a9fb5df6295b894a6df42a14.svg"}}}],"key":"OMzr99V1W6"}],"data":{},"key":"NP4CQKnG0Q"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"A polynomial interpolant can be used to fit the data. Here we build one using a Vandermonde matrix. First, though, we express time as decades since 1950, as it improves the condition number of the matrix.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"JJBopTMpWa"}],"key":"A5wQGKoI86"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = @. (year - 1950) / 10\nn = length(t)\nV = [ t[i]^j for i in 1:n, j in 0:n-1 ]\nc = V \\ temp","key":"z0635w2OCX"},{"type":"output","id":"oeU-XsdnA4SvHCK7oJMpt","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n  -14.114000001832462\n   76.36173810552113\n -165.45597224550528\n  191.96056669514388\n -133.27347224319684\n   58.015577787494486\n  -15.962888891734785\n    2.6948063497166928\n   -0.2546666667177082\n    0.010311111113288083","content_type":"text/plain"}}}],"key":"eWLMmMJk6o"}],"data":{},"key":"LrPJZTzrd4"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"The coefficients in vector ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"v4uttaPtez"},{"type":"inlineCode","value":"c","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"bVZk6zd3OL"},{"type":"text","value":" are used to create a polynomial. Then we create a function that evaluates the polynomial after changing the time variable as we did for the Vandermonde matrix.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"kLAnW5Wktn"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"plotting functions","kind":"entry"},"emphasis":false}],"label":"index-lvlQiYmNvh","identifier":"index-lvlqiymnvh","html_id":"index-lvlqiymnvh","key":"tG4CGZ05yN"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Xc8lw32Roh"}],"key":"NdlRm5eHLO"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"If you ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"UpzecrmYTJ"},{"type":"inlineCode","value":"plot","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"mSqWetms9M"},{"type":"text","value":" a function, then the points are chosen automatically to make a smooth curve.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"dD8Kasn2dQ"}],"key":"G1AHjSrIaK"}],"class":"dropdown","key":"j8aUHYlr1i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials, Plots\np = Polynomial(c)\nf = yr -> p((yr - 1950) / 10)\nplot!(f, 1955, 2000, label=\"interpolant\")","key":"UKzTkFH6lB"},{"type":"output","id":"PBzMrDkK0sX9Yya1aKf6f","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ba5e97290c4348f6eb39f4c9b0de1ee","path":"/2025-02-11/build/7ba5e97290c4348f6eb39f4c9b0de1ee.png"},"text/html":{"content_type":"text/html","hash":"da1dbc0b2800fc25b2150cdd366c180f","path":"/2025-02-11/build/da1dbc0b2800fc25b2150cdd366c180f.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"74b185f7fe8fe19be9b57d4094a2a7d7","path":"/2025-02-11/build/74b185f7fe8fe19be9b57d4094a2a7d7.svg"}}}],"key":"DgjfbHx4kO"}],"data":{},"key":"USg9XkvQxm"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"As you can see, the interpolant does represent the data, in a sense. However it’s a crazy-looking curve for the application. Trying too hard to reproduce all the data exactly is known as ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"n3zCVns6lK"},{"type":"emphasis","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"overfitting","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"JaiXLEtsyz"}],"key":"uuPFL1iMDf"},{"type":"text","value":".","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"g39VGnQgsk"}],"key":"Oa9u4rAmxe"}],"label":"demo-fitting-tempinterp-julia","identifier":"demo-fitting-tempinterp-julia","html_id":"demo-fitting-tempinterp-julia","key":"CLMqWYaBpO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempfit","label":"demo-fitting-tempfit","kind":"proof:example","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":22}},"children":[{"type":"text","value":"Example ","key":"DPo8VVoiZl"},{"type":"text","value":"3.1.2","key":"b4NP31QlnF"}],"template":"Example %s","enumerator":"3.1.2","resolved":true,"html_id":"demo-fitting-tempfit","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"tz4I3qNM7R"}],"key":"oXOuLbxZtE"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Here are the 5-year temperature averages again.","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"kivT6KerBS"}],"key":"b0DTXoRuAi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\nt = @. (year - 1950) / 10\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n          0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]","key":"QuUBUeMIv6"},{"type":"output","id":"eK6HvdTE0GomffP6MdZJC","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n -0.048\n -0.018\n -0.036\n -0.012\n -0.004\n  0.118\n  0.21\n  0.332\n  0.334\n  0.456","content_type":"text/plain"}}}],"key":"Id0qBh0Ery"}],"data":{},"key":"e1tAbTm0YO"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"The standard best-fit line results from using a linear polynomial that meets the least-squares criterion.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"oepXBn2yqw"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-Ld6c1lYiJ3","identifier":"index-ld6c1lyij3","html_id":"index-ld6c1lyij3","key":"Hg9XlsNZK8"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"gUe2gNkRRi"}],"key":"d1BV0sHFvk"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"Backslash solves overdetermined linear systems in a least-squares sense.","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"PRNNRGw4ZM"}],"key":"MyQa1mwncW"}],"class":"dropdown","key":"ywfH7IPjnU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t.^0 t ]    # Vandermonde-ish matrix\n@show size(V)\nc = V \\ temp\np = Polynomial(c)","key":"gDrsZKrj8P"},{"type":"output","id":"lmZUt4EyVMZS9OIOIgeiL","data":[{"output_type":"stream","name":"stdout","text":"size(V) = (10, 2)"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"Polynomial(-0.18773333333333356 + 0.11670303030303034*x)","content_type":"text/plain"},"text/html":{"content":"&#45;0.18773333333333356 &#43; 0.11670303030303034&#8729;x","content_type":"text/html"},"text/latex":{"content":"$-0.18773333333333356 + 0.11670303030303034\\cdot x$","content_type":"text/latex"}}}],"key":"kEd4dOkFQd"}],"data":{},"key":"bgxyJ60ClD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = yr -> p((yr - 1955) / 10)\nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", leg=:bottomright)\nplot!(f, 1955, 2000, label=\"linear fit\")","key":"aSmDIAMFja"},{"type":"output","id":"3EcjNLdceV7g0Ylrrxbd5","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c154bb9e7191c4921546b7c6472887e0","path":"/2025-02-11/build/c154bb9e7191c4921546b7c6472887e0.png"},"text/html":{"content_type":"text/html","hash":"81d13e6c98dc453d8e221c390685595b","path":"/2025-02-11/build/81d13e6c98dc453d8e221c390685595b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a90948863d49d7a6bbcbc23f80bbb8c0","path":"/2025-02-11/build/a90948863d49d7a6bbcbc23f80bbb8c0.svg"}}}],"key":"QWfIlX1vS2"}],"data":{},"key":"WR0Xw8ijJl"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"If we use a global cubic polynomial, the points are fit more closely.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"ZSOs8DxGS2"}],"key":"u1Sk51pFfs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t[i]^j for i in 1:length(t), j in 0:3 ]   \n@show size(V);","key":"FTW8Wc223o"},{"type":"output","id":"YeUParUmaOr-FWOij0IOe","data":[{"output_type":"stream","name":"stdout","text":"size(V) = (10, 4)"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"EzaW8rbywC"}],"data":{},"key":"iRt0GeBkoc"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"Now we solve the new least-squares problem to redefine the fitting polynomial.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"lLwg0gIb8w"}],"key":"LbrwR3Qrnm"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Ft9cZvymJJ"}],"key":"PMAcGJQAev"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"The definition of ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"kI1q59t5p4"},{"type":"inlineCode","value":"f","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"CirOnYS9ca"},{"type":"text","value":" above is in terms of ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"f2TaOKz0YU"},{"type":"inlineCode","value":"p","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"ptPsjl30TR"},{"type":"text","value":". When ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"uFV0vhuGbJ"},{"type":"inlineCode","value":"p","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"H5UxtvKvmn"},{"type":"text","value":" is changed, then ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"H8UgWOhTKb"},{"type":"inlineCode","value":"f","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"ti9txfQRfv"},{"type":"text","value":" calls the new version.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"H24bdAmiOg"}],"key":"jgWq0s78iO"}],"class":"dropdown","key":"D99Rwvx8iK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"p = Polynomial( V \\ temp )\nplot!(f, 1955, 2000, label=\"cubic fit\")","key":"LkX4ezSZr3"},{"type":"output","id":"6kcdfM9Xx32UM-ay7iBlg","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3b4ac1918b5ad83106e92af6f49b2c14","path":"/2025-02-11/build/3b4ac1918b5ad83106e92af6f49b2c14.png"},"text/html":{"content_type":"text/html","hash":"266b9a7d2116d231d734e6d1ece9ef03","path":"/2025-02-11/build/266b9a7d2116d231d734e6d1ece9ef03.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"93204d99e32204634bf1185cf2518a02","path":"/2025-02-11/build/93204d99e32204634bf1185cf2518a02.svg"}}}],"key":"i59ExXc1wt"}],"data":{},"key":"wyutQ2OArG"},{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"If we were to continue increasing the degree of the polynomial, the residual at the data points would get smaller, but overfitting would increase.","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"JGXlH3QMqu"}],"key":"eEgSkmLq7v"}],"label":"demo-fitting-tempfit-julia","identifier":"demo-fitting-tempfit-julia","html_id":"demo-fitting-tempfit-julia","key":"TYU5uhdgZL"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-pirate","label":"demo-fitting-pirate","kind":"proof:example","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":21}},"children":[{"type":"text","value":"Example ","key":"gZLdSJkr2o"},{"type":"text","value":"3.1.3","key":"J0WeyE84N1"}],"template":"Example %s","enumerator":"3.1.3","resolved":true,"html_id":"demo-fitting-pirate","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"WRc7BvcYMb"}],"key":"yygrTi1qh2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"a = [1/k^2 for k=1:100] \ns = cumsum(a)        # cumulative summation\np = @. sqrt(6*s)\n\nscatter(1:100, p;\n    title=\"Sequence convergence\",\n    xlabel=L\"k\",  ylabel=L\"p_k\")","key":"rFhJoq7CmR"},{"type":"output","id":"_YTyYhf3dwsJs7ma_5ec2","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b5ae30c8e60d81af034b3247485abc4f","path":"/2025-02-11/build/b5ae30c8e60d81af034b3247485abc4f.png"},"text/html":{"content_type":"text/html","hash":"8eff01610123436aa49d3bddec458ab8","path":"/2025-02-11/build/8eff01610123436aa49d3bddec458ab8.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e36ffbaa5d1fc03cf0d14cfe153a52d5","path":"/2025-02-11/build/e36ffbaa5d1fc03cf0d14cfe153a52d5.svg"}}}],"key":"RAuhsnRUfK"}],"data":{},"key":"x7KC302z5f"},{"type":"paragraph","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"This graph suggests that maybe ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"xCg6VFWn2y"},{"type":"inlineMath","value":"p_k\\to \\pi","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>→</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">p_k\\to \\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"pd7VvYNE7c"},{"type":"text","value":", but it’s far from clear how close the sequence gets. It’s more informative to plot the sequence of errors, ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"K5b3k1e1cX"},{"type":"inlineMath","value":"\\epsilon_k= |\\pi-p_k|","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>π</mi><mo>−</mo><msub><mi>p</mi><mi>k</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k= |\\pi-p_k|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>","key":"oK1A10tvKZ"},{"type":"text","value":". By plotting the error sequence on a log-log scale, we can see a nearly linear relationship.","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"cmHYqYC5UM"}],"key":"ub3U1LKe5x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = @. abs(π - p)    # error sequence\nscatter(1:100, ϵ;\n    title=\"Convergence of errors\",\n    xaxis=(:log10,L\"k\"),  yaxis=(:log10,\"error\"))","key":"qoQ6bKk5yV"},{"type":"output","id":"KRDq7LS1ambmUwCnxx6pm","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"424cd0e0b45b848a740763ee21943940","path":"/2025-02-11/build/424cd0e0b45b848a740763ee21943940.png"},"text/html":{"content_type":"text/html","hash":"8a611c09d3fc13c224f195352bcb05dc","path":"/2025-02-11/build/8a611c09d3fc13c224f195352bcb05dc.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"3d7dd009af6af29ecf6340ef35e6fcaa","path":"/2025-02-11/build/3d7dd009af6af29ecf6340ef35e6fcaa.svg"}}}],"key":"FavYShLmOG"}],"data":{},"key":"KlJFcVToEO"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"The straight line on the log-log scale suggests a power-law relationship where ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"EnYc2AsQbf"},{"type":"inlineMath","value":"\\epsilon_k\\approx a k^b","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>a</mi><msup><mi>k</mi><mi>b</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k\\approx a k^b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6331em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span></span></span></span>","key":"jfW4bcHNDj"},{"type":"text","value":", or ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"XiBuVZ3X9t"},{"type":"inlineMath","value":"\\log \\epsilon_k \\approx b (\\log k) + \\log a","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>b</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">\\log \\epsilon_k \\approx b (\\log k) + \\log a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"emIgBuouXu"},{"type":"text","value":".","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"jU6AHRZhhD"}],"key":"Sy1TCi4sYo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"k = 1:100\nV = [ k.^0 log.(k) ]     # fitting matrix\nc = V \\ log.(ϵ)          # coefficients of linear fit","key":"I3ax3pHHRu"},{"type":"output","id":"BuKm-oPmtakju2B4adPL6","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.18237524972829994\n -0.9674103233127929","content_type":"text/plain"}}}],"key":"IZJioJnA4S"}],"data":{},"key":"ZOSAyALelW"},{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"In terms of the parameters ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"HiP5y4BlOx"},{"type":"inlineMath","value":"a","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"hJwdxHjTSM"},{"type":"text","value":" and ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"HF5jY33qJ0"},{"type":"inlineMath","value":"b","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"mG1GT2srPM"},{"type":"text","value":" used above, we have","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"NHGXPYDNVo"}],"key":"Z5ozmvwazA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"a, b = exp(c[1]), c[2];\n@show b;","key":"fW4g6BbGki"},{"type":"output","id":"O7F_TRYqMwoA2XcfrSrcX","data":[{"output_type":"stream","name":"stdout","text":"b = -0.9674103233127929"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"rdFvLI379V"}],"data":{},"key":"Q5uRim39jD"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"It’s tempting to conjecture that the slope ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"DigPJFGuIf"},{"type":"inlineMath","value":"b\\to -1","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>→</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">b\\to -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"tpgLeNkkXG"},{"type":"text","value":" asymptotically. Here is how the numerical fit compares to the original convergence curve.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"PUNBOPZtgk"}],"key":"KtMSU33A0J"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!(k, a * k.^b, l=:dash, label=\"power-law fit\")","key":"ZxTk8lyGhg"},{"type":"output","id":"wmeJtmNSr0UYFMwuYKR8d","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b38e6613a40a415ae05e9f35a39ee12","path":"/2025-02-11/build/5b38e6613a40a415ae05e9f35a39ee12.png"},"text/html":{"content_type":"text/html","hash":"316afbcf05cb5e5f2d53271b1d36c632","path":"/2025-02-11/build/316afbcf05cb5e5f2d53271b1d36c632.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"0d28ad0db0217e60a7f83312d041b7c1","path":"/2025-02-11/build/0d28ad0db0217e60a7f83312d041b7c1.svg"}}}],"key":"V0tSQnDhqq"}],"data":{},"key":"Wymlta7Vqo"}],"label":"demo-fitting-pirate-julia","identifier":"demo-fitting-pirate-julia","html_id":"demo-fitting-pirate-julia","key":"uS7R5hNGPe"},{"type":"heading","depth":3,"position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"children":[{"type":"text","value":"3.2 ","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"jmGdaSornz"},{"type":"link","identifier":"section-leastsq-normaleqns","label":"section-leastsq-normaleqns","kind":"narrative","position":{"start":{"line":207,"column":5},"end":{"line":207,"column":32}},"url":"/normaleqns","internal":true,"dataUrl":"/normaleqns.json","children":[{"type":"text","value":"The normal equations","key":"k4q7aBPCRo"}],"key":"Qq16y5UlvB"}],"identifier":"id-3-2","label":"3.2 ","html_id":"id-3-2","implicit":true,"key":"GMucSYouuk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","kind":"proof:example","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":24}},"children":[{"type":"text","value":"Example ","key":"TD3dKVwVKK"},{"type":"text","value":"3.2.1","key":"D0SNFwP8Fy"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"hlkxdxGobV"}],"key":"Gtk0YY4ggk"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"Because the functions ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"QADCStFbuC"},{"type":"inlineMath","value":"\\sin^2(t)","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1219em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">sin</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8719em;\"><span style=\"top:-3.1208em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"tWfSJ5aE61"},{"type":"text","value":", ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"TmBkiqSB6b"},{"type":"inlineMath","value":"\\cos^2(t)","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>cos</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\cos^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">cos</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"gmCEJ51MPs"},{"type":"text","value":", and ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"iN7snbhjAE"},{"type":"text","value":"1","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"ayEM4qDooI"},{"type":"text","value":" are linearly dependent, we should find that the following matrix is somewhat ill-conditioned.","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"vrJQ7STEQt"}],"key":"ic0Jb7Ceg2"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"lR6T9TOWI5"}],"key":"tQk36XzWOh"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"The local variable scoping rule for loops applies to comprehensions as well.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"FpNa5yZNb5"}],"key":"kQqJyKqRd6"}],"class":"dropdown","key":"s5UaA2qtle"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, 400)\nf = [ x -> sin(x)^2, x -> cos((1 + 1e-7) * x)^2, x -> 1. ]\nA = [ f(t) for t in t, f in f ]\n@show κ = cond(A);","key":"CaVeLYK20n"},{"type":"output","id":"wE7lqrVNuycNw5trtNxUx","data":[{"output_type":"stream","name":"stdout","text":"κ = cond(A) = 1.8253225426741675e7"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"sdIvrdx0Zl"}],"data":{},"key":"hq57npRBkp"},{"type":"paragraph","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"text","value":"Now we set up an artificial linear least-squares problem with a known exact solution that actually makes the residual zero.","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"lM015W9Wph"}],"key":"H8usVUv8vx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [1., 2, 1]\nb = A * x;","key":"iTwDl9a9Hs"},{"type":"output","id":"tDYGQm9kQ6iIpbfm-6waK","data":[],"key":"qLx8fnrFki"}],"data":{},"key":"L257aWJTbv"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"Using backslash to find the least-squares solution, we get a relative error that is well below ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"EvWjiYN8BJ"},{"type":"text","value":"κ","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"kGClSrFFEY"},{"type":"text","value":" times machine epsilon.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"fmeUlKpJsD"}],"key":"jqZq3Ubz2H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x_BS = A \\ b\n@show observed_error = norm(x_BS - x) / norm(x);\n@show error_bound = κ * eps();","key":"zR8eJpQ6Nm"},{"type":"output","id":"KzVoaSAW1Tj69ID2QW8lP","data":[{"output_type":"stream","name":"stdout","text":"observed_error = norm(x_BS - x) / norm(x) = 1.0163949045357309e-10\nerror_bound = κ * eps() = 4.053030228488391e-9\n"}],"key":"KZgyfrrkQy"}],"data":{},"key":"EWpHHmDUUf"},{"type":"paragraph","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"If we formulate and solve via the normal equations, we get a much larger relative error. With ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"k5uVCPMQM5"},{"type":"inlineMath","value":"\\kappa^2\\approx 10^{14}","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>κ</mi><mn>2</mn></msup><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa^2\\approx 10^{14}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span></span></span></span></span></span></span></span></span></span></span></span>","key":"RJt3dMlTxO"},{"type":"text","value":", we may not be left with more than about 2 accurate digits.","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"ByJoUmunm9"}],"key":"wekI0SM8W7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"N = A' * A\nx_NE = N \\ (A'*b)\n@show observed_err = norm(x_NE - x) / norm(x);\n@show digits = -log10(observed_err);","key":"AmKylt50IU"},{"type":"output","id":"wPnRAxIpp7naqIhz5LZdB","data":[{"output_type":"stream","name":"stdout","text":"observed_err = norm(x_NE - x) / norm(x) = 0.021745909192780664\ndigits = -(log10(observed_err)) = 1.6626224298403076\n"}],"key":"Lxun7n3Oof"}],"data":{},"key":"OJXoU89FC4"}],"label":"demo-normaleqns-instab-julia","identifier":"demo-normaleqns-instab-julia","html_id":"demo-normaleqns-instab-julia","key":"U8qMEEchaq"},{"type":"heading","depth":3,"position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"3.3 ","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"svAO5TxZK4"},{"type":"link","identifier":"section-leastsq-qr","label":"section-leastsq-qr","kind":"narrative","position":{"start":{"line":251,"column":5},"end":{"line":251,"column":24}},"url":"/qr","internal":true,"dataUrl":"/qr.json","children":[{"type":"text","value":"The QR factorization","key":"VPEQCy6YIV"}],"key":"yw9VE3gUvb"}],"identifier":"id-3-3","label":"3.3 ","html_id":"id-3-3","implicit":true,"key":"udgRUPB1xw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-qrfact","label":"demo-qr-qrfact","kind":"proof:example","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":16}},"children":[{"type":"text","value":"Example ","key":"wdkUHYSL8V"},{"type":"text","value":"3.3.1","key":"VDErJxb8v4"}],"template":"Example %s","enumerator":"3.3.1","resolved":true,"html_id":"demo-qr-qrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"Te1y9ukkyB"}],"key":"u7ZfESdrWx"},{"type":"paragraph","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"Julia provides access to both the thin and full forms of the QR factorization.","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"OCig8OkbPc"}],"key":"GMBBA6L6ua"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.:9., 6, 4)\n@show m,n = size(A);","key":"sirn0tGYe6"},{"type":"output","id":"2-RODWuMu_A5NqTT2xWTm","data":[{"output_type":"stream","name":"stdout","text":"(m, n) = size(A) = (6, 4)"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"XYb2lxAMjV"}],"data":{},"key":"p9HATmbYRg"},{"type":"paragraph","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"children":[{"type":"text","value":"Here is a standard call:","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":1}},"key":"JqJGVy9bBK"}],"key":"I35Zodi7GJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q,R = qr(A);\nQ","key":"X2lAPc0alt"},{"type":"output","id":"PsqWSms1hWnESjH7ynJkT","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"6×6 LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}","content_type":"text/plain"}}}],"key":"CDSNgnmNeu"}],"data":{},"key":"jeVGF8ICDg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"R","key":"bN1Wm7YjTd"},{"type":"output","id":"gFzRImU4ohLwneUgjGAp0","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -9.32738  -11.3644   -14.3663   -7.39758\n  0.0       -8.35767   -4.27579  -2.74371\n  0.0        0.0       -4.28098   0.936095\n  0.0        0.0        0.0      -4.56855","content_type":"text/plain"}}}],"key":"OBbpdE8KVN"}],"data":{},"key":"bpYpUO6JLJ"},{"type":"paragraph","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"If you look carefully, you see that we seemingly got a full ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"sLMdnPBSTj"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"a56pxZ3ui7"},{"type":"text","value":" but a thin ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"dX1Bt0RnId"},{"type":"inlineMath","value":"\\mathbf{R}","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">R</span></span></span></span>","key":"GeHG6Rtzp2"},{"type":"text","value":". However, the ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"l4M0ocrYsc"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"ZriIXtgErA"},{"type":"text","value":" above is not a standard matrix type. If you convert it to a true matrix, then it reverts to the thin form.","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"LoBwYCpySy"}],"key":"GjNyJo4ah9"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"PAwtCXwwgm"}],"key":"VMb3oB4cyP"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"To enter the accented character ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"w0UkEhPRAN"},{"type":"inlineCode","value":"Q̂","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"HlLZx700Yr"},{"type":"text","value":", type ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"qeCBYBtNuL"},{"type":"inlineCode","value":"Q\\hat","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"w7CcLijpwN"},{"type":"text","value":" followed by ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"nbQFhgecNc"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"KupMchFt6b"}],"key":"JAOmKMNrdc"},{"type":"text","value":".","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"wmybULxPnG"}],"key":"vkTXhe3ijo"}],"class":"dropdown","key":"pJzvCG30bm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂ = Matrix(Q)","key":"Mzh5AoO0vg"},{"type":"output","id":"T-BqRoASsKZSJGGPidxTf","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n -0.536056  -0.108648   0.50589    0.599135\n -0.321634  -0.160909   0.539293  -0.585387\n -0.214423  -0.545992  -0.136649  -0.00955763\n -0.321634  -0.28056   -0.275566  -0.461606\n -0.643268   0.635386  -0.34464   -0.067267\n -0.214423  -0.426341  -0.489746   0.284011","content_type":"text/plain"}}}],"key":"VG1tuEV8oy"}],"data":{},"key":"WP0njLta3K"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"We can test that ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"n2QVefgi5x"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"CN3T2GygkR"},{"type":"text","value":" is an orthogonal matrix:","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"yGtzh26qCl"}],"key":"OK2zYPtYF1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(Q' * Q - I)","key":"Uq9p0OzZNw"},{"type":"output","id":"oJAhzOsW0Tui5DisfoEQy","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"3.8063921299074416e-16","content_type":"text/plain"}}}],"key":"UryhXkN4K7"}],"data":{},"key":"FGkqHWN3gr"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"The thin ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"MsoYa9IqVC"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"Xoerrb08OB"},{"type":"text","value":" cannot be an orthogonal matrix, because it is not square, but it is still ","key":"XpxiTcmSAI"},{"type":"abbreviation","title":"matrix with orthonormal columns","children":[{"type":"text","value":"ONC","key":"jikPSKR38s"}],"key":"bFCY07OjuD"},{"type":"text","value":":","key":"CLhC4dSyE6"}],"key":"Oahz2LNzLr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂' * Q̂ - I","key":"ArQCVrdHL4"},{"type":"output","id":"-EnLidwJ74jL00bFcbUh0","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -1.11022e-16   1.46031e-17   2.20411e-16  -4.14866e-17\n  1.46031e-17  -1.11022e-16   1.73433e-16  -6.49759e-17\n  2.20411e-16   1.73433e-16  -1.11022e-16   8.18697e-17\n -4.14866e-17  -6.49759e-17   8.18697e-17   2.22045e-16","content_type":"text/plain"}}}],"key":"JCo8BMKvVY"}],"data":{},"key":"UO4MA12fWN"}],"label":"demo-qr-qrfact-julia","identifier":"demo-qr-qrfact-julia","html_id":"demo-qr-qrfact-julia","key":"j1viMiun1l"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-stable","label":"demo-qr-stable","kind":"proof:example","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":16}},"children":[{"type":"text","value":"Example ","key":"UxyX1QK0PE"},{"type":"text","value":"3.3.2","key":"ZqVfjpj6oL"}],"template":"Example %s","enumerator":"3.3.2","resolved":true,"html_id":"demo-qr-stable","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"P414ohK4NG"}],"key":"kElj5Retgz"},{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"We’ll repeat the experiment of ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"vysHC8TipT"},{"type":"crossReference","kind":"proof:example","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","children":[{"type":"text","value":"Demo ","key":"kqmKJa880d"},{"type":"text","value":"3.2.1","key":"SWVSFBMnG3"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"an7UP7sjD3"},{"type":"text","value":", which exposed instability in the normal equations.","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"vx6aR7HgEz"}],"key":"AyKsv0fjca"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, 400)\nf = [ x -> sin(x)^2, x -> cos((1 + 1e-7) * x)^2, x -> 1. ]\nA = [ f(t) for t in t, f in f ]\nx = [1., 2, 1]\nb = A * x;","key":"yy600pX3dt"},{"type":"output","id":"Fzh5syR0yAhp8o_1U70E6","data":[],"key":"K2gOGiGkrA"}],"data":{},"key":"Wz5RyBOXR6"},{"type":"paragraph","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"The error in the solution by ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"JAUYab7ROi"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lsqrfact","label":"function-lsqrfact","children":[{"type":"text","value":"Function ","key":"uMgontR9zE"},{"type":"text","value":"3.3.2","key":"VTJx3GeYWx"}],"template":"Algorithm %s","enumerator":"3.3.2","resolved":true,"html_id":"function-lsqrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"Dj1RqRC3qW"},{"type":"text","value":" is similar to the bound predicted by the condition number.","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"uewAjwaaDF"}],"key":"oVyDTO2hwb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"observed_error = norm(FNC.lsqrfact(A, b) - x) / norm(x);\n@show observed_error;\n@show error_bound = cond(A) * eps();","key":"on3r9MNKoh"},{"type":"output","id":"t8II8SNMg6xCMY6IbYTar","data":[{"output_type":"stream","name":"stdout","text":"observed_error = 4.665273501889628e-9"},{"output_type":"stream","name":"stdout","text":"\nerror_bound = cond(A) * eps() = "},{"output_type":"stream","name":"stdout","text":"4.053030228488391e-9\n"}],"key":"ZRXsxXel0y"}],"data":{},"key":"eQ4TOuWj4h"}],"label":"demo-qr-stable-julia","identifier":"demo-qr-stable-julia","html_id":"demo-qr-stable-julia","key":"k9A7z4t42d"},{"type":"heading","depth":3,"position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"text","value":"3.4 ","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"uJ0teQhegK"},{"type":"link","identifier":"section-leastsq-house","label":"section-leastsq-house","kind":"narrative","position":{"start":{"line":319,"column":5},"end":{"line":319,"column":27}},"url":"/house","internal":true,"dataUrl":"/house.json","children":[{"type":"text","value":"Computing QR factorizations","key":"KRCLIou4Xf"}],"key":"lksXeVAhrR"}],"identifier":"id-3-4","label":"3.4 ","html_id":"id-3-4","implicit":true,"key":"HxkVUGtr4G"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-house-qr","label":"demo-house-qr","kind":"proof:example","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":15}},"children":[{"type":"text","value":"Example ","key":"qegvljCtag"},{"type":"text","value":"3.4.1","key":"bfUXwDn98V"}],"template":"Example %s","enumerator":"3.4.1","resolved":true,"html_id":"demo-house-qr","remote":true,"url":"/house","dataUrl":"/house.json","key":"V8IAMy9ia1"}],"key":"iKuxANTf4c"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"We will use Householder reflections to produce a QR factorization of a random matrix.","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"NNlYI6EBso"}],"key":"pm6jnErMwZ"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"qcklGjN8Va"}],"key":"hDr74GnZcn"},{"type":"paragraph","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"SgTNSXWbdd"},{"type":"inlineCode","value":"rand","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"GyAieByTDA"},{"type":"text","value":" function can select randomly from within the interval ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"O6DUrWyWnD"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"kmo4qKleVB"},{"type":"text","value":", or from a vector or range that you specify.","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"Bh7p6z2SUB"}],"key":"FvTSNO6zhd"}],"class":"dropdown","key":"ih0RlnlgDZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(float(1:9), 6, 4)\nm,n = size(A)","key":"qeHH5F627H"},{"type":"output","id":"B7EwXufdTpk3WLBH2sCYy","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"(6, 4)","content_type":"text/plain"}}}],"key":"TCZ2tqrF54"}],"data":{},"key":"Bftz9J6KLS"},{"type":"paragraph","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"Our first step is to introduce zeros below the diagonal in column 1 by using ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"pH5htYBsYh"},{"type":"crossReference","kind":"equation","identifier":"hhvector","label":"hhvector","children":[{"type":"text","value":"(","key":"EVNwZEp0wN"},{"type":"text","value":"3.4.4","key":"tieGW55mSp"},{"type":"text","value":")","key":"OFptamAiEr"}],"template":"(%s)","enumerator":"3.4.4","resolved":true,"html_id":"hhvector","remote":true,"url":"/house","dataUrl":"/house.json","key":"IGmMgJqRAx"},{"type":"text","value":" and ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"gV2r0MVpEh"},{"type":"crossReference","kind":"equation","identifier":"hhreflect","label":"hhreflect","children":[{"type":"text","value":"(","key":"aZ96enXyIy"},{"type":"text","value":"3.4.1","key":"to3HNSPyIy"},{"type":"text","value":")","key":"HZuQCafrla"}],"template":"(%s)","enumerator":"3.4.1","resolved":true,"html_id":"hhreflect","remote":true,"url":"/house","dataUrl":"/house.json","key":"YO3W1Rkv0I"},{"type":"text","value":".","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"qkmmz5jKBF"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"normalize","kind":"entry"},"emphasis":false},{"entry":"Julia","subEntry":{"value":"I","kind":"entry"},"emphasis":true}],"label":"index-ClKokPBbqI","identifier":"index-clkokpbbqi","html_id":"index-clkokpbbqi","key":"pSnoGXlPGw"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"WMNT39OdeG"}],"key":"akrqdEjLti"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"inlineCode","value":"I","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"xVsCdDHAgs"},{"type":"text","value":" can stand for an identity matrix of any size, inferred from the context when needed.","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"mEwEJBAP1g"}],"key":"vGjBKyPne1"}],"class":"dropdown","key":"PP6UVyjN3K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = A[:, 1];\nv = normalize(z - norm(z) * [1; zeros(m-1)])\nP₁ = I - 2v * v'   # reflector","key":"dCwi757FI4"},{"type":"output","id":"7TWhB4CH0khy2-EQWi2Gn","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Float64}:\n 0.2566    0.44905     0.5132      0.5132      0.06415     0.44905\n 0.44905   0.728752   -0.309998   -0.309998   -0.0387498  -0.271248\n 0.5132   -0.309998    0.645716   -0.354284   -0.0442855  -0.309998\n 0.5132   -0.309998   -0.354284    0.645716   -0.0442855  -0.309998\n 0.06415  -0.0387498  -0.0442855  -0.0442855   0.994464   -0.0387498\n 0.44905  -0.271248   -0.309998   -0.309998   -0.0387498   0.728752","content_type":"text/plain"}}}],"key":"fTDHTV2p3T"}],"data":{},"key":"VK9jMGvxx1"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"We check that this reflector introduces zeros as it should:","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"KZnM1zSqKR"}],"key":"vvd1STlBqK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"P₁ * z","key":"q23SSNGCG9"},{"type":"output","id":"iN6iCCWHL-TIvC3yr9pMt","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n 15.5884572681199\n -1.5543122344752192e-15\n -2.55351295663786e-15\n -2.55351295663786e-15\n -2.0816681711721685e-16\n -1.1102230246251565e-15","content_type":"text/plain"}}}],"key":"WaDrfP8tvm"}],"data":{},"key":"p6tM1xMpJx"},{"type":"paragraph","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"children":[{"type":"text","value":"Now we replace ","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"LtzkhGM243"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"hRUs86RzCF"},{"type":"text","value":" by ","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"A97QMeoEIQ"},{"type":"inlineMath","value":"\\mathbf{P}\\mathbf{A}","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"kD1gEfyXrw"},{"type":"text","value":".","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":1}},"key":"CH6eDhn2Od"}],"key":"aawcdhlXVp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = P₁ * A","key":"G7BaasSq2D"},{"type":"output","id":"iDHiR6abz5Xa6fqG-AAKc","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 15.5885        5.3886    10.7772   12.2527\n -1.55431e-15  -0.650932  -3.69782  -1.17286\n -2.55351e-15  -1.02964   -2.36893   2.37387\n -2.55351e-15  -1.02964    1.63107   3.37387\n -2.08167e-16   5.6213     5.32888   2.54673\n -1.11022e-15   1.34907    4.30218   2.82714","content_type":"text/plain"}}}],"key":"Q2PDzKeY4Z"}],"data":{},"key":"HELjZaxsuX"},{"type":"paragraph","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"text","value":"We are set to put zeros into column 2. We must not use row 1 in any way, lest it destroy the zeros we just introduced. So we leave it out of the next reflector.","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"key":"Z7aS9IQrxb"}],"key":"JWJ7fcYBB0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = A[2:m, 2]\nv = normalize(z - norm(z) * [1; zeros(m-2)])\nP₂ = I - 2v * v'","key":"vcc5VmsXWQ"},{"type":"output","id":"U3cLfIT93PDiRoN8Q5HR7","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"5×5 Matrix{Float64}:\n -0.108545  -0.171695   -0.171695    0.937365   0.22496\n -0.171695   0.973407   -0.0265925   0.145182   0.0348425\n -0.171695  -0.0265925   0.973407    0.145182   0.0348425\n  0.937365   0.145182    0.145182    0.207382  -0.190222\n  0.22496    0.0348425   0.0348425  -0.190222   0.954348","content_type":"text/plain"}}}],"key":"eCT9DAbCEo"}],"data":{},"key":"sxuN4rq22a"},{"type":"paragraph","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"children":[{"type":"text","value":"We now apply this reflector to rows 2 and below only.","position":{"start":{"line":371,"column":1},"end":{"line":371,"column":1}},"key":"g8sz5FVmqZ"}],"key":"x2l6j6n0cH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[2:m, :] = P₂ * A[2:m, :]\nA","key":"EGYPO04Aw3"},{"type":"output","id":"4RO3xCi96cm2G1-htM8jP","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 15.5885        5.3886       10.7772   12.2527\n  6.00676e-16   5.99691       6.49099   2.16366\n -2.21974e-15  -7.34063e-17  -0.79086   2.89064\n -2.21974e-15  -7.34063e-17   3.20914   3.89064\n -2.03039e-15  -5.54008e-17  -3.28659  -0.274573\n -1.54754e-15   1.30103e-16   2.23454   2.15004","content_type":"text/plain"}}}],"key":"TifeDLznP1"}],"data":{},"key":"bhqECbpqK1"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"We need to iterate the process for the last two columns.","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"T832IfsIn1"}],"key":"TtCfVb9Cog"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"for j in 3:n\n    z = A[j:m, j]\n    v = normalize(z - norm(z) * [1; zeros(m-j)])\n    P = I - 2v * v'\n    A[j:m, :] = P * A[j:m, :]\nend","key":"iPK7cfWODt"},{"type":"output","id":"Vnvavu4rGAZ5IsOf5gmLj","data":[],"key":"z0gnTbS0nu"}],"data":{},"key":"x46eqMdog7"},{"type":"paragraph","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"children":[{"type":"text","value":"We have now reduced the original to an upper triangular matrix using four orthogonal Householder reflections:","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"Jqhu67EYoq"}],"key":"EkkhYMBaa3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"R = triu(A)","key":"uzsstoaJyw"},{"type":"output","id":"SqJhddfqtzu-HaN18bXRn","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 15.5885  5.3886   10.7772   12.2527\n  0.0     5.99691   6.49099   2.16366\n  0.0     0.0       5.16903   3.07723\n  0.0     0.0       0.0       4.32685\n  0.0     0.0       0.0       0.0\n  0.0     0.0       0.0       0.0","content_type":"text/plain"}}}],"key":"MkKBEzh9BS"}],"data":{},"key":"d7FF7rzrwc"}],"label":"demo-house-qr-julia","identifier":"demo-house-qr-julia","html_id":"demo-house-qr-julia","key":"KSsd2ai8BQ"}],"key":"so0APuyTsX"}],"key":"euwus6ymzI"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 2","url":"/chapter2","group":"Julia codes"},"next":{"title":"Chapter 4","url":"/chapter4","group":"Julia codes"}}},"domain":"http://localhost:3000"}