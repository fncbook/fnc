{"kind":"Notebook","sha256":"fa3f671489651c11c13e1c41c2fcf924573d4497fd24f30411b2c0568982d0dc","slug":"chapter3","location":"/julia/chapter3.md","dependencies":[],"frontmatter":{"title":"Chapter 3","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter3.md","url":"/fnc/build/chapter3-de679d893e17e2e1eaa6b0681e04d968.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"A6Y7XqOcvT"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"UWRZwEGQrq"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by the normal equations","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ziiva3EUgL"}],"key":"piSmBzaZSE"},{"type":"include","file":"package/src/chapter03.jl","literal":true,"filter":{"startAfter":"# begin lsnormal","endBefore":"# end lsnormal"},"children":[{"type":"code","value":"\"\"\"\n    lsnormal(A, b)\n\nSolve a linear least-squares problem by the normal equations.\nReturns the minimizer of ||b-Ax||.\n\"\"\"\nfunction lsnormal(A, b)\n    N = A' * A\n    z = A' * b\n    R = cholesky(N).U\n    w = forwardsub(R', z)                   # solve R'z=c\n    x = backsub(R, w)                       # solve Rx=z\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"lsnormal.jl","key":"tE2Dm3J2Fr"}],"key":"ZNd25bGJB0"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"fTmFYXxKIA"}],"key":"HGILKBpfV1"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"The syntax on line 9 is a ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"FPNovEzrnR"},{"type":"emphasis","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"field reference","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"P61PbSlADC"}],"key":"M1wjRcm3x5"},{"type":"text","value":" to extract the matrix we want from the structure returned by ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"WnjF8tsdCP"},{"type":"inlineCode","value":"cholesky","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"sju8ngmx37"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"tff6bKztKc"}],"key":"pvnRUISeik"}],"class":"dropdown","key":"AMCBRRn4MA"}],"label":"function-lsnormal-julia","identifier":"function-lsnormal-julia","html_id":"function-lsnormal-julia","key":"ZRyhKc9YFM"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by QR factorization","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Qo1D6ooSJX"}],"key":"ZLxNNdRvRD"},{"type":"include","file":"package/src/chapter03.jl","literal":true,"filter":{"startAfter":"# begin lsqrfact","endBefore":"# end lsqrfact"},"children":[{"type":"code","value":"\"\"\"\n    lsqrfact(A, b)\n\nSolve a linear least-squares problem by QR factorization. Returns\nthe minimizer of ||b-Ax||.\n\"\"\"\nfunction lsqrfact(A, b)\n    Q, R = qr(A)\n    c = Q' * b\n    x = backsub(R, c)\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"lsqrfact.jl","key":"jc9bp6S1kM"}],"key":"N00Urp10WX"}],"label":"function-lsqrfact-julia","identifier":"function-lsqrfact-julia","html_id":"function-lsqrfact-julia","key":"SfCSXMQCQW"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"QR factorization by Householder reflections","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"MkeN7ODAdb"}],"key":"ZkS4U6gCA2"},{"type":"include","file":"package/src/chapter03.jl","literal":true,"filter":{"startAfter":"# begin qrfact","endBefore":"# end qrfact"},"children":[{"type":"code","value":"\"\"\"\n    qrfact(A)\n\nQR factorization by Householder reflections. Returns Q and R.\n\"\"\"\nfunction qrfact(A)\n    m, n = size(A)\n    Qt = diagm(ones(m))\n    R = float(copy(A))\n    for k in 1:n\n        z = R[k:m, k]\n        w = [-sign(z[1]) * norm(z) - z[1]; -z[2:end]]\n        nrmw = norm(w)\n        if nrmw < eps()\n            continue\n        end    # skip this iteration\n        v = w / nrmw\n        # Apply the reflection to each relevant column of R and Q\n        for j in k:n\n            R[k:m, j] -= v * (2 * (v' * R[k:m, j]))\n        end\n        for j in 1:m\n            Qt[k:m, j] -= v * (2 * (v' * Qt[k:m, j]))\n        end\n    end\n    return Qt', triu(R)\nend","lang":"julia","showLineNumbers":true,"filename":"qrfact.jl","key":"ZIlYqpWVO9"}],"key":"g8ZgNOHUQm"}],"label":"function-qrfact-julia","identifier":"function-qrfact-julia","html_id":"function-qrfact-julia","key":"InbHQ3oXIQ"},{"type":"heading","depth":2,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"Oxxy84uc4s"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"oktjWkGmd9"}],"key":"y921g1Vq5q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"CAJ3gEkQ38"},{"type":"output","id":"K9vZbLCHU5XJ1u0Ov0kNl","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"}],"visibility":"show","key":"W0U1sMgViF"}],"data":{"tags":[]},"visibility":"remove","key":"Dcwq5BRYVc"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"3.1 ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"EHg6Vohe8M"},{"type":"link","identifier":"section-leastsq-fitting","label":"section-leastsq-fitting","kind":"narrative","position":{"start":{"line":58,"column":5},"end":{"line":58,"column":29}},"url":"/fitting","internal":true,"dataUrl":"/fitting.json","children":[{"type":"text","value":"Fitting functions to data","key":"PuXjmMLM3P"}],"key":"VLGecdaJIz"}],"identifier":"id-3-1","label":"3.1 ","html_id":"id-3-1","implicit":true,"key":"z0NCQTMhKO"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempinterp","label":"demo-fitting-tempinterp","kind":"proof:example","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":25}},"children":[{"type":"text","value":"Example ","key":"kZuOXEg7Ei"},{"type":"text","value":"3.1.1","key":"nixdnuMQ85"}],"template":"Example %s","enumerator":"3.1.1","resolved":true,"html_id":"demo-fitting-tempinterp","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"Kt9prahTIB"}],"key":"I2Y24QG6Gy"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Here are 5-year averages of the worldwide temperature anomaly as compared to the 1951–1980 average (source: NASA).","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"R6aqMYUBrF"}],"key":"Gt5n6YRvTV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n       0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]\n    \nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", \n    legend=:bottomright)","key":"KaS2SlcG7p"},{"type":"output","id":"QaWMiDP8C8oYpFYS0Ym3N","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00c2a210fc24ac3df4cd7443eddef9ff","path":"/fnc/build/00c2a210fc24ac3df4cd7443eddef9ff.png"},"text/html":{"content_type":"text/html","hash":"d5bd5ba43e2711f6c5600815b6b30b10","path":"/fnc/build/d5bd5ba43e2711f6c5600815b6b30b10.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"49c3b9841bd4737b68d7f5f81001c958","path":"/fnc/build/49c3b9841bd4737b68d7f5f81001c958.svg"}}}],"key":"drkOGHyMqQ"}],"data":{},"key":"FR9bmxvbfk"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"A polynomial interpolant can be used to fit the data. Here we build one using a Vandermonde matrix. First, though, we express time as decades since 1950, as it improves the condition number of the matrix.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"pc4AWe5YyM"}],"key":"o55RcPh2s6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = @. (year - 1950) / 10\nn = length(t)\nV = [ t[i]^j for i in 1:n, j in 0:n-1 ]\nc = V \\ temp","key":"ltJc6PlhdO"},{"type":"output","id":"frLx-XtGRcUyYs1YbtUy3","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n  -14.114000001832462\n   76.36173810552113\n -165.45597224550528\n  191.96056669514388\n -133.27347224319684\n   58.015577787494486\n  -15.962888891734785\n    2.6948063497166928\n   -0.2546666667177082\n    0.010311111113288083","content_type":"text/plain"}}}],"key":"DCMXV1cLJ0"}],"data":{},"key":"QgaTy9nRvy"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"The coefficients in vector ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"fwM2jlSqJQ"},{"type":"inlineCode","value":"c","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"oF5iI0UWQS"},{"type":"text","value":" are used to create a polynomial. Then we create a function that evaluates the polynomial after changing the time variable as we did for the Vandermonde matrix.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"Q5nqsvQLYI"}],"key":"HRXJN6eObV"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"If you ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"Pq4wtdMgxm"},{"type":"inlineCode","value":"plot","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"jegnrZxzo1"},{"type":"text","value":" a function, then the points are chosen automatically to make a smooth curve.","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"yWEeLTjpvB"}],"key":"tIckK1cvTh"}],"key":"rw6WLC8JAH"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"plotting functions","kind":"entry"},"emphasis":false}],"label":"index-bbiEr9PBnd","identifier":"index-bbier9pbnd","html_id":"index-bbier9pbnd","key":"RJptI2IML8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Polynomials, Plots\np = Polynomial(c)\nf = yr -> p((yr - 1950) / 10)\nplot!(f, 1955, 2000, label=\"interpolant\")","key":"QDUTdZRKrf"},{"type":"output","id":"6kjF2uLR_8F6r2b4iUr5u","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ba5e97290c4348f6eb39f4c9b0de1ee","path":"/fnc/build/7ba5e97290c4348f6eb39f4c9b0de1ee.png"},"text/html":{"content_type":"text/html","hash":"f945000bd5f10cdf905a341dd5957777","path":"/fnc/build/f945000bd5f10cdf905a341dd5957777.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"1fdeb6888ec8533f3d159af1db320f3a","path":"/fnc/build/1fdeb6888ec8533f3d159af1db320f3a.svg"}}}],"key":"DheBQn2Vpx"}],"data":{},"key":"BGAUkgIeNP"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"As you can see, the interpolant does represent the data, in a sense. However it’s a crazy-looking curve for the application. Trying too hard to reproduce all the data exactly is known as ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"LhpRTYoiC0"},{"type":"emphasis","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"overfitting","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"saCaM79B1v"}],"key":"dzEiOObn9s"},{"type":"text","value":".","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"u8kvUbnreU"}],"key":"RJA8AAI3Nh"}],"label":"demo-fitting-tempinterp-julia","identifier":"demo-fitting-tempinterp-julia","html_id":"demo-fitting-tempinterp-julia","key":"DdWznPehXt"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempfit","label":"demo-fitting-tempfit","kind":"proof:example","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":22}},"children":[{"type":"text","value":"Example ","key":"gntT88s5Ps"},{"type":"text","value":"3.1.2","key":"YGnsEgaJps"}],"template":"Example %s","enumerator":"3.1.2","resolved":true,"html_id":"demo-fitting-tempfit","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"L93mmuyfhJ"}],"key":"pp9ZvqGEFf"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Here are the 5-year temperature averages again.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"WUmNAE586K"}],"key":"DKUr1kBNIO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"year = 1955:5:2000\nt = @. (year - 1950) / 10\ntemp = [ -0.0480, -0.0180, -0.0360, -0.0120, -0.0040,\n          0.1180, 0.2100, 0.3320, 0.3340, 0.4560 ]","key":"ykhsjXwp3U"},{"type":"output","id":"AYs6SlnBOLJtvzV71XTpa","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"10-element Vector{Float64}:\n -0.048\n -0.018\n -0.036\n -0.012\n -0.004\n  0.118\n  0.21\n  0.332\n  0.334\n  0.456","content_type":"text/plain"}}}],"key":"THJHt6CraO"}],"data":{},"key":"q7tJ7Mtqmk"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"The standard best-fit line results from using a linear polynomial that meets the least-squares criterion.","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"PG3NVl5Vvd"}],"key":"PdYcsoo7d0"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"Backslash solves overdetermined linear systems in a least-squares sense.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"YOxqFvxAUA"}],"key":"rFPb4pOogB"}],"key":"DPbXnhE4bX"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-ldvwUMg7KS","identifier":"index-ldvwumg7ks","html_id":"index-ldvwumg7ks","key":"ZIP5Bd9D99"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t.^0 t ]    # Vandermonde-ish matrix\n@show size(V)\nc = V \\ temp\np = Polynomial(c)","key":"GelcYQ04WK"},{"type":"output","id":"4dcsqw9Yl0wEOmSEp1Tb9","data":[{"output_type":"stream","name":"stdout","text":"size(V) = (10, 2)"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"Polynomial(-0.18773333333333356 + 0.11670303030303034*x)","content_type":"text/plain"},"text/html":{"content":"&#45;0.18773333333333356 &#43; 0.11670303030303034&#8729;x","content_type":"text/html"},"text/latex":{"content":"$-0.18773333333333356 + 0.11670303030303034\\cdot x$","content_type":"text/latex"}}}],"key":"GrcNSw7dM2"}],"data":{},"key":"Ykxq4CxBhA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = yr -> p((yr - 1955) / 10)\nscatter(year, temp, label=\"data\",\n    xlabel=\"year\", ylabel=\"anomaly (degrees C)\", leg=:bottomright)\nplot!(f, 1955, 2000, label=\"linear fit\")","key":"j1XHBwp4C8"},{"type":"output","id":"BUBkKW00EFxcTxEEYLSmI","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c154bb9e7191c4921546b7c6472887e0","path":"/fnc/build/c154bb9e7191c4921546b7c6472887e0.png"},"text/html":{"content_type":"text/html","hash":"e44c3edf7e933e52c0b2822c9e94e646","path":"/fnc/build/e44c3edf7e933e52c0b2822c9e94e646.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a0267ea665f75b97e617b3cb634bcd28","path":"/fnc/build/a0267ea665f75b97e617b3cb634bcd28.svg"}}}],"key":"dBPlimyJt5"}],"data":{},"key":"tH39Q4i4UN"},{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"If we use a global cubic polynomial, the points are fit more closely.","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"UfZKnTnaMN"}],"key":"sMy1HNSokC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"V = [ t[i]^j for i in 1:length(t), j in 0:3 ]   \n@show size(V);","key":"hwfQAxnJfS"},{"type":"output","id":"LUaxf4bqj3iK2sfGWolQf","data":[{"output_type":"stream","name":"stdout","text":"size(V) = (10, 4)\n"}],"key":"IEmU2EG2yz"}],"data":{},"key":"MDFz7NEX83"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Now we solve the new least-squares problem to redefine the fitting polynomial.","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"AKOsMeMSP3"}],"key":"erOYdyHowx"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"The definition of ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"zAEPwzdfoA"},{"type":"inlineCode","value":"f","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"yBvJKOl8Av"},{"type":"text","value":" above is in terms of ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"d9w6Zm6NZe"},{"type":"inlineCode","value":"p","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"iD3UwsPsnA"},{"type":"text","value":". When ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"I8J4npen3E"},{"type":"inlineCode","value":"p","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"v4QZSPySh9"},{"type":"text","value":" is changed, then ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"nbsnCgq26Y"},{"type":"inlineCode","value":"f","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"h7R8lsNBnl"},{"type":"text","value":" calls the new version.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"a8iRYypjKl"}],"key":"OMQGfB3tqf"}],"key":"gmhCulOTkg"}],"key":"nqLGIXAiOI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"p = Polynomial( V \\ temp )\nplot!(f, 1955, 2000, label=\"cubic fit\")","key":"MbGgnc6JYi"},{"type":"output","id":"AL9NJLD_1HRGtSp4ud4jm","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3b4ac1918b5ad83106e92af6f49b2c14","path":"/fnc/build/3b4ac1918b5ad83106e92af6f49b2c14.png"},"text/html":{"content_type":"text/html","hash":"5d893b090c75d8d5da5ddac18f6ddcd1","path":"/fnc/build/5d893b090c75d8d5da5ddac18f6ddcd1.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"74279b9d988911f4eaa684df4ee5e4fe","path":"/fnc/build/74279b9d988911f4eaa684df4ee5e4fe.svg"}}}],"key":"sBfZbknbff"}],"data":{},"key":"xlbe8oAtut"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"If we were to continue increasing the degree of the polynomial, the residual at the data points would get smaller, but overfitting would increase.","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"Wk1Xo2Tvhi"}],"key":"eMY6qm1DB1"}],"label":"demo-fitting-tempfit-julia","identifier":"demo-fitting-tempfit-julia","html_id":"demo-fitting-tempfit-julia","key":"p4tUAAqgVf"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-pirate","label":"demo-fitting-pirate","kind":"proof:example","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":21}},"children":[{"type":"text","value":"Example ","key":"IDlS92oJMK"},{"type":"text","value":"3.1.3","key":"f9p8yyPZuv"}],"template":"Example %s","enumerator":"3.1.3","resolved":true,"html_id":"demo-fitting-pirate","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"zzsCumgZrn"}],"key":"gTPPrSpdfb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"a = [1/k^2 for k=1:100] \ns = cumsum(a)        # cumulative summation\np = @. sqrt(6*s)\n\nscatter(1:100, p;\n    title=\"Sequence convergence\",\n    xlabel=L\"k\",  ylabel=L\"p_k\")","key":"vy3qt06fxe"},{"type":"output","id":"CGbMuk2irePhwLpKwj8_R","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b5ae30c8e60d81af034b3247485abc4f","path":"/fnc/build/b5ae30c8e60d81af034b3247485abc4f.png"},"text/html":{"content_type":"text/html","hash":"8946f3b26b8b1c713cebadaccedf517d","path":"/fnc/build/8946f3b26b8b1c713cebadaccedf517d.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"228467b21016fe2cafa321963d0c6ab1","path":"/fnc/build/228467b21016fe2cafa321963d0c6ab1.svg"}}}],"key":"HofuSQl3uJ"}],"data":{},"key":"EeOSQzxRZV"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"This graph suggests that maybe ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"o3c8N4tjc0"},{"type":"inlineMath","value":"p_k\\to \\pi","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>→</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">p_k\\to \\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"TU9rBLpzsJ"},{"type":"text","value":", but it’s far from clear how close the sequence gets. It’s more informative to plot the sequence of errors, ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"o5KZNBPmAu"},{"type":"inlineMath","value":"\\epsilon_k= |\\pi-p_k|","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>π</mi><mo>−</mo><msub><mi>p</mi><mi>k</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k= |\\pi-p_k|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>","key":"d6FRZDuglX"},{"type":"text","value":". By plotting the error sequence on a log-log scale, we can see a nearly linear relationship.","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"MAhdlt4aar"}],"key":"cyaomIks0p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = @. abs(π - p)    # error sequence\nscatter(1:100, ϵ;\n    title=\"Convergence of errors\",\n    xaxis=(:log10,L\"k\"),  yaxis=(:log10,\"error\"))","key":"ul52NpqeL1"},{"type":"output","id":"KH97o5DoGIDTbuN1Jko4N","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"424cd0e0b45b848a740763ee21943940","path":"/fnc/build/424cd0e0b45b848a740763ee21943940.png"},"text/html":{"content_type":"text/html","hash":"f93b9e37f17c0e961b6e9ba1a84f1a9a","path":"/fnc/build/f93b9e37f17c0e961b6e9ba1a84f1a9a.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"8ad1a40cc9d15c63c808aa93566336df","path":"/fnc/build/8ad1a40cc9d15c63c808aa93566336df.svg"}}}],"key":"CjALlKx0nA"}],"data":{},"key":"lU4KKLLtcX"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"The straight line on the log-log scale suggests a power-law relationship where ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"rEgoDnBBOA"},{"type":"inlineMath","value":"\\epsilon_k\\approx a k^b","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>a</mi><msup><mi>k</mi><mi>b</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k\\approx a k^b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6331em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span></span></span></span>","key":"yGX4wzayeB"},{"type":"text","value":", or ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"wfVbW1rT2w"},{"type":"inlineMath","value":"\\log \\epsilon_k \\approx b (\\log k) + \\log a","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>b</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">\\log \\epsilon_k \\approx b (\\log k) + \\log a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"QO5vpmRL0C"},{"type":"text","value":".","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"oIl1HjgBIR"}],"key":"HiqiNOmWkn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"k = 1:100\nV = [ k.^0 log.(k) ]     # fitting matrix\nc = V \\ log.(ϵ)          # coefficients of linear fit","key":"vNhzcvCZVN"},{"type":"output","id":"e0JZC0oKxp4xt9ly-yXpG","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Float64}:\n -0.18237524972829994\n -0.9674103233127929","content_type":"text/plain"}}}],"key":"JRq8wnR4WV"}],"data":{},"key":"QioY52u6AG"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"In terms of the parameters ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"OFWYzKTzhX"},{"type":"inlineMath","value":"a","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"Y1ugi1fm8E"},{"type":"text","value":" and ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"h3sjMNmHqi"},{"type":"inlineMath","value":"b","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"p1vcD1ReLi"},{"type":"text","value":" used above, we have","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"dITftM1VeM"}],"key":"RGMZgZOtf0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"a, b = exp(c[1]), c[2];\n@show b;","key":"i8NoJIbs9h"},{"type":"output","id":"3XHa9an3lu2xL2dxGiukR","data":[{"output_type":"stream","name":"stdout","text":"b = -0.9674103233127929\n"}],"key":"cLqA2SC2oJ"}],"data":{},"key":"v28WJKTJmB"},{"type":"paragraph","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"It’s tempting to conjecture that the slope ","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"vzDo1fE5t6"},{"type":"inlineMath","value":"b\\to -1","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>→</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">b\\to -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"CJXrRdQLap"},{"type":"text","value":" asymptotically. Here is how the numerical fit compares to the original convergence curve.","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"cozM1nNs8C"}],"key":"LhKkIREv2s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot!(k, a * k.^b, l=:dash, label=\"power-law fit\")","key":"ryi4konWib"},{"type":"output","id":"g7qRkKrREjo38Bu7sV8x0","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b38e6613a40a415ae05e9f35a39ee12","path":"/fnc/build/5b38e6613a40a415ae05e9f35a39ee12.png"},"text/html":{"content_type":"text/html","hash":"48be0d59032e73904fea62c25552b2dd","path":"/fnc/build/48be0d59032e73904fea62c25552b2dd.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"87dc6ace42f6abed730d03faa7dd0c9f","path":"/fnc/build/87dc6ace42f6abed730d03faa7dd0c9f.svg"}}}],"key":"Meagjs0eeE"}],"data":{},"key":"VARgsNO41h"}],"label":"demo-fitting-pirate-julia","identifier":"demo-fitting-pirate-julia","html_id":"demo-fitting-pirate-julia","key":"X3dSnj84NX"},{"type":"heading","depth":3,"position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"3.2 ","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"DJy0dO4bQS"},{"type":"link","identifier":"section-leastsq-normaleqns","label":"section-leastsq-normaleqns","kind":"narrative","position":{"start":{"line":204,"column":5},"end":{"line":204,"column":32}},"url":"/normaleqns","internal":true,"dataUrl":"/normaleqns.json","children":[{"type":"text","value":"The normal equations","key":"yKLmWP6qkY"}],"key":"POO5PNygYN"}],"identifier":"id-3-2","label":"3.2 ","html_id":"id-3-2","implicit":true,"key":"Bh2jyUB164"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","kind":"proof:example","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":24}},"children":[{"type":"text","value":"Example ","key":"EBDKf8Px6e"},{"type":"text","value":"3.2.1","key":"MoGcAnhUCZ"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"Yn5PF2Txpk"}],"key":"NwOIWgt4Jq"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Because the functions ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"nWZpvE8nxu"},{"type":"inlineMath","value":"\\sin^2(t)","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1219em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">sin</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8719em;\"><span style=\"top:-3.1208em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"c14Is2fvaf"},{"type":"text","value":", ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"gYEy14lBi7"},{"type":"inlineMath","value":"\\cos^2(t)","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>cos</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\cos^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">cos</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"d4unJrU3Id"},{"type":"text","value":", and ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"ZW0Q8OSO1I"},{"type":"text","value":"1","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"zfq2EtGbVy"},{"type":"text","value":" are linearly dependent, we should find that the following matrix is somewhat ill-conditioned.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"kRtcxFSnNJ"}],"key":"pv1oojCUfX"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"The local variable scoping rule for loops applies to comprehensions as well.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"yqPTBtJYxX"}],"key":"gPZdSW0cgw"}],"key":"mE68VcDiRl"}],"key":"kmbrEuAush"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, 400)\nf = [ x -> sin(x)^2, x -> cos((1 + 1e-7) * x)^2, x -> 1. ]\nA = [ f(t) for t in t, f in f ]\n@show κ = cond(A);","key":"rkintujqmI"},{"type":"output","id":"ngQXJpYVOuTeEKxIk7-7A","data":[{"output_type":"stream","name":"stdout","text":"κ = cond(A) = 1.8253225426741675e7\n"}],"key":"ZVbCrmtzbC"}],"data":{},"key":"djQvoXZNOJ"},{"type":"paragraph","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"text","value":"Now we set up an artificial linear least-squares problem with a known exact solution that actually makes the residual zero.","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"AfaVErvXit"}],"key":"yqcA43bLON"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x = [1., 2, 1]\nb = A * x;","key":"mo5VMDqG4B"},{"type":"output","id":"VEyx0kkBJJUgEWSNPFQD-","data":[],"key":"qeJFUlcz11"}],"data":{},"key":"H16NarLAAl"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"Using backslash to find the least-squares solution, we get a relative error that is well below ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"CPpg5A8mgp"},{"type":"text","value":"κ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"uHrqvwAUPe"},{"type":"text","value":" times machine epsilon.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"FOIKQelAdj"}],"key":"HXQGE4srkX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x_BS = A \\ b\n@show observed_error = norm(x_BS - x) / norm(x);\n@show error_bound = κ * eps();","key":"pSyWAgaORU"},{"type":"output","id":"JD6hBjAsK3uLO0q0_GB5r","data":[{"output_type":"stream","name":"stdout","text":"observed_error = norm(x_BS - x) / norm(x) = 1.0163949045357309e-10\nerror_bound = κ * eps() = 4.053030228488391e-9\n"}],"key":"LF4HiPjztn"}],"data":{},"key":"EQ9WjYQvSz"},{"type":"paragraph","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"If we formulate and solve via the normal equations, we get a much larger relative error. With ","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"OlUndTINDf"},{"type":"inlineMath","value":"\\kappa^2\\approx 10^{14}","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>κ</mi><mn>2</mn></msup><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa^2\\approx 10^{14}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span></span></span></span></span></span></span></span></span></span></span></span>","key":"xvPW8Dl4mE"},{"type":"text","value":", we may not be left with more than about 2 accurate digits.","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"d42CIQhYnD"}],"key":"imkvmskzda"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"N = A' * A\nx_NE = N \\ (A'*b)\n@show observed_err = norm(x_NE - x) / norm(x);\n@show digits = -log10(observed_err);","key":"yfWhV152CQ"},{"type":"output","id":"H2RB0H0iF0BYjmaGlTRJs","data":[{"output_type":"stream","name":"stdout","text":"observed_err = norm(x_NE - x) / norm(x) = 0.021745909192780664"},{"output_type":"stream","name":"stdout","text":"\ndigits = -(log10(observed_err)) = 1.6626224298403076\n"}],"key":"OPtET7Q0rO"}],"data":{},"key":"lsoXN21GpK"}],"label":"demo-normaleqns-instab-julia","identifier":"demo-normaleqns-instab-julia","html_id":"demo-normaleqns-instab-julia","key":"GIKqCyVVO8"},{"type":"heading","depth":3,"position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"3.3 ","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"GrUYB2N4gl"},{"type":"link","identifier":"section-leastsq-qr","label":"section-leastsq-qr","kind":"narrative","position":{"start":{"line":248,"column":5},"end":{"line":248,"column":24}},"url":"/qr","internal":true,"dataUrl":"/qr.json","children":[{"type":"text","value":"The QR factorization","key":"kw2FxDfMoj"}],"key":"IhqlWdZ0rR"}],"identifier":"id-3-3","label":"3.3 ","html_id":"id-3-3","implicit":true,"key":"rR9nHlsLl6"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-qrfact","label":"demo-qr-qrfact","kind":"proof:example","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":16}},"children":[{"type":"text","value":"Example ","key":"x1JqdEffRD"},{"type":"text","value":"3.3.1","key":"x2x3hDcqtm"}],"template":"Example %s","enumerator":"3.3.1","resolved":true,"html_id":"demo-qr-qrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"g6bGk4O1bV"}],"key":"lEBixTlzjd"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"Julia provides access to both the thin and full forms of the QR factorization.","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"V1a42xzY7O"}],"key":"y3uvN2QSQo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.:9., 6, 4)\n@show m,n = size(A);","key":"XrudBPoY9J"},{"type":"output","id":"iQH_ZmG_vP-rRbkDn0Seq","data":[{"output_type":"stream","name":"stdout","text":"(m, n) = size(A) = (6, 4)\n"}],"key":"Q2OM5Z4ZvJ"}],"data":{},"key":"ZZgOEO06wS"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Here is a standard call:","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"bjqbnCru85"}],"key":"vKGh3QyLlJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q,R = qr(A);\nQ","key":"rsMZ17mB7H"},{"type":"output","id":"93OXAEl9gb_BtSLEZO4gR","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"6×6 LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}","content_type":"text/plain"}}}],"key":"xtAHXE5Zc7"}],"data":{},"key":"q3xhh7bjVz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"R","key":"RbDJUwUhHX"},{"type":"output","id":"tNYkrz8SEf-oB_5HEkE6z","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -14.2478  -15.441    -13.9671   -6.17639\n   0.0      -6.04784   -4.85049  -4.89936\n   0.0       0.0       -8.20938  -1.57986\n   0.0       0.0        0.0      -2.89007","content_type":"text/plain"}}}],"key":"iqz14S7AUf"}],"data":{},"key":"qZQgNVs9oI"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"If you look carefully, you see that we seemingly got a full ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"lBqgwTzAKW"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"JlJFC0RlVZ"},{"type":"text","value":" but a thin ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"wBsobvOEby"},{"type":"inlineMath","value":"\\mathbf{R}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">R</span></span></span></span>","key":"qRxn5NfzQU"},{"type":"text","value":". However, the ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"hfSd6Fv5NQ"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"K0S9XKYyft"},{"type":"text","value":" above is not a standard matrix type. If you convert it to a true matrix, then it reverts to the thin form.","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"nvS7GNgBLS"}],"key":"s0yM26jtia"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"text","value":"To enter the accented character ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"gBN4Sil6bA"},{"type":"inlineCode","value":"Q̂","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"NukjAnA3Xx"},{"type":"text","value":", type ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"vqUT753Jkc"},{"type":"inlineCode","value":"Q\\hat","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"y4zdkDymPG"},{"type":"text","value":" followed by ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"DQ4bz0U5qH"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"QCcMub72CJ"}],"key":"UaDgbeZAbR"},{"type":"text","value":".","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"jNhv96dgJn"}],"key":"YiZXvdeAhJ"}],"key":"VaHE3Qck6a"}],"key":"qXA0ncvkNB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂ = Matrix(Q)","key":"tMUd9GZBRx"},{"type":"output","id":"hnlZgdAFzym3b50LBUnR4","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n -0.631676   0.620667   -0.144698  -0.315145\n -0.56149   -0.0545731   0.134854   0.180723\n -0.140372  -0.468351   -0.337136  -0.451807\n -0.210559  -0.454504   -0.225906  -0.38609\n -0.421117  -0.412964    0.595032   0.236732\n -0.210559  -0.123808   -0.664921   0.677337","content_type":"text/plain"}}}],"key":"nVDBPq4tlX"}],"data":{},"key":"gTopjuXUsM"},{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"We can test that ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"vLlka3Hoa3"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"X1RM23R1Cl"},{"type":"text","value":" is an orthogonal matrix:","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"MuPhqsg46S"}],"key":"o8F920kgZO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(Q' * Q - I)","key":"cwjVIy6XCW"},{"type":"output","id":"Ocad-TsUiwsAg2r67S5dd","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"9.20504988550131e-16","content_type":"text/plain"}}}],"key":"LAaxc0Vytj"}],"data":{},"key":"sRLbcEm5TD"},{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"The thin ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"MZ775Swoz0"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"E7pg2HQNpi"},{"type":"text","value":" cannot be an orthogonal matrix, because it is not square, but it is still ","key":"Imy3vzsE3k"},{"type":"abbreviation","title":"matrix with orthonormal columns","children":[{"type":"text","value":"ONC","key":"RxtdUbyKcp"}],"key":"QW645d3Cc9"},{"type":"text","value":":","key":"UtrWVeYPkP"}],"key":"AYXBuwIPEq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂' * Q̂ - I","key":"hHwlDX8BLV"},{"type":"output","id":"2_vIrT-vKENqzC9E-DNZA","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  2.22045e-16  -1.79574e-16   1.39857e-16   1.14455e-16\n -1.79574e-16  -2.22045e-16   6.99966e-17  -4.73634e-17\n  1.39857e-16   6.99966e-17   0.0          -5.0737e-18\n  1.14455e-16  -4.73634e-17  -5.0737e-18   -5.55112e-16","content_type":"text/plain"}}}],"key":"UVj8zTQh4t"}],"data":{},"key":"OCbAhMhyyv"}],"label":"demo-qr-qrfact-julia","identifier":"demo-qr-qrfact-julia","html_id":"demo-qr-qrfact-julia","key":"rHo3wED9v1"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-stable","label":"demo-qr-stable","kind":"proof:example","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":16}},"children":[{"type":"text","value":"Example ","key":"vk3OMGb4Bj"},{"type":"text","value":"3.3.2","key":"zFtwfYyzw6"}],"template":"Example %s","enumerator":"3.3.2","resolved":true,"html_id":"demo-qr-stable","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"Ojlvg2Apyn"}],"key":"Ri501xfWsT"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"We’ll repeat the experiment of ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"jPPQeXq8iE"},{"type":"crossReference","kind":"proof:example","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","children":[{"type":"text","value":"Demo ","key":"tmoY0IvwkV"},{"type":"text","value":"3.2.1","key":"HypzfKBPNS"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"oKHE5vOODv"},{"type":"text","value":", which exposed instability in the normal equations.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"S6hyRMFjZR"}],"key":"hqo8Zynm1v"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 3, 400)\nf = [ x -> sin(x)^2, x -> cos((1 + 1e-7) * x)^2, x -> 1. ]\nA = [ f(t) for t in t, f in f ]\nx = [1., 2, 1]\nb = A * x;","key":"Iop5oJMFx0"},{"type":"output","id":"fIbZhZzLiyFGOjG0jvj1H","data":[],"key":"cEVDef1xxY"}],"data":{},"key":"MqLQzRPKk9"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"The error in the solution by ","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"JBoZGKEqP3"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lsqrfact","label":"function-lsqrfact","children":[{"type":"text","value":"Function ","key":"EwohkFlpf9"},{"type":"text","value":"3.3.2","key":"JVcvG8AFOh"}],"template":"Algorithm %s","enumerator":"3.3.2","resolved":true,"html_id":"function-lsqrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"yBNc7Rqn1n"},{"type":"text","value":" is similar to the bound predicted by the condition number.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"QEUq3eK0nx"}],"key":"pECTiodyH3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"observed_error = norm(FNC.lsqrfact(A, b) - x) / norm(x);\n@show observed_error;\n@show error_bound = cond(A) * eps();","key":"MgbcpMct1f"},{"type":"output","id":"YP1ipNWFO687dfqjs6Kh6","data":[{"output_type":"stream","name":"stdout","text":"observed_error = 4.665273501889628e-9"},{"output_type":"stream","name":"stdout","text":"\nerror_bound = cond(A) * eps() = 4.053030228488391e-9\n"}],"key":"yv9o7eojVR"}],"data":{},"key":"v1PjCcJBi2"}],"label":"demo-qr-stable-julia","identifier":"demo-qr-stable-julia","html_id":"demo-qr-stable-julia","key":"NXPZykYlB6"},{"type":"heading","depth":3,"position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"3.4 ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"kurSr1CAFl"},{"type":"link","identifier":"section-leastsq-house","label":"section-leastsq-house","kind":"narrative","position":{"start":{"line":315,"column":5},"end":{"line":315,"column":27}},"url":"/house","internal":true,"dataUrl":"/house.json","children":[{"type":"text","value":"Computing QR factorizations","key":"mlOWbpqw4C"}],"key":"i700iqovTS"}],"identifier":"id-3-4","label":"3.4 ","html_id":"id-3-4","implicit":true,"key":"PDH7KhmYyj"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-house-qr","label":"demo-house-qr","kind":"proof:example","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":15}},"children":[{"type":"text","value":"Example ","key":"j8pfill0nF"},{"type":"text","value":"3.4.1","key":"CjgEO2QLAP"}],"template":"Example %s","enumerator":"3.4.1","resolved":true,"html_id":"demo-house-qr","remote":true,"url":"/house","dataUrl":"/house.json","key":"WyLWZPivtU"}],"key":"vAPGJxMSq8"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"We will use Householder reflections to produce a QR factorization of a random matrix.","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"hn80IVJQfw"}],"key":"SQf3gFNsdY"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"jCXb9Nf0Uw"},{"type":"inlineCode","value":"rand","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"Osissvfhby"},{"type":"text","value":" function can select randomly from within the interval ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"oFhcUJ3FvE"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"J0fGrUTplQ"},{"type":"text","value":", or from a vector or range that you specify.","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"BWsRmz1wiq"}],"key":"LSTwIthiS5"}],"key":"niBiiF9Yi7"}],"key":"MJorNjt121"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(float(1:9), 6, 4)\nm,n = size(A)","key":"TclClA9Sos"},{"type":"output","id":"K-xhvyrUrVAnPFNbvI3jy","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"(6, 4)","content_type":"text/plain"}}}],"key":"ygFbde7Tfn"}],"data":{},"key":"kzEeeZ4jDw"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"Our first step is to introduce zeros below the diagonal in column 1 by using ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"qftEExfuhL"},{"type":"crossReference","kind":"equation","identifier":"hhvector","label":"hhvector","children":[{"type":"text","value":"(","key":"u4pJBWOrIV"},{"type":"text","value":"3.4.4","key":"W5RRmUx758"},{"type":"text","value":")","key":"BfYl1p4LAG"}],"template":"(%s)","enumerator":"3.4.4","resolved":true,"html_id":"hhvector","remote":true,"url":"/house","dataUrl":"/house.json","key":"L9Snhotb0X"},{"type":"text","value":" and ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"JxeSkNSTI7"},{"type":"crossReference","kind":"equation","identifier":"hhreflect","label":"hhreflect","children":[{"type":"text","value":"(","key":"TDXAgJedDU"},{"type":"text","value":"3.4.1","key":"EUpGYT0sf8"},{"type":"text","value":")","key":"QYkSeHz7eS"}],"template":"(%s)","enumerator":"3.4.1","resolved":true,"html_id":"hhreflect","remote":true,"url":"/house","dataUrl":"/house.json","key":"WKjUsnnkCX"},{"type":"text","value":".","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"BigBRIce6p"}],"key":"MMNTak4HEB"},{"type":"code","lang":"","value":":::{card}\n`I` can stand for an identity matrix of any size, inferred from the context when needed.","position":{"start":{"line":336,"column":1},"end":{"line":339,"column":1}},"key":"P6GAF07IqC"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"normalize","kind":"entry"},"emphasis":false},{"entry":"Julia","subEntry":{"value":"I","kind":"entry"},"emphasis":true}],"label":"index-pKBfXO7mn8","identifier":"index-pkbfxo7mn8","html_id":"index-pkbfxo7mn8","key":"hu3ou6Bfsc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = A[:, 1];\nv = normalize(z - norm(z) * [1; zeros(m-1)])\nP₁ = I - 2v * v'   # reflector","key":"ZU1d9t80bC"},{"type":"output","id":"9yEjlVjX_BO80S3Z2N73h","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"6×6 Matrix{Float64}:\n 0.465778   0.291111   0.524      0.465778   0.291111   0.349334\n 0.291111   0.841366  -0.285541  -0.253814  -0.158634  -0.190361\n 0.524     -0.285541   0.486026  -0.456866  -0.285541  -0.342649\n 0.465778  -0.253814  -0.456866   0.593897  -0.253814  -0.304577\n 0.291111  -0.158634  -0.285541  -0.253814   0.841366  -0.190361\n 0.349334  -0.190361  -0.342649  -0.304577  -0.190361   0.771567","content_type":"text/plain"}}}],"key":"LtyVhDFgHu"}],"data":{},"key":"qdn7K4DI7w"},{"type":"paragraph","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"children":[{"type":"text","value":"We check that this reflector introduces zeros as it should:","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"fvmAzZ7jA8"}],"key":"vr1HAmW8sX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"P₁ * z","key":"ntPaE4YxC7"},{"type":"output","id":"8KXDFyoG6fdSSm6vuz4Cd","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Float64}:\n 17.17556403731767\n -1.7763568394002505e-15\n -4.551914400963142e-15\n -3.4416913763379853e-15\n -1.3322676295501878e-15\n -1.5543122344752192e-15","content_type":"text/plain"}}}],"key":"BR2qRWKIES"}],"data":{},"key":"Ey3kEgRlXk"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"Now we replace ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"UNENFlKVYt"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"GKbZDM8lir"},{"type":"text","value":" by ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"K9OTrP7ass"},{"type":"inlineMath","value":"\\mathbf{P}\\mathbf{A}","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">P</mi><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">PA</span></span></span></span>","key":"AYnA6zSVJ8"},{"type":"text","value":".","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"xjtUJjq0SE"}],"key":"Ie1qnCNmQJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A = P₁ * A","key":"x7S0J080sD"},{"type":"output","id":"OVKosaxKlPcwDyYO1tZK3","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 17.1756       10.1307    12.8089     9.31556\n -1.77636e-15   2.02446   -1.80019    0.468638\n -4.55191e-15  -2.95597    0.359653  -2.15645\n -3.44169e-15  -3.96086   -2.68031   -3.25018\n -1.33227e-15  -1.97554    3.19981    2.46864\n -1.55431e-15  -0.970644  -3.76023   -4.43763","content_type":"text/plain"}}}],"key":"fAu15nypM2"}],"data":{},"key":"DL74SyDJhY"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"We are set to put zeros into column 2. We must not use row 1 in any way, lest it destroy the zeros we just introduced. So we leave it out of the next reflector.","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"RQc5BhrJwo"}],"key":"Ya9YZM5vR5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"z = A[2:m, 2]\nv = normalize(z - norm(z) * [1; zeros(m-2)])\nP₂ = I - 2v * v'","key":"za5AFcZIpa"},{"type":"output","id":"r2UuTUpUHyXinKPvm5MC7","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"5×5 Matrix{Float64}:\n  0.350457  -0.511711  -0.685669  -0.341988   -0.168029\n -0.511711   0.596873  -0.540171  -0.269418   -0.132374\n -0.685669  -0.540171   0.276195  -0.361008   -0.177375\n -0.341988  -0.269418  -0.361008   0.819942   -0.0884684\n -0.168029  -0.132374  -0.177375  -0.0884684   0.956533","content_type":"text/plain"}}}],"key":"x808gwhDLw"}],"data":{},"key":"fFJFN3oVbr"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"We now apply this reflector to rows 2 and below only.","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"tzCXmI1UbM"}],"key":"OhaEXEh7i7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"A[2:m, :] = P₂ * A[2:m, :]\nA","key":"oU6gcRvZyF"},{"type":"output","id":"5EMPCZtOwbRWphSnkWet3","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 17.1756       10.1307       12.8089     9.31556\n  4.78338e-15   5.77663       0.560411   3.39767\n  6.15857e-16  -1.11848e-15   2.21934    0.151049\n  3.48288e-15  -1.44308e-15  -0.188412  -0.158235\n  2.12147e-15  -1.10537e-15   4.44268    4.01079\n  1.42618e-16  -2.95457e-16  -3.14957   -3.67993","content_type":"text/plain"}}}],"key":"mmzJFpYO5h"}],"data":{},"key":"xM3TYN4mKv"},{"type":"paragraph","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"children":[{"type":"text","value":"We need to iterate the process for the last two columns.","position":{"start":{"line":375,"column":1},"end":{"line":375,"column":1}},"key":"J8kDp7oHOL"}],"key":"mvryfPXem9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"for j in 3:n\n    z = A[j:m, j]\n    v = normalize(z - norm(z) * [1; zeros(m-j)])\n    P = I - 2v * v'\n    A[j:m, :] = P * A[j:m, :]\nend","key":"nFj1V6SPLB"},{"type":"output","id":"E4FEGKrMfkkOWJOkb6wHN","data":[],"key":"rkfRUFkpss"}],"data":{},"key":"DvXtliln5O"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"We have now reduced the original to an upper triangular matrix using four orthogonal Householder reflections:","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"nicg9CO88y"}],"key":"FnFEI3F3VY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"R = triu(A)","key":"cmd814c0uV"},{"type":"output","id":"kNwf3we00w_Xo54-jebv-","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n 17.1756  10.1307   12.8089    9.31556\n  0.0      5.77663   0.560411  3.39767\n  0.0      0.0       5.88372   5.06038\n  0.0      0.0       0.0       2.01709\n  0.0      0.0       0.0       0.0\n  0.0      0.0       0.0       0.0","content_type":"text/plain"}}}],"key":"NVVzeyGMfq"}],"data":{},"key":"rsfRjGIxHE"}],"label":"demo-house-qr-julia","identifier":"demo-house-qr-julia","html_id":"demo-house-qr-julia","key":"ypycocjzp6"}],"key":"J44SGGVR3O"}],"key":"tU6Nsfmhcn"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 2","url":"/chapter2","group":"Julia codes"},"next":{"title":"Chapter 4","url":"/chapter4","group":"Julia codes"}}},"domain":"http://localhost:3000"}