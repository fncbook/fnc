{"version":2,"kind":"Notebook","sha256":"955c2200664cd5ca6056f9570641c878568d8b4583edfcdf7bdd790082018663","slug":"chapter12-2","location":"/python/chapter12.md","dependencies":[],"frontmatter":{"title":"Chapter 12","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/python/chapter12.md","exports":[{"format":"md","filename":"chapter12.md","url":"/build/chapter12-466039e29b7e91584f1d2f25796048d8.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qJCx1uPnuf"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"TzXoNVBs0W"}],"key":"FKDFFUSNwM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"FNC_init.py\").read())","visibility":"show","key":"Rid7mCTbQT"},{"type":"output","id":"xKvIfhHXfmKk-XaMEdtRA","data":[],"visibility":"show","key":"KSiZ0G3XHy"}],"data":{"tags":[]},"visibility":"remove","key":"kJb4ZqFM4l"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"12.1 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"hG4yGe0stz"},{"type":"link","identifier":"section-advection-traffic","label":"section-advection-traffic","kind":"narrative","position":{"start":{"line":18,"column":6},"end":{"line":18,"column":32}},"url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"zRjJyO8Coy"}],"key":"T5HGlLgFOy"}],"identifier":"id-12-1","label":"12.1 ","html_id":"id-12-1","implicit":true,"key":"w7rykK7YpY"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":24}},"children":[{"type":"text","value":"Example ","key":"FAffqnJlBE"},{"type":"text","value":"12.1.1","key":"BNcHK6oYqB"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"I1AXrqfM7Y"}],"key":"gixsqa9hiX"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"ammvarZPha"},{"type":"inlineMath","value":"c","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"pkeuWtI22c"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"sGwhNKhHga"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"IbsMpgp6jy"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"TneBjYm8Ns"}],"key":"kStVKSdesc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(300, [-4, 4])\nf = lambda t, u: -c * (Dx @ u)","key":"ebaWylhGGp"},{"type":"output","id":"ETqkWLhYE-yyjJj5JgnJE","data":[],"key":"U4Un1eJLHd"}],"key":"weYZb6zS83"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"iXvAaKXOuq"}],"key":"bl5rVSodvh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nu_init = 1 + exp(-3 * x**2)\nc = 2\nsol = solve_ivp(f, [0, 3.0], u_init, method=\"Radau\", dense_output=True)","key":"S9zz4pI5X9"},{"type":"output","id":"QrAf1LxJ0RkC7Jmzd0rbF","data":[],"key":"gEc6au9y9P"}],"key":"vPTca2yD5h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for t in arange(0, 3, 2/3):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\nlegend()\nxlabel(\"$x$\"),  ylabel(\"$u(x,t)$\")\ntitle(\"Advection with periodic boundary\");","visibility":"hide","key":"nrYs4ang8P"},{"type":"output","id":"i52YBFp0W8YsiKFM_nKMF","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d4bcf12966b321c31e7562370b900711","path":"/build/d4bcf12966b321c31e7562370b900711.png"}}}],"visibility":"show","key":"SjtLyXwok8"}],"data":{"tags":[]},"visibility":"show","key":"v3WAj4PAhd"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"QmV3Q3XQPw"}],"key":"JwZ7hQWhmy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\n\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(0.9, 2.1)\nax.set_title(\"Advection equation with periodic boundary\")\n\ndef snapshot(t):\n    curve.set_ydata(sol.sol(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 3, 201)\n    )\nanim.save(\"figures/advection-periodic.mp4\", fps=30)\nclose()","visibility":"hide","key":"ZdLYghS5Ni"},{"type":"output","id":"FopnC6qN0v9kMpYuoxU5I","data":[],"visibility":"show","key":"D0iUgkhYHN"}],"data":{"tags":[]},"visibility":"show","key":"zGdnz27R3d"},{"type":"image","url":"/build/advection-periodic-d98a60a573f192a720f4f1813c60af61.mp4","alt":"Advection with periodic boundary","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"Ij85t5m18i","urlSource":"figures/advection-periodic.mp4"}],"label":"demo-traffic-advection-python","identifier":"demo-traffic-advection-python","html_id":"demo-traffic-advection-python","key":"CUAJSTDxGb"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":20}},"children":[{"type":"text","value":"Example ","key":"tDRvrtOIE2"},{"type":"text","value":"12.1.2","key":"NoelizmmTv"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"mJH3hFSXHU"}],"key":"xavjZ7eyLq"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"AKLm1NWNio"}],"key":"vHNJi3rGXh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rho_c = 1080\nrho_m = 380\nq_m = 10000\nQ0prime = (\n    lambda rho: q_m\n    * 4\n    * rho_c**2\n    * (rho_c - rho_m)\n    * rho_m\n    * (rho_m - rho)\n    / (rho * (rho_c - 2 * rho_m) + rho_c * rho_m) ** 3\n)","key":"gzqnOab0Hl"},{"type":"output","id":"jMwjI-JTBmX-_YZFU_xWp","data":[],"key":"vrWTvJD2EZ"}],"key":"elBpm7WwKz"},{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"H2aJ6aI3JV"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"WYTHs2yNyt"},{"type":"text","value":" points.","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"CJ8AXgaj3M"}],"key":"sV65x1hKt7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(800, [0, 4])","key":"iA9SJ9HZyc"},{"type":"output","id":"HxK8TlHNQ8Z6tUCAoJxqP","data":[],"key":"T9lH65WZ2B"}],"key":"RFvh9chtml"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"n99amRG4v9"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"zhzLLE03MS"}],"key":"xy9yNUv24u"},{"type":"text","value":" resulting from the method of lines.","key":"UQsZ4Ouvoo"}],"key":"pqrIJba5ld"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ode = lambda t, rho: -Q0prime(rho) * (Dx @ rho) + ep * (Dxx @ rho)","key":"TwPCNtBNel"},{"type":"output","id":"wa1uoPDCwhmhjKX6T-DSH","data":[],"key":"ftaFbKyus5"}],"key":"XwafZnJtE5"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"N1keAwq1G7"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"zGihUEc0op"}],"key":"MJVm0nln9a"},{"type":"text","value":".","key":"YD55UT5qqv"}],"key":"SPSLbn8PdT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rho_init = 400 + 10 * exp(-20 * (x - 3) ** 2)\nep = 0.02\nsol = solve_ivp(ode, [0, 1.0], rho_init, method=\"Radau\", dense_output=True)","key":"bdrj4mq2q2"},{"type":"output","id":"f-bBahsxJroDJtCV2R_OB","data":[],"key":"bZDUS8uiiV"}],"key":"b0Rz8nrCi8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for t in linspace(0, 1, 6):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\n\nxlabel(\"$x$\"),  ylabel(\"car density\")\nlegend(),  title(\"Traffic flow\");","visibility":"hide","key":"RzK2KGT7xA"},{"type":"output","id":"fJJJQWw-hRuja_99_pFOs","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c1dc6c644f3286d18e6d65e42e3ba10a","path":"/build/c1dc6c644f3286d18e6d65e42e3ba10a.png"}}}],"visibility":"show","key":"LzUyAlujan"}],"data":{"tags":[]},"visibility":"show","key":"kmHtuTAsia"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"SNP9kTKiTL"}],"key":"XadLZDOvC0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, rho_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"density\")\nax.set_ylim(400, 410)\nax.set_title(\"Traffic flow\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 1, 101)\n    )\nanim.save(\"figures/traffic-small.mp4\", fps=30)\nclose()","visibility":"hide","key":"rUWuH411DA"},{"type":"output","id":"FXdboND9_87p35bWiQwxb","data":[],"visibility":"show","key":"y5auWJ4RRH"}],"data":{"tags":[]},"visibility":"show","key":"JfFt0wOPz5"},{"type":"image","url":"/build/traffic-small-2b6abf8ec8c45c084229a8187b94896d.mp4","alt":"Traffic flow simulation","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"QfhuYcBfu2","urlSource":"figures/traffic-small.mp4"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"aGxTc4ho1M"},{"type":"inlineMath","value":"y","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"ZlIFJragb9"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"d2mzxm8vpL"}],"key":"LNxSF01rOK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rho_init = 400 + 80 * exp(-16 * (x - 3) ** 2)\nsol = solve_ivp(ode, [0, 0.5], rho_init, method=\"Radau\", dense_output=True)","key":"guLLIQ8ixJ"},{"type":"output","id":"Z6dCi1pKyBlceogfrpGRR","data":[],"key":"L2Ss1XxVB1"}],"key":"CSiTAeRiIn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for t in linspace(0, 0.5, 6):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\n\nxlabel(\"$x$\"),  ylabel(\"car density\")\nlegend(),  title(\"Traffic jam\");","visibility":"hide","key":"Bp5uVJOuYK"},{"type":"output","id":"q9We2qRYE_7tLsvwOubIM","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3ef7652b516d60fa0fcb937c39467604","path":"/build/3ef7652b516d60fa0fcb937c39467604.png"}}}],"visibility":"show","key":"BAznJiij8B"}],"data":{"tags":[]},"visibility":"show","key":"D1y8jkaCDC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, rho_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"density\")\nax.set_ylim(400, 480)\nax.set_title(\"Traffic jam\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 0.5, 101)\n    )\nanim.save(\"figures/traffic-jam.mp4\", fps=30)\nclose()","visibility":"hide","key":"hx6LFETlUc"},{"type":"output","id":"nBZPve5iCnKBEkzQbrNOs","data":[],"visibility":"show","key":"L2G7ypCwY8"}],"data":{"tags":[]},"visibility":"show","key":"h0GwfMfCAe"},{"type":"image","url":"/build/traffic-jam-8d6cfb32bd68b29b7e38b35939ecd1d1.mp4","alt":"Traffic jam simulation","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ixGRFAqIou","urlSource":"figures/traffic-jam.mp4"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"Qc1gyuoUHd"}],"key":"JERPIp6rPb"}],"label":"demo-traffic-solve-python","identifier":"demo-traffic-solve-python","html_id":"demo-traffic-solve-python","key":"es6OnUB6j3"},{"type":"heading","depth":3,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"12.2 ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"cZ1V3MPBXq"},{"type":"link","identifier":"section-advection-upwind","label":"section-advection-upwind","kind":"narrative","position":{"start":{"line":187,"column":6},"end":{"line":187,"column":31}},"url":"/upwind","internal":true,"dataUrl":"/upwind.json","children":[{"type":"text","value":"Upwinding and stability","key":"cEzBH5N68D"}],"key":"SRiQHda1qo"}],"identifier":"id-12-2","label":"12.2 ","html_id":"id-12-2","implicit":true,"key":"JWDii8CyZR"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":17}},"children":[{"type":"text","value":"Example ","key":"vD0EojVLGt"},{"type":"text","value":"12.2.5","key":"Naz0rzINPB"}],"template":"Example %s","enumerator":"12.2.5","resolved":true,"html_id":"demo-upwind-cfl","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"KW0ba6vZbn"}],"key":"Q9GO6gmrFl"},{"type":"paragraph","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"text","value":"For time stepping, we use the adaptive explicit method ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"g0954A0fZX"},{"type":"inlineCode","value":"RK45","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"BRQKiYvyat"},{"type":"text","value":".","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"R3pf1NKyfN"}],"key":"jg1LtHI9t2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(400, [0, 1])\nu_init = exp(-80 * (x - 0.5) ** 2)\nc = 2\node = lambda t, u: -c * (Dx @ u)\nsol = solve_ivp(ode, (0, 2), u_init, method=\"RK45\", dense_output=True)\nu = sol.sol","key":"zlLGu773Q0"},{"type":"output","id":"_XtwVQtWLDdBT2AJvKVQz","data":[],"key":"eClbLM0Z0s"}],"key":"b5y3MBM6wc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 2, 81)\nU = vstack([u(tj) for tj in t])\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Linear advection\");","visibility":"hide","key":"wtn9ItwnkL"},{"type":"output","id":"7ZeEgoLfUeux-mtTbwurg","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5ef0a742a322f3bb58b68fb76444763d","path":"/build/5ef0a742a322f3bb58b68fb76444763d.png"}}}],"visibility":"show","key":"bunGfJC8kv"}],"data":{"tags":[]},"visibility":"show","key":"j5Lr47U3Go"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"o3dkBcJnmY"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"rNjCK60ciR"},{"type":"text","value":".","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"cmgBGqdH68"}],"key":"iTBNli7z7e"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"Yk8WDN9Wmn"},{"type":"inlineMath","value":"h","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"AufeEZyFTC"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"UQao5nvbgQ"},{"type":"inlineMath","value":"m","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"y27HW6KpWG"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"qTo3fepgCk"}],"key":"Zqq4UzkzPc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"{len(sol.t) - 1} time steps taken for m = 400\")\n\nx, Dx, Dxx = FNC.diffper(800, [0, 1])\nu_init = exp(-80 * (x - 0.5) ** 2)\nsol = solve_ivp(ode, (0, 2), u_init, method=\"RK45\", dense_output=True)\nprint(f\"{len(sol.t) - 1} time steps taken for m = 800\")","key":"weiouquG0Q"},{"type":"output","id":"dcz8IiCQnw8_r5kdQPOIL","data":[{"output_type":"stream","name":"stdout","text":"1416 time steps taken for m = 400\n"},{"output_type":"stream","name":"stdout","text":"2906 time steps taken for m = 800\n"}],"key":"w2vlQiU95r"}],"key":"uQq7EYBVv3"}],"label":"demo-upwind-cfl-python","identifier":"demo-upwind-cfl-python","html_id":"demo-upwind-cfl-python","key":"EDHIQ10sML"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":23}},"children":[{"type":"text","value":"Example ","key":"GZ5czPO6QN"},{"type":"text","value":"12.2.7","key":"FLZVN7vg4m"}],"template":"Example %s","enumerator":"12.2.7","resolved":true,"html_id":"demo-upwind-direction","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"mw4TxkFCIn"}],"key":"NYD4BrnmnK"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"To5g7E8zF2"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"XwuLrqCwkN"},{"type":"text","value":" with velocity ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"P8K52CqReu"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"s9bT93V3SD"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"R4tsyblo4g"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"pqJE9aOtH9"},{"type":"text","value":".","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"H0wPpII7VN"}],"key":"zhkadWOHUC"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"FllENYDWln"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"lSM3ZrS1u8"},{"type":"text","value":"11.5.2","key":"DmpbKJ9W3S"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"MvMZxITL07"},{"type":"text","value":". Since ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"exLjf2Itts"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"yIAnMT0nZM"},{"type":"text","value":", we define the ","key":"FNrc4dxMTu"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"sWTj1CYZYC"}],"key":"ih327q0jdH"},{"type":"text","value":" interior problem ","key":"mK78vu0YFO"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"G19z8euKXq"},{"type":"text","value":"11.5.4","key":"ukQvRXQ6iM"},{"type":"text","value":")","key":"hqrITrlbJQ"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"E1jHvE37Ga"},{"type":"text","value":" for ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"sdQKnqTa9t"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"EAv0HjrM7Y"},{"type":"text","value":" without ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"A3QvC3VgX3"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QrwMrDSJF1"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"xfzP92ylbw"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"N0Rj3sEPEW"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"yZ1ZAlJbHX"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XI1x7RMSik"},{"type":"text","value":" first.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"YInOix6RAH"}],"key":"bbIbqZNnXZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 80\nx, Dx, Dxx = FNC.diffmat2(m, [0, 1])\n\nchop = lambda u : u[:-1]\nextend = lambda v: hstack([v, 0])\n\node = lambda t, v: -c * chop( Dx @ extend(v) )\nc = -1","key":"UEcCRtAnY4"},{"type":"output","id":"8ThYJS8SKQ-EvqEPua-_2","data":[],"key":"HOio2GXp5X"}],"key":"vFCJeHewQZ"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"veXH4bgRWc"}],"key":"rBaGX1CGBG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u_init = exp(-80 * (x - 0.5) ** 2)\nsol = solve_ivp(ode, (0, 1), chop(u_init), method=\"RK45\", dense_output=True)\nu = lambda t: extend(sol.sol(t))","key":"KXdMnkLfOy"},{"type":"output","id":"oS2cB8a7ynOJyLmQfG49u","data":[],"key":"tNKkwE0Tpp"}],"key":"XDRN8p81ap"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 1, 80)\nU = [u(tj) for tj in t]\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Advection with inflow BC\");","key":"Go2AWKj7py"},{"type":"output","id":"h_JmBmPnNfXYBFZyeIYbk","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"982d404cd1f2518d00f75f7960250a0d","path":"/build/982d404cd1f2518d00f75f7960250a0d.png"}}}],"key":"wgMXJk3fie"}],"key":"LK9G3N21ep"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"LjyCxc63SW"}],"key":"KgES6TwOur"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-0.1, 1.1)\nax.set_title(\"Advection with inflow BC\")\n\ndef snapshot(t):\n    curve.set_ydata(u(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 1, 101)\n    )\nanim.save(\"figures/advection-inflow.mp4\", fps=30)\nclose()","visibility":"hide","key":"QEDbr4lPOm"},{"type":"output","id":"1SQeRSF7duYEtGeydBuIe","data":[],"visibility":"show","key":"zmydSltdRS"}],"data":{"tags":[]},"visibility":"show","key":"BIWw0k7aqn"},{"type":"image","url":"/build/advection-inflow-86bc26e4ba8a5cc22caf79ee3916f06e.mp4","alt":"Advection with inflow BC","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"WDNCWhftA9","urlSource":"figures/advection-inflow.mp4"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"If, instead of ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"lDV70FlOhO"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"SEJgmSsfR3"},{"type":"text","value":", we were to try to impose the downwind condition ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"GJDqSZKAL2"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"cQnSMAI3ce"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"JQIMvvoI4L"}],"key":"AUsWkKq3B8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"chop = lambda u : u[1:]\nextend = lambda v: hstack([0, v])\n\nsol = solve_ivp(ode, (0, 1), chop(u_init), method=\"RK45\", dense_output=True)\nu = lambda t: extend(sol.sol(t))","key":"PItcXMTzqy"},{"type":"output","id":"RZwFTe1Hn91iWTiLEWsL4","data":[],"key":"C8JBvpayjC"}],"key":"PSi3pI8qEn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U = [u(tj) for tj in t]\nclf\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Outflow boundary condition\");","visibility":"hide","key":"VeyrmF1JLA"},{"type":"output","id":"Fmw8S133aNV5t-6k7Vt0h","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e08ec6910cbd79b51c1789a89503228e","path":"/build/e08ec6910cbd79b51c1789a89503228e.png"}}}],"visibility":"show","key":"vcPostriGL"}],"data":{"tags":[]},"visibility":"show","key":"yeszCvWvBz"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"vqX3H3NDwP"}],"key":"mvKESV9M3A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-0.1, 1.1)\nax.set_title(\"Advection with outflow BC\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 0.5, 51)\n    )\nanim.save(\"figures/advection-outflow.mp4\", fps=30)\nclose()","visibility":"hide","key":"qOsKKIO5BO"},{"type":"output","id":"fz6ZAYU0o1H320_2wAMsu","data":[],"visibility":"show","key":"ZF6bHFMAgL"}],"data":{"tags":[]},"visibility":"show","key":"kqyMNzUrGu"},{"type":"image","url":"/build/advection-outflow-8fc091db53f491dc12f01b62ba0768f4.mp4","alt":"Advection with outflow BC","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"f2zbKY6Ajk","urlSource":"figures/advection-outflow.mp4"}],"label":"demo-upwind-direction-python","identifier":"demo-upwind-direction-python","html_id":"demo-upwind-direction-python","key":"TF3OijI2nD"},{"type":"heading","depth":3,"position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"12.3 ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"c5NAsWW7cI"},{"type":"link","identifier":"section-advection-absstab","label":"section-advection-absstab","kind":"narrative","position":{"start":{"line":326,"column":6},"end":{"line":326,"column":32}},"url":"/absstab-advection","internal":true,"dataUrl":"/absstab-advection.json","children":[{"type":"text","value":"Absolute stability","key":"vZKXTva419"}],"key":"Gulutc7glV"}],"identifier":"id-12-3","label":"12.3 ","html_id":"id-12-3","implicit":true,"key":"ZsrCvjOJqq"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":24}},"children":[{"type":"text","value":"Example ","key":"EQznj2QtTY"},{"type":"text","value":"12.3.1","key":"xzhUoZAqds"}],"template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"O0R35blVex"}],"key":"kWQ3M48fnZ"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"n9frpl4JIm"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"TFkUvKjtHV"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"h5017Dyn9F"}],"key":"NNgvYc9tdd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import eigvals\nx, Dx, Dxx = FNC.diffper(40, [0, 1])\nlamb = eigvals(Dx)\n\nplot(real(lamb), imag(lamb), \"o\")\naxis([-40, 40, -40, 40])\naxis(\"equal\")\ntitle(\"Eigenvalues for pure advection\");","visibility":"hide","key":"uYClhADjit"},{"type":"output","id":"-wyOEkoDe4vB8GeveI8xv","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"038302d365c3e7308d6a85ecd04e95a7","path":"/build/038302d365c3e7308d6a85ecd04e95a7.png"}}}],"visibility":"show","key":"KrNH8fYzEY"}],"data":{"tags":[]},"visibility":"show","key":"ScT56bVCNB"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"VEWZEkWZb8"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"ruuGonNrJQ"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"P5yhwpTxe2"}],"key":"ugDntapeun"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"zc = exp(2j * pi * arange(361) / 360)\n# points on |z|=1\n\nz = zc - 1    # shift circle left by 1\nfill(real(z), imag(z), color=(0.8, 0.8, 1))\nplot(real(0.1 * lamb), imag(0.1 * lamb), \"o\")\naxis([-5, 5, -5, 5]),  axis(\"equal\")\ntitle(\"Euler\");","visibility":"hide","key":"CBWJaV933C"},{"type":"output","id":"W7nH0bYKuLA_LoTBxHgIu","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"09bb59b933826415e6df95e4d14027a1","path":"/build/09bb59b933826415e6df95e4d14027a1.png"}}}],"visibility":"show","key":"D7CSr8O6Ps"}],"data":{"tags":[]},"visibility":"show","key":"d4TwK6Eixi"},{"type":"paragraph","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"DRPYFjfFlj"},{"type":"emphasis","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"SQhhoo61in"}],"key":"IFqM3S3KNh"},{"type":"text","value":" real value of ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"ORqpslx28Q"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"zh67ofavcQ"},{"type":"text","value":" is going to make ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"PcxCMWQKLC"},{"type":"text","value":"ζ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"hLdwGmtU1u"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"f31i96u0ji"}],"key":"FCasMACIvn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"z = zc + 1    # shift circle right by 1\nfill([-6, 6, 6, -6], [-6, -6, 6, 6], color=(0.8, 0.8, 1))\nfill(real(z), imag(z), color=\"w\")\nplot(real(0.1 * lamb), imag(0.1 * lamb), \"o\")\naxis([-5, 5, -5, 5])\naxis(\"equal\")\ntitle(\"Backward Euler\");","visibility":"hide","key":"ZG2zO52MpT"},{"type":"output","id":"e6X9QAr1ltUkHwrmlrwTr","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3ec660878c1b891e6bb0d700c6248f5a","path":"/build/3ec660878c1b891e6bb0d700c6248f5a.png"}}}],"visibility":"show","key":"jf3790OMYf"}],"data":{"tags":[]},"visibility":"show","key":"SmvOwN0ZRc"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"IqoHEn7Sy1"},{"type":"text","value":"τ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"iqEvm89c6h"},{"type":"text","value":".","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"vzpou7xXjo"}],"key":"NzFSazhaAR"}],"label":"demo-absstab-advection-python","identifier":"demo-absstab-advection-python","html_id":"demo-absstab-advection-python","key":"SGPZVNDzam"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advdiff","label":"demo-absstab-advdiff","kind":"proof:example","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":22}},"children":[{"type":"text","value":"Example ","key":"xIIGb4VHwX"},{"type":"text","value":"12.3.2","key":"ZzQgwszndF"}],"template":"Example %s","enumerator":"12.3.2","resolved":true,"html_id":"demo-absstab-advdiff","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"zISwfy1Aum"}],"key":"M65W29nmfe"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"The eigenvalues of advection-diffusion are near-imaginary for ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"u5lYfO3PmM"},{"type":"inlineMath","value":"\\epsilon\\approx 0","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>≈</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\approx 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"FFofj0a3K5"},{"type":"text","value":" and get closer to the negative real axis as ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"LUSkbohafZ"},{"type":"text","value":"ε","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"fSfqC7ybF0"},{"type":"text","value":" increases.","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"eaHwDKVqmd"}],"key":"Yuo2zcH3iW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(40, [0, 1])\nfor ep in [0.001, 0.01, 0.05]:\n    lamb = eigvals(-Dx + ep * Dxx)\n    plot(real(lamb), imag(lamb), \"o\", label=f\"epsilon={ep:.1g}\")\naxis(\"equal\")\nlegend()\ntitle(\"Eigenvalues for advection-diffusion\");","visibility":"hide","key":"BicanbTARL"},{"type":"output","id":"44z00qUVhHDAG_8C4ISt0","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1ec1760c4e6758bda1ab2f4cf7575c98","path":"/build/1ec1760c4e6758bda1ab2f4cf7575c98.png"}}}],"visibility":"show","key":"LsVFgTo3IS"}],"data":{"tags":[]},"visibility":"show","key":"AD6E2hMjkb"}],"label":"demo-absstab-advdiff-python","identifier":"demo-absstab-advdiff-python","html_id":"demo-absstab-advdiff-python","key":"DdhL1sIqFr"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-inflow","label":"demo-absstab-inflow","kind":"proof:example","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":21}},"children":[{"type":"text","value":"Example ","key":"SdpKYJOtvx"},{"type":"text","value":"12.3.3","key":"qE1PrZdMo5"}],"template":"Example %s","enumerator":"12.3.3","resolved":true,"html_id":"demo-absstab-inflow","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"wmiIjuOv2C"}],"key":"w210OmuFSk"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"Deleting the last row and column places all the eigenvalues of the discretization into the left half of the complex plane.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"yijLRXtH9m"}],"key":"iLtOm8H7x4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import eigvals\nx, Dx, Dxx = FNC.diffcheb(40, [0, 1])\nA = -Dx[1:, 1:]  # leave out first row and column\n\nlamb = eigvals(A)\nplot(real(lamb), imag(lamb), \"o\")\nxlim(-300, 100),  axis(\"equal\"),  grid(True)\ntitle(\"Eigenvalues of advection with zero inflow\");","key":"fKW5JfMrjG"},{"type":"output","id":"P62JM6yP_GvF31MGhoW-m","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8b6f90529967fc16dbd76d8dab771d18","path":"/build/8b6f90529967fc16dbd76d8dab771d18.png"}}}],"key":"nJkYzAemTY"}],"key":"eju1wYcMCW"},{"type":"paragraph","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"text","value":"Note that the rightmost eigenvalues have real part at most","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"key":"cBQvTgrgJZ"}],"key":"c0s4pbE490"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"rightmost extent of eigenvalues: {max(real(lamb)):.3g}\")","key":"Lk4ipec8le"},{"type":"output","id":"Afp4niJifgH2eUweH7LwZ","data":[{"output_type":"stream","name":"stdout","text":"rightmost extent of eigenvalues: -4.93\n"}],"key":"S8IVBxDDTC"}],"key":"uxjTHiQziX"},{"type":"paragraph","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"Consequently all solutions decay exponentially to zero as ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"ZNH6BfPbzg"},{"type":"inlineMath","value":"t\\to\\infty","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">t\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"l3GKRAs5Aa"},{"type":"text","value":". This matches our observation of the solution: eventually, everything flows out of the domain.","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"uRXv0w9unw"}],"key":"KWCngsZ0VE"}],"label":"demo-absstab-inflow-python","identifier":"demo-absstab-inflow-python","html_id":"demo-absstab-inflow-python","key":"UzutTE1GLt"},{"type":"heading","depth":3,"position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"children":[{"type":"text","value":"12.4 ","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"KraqcOzYKI"},{"type":"link","identifier":"section-advection-wave","label":"section-advection-wave","kind":"narrative","position":{"start":{"line":418,"column":6},"end":{"line":418,"column":29}},"url":"/wave","internal":true,"dataUrl":"/wave.json","children":[{"type":"text","value":"The wave equation","key":"ztxJXO51kW"}],"key":"bVzXdNbSOf"}],"identifier":"id-12-4","label":"12.4 ","html_id":"id-12-4","implicit":true,"key":"gnJHMTts0U"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":22}},"children":[{"type":"text","value":"Example ","key":"KX5XLgVb56"},{"type":"text","value":"12.4.1","key":"LPTqagMCq4"}],"template":"Example %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"HQrkgRL9jv"}],"key":"OHiOWl0rBq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 200\nx, Dx, Dxx = FNC.diffmat2(m, [-1, 1])","key":"ewdaqoWxR6"},{"type":"output","id":"FXSnMjbQIGd_B2tGkiluw","data":[],"key":"XWnBIxKIc6"}],"key":"fzIoJ8lJAA"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"NQh2VucgVI"},{"type":"inlineMath","value":"u","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"VvcPldjcy8"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"JGcg6gtEw5"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"SZqD27JhMG"}],"key":"PcNyEfc8Ir"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"jF2etOJfm6"}],"key":"XwQvQONFSW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"chop = lambda u: u[1:-1]\nextend = lambda v: hstack([0, v, 0])","key":"avrPoGqb61"},{"type":"output","id":"CEWxLnFdv8LkecgloRLr3","data":[],"key":"YcmRUdFm69"}],"key":"tktR4LGS0H"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"Yp90tk0yuK"}],"key":"IeJSaVVxNK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def dw_dt(t, w):\n    u = extend(w[:m-1])\n    z = w[m-1:]\n    du_dt = Dx @ z\n    dz_dt = c**2 * (Dx @ u)\n    return hstack([chop(du_dt), dz_dt])","key":"uoWQA04SbD"},{"type":"output","id":"BXMsggfA4Pzg38pDSC1mF","data":[],"key":"lhP0epVAGW"}],"key":"e05mwQc4Cg"},{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"Iyp9Cqx8cg"},{"type":"inlineMath","value":"u","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"fQhUfEEivH"},{"type":"text","value":".","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"qvVEsQwBpU"}],"key":"Qa2tMcxHDJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u_init = exp(-100 * x**2)\nz_init = -u_init\nw_init = hstack([chop(u_init), z_init])","key":"dKUVGWqA6E"},{"type":"output","id":"ot1pVYeAOkmiSMqe2ue4F","data":[],"key":"eO5GNDXX9K"}],"key":"ySBLGXqjJF"},{"type":"paragraph","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"lm7mwQgWjS"}],"key":"F9rVKBsy1N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"c = 2\nsol = solve_ivp(dw_dt, (0, 2), w_init, dense_output=True)\nu = lambda t: extend(sol.sol(t)[:m-1])   # extract the u component","key":"jsc38HO57q"},{"type":"output","id":"w_o9F9xuywFducA9NGgMT","data":[],"key":"MbvWYNrxu4"}],"key":"MEwWm4mvqX"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"zGtLxy6SO3"},{"type":"inlineMath","value":"u","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"LrVo9H1kpe"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"nXlglWOREN"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"BdoECDvY0I"},{"type":"text","value":" of the composite ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"eSS0R3InLC"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"HMTusXjjIX"},{"type":"text","value":" variable.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"iqEFLh7sRq"}],"key":"MONPbGveYw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 2, 80)\nU = [u(tj) for tj in t]\ncontour(x, t, U, levels=24, cmap=\"RdBu\", vmin=-1, vmax=1)\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Wave equation with boundaries\");","key":"N8Odkrxru9"},{"type":"output","id":"HruQ59_3phHInFENx5YGN","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"075ad1e949bd208061c9260de3318e84","path":"/build/075ad1e949bd208061c9260de3318e84.png"}}}],"key":"Usshq90Fkg"}],"key":"QANRZUC6k5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-1.05, 1.05)\nax.set_title(\"Wave equation with boundaries\")\n\ndef snapshot(t):\n    curve.set_ydata(u(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 2, 161)\n    )\nanim.save(\"figures/wave-boundaries.mp4\", fps=30)\nclose()","visibility":"hide","key":"ryzLFY7mPW"},{"type":"output","id":"RhLr8jtkQ2GWNY5pPtrwm","data":[],"visibility":"show","key":"OdWZ38a9J9"}],"data":{"tags":[]},"visibility":"show","key":"uglm8kfOuT"},{"type":"image","url":"/build/wave-boundaries-99c075d8f2af95684dc530e706e03567.mp4","alt":"Wave equation with boundaries","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"r3Kr33uj0c","urlSource":"figures/wave-boundaries.mp4"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"rbGdMh8f2h"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"wqJGb5IcVf"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"TKv5yX8YFQ"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"yNADSLWnav"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"HiGgXhwGuW"}],"key":"snBmffo6tD"}],"label":"demo-wave-boundaries-python","identifier":"demo-wave-boundaries-python","html_id":"demo-wave-boundaries-python","key":"ERiH04VkoH"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":17}},"children":[{"type":"text","value":"Example ","key":"QOd8yBEQYL"},{"type":"text","value":"12.4.2","key":"XSTuxd48u0"}],"template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"Wd00CciHCA"}],"key":"FTPV7PH8cI"},{"type":"paragraph","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"text","value":"The variable wave speed is set to be re-used","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"key":"JaTS2r6EVH"}],"key":"fp2HaWo3Gf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 120\nx, Dx, Dxx = FNC.diffcheb(m, [-1, 1])\nc = 1 + (sign(x) + 1) / 2\nu_init = exp(-100 * x**2)\nz_init = -u_init\nw_init = hstack([chop(u_init), z_init])\n\nsol = solve_ivp(dw_dt, (0, 5), w_init, dense_output=True, method=\"Radau\")\nu = lambda t: extend(sol.sol(t)[:m-1])","key":"GvNp2dnAAC"},{"type":"output","id":"Txva5qQFx9f4K3ekLNukq","data":[],"key":"Mf3MzsSkfP"}],"key":"aq8HfsCkZp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 5, 150)\nU = [u(tj) for tj in t]\ncontour(x, t, U, levels=24, cmap=\"RdBu\", vmin=-1, vmax=1)\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Wave equation with variable speed\");","key":"Wz454iXLUq"},{"type":"output","id":"oaOElvdBxX0RjD-LSZkjZ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ce0bbb293094b398c9d3696193f91a94","path":"/build/ce0bbb293094b398c9d3696193f91a94.png"}}}],"key":"zC9BYVvShn"}],"key":"IHrsrNLTs5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-1.05, 1.05)\nax.set_title(\"Wave equation with variable speed\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 5, 251)\n    )\nanim.save(\"figures/wave-speed.mp4\", fps=30)\nclose()","visibility":"hide","key":"zBWgFt6t9W"},{"type":"output","id":"ofUkIHz1gs7dGo014MAB_","data":[],"visibility":"show","key":"D15vXCR4Pa"}],"data":{"tags":[]},"visibility":"show","key":"adzvLmK1Yg"},{"type":"image","url":"/build/wave-speed-5c87e1fd24339bbab46df84f41c227cb.mp4","alt":"Wave equation with variable speed","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"H2al0mXrcF","urlSource":"figures/wave-speed.mp4"},{"type":"paragraph","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"weuPd5JgyN"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"fDHdDAHnQI"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"y2u4RhO3Cl"}],"key":"LIzj1vTWdB"}],"label":"demo-wave-speed-python","identifier":"demo-wave-speed-python","html_id":"demo-wave-speed-python","key":"J6Z1OhfJQ5"}],"key":"rSic6KTrq6"}],"key":"tP2EocP7kt"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 11","url":"/chapter11-2","group":"Python codes"},"next":{"title":"Chapter 13","url":"/chapter13-2","group":"Python codes"}}},"domain":"http://localhost:3000"}