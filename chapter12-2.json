{"version":2,"kind":"Notebook","sha256":"955c2200664cd5ca6056f9570641c878568d8b4583edfcdf7bdd790082018663","slug":"chapter12-2","location":"/python/chapter12.md","dependencies":[],"frontmatter":{"title":"Chapter 12","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"source_url":"https://github.com/fncbook/fnc/blob/master/python/chapter12.md","edit_url":"https://github.com/fncbook/fnc/edit/master/python/chapter12.md","exports":[{"format":"md","filename":"chapter12.md","url":"/build/chapter12-466039e29b7e91584f1d2f25796048d8.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NsozLF4ezk"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"R8ulpZlURl"}],"key":"yXTZUpJ0d9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"FNC_init.py\").read())","visibility":"show","key":"GRgmGjGE32"},{"type":"output","id":"BBnL2mqJd4xDPUgf--7-Y","data":[],"visibility":"show","key":"iA9K5Knwu3"}],"data":{"tags":[]},"visibility":"remove","key":"WYMOjvPsF2"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"12.1 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"jANKm11Eje"},{"type":"link","identifier":"section-advection-traffic","label":"section-advection-traffic","kind":"narrative","position":{"start":{"line":18,"column":6},"end":{"line":18,"column":32}},"url":"/traffic","internal":true,"dataUrl":"/traffic.json","children":[{"type":"text","value":"Traffic flow","key":"evR6XcsxjN"}],"key":"psae7ZP8oG"}],"identifier":"id-12-1","label":"12.1 ","html_id":"id-12-1","implicit":true,"key":"O5CNhLG2IY"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-advection","label":"demo-traffic-advection","kind":"proof:example","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":24}},"children":[{"type":"text","value":"Example ","key":"CaS7xgMqr7"},{"type":"text","value":"12.1.1","key":"u6n2Mt5003"}],"template":"Example %s","enumerator":"12.1.1","resolved":true,"html_id":"demo-traffic-advection","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"rGiHW33K5i"}],"key":"DbC1fjkW6k"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"In the following definition we allow the velocity ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Ni1Znic8fL"},{"type":"inlineMath","value":"c","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"DHiT0X7Lqc"},{"type":"text","value":" to be specified as a parameter in the ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"e0T1OK3QSe"},{"type":"inlineCode","value":"ODEProblem","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"eJSBmNzG9Y"},{"type":"text","value":".","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hj0dJphiSZ"}],"key":"T9OBFRAvce"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(300, [-4, 4])\nf = lambda t, u: -c * (Dx @ u)","key":"BbhnEC6Udm"},{"type":"output","id":"zZ0nC5he5x1-ql8cWFvrI","data":[],"key":"Fxv2zaVxNA"}],"key":"LvGapTl1o0"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"The following initial condition isn’t mathematically periodic, but the deviation is less than machine precision. We specify RK4 as the solver.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"JBLVmo6Bxj"}],"key":"EvvjzB8hSD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nu_init = 1 + exp(-3 * x**2)\nc = 2\nsol = solve_ivp(f, [0, 3.0], u_init, method=\"Radau\", dense_output=True)","key":"KZBKHCg8KZ"},{"type":"output","id":"7lgcRId__1rNKSvBbDzP_","data":[],"key":"nwj7dojmbm"}],"key":"xCC2pfYNoN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for t in arange(0, 3, 2/3):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\nlegend()\nxlabel(\"$x$\"),  ylabel(\"$u(x,t)$\")\ntitle(\"Advection with periodic boundary\");","visibility":"hide","key":"FEfoM1TB6c"},{"type":"output","id":"v5Ag9jy9Oe5Ug3ur_ZFx0","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d4bcf12966b321c31e7562370b900711","path":"/build/d4bcf12966b321c31e7562370b900711.png"}}}],"visibility":"show","key":"niGsZnPUUI"}],"data":{"tags":[]},"visibility":"show","key":"DtDDOVTn3m"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"An animation shows the solution nicely. The bump moves with speed 2 to the right, reentering on the left as it exits to the right because of the periodic conditions.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"YnholouYXR"}],"key":"vYCtx9JDOI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\n\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(0.9, 2.1)\nax.set_title(\"Advection equation with periodic boundary\")\n\ndef snapshot(t):\n    curve.set_ydata(sol.sol(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 3, 201)\n    )\nanim.save(\"figures/advection-periodic.mp4\", fps=30)\nclose()","visibility":"hide","key":"yxO5Remqod"},{"type":"output","id":"50hojH_zf1xBg6Y0NzP3p","data":[],"visibility":"show","key":"ZT8b8aosMn"}],"data":{"tags":[]},"visibility":"show","key":"MUZnyyhLWK"},{"type":"image","url":"/build/advection-periodic-711206cc60bb112dcb95ca8c96372f70.mp4","alt":"Advection with periodic boundary","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"Gd5hYvku9P","urlSource":"figures/advection-periodic.mp4"}],"label":"demo-traffic-advection-python","identifier":"demo-traffic-advection-python","html_id":"demo-traffic-advection-python","key":"ZfrqIyXBGs"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-traffic-solve","label":"demo-traffic-solve","kind":"proof:example","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":20}},"children":[{"type":"text","value":"Example ","key":"iIW8Ye9eLT"},{"type":"text","value":"12.1.2","key":"PWdBNZQWVT"}],"template":"Example %s","enumerator":"12.1.2","resolved":true,"html_id":"demo-traffic-solve","remote":true,"url":"/traffic","dataUrl":"/traffic.json","key":"EWyfVp4dx3"}],"key":"utJaZlpZpd"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"The following are parameters and a function relevant to defining the problem.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"BxEZV2nwnn"}],"key":"CvjiWMDAbw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rho_c = 1080\nrho_m = 380\nq_m = 10000\nQ0prime = (\n    lambda rho: q_m\n    * 4\n    * rho_c**2\n    * (rho_c - rho_m)\n    * rho_m\n    * (rho_m - rho)\n    / (rho * (rho_c - 2 * rho_m) + rho_c * rho_m) ** 3\n)","key":"zO0IMO4nOY"},{"type":"output","id":"Dj-2RbOqcJCDnwmoA4Yg_","data":[],"key":"T6LZgK1VAi"}],"key":"aJ5LtbfEYP"},{"type":"paragraph","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"text","value":"Here we create a discretization on ","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"KeuD4AVY2G"},{"type":"inlineMath","value":"m=800","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>800</mn></mrow><annotation encoding=\"application/x-tex\">m=800</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">800</span></span></span></span>","key":"nR1f7bMD4Y"},{"type":"text","value":" points.","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"xUj3a6tvzY"}],"key":"RHX6913AsG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(800, [0, 4])","key":"rSEdFbpoGR"},{"type":"output","id":"4JUNNrlXdgSfp9NWYRMxC","data":[],"key":"cxK1WowtlG"}],"key":"gYX9c9RYDN"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"Next we define the ","key":"XHu3kKIz8O"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"Rmy369DLpB"}],"key":"N2BNrumLqJ"},{"type":"text","value":" resulting from the method of lines.","key":"ylDs5cC1HS"}],"key":"Vm5rQy3oEt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ode = lambda t, rho: -Q0prime(rho) * (Dx @ rho) + ep * (Dxx @ rho)","key":"PdNhcYmOvB"},{"type":"output","id":"8eidc3O6Tjgz1KkHQsV09","data":[],"key":"hWDclRFfpx"}],"key":"XAbwcWwRUr"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"Our first initial condition has moderate density with a small bump. Because of the diffusion present, we use a stiff solver for the ","key":"GwCthDqbGy"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"JPNqm7QO7Y"}],"key":"F5jTNoKjqX"},{"type":"text","value":".","key":"d8ezbyXJvP"}],"key":"uApimMBPzv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rho_init = 400 + 10 * exp(-20 * (x - 3) ** 2)\nep = 0.02\nsol = solve_ivp(ode, [0, 1.0], rho_init, method=\"Radau\", dense_output=True)","key":"AC5cXtE7Qf"},{"type":"output","id":"G5MrXqMKeDFCq7rBXV_gE","data":[],"key":"sE1kAR6SGh"}],"key":"IOWgKmp3jM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for t in linspace(0, 1, 6):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\n\nxlabel(\"$x$\"),  ylabel(\"car density\")\nlegend(),  title(\"Traffic flow\");","visibility":"hide","key":"xILgAecbQW"},{"type":"output","id":"c0Yce_ztg8gji380q2BZl","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c1dc6c644f3286d18e6d65e42e3ba10a","path":"/build/c1dc6c644f3286d18e6d65e42e3ba10a.png"}}}],"visibility":"show","key":"lEZ4hPjkSC"}],"data":{"tags":[]},"visibility":"show","key":"R8BrgQ54bJ"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"The bump slowly moves backward on the roadway, spreading out and gradually fading away due to the presence of diffusion.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"wAClwr5G2N"}],"key":"ZDfkoX3vqS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, rho_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"density\")\nax.set_ylim(400, 410)\nax.set_title(\"Traffic flow\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 1, 101)\n    )\nanim.save(\"figures/traffic-small.mp4\", fps=30)\nclose()","visibility":"hide","key":"Ye3oLOB63I"},{"type":"output","id":"-mxrmk6krL_DAtaV4oPPw","data":[],"visibility":"show","key":"myhtVs1dZi"}],"data":{"tags":[]},"visibility":"show","key":"MftyWWx8N7"},{"type":"image","url":"/build/traffic-small-1383f21971dcb7a0bfe1b1a64da01f06.mp4","alt":"Traffic flow simulation","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"PElCKK5aoS","urlSource":"figures/traffic-small.mp4"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"Now we use an initial condition with a larger bump. Note that the scale on the ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"RRMEHwlX5n"},{"type":"inlineMath","value":"y","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"tZoa1scjhE"},{"type":"text","value":"-axis is much different for this solution.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"SUU9ThdJ1R"}],"key":"pKo0vQmqAk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rho_init = 400 + 80 * exp(-16 * (x - 3) ** 2)\nsol = solve_ivp(ode, [0, 0.5], rho_init, method=\"Radau\", dense_output=True)","key":"xyn0dKYisQ"},{"type":"output","id":"E1EUu4w6Fn9E0EU8KTtaK","data":[],"key":"MTmuxaVhhb"}],"key":"S1Om4cEg0O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for t in linspace(0, 0.5, 6):\n    plot(x, sol.sol(t), label=f\"t = {t:.1f}\")\n\nxlabel(\"$x$\"),  ylabel(\"car density\")\nlegend(),  title(\"Traffic jam\");","visibility":"hide","key":"KJCXkWpSTi"},{"type":"output","id":"bWDh1r8o1PgkNzXQORbiC","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3ef7652b516d60fa0fcb937c39467604","path":"/build/3ef7652b516d60fa0fcb937c39467604.png"}}}],"visibility":"show","key":"pRTgc4ICxu"}],"data":{"tags":[]},"visibility":"show","key":"czRVuF5jlk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, rho_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"density\")\nax.set_ylim(400, 480)\nax.set_title(\"Traffic jam\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 0.5, 101)\n    )\nanim.save(\"figures/traffic-jam.mp4\", fps=30)\nclose()","visibility":"hide","key":"zbPYWrxc80"},{"type":"output","id":"7HxUnKWH2eJdpWFYWImBb","data":[],"visibility":"show","key":"uyMyj7kZ47"}],"data":{"tags":[]},"visibility":"show","key":"rdUeS993wo"},{"type":"image","url":"/build/traffic-jam-a9a32d6843a3a8df0c662b31a87258d8.mp4","alt":"Traffic jam simulation","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"x4S99rUOY5","urlSource":"figures/traffic-jam.mp4"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"In this case the density bump travels backward along the road. It also steepens on the side facing the incoming traffic and decreases much more slowly on the other side. A motorist would experience this as an abrupt increase in density, followed by a much more gradual decrease in density and resulting gradual increase in speed. (You also see some transient, high-frequency oscillations. These are caused by instabilities, as we discuss in simpler situations later in this chapter.)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"cczz1X6fkZ"}],"key":"wRt0NhwB3T"}],"label":"demo-traffic-solve-python","identifier":"demo-traffic-solve-python","html_id":"demo-traffic-solve-python","key":"qp6A4GuQyI"},{"type":"heading","depth":3,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"12.2 ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"caqyenI8xs"},{"type":"link","identifier":"section-advection-upwind","label":"section-advection-upwind","kind":"narrative","position":{"start":{"line":187,"column":6},"end":{"line":187,"column":31}},"url":"/upwind","internal":true,"dataUrl":"/upwind.json","children":[{"type":"text","value":"Upwinding and stability","key":"VdTyxoNEEh"}],"key":"BS71M9rwsc"}],"identifier":"id-12-2","label":"12.2 ","html_id":"id-12-2","implicit":true,"key":"EJSOgCoM8T"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-cfl","label":"demo-upwind-cfl","kind":"proof:example","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":17}},"children":[{"type":"text","value":"Example ","key":"dptCRc4nEt"},{"type":"text","value":"12.2.5","key":"heyxLiKEwT"}],"template":"Example %s","enumerator":"12.2.5","resolved":true,"html_id":"demo-upwind-cfl","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"jRQRIOprKI"}],"key":"jw6cPQXBmO"},{"type":"paragraph","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"text","value":"For time stepping, we use the adaptive explicit method ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"AuIPfu1J6y"},{"type":"inlineCode","value":"RK45","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"vp8eJmi4PD"},{"type":"text","value":".","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"ELdWOdAdzx"}],"key":"J0S6wkVoCS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(400, [0, 1])\nu_init = exp(-80 * (x - 0.5) ** 2)\nc = 2\node = lambda t, u: -c * (Dx @ u)\nsol = solve_ivp(ode, (0, 2), u_init, method=\"RK45\", dense_output=True)\nu = sol.sol","key":"czzwpxxzE8"},{"type":"output","id":"nCPUBWb4EWS5OGi8z_C_d","data":[],"key":"hR7fx9Kcqb"}],"key":"x7SnFa0ZW8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 2, 81)\nU = vstack([u(tj) for tj in t])\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Linear advection\");","visibility":"hide","key":"a592LTxWjp"},{"type":"output","id":"CiSLbVeKQE5MxsKtEfrVO","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5ef0a742a322f3bb58b68fb76444763d","path":"/build/5ef0a742a322f3bb58b68fb76444763d.png"}}}],"visibility":"show","key":"E9MfSEYw5Q"}],"data":{"tags":[]},"visibility":"show","key":"Jh12OYYQmt"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"In the space-time plot above, you can see the initial hump traveling rightward at constant speed. It fully traverses the domain once for each integer multiple of ","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"i2CzUtbGon"},{"type":"inlineMath","value":"t=1/2","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=1/2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/2</span></span></span></span>","key":"rLNEtgzPOQ"},{"type":"text","value":".","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"RYi5IspHAf"}],"key":"AlwYbL7AQC"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"If we cut ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"bTioNEsXVG"},{"type":"inlineMath","value":"h","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"hRzZohBjBa"},{"type":"text","value":" by a factor of 2 (i.e., double ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"HiWCwX0fAu"},{"type":"inlineMath","value":"m","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"pD0R38EYIP"},{"type":"text","value":"), then the CFL condition suggests that the time step should be cut by a factor of 2 also.","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"xlMuTqxFxU"}],"key":"tCytCJmDuE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"{len(sol.t) - 1} time steps taken for m = 400\")\n\nx, Dx, Dxx = FNC.diffper(800, [0, 1])\nu_init = exp(-80 * (x - 0.5) ** 2)\nsol = solve_ivp(ode, (0, 2), u_init, method=\"RK45\", dense_output=True)\nprint(f\"{len(sol.t) - 1} time steps taken for m = 800\")","key":"kE8oADULLg"},{"type":"output","id":"S3053pBwkM0ZUq5nrbcNv","data":[{"output_type":"stream","name":"stdout","text":"1416 time steps taken for m = 400\n"},{"output_type":"stream","name":"stdout","text":"2906 time steps taken for m = 800\n"}],"key":"XUiI2bF9us"}],"key":"xpy3TsPUZV"}],"label":"demo-upwind-cfl-python","identifier":"demo-upwind-cfl-python","html_id":"demo-upwind-cfl-python","key":"m8Nm8DIn7t"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-upwind-direction","label":"demo-upwind-direction","kind":"proof:example","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":23}},"children":[{"type":"text","value":"Example ","key":"hlYciBT9UA"},{"type":"text","value":"12.2.7","key":"pzr7TaAjGE"}],"template":"Example %s","enumerator":"12.2.7","resolved":true,"html_id":"demo-upwind-direction","remote":true,"url":"/upwind","dataUrl":"/upwind.json","key":"WryuvT2UMn"}],"key":"TITivfq4yK"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"If we solve advection over ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"LgreenZcLu"},{"type":"inlineMath","value":"[0,1]","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"xG5ooUj0BA"},{"type":"text","value":" with velocity ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"RaaoLyqNZg"},{"type":"inlineMath","value":"c=-1","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"PebhdN8uEP"},{"type":"text","value":", the right boundary is in the upwind/inflow direction. Thus a well-posed boundary condition is ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"VlvZ2LPIwK"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"bUZY2co3eI"},{"type":"text","value":".","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"YP0vu0sgt7"}],"key":"j8ZGwvlw1I"},{"type":"paragraph","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"children":[{"type":"text","value":"We’ll pattern a solution after ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"ewNLeKGE7U"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-parabolic","label":"function-parabolic","children":[{"type":"text","value":"Function ","key":"kIyv2coeTZ"},{"type":"text","value":"11.5.2","key":"CHjLYR2D8z"}],"template":"Algorithm %s","enumerator":"11.5.2","resolved":true,"html_id":"function-parabolic","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"Wkb7J4IQX2"},{"type":"text","value":". Since ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"DYQifpQW8h"},{"type":"inlineMath","value":"u(x_m,t)=0","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(x_m,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"CffnjEFYiQ"},{"type":"text","value":", we define the ","key":"gkxEKUJ2VM"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"zyNfUhp4ir"}],"key":"qR9PRcdeZL"},{"type":"text","value":" interior problem ","key":"ZfYOe3knRN"},{"type":"crossReference","kind":"equation","identifier":"mol-interior","label":"mol-interior","children":[{"type":"text","value":"(","key":"tYH2FBjZnp"},{"type":"text","value":"11.5.4","key":"dBSNkxOhqU"},{"type":"text","value":")","key":"dKH9ply7qy"}],"template":"(%s)","enumerator":"11.5.4","resolved":true,"html_id":"mol-interior","remote":true,"url":"/boundaries","dataUrl":"/boundaries.json","key":"hw6FpBddac"},{"type":"text","value":" for ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"wZNAwzDgD8"},{"type":"inlineMath","value":"\\mathbf{v}","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">v</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span></span></span></span>","key":"fXgXmrmGTr"},{"type":"text","value":" without ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"UrjyawJCeY"},{"type":"inlineMath","value":"u_m","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tOZh6zal75"},{"type":"text","value":". For each evaluation of ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"wf23QHsKM8"},{"type":"inlineMath","value":"\\mathbf{v}'","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">v</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{v}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"SQVTFhYP0U"},{"type":"text","value":", we must extend the data back to ","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"cqkGeI6hCl"},{"type":"inlineMath","value":"x_m","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>m</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"f3G6PQiqk6"},{"type":"text","value":" first.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"bwGbl6yzRR"}],"key":"sy8ENBM5mh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 80\nx, Dx, Dxx = FNC.diffmat2(m, [0, 1])\n\nchop = lambda u : u[:-1]\nextend = lambda v: hstack([v, 0])\n\node = lambda t, v: -c * chop( Dx @ extend(v) )\nc = -1","key":"onCLXlvWV3"},{"type":"output","id":"Ctq9GgZEeBVf5GVfKt_yD","data":[],"key":"nSaWRvTOUC"}],"key":"B6ITZVJvQX"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"Now we solve for an initial condition that has a single hump.","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"PeIgHrcpa1"}],"key":"sEx1T43VSD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u_init = exp(-80 * (x - 0.5) ** 2)\nsol = solve_ivp(ode, (0, 1), chop(u_init), method=\"RK45\", dense_output=True)\nu = lambda t: extend(sol.sol(t))","key":"SbelyWhS6h"},{"type":"output","id":"-s2YPaBb_xPx4UDeHjfHq","data":[],"key":"gGlUHMfns8"}],"key":"BPTm9d53mS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 1, 80)\nU = [u(tj) for tj in t]\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Advection with inflow BC\");","key":"z3sCYKrl6w"},{"type":"output","id":"Uk0ab2iIDHcxbKjDyhfbX","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"982d404cd1f2518d00f75f7960250a0d","path":"/build/982d404cd1f2518d00f75f7960250a0d.png"}}}],"key":"GnozwBYQwg"}],"key":"AETVgrDEMg"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"We find that the hump gracefully exits out the downwind end.","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"bbBFt0iBNj"}],"key":"c7cSr36WJe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-0.1, 1.1)\nax.set_title(\"Advection with inflow BC\")\n\ndef snapshot(t):\n    curve.set_ydata(u(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 1, 101)\n    )\nanim.save(\"figures/advection-inflow.mp4\", fps=30)\nclose()","visibility":"hide","key":"Sg2wKeoc2y"},{"type":"output","id":"CYeTxrBPP260Y10_MrKoc","data":[],"visibility":"show","key":"HlaNxV86KG"}],"data":{"tags":[]},"visibility":"show","key":"Epiwskg7Qa"},{"type":"image","url":"/build/advection-inflow-68b0bd1a2f3cbe6c4a7fc9816af28eab.mp4","alt":"Advection with inflow BC","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"ETeqaLLMHQ","urlSource":"figures/advection-inflow.mp4"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"If, instead of ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"SP7v01trzU"},{"type":"inlineMath","value":"u(1,t)=0","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(1,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"dBrNUL1SiX"},{"type":"text","value":", we were to try to impose the downwind condition ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"z2w5GeBDBf"},{"type":"inlineMath","value":"u(0,t)=0","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u(0,t)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"AiWFZmDFnn"},{"type":"text","value":", we only need to change the index of the interior nodes and where to append the zero value.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"zAhov9lSy6"}],"key":"KJviRZYcYD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"chop = lambda u : u[1:]\nextend = lambda v: hstack([0, v])\n\nsol = solve_ivp(ode, (0, 1), chop(u_init), method=\"RK45\", dense_output=True)\nu = lambda t: extend(sol.sol(t))","key":"kB4G7VZFv9"},{"type":"output","id":"hVffepENF9LVQ-SWY4q1d","data":[],"key":"xXCjSzqFe6"}],"key":"USchvDve1u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U = [u(tj) for tj in t]\nclf\ncontour(x, t, U, levels=arange(0.15, 1.0, 0.2))\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Outflow boundary condition\");","visibility":"hide","key":"rR1Gww2tWg"},{"type":"output","id":"2cU36Sf3FE8MuBIQU52aF","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"e08ec6910cbd79b51c1789a89503228e","path":"/build/e08ec6910cbd79b51c1789a89503228e.png"}}}],"visibility":"show","key":"bQUpYHrX0L"}],"data":{"tags":[]},"visibility":"show","key":"gYLNt6MdYm"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"This time, the solution blows up as soon as the hump runs into the boundary because there are conflicting demands there.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"SRtJZKZU7b"}],"key":"lzpT1OnNHH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-0.1, 1.1)\nax.set_title(\"Advection with outflow BC\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 0.5, 51)\n    )\nanim.save(\"figures/advection-outflow.mp4\", fps=30)\nclose()","visibility":"hide","key":"mXAZXE10BK"},{"type":"output","id":"Ayis3NHN_9rBGvPjJ0gwt","data":[],"visibility":"show","key":"r4Ke1AtWhN"}],"data":{"tags":[]},"visibility":"show","key":"TlaDklvUIX"},{"type":"image","url":"/build/advection-outflow-37351d678f5c01540ac9f06dfd3b5644.mp4","alt":"Advection with outflow BC","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"PG76lekdVX","urlSource":"figures/advection-outflow.mp4"}],"label":"demo-upwind-direction-python","identifier":"demo-upwind-direction-python","html_id":"demo-upwind-direction-python","key":"b8hdzGPrEy"},{"type":"heading","depth":3,"position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"12.3 ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"BsMzauV3C2"},{"type":"link","identifier":"section-advection-absstab","label":"section-advection-absstab","kind":"narrative","position":{"start":{"line":326,"column":6},"end":{"line":326,"column":32}},"url":"/absstab-advection","internal":true,"dataUrl":"/absstab-advection.json","children":[{"type":"text","value":"Absolute stability","key":"kM1OPhUutA"}],"key":"CWXNOvFBZA"}],"identifier":"id-12-3","label":"12.3 ","html_id":"id-12-3","implicit":true,"key":"SpYrk3HWEN"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advection","label":"demo-absstab-advection","kind":"proof:example","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":24}},"children":[{"type":"text","value":"Example ","key":"odeSQsi6Fe"},{"type":"text","value":"12.3.1","key":"EOGLJl6Xx9"}],"template":"Example %s","enumerator":"12.3.1","resolved":true,"html_id":"demo-absstab-advection","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"jHzmwYyh7i"}],"key":"h4GWNCHke2"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"For ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"Fe7GjRUmIm"},{"type":"inlineMath","value":"c=1","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">c=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"qKLXhmycEl"},{"type":"text","value":" we get purely imaginary eigenvalues.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"hVtEbWJQZh"}],"key":"wFPS6kzc3O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import eigvals\nx, Dx, Dxx = FNC.diffper(40, [0, 1])\nlamb = eigvals(Dx)\n\nplot(real(lamb), imag(lamb), \"o\")\naxis([-40, 40, -40, 40])\naxis(\"equal\")\ntitle(\"Eigenvalues for pure advection\");","visibility":"hide","key":"alVF0HhoW1"},{"type":"output","id":"YX5BZ9Puo5Px8JitmqOMQ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"038302d365c3e7308d6a85ecd04e95a7","path":"/build/038302d365c3e7308d6a85ecd04e95a7.png"}}}],"visibility":"show","key":"nJc8hLl0AR"}],"data":{"tags":[]},"visibility":"show","key":"bcLE3ML97v"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"Let’s choose a time step of ","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"wu7yPII37a"},{"type":"inlineMath","value":"\\tau=0.1","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">\\tau=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"wshvbdOh7E"},{"type":"text","value":" and compare to the stability regions of the Euler and backward Euler time steppers (shown as shaded regions):","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"cxkQAdJtpx"}],"key":"v7m58gZiGL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"zc = exp(2j * pi * arange(361) / 360)\n# points on |z|=1\n\nz = zc - 1    # shift circle left by 1\nfill(real(z), imag(z), color=(0.8, 0.8, 1))\nplot(real(0.1 * lamb), imag(0.1 * lamb), \"o\")\naxis([-5, 5, -5, 5]),  axis(\"equal\")\ntitle(\"Euler\");","visibility":"hide","key":"knFiWq2SC6"},{"type":"output","id":"xjFaPFz7HYnKd6yhLe_eH","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"09bb59b933826415e6df95e4d14027a1","path":"/build/09bb59b933826415e6df95e4d14027a1.png"}}}],"visibility":"show","key":"fs3DsgzSeR"}],"data":{"tags":[]},"visibility":"show","key":"H8bsg1NOUE"},{"type":"paragraph","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"In the Euler case it’s clear that ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"Ru9JRTcZ9K"},{"type":"emphasis","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"no","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"C7Y0Ajdnq4"}],"key":"Frwb5J2QmQ"},{"type":"text","value":" real value of ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"kKSzzUwWJu"},{"type":"inlineMath","value":"\\tau>0","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\tau&gt;0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"xarLICxpkn"},{"type":"text","value":" is going to make ","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"MO4RELDXo2"},{"type":"inlineMath","value":"\\zeta","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ζ</mi></mrow><annotation encoding=\"application/x-tex\">\\zeta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07378em;\">ζ</span></span></span></span>","key":"vAI5hSMcQF"},{"type":"text","value":" values fit within the stability region. Any method whose stability region includes none of the imaginary axis is an unsuitable choice for advection.","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"WI9zSEzZJ9"}],"key":"MK848ZIIGB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"z = zc + 1    # shift circle right by 1\nfill([-6, 6, 6, -6], [-6, -6, 6, 6], color=(0.8, 0.8, 1))\nfill(real(z), imag(z), color=\"w\")\nplot(real(0.1 * lamb), imag(0.1 * lamb), \"o\")\naxis([-5, 5, -5, 5])\naxis(\"equal\")\ntitle(\"Backward Euler\");","visibility":"hide","key":"KnQaRaA98i"},{"type":"output","id":"iMtFUebr6sA0WVCE0qSBo","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3ec660878c1b891e6bb0d700c6248f5a","path":"/build/3ec660878c1b891e6bb0d700c6248f5a.png"}}}],"visibility":"show","key":"bxZSZe8tmV"}],"data":{"tags":[]},"visibility":"show","key":"HH6pZ2D2ga"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"The A-stable backward Euler time stepping tells the exact opposite story: it will be absolutely stable for any choice of the time step ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"fS01gKkeup"},{"type":"inlineMath","value":"\\tau","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>τ</mi></mrow><annotation encoding=\"application/x-tex\">\\tau</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.1132em;\">τ</span></span></span></span>","key":"IQeotZIGZm"},{"type":"text","value":".","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"oNTxmVUdFT"}],"key":"TLDUbcuO6C"}],"label":"demo-absstab-advection-python","identifier":"demo-absstab-advection-python","html_id":"demo-absstab-advection-python","key":"Ym2byAOjWh"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-advdiff","label":"demo-absstab-advdiff","kind":"proof:example","position":{"start":{"line":376,"column":1},"end":{"line":376,"column":22}},"children":[{"type":"text","value":"Example ","key":"lJVnvGZe3r"},{"type":"text","value":"12.3.2","key":"rF2feDJqDu"}],"template":"Example %s","enumerator":"12.3.2","resolved":true,"html_id":"demo-absstab-advdiff","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"ZaIJuAi8X9"}],"key":"eU06oriITx"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"The eigenvalues of advection-diffusion are near-imaginary for ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"IjT14Y9AEl"},{"type":"inlineMath","value":"\\epsilon\\approx 0","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi><mo>≈</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\epsilon\\approx 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"x1Tt6TMvQl"},{"type":"text","value":" and get closer to the negative real axis as ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"QwTjZP4VOA"},{"type":"inlineMath","value":"\\epsilon","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span></span>","key":"JU6ukt0WQk"},{"type":"text","value":" increases.","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"A5bnLtyvZ0"}],"key":"Hs1ywFHWek"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x, Dx, Dxx = FNC.diffper(40, [0, 1])\nfor ep in [0.001, 0.01, 0.05]:\n    lamb = eigvals(-Dx + ep * Dxx)\n    plot(real(lamb), imag(lamb), \"o\", label=f\"epsilon={ep:.1g}\")\naxis(\"equal\")\nlegend()\ntitle(\"Eigenvalues for advection-diffusion\");","visibility":"hide","key":"t4snTeQrC0"},{"type":"output","id":"d0427HRkZOIoimDa9-Wl1","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1ec1760c4e6758bda1ab2f4cf7575c98","path":"/build/1ec1760c4e6758bda1ab2f4cf7575c98.png"}}}],"visibility":"show","key":"x8V87fBttL"}],"data":{"tags":[]},"visibility":"show","key":"CKRigVRb78"}],"label":"demo-absstab-advdiff-python","identifier":"demo-absstab-advdiff-python","html_id":"demo-absstab-advdiff-python","key":"BwrOaJjhQR"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-absstab-inflow","label":"demo-absstab-inflow","kind":"proof:example","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":21}},"children":[{"type":"text","value":"Example ","key":"SOxa6FdgG5"},{"type":"text","value":"12.3.3","key":"bmbRx5dlph"}],"template":"Example %s","enumerator":"12.3.3","resolved":true,"html_id":"demo-absstab-inflow","remote":true,"url":"/absstab-advection","dataUrl":"/absstab-advection.json","key":"VbWtinzVob"}],"key":"wlaclhnxIG"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"Deleting the last row and column places all the eigenvalues of the discretization into the left half of the complex plane.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"BSCh8H1fyN"}],"key":"LQfOk7RLsm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import eigvals\nx, Dx, Dxx = FNC.diffcheb(40, [0, 1])\nA = -Dx[1:, 1:]  # leave out first row and column\n\nlamb = eigvals(A)\nplot(real(lamb), imag(lamb), \"o\")\nxlim(-300, 100),  axis(\"equal\"),  grid(True)\ntitle(\"Eigenvalues of advection with zero inflow\");","key":"vLc7U4fPM6"},{"type":"output","id":"S7wOjQHxXTgjlyJO09J6O","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8b6f90529967fc16dbd76d8dab771d18","path":"/build/8b6f90529967fc16dbd76d8dab771d18.png"}}}],"key":"fbelFUl9hX"}],"key":"aDDIGY1x15"},{"type":"paragraph","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"children":[{"type":"text","value":"Note that the rightmost eigenvalues have real part at most","position":{"start":{"line":408,"column":1},"end":{"line":408,"column":1}},"key":"SeZ12CFwSd"}],"key":"Y7ZZ3CLxym"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"rightmost extent of eigenvalues: {max(real(lamb)):.3g}\")","key":"hiOBYZZNPS"},{"type":"output","id":"Sux5M6JCyuwdSo2ME3UmH","data":[{"output_type":"stream","name":"stdout","text":"rightmost extent of eigenvalues: -4.93\n"}],"key":"DjpEcLH1Rx"}],"key":"L3lxF0BwvG"},{"type":"paragraph","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"Consequently all solutions decay exponentially to zero as ","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"gr172x8tV2"},{"type":"inlineMath","value":"t\\to\\infty","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">t\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"koZPCyxAfF"},{"type":"text","value":". This matches our observation of the solution: eventually, everything flows out of the domain.","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"g3EtcZCSPA"}],"key":"zq559aQhht"}],"label":"demo-absstab-inflow-python","identifier":"demo-absstab-inflow-python","html_id":"demo-absstab-inflow-python","key":"HUUR2KYHYA"},{"type":"heading","depth":3,"position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"children":[{"type":"text","value":"12.4 ","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"M2fI5cRzyT"},{"type":"link","identifier":"section-advection-wave","label":"section-advection-wave","kind":"narrative","position":{"start":{"line":418,"column":6},"end":{"line":418,"column":29}},"url":"/wave","internal":true,"dataUrl":"/wave.json","children":[{"type":"text","value":"The wave equation","key":"BXCRSmBDLd"}],"key":"Ur2LULj31Q"}],"identifier":"id-12-4","label":"12.4 ","html_id":"id-12-4","implicit":true,"key":"glheCnPyIj"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-boundaries","label":"demo-wave-boundaries","kind":"proof:example","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":22}},"children":[{"type":"text","value":"Example ","key":"vAoYYXrSCj"},{"type":"text","value":"12.4.1","key":"fkm8AakkDs"}],"template":"Example %s","enumerator":"12.4.1","resolved":true,"html_id":"demo-wave-boundaries","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"JuRQY6CDAL"}],"key":"fHH4MOrFYm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 200\nx, Dx, Dxx = FNC.diffmat2(m, [-1, 1])","key":"iUqu1N2W54"},{"type":"output","id":"djhtd54ov_NtcTHChyET8","data":[],"key":"Udlc9sACYX"}],"key":"nCKjuumEMd"},{"type":"paragraph","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"children":[{"type":"text","value":"The boundary values of ","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"sJbt8ufx1s"},{"type":"inlineMath","value":"u","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"gCprQ6MtEl"},{"type":"text","value":" are given to be zero, so they are not unknowns in the ","key":"TclEi2RpsG"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"CGGYgLfQZH"}],"key":"cWlJ9Rq1WE"},{"type":"text","value":"s. Instead they are added or removed as necessary.","key":"GapjNbsDVW"}],"key":"C99GROJSeF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"chop = lambda u: u[1:-1]\nextend = lambda v: hstack([0, v, 0])","key":"JLg21x2jUi"},{"type":"output","id":"BB2PLo0LgEhsS4aT2-JRB","data":[],"key":"oqNuqC5gaF"}],"key":"vwLD8EzI3S"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"The following function computes the time derivative of the system at interior points.","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"jhPL1xubFo"}],"key":"Cmf3v9ZB8l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def dw_dt(t, w):\n    u = extend(w[:m-1])\n    z = w[m-1:]\n    du_dt = Dx @ z\n    dz_dt = c**2 * (Dx @ u)\n    return hstack([chop(du_dt), dz_dt])","key":"SZNhI9X8iq"},{"type":"output","id":"vwcnbTCSZ2sGA2KyQ6Ekq","data":[],"key":"qdBlhf6MEg"}],"key":"DvlebQTU09"},{"type":"paragraph","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"children":[{"type":"text","value":"Our initial condition is a single hump for ","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"QRC7pVqars"},{"type":"inlineMath","value":"u","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"MspGyDTtdu"},{"type":"text","value":".","position":{"start":{"line":447,"column":1},"end":{"line":447,"column":1}},"key":"iEGfu3FLXD"}],"key":"mmR5suj9QM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u_init = exp(-100 * x**2)\nz_init = -u_init\nw_init = hstack([chop(u_init), z_init])","key":"YuUrUa17Mc"},{"type":"output","id":"kBTEkEkX2SZpOXvPNdZSl","data":[],"key":"oCFmYyrUN2"}],"key":"jgOMJtCMpk"},{"type":"paragraph","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"children":[{"type":"text","value":"Because the wave equation is hyperbolic, we can use a nonstiff explicit solver.","position":{"start":{"line":455,"column":1},"end":{"line":455,"column":1}},"key":"BxIRbh5Ngl"}],"key":"Ri71ydTIdg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"c = 2\nsol = solve_ivp(dw_dt, (0, 2), w_init, dense_output=True)\nu = lambda t: extend(sol.sol(t)[:m-1])   # extract the u component","key":"kbmg7zoYYU"},{"type":"output","id":"cT4pyA2mWnUfakkNzLOgp","data":[],"key":"nC3sciVhy1"}],"key":"lxi9LUTE7s"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"We plot the results for the original ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"l9m8rjH7Du"},{"type":"inlineMath","value":"u","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"pDvk4bfdUK"},{"type":"text","value":" variable only. Its interior values are at indices ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"sANsUwhPHi"},{"type":"inlineCode","value":"1:m-1","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"sV31w8a361"},{"type":"text","value":" of the composite ","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"hyW77b341b"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"KEs0bKVoyn"},{"type":"text","value":" variable.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"nr43KpZ4FP"}],"key":"wUUGeWUrvY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 2, 80)\nU = [u(tj) for tj in t]\ncontour(x, t, U, levels=24, cmap=\"RdBu\", vmin=-1, vmax=1)\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Wave equation with boundaries\");","key":"qrSVOtGKMW"},{"type":"output","id":"kH5XW3bWDM-laVi1YVXec","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"075ad1e949bd208061c9260de3318e84","path":"/build/075ad1e949bd208061c9260de3318e84.png"}}}],"key":"eCNwBGeQxf"}],"key":"alX3wZ2nvO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-1.05, 1.05)\nax.set_title(\"Wave equation with boundaries\")\n\ndef snapshot(t):\n    curve.set_ydata(u(t))\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 2, 161)\n    )\nanim.save(\"figures/wave-boundaries.mp4\", fps=30)\nclose()","visibility":"hide","key":"rPDQ6V6RvA"},{"type":"output","id":"HnKQQ2FOSmdccZQtXht0S","data":[],"visibility":"show","key":"gC0XkFKKxC"}],"data":{"tags":[]},"visibility":"show","key":"kqd4V0eTOC"},{"type":"image","url":"/build/wave-boundaries-55fef7f4b75279e6520f5cfd5b25dc2f.mp4","alt":"Wave equation with boundaries","position":{"start":{"line":495,"column":1},"end":{"line":495,"column":1}},"key":"QoTH9cI1nF","urlSource":"figures/wave-boundaries.mp4"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"The original hump breaks into two pieces of different amplitudes, each traveling with speed ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"U2jDlvZU0V"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"sANt8DWKdG"},{"type":"text","value":". They pass through one another without interference. When a hump encounters a boundary, it is perfectly reflected, but with inverted shape. At time ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"PVb8kLzpsX"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"HkdOE61N4R"},{"type":"text","value":", the solution looks just like the initial condition.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"pQLup1iyXd"}],"key":"kWZHv3nMUf"}],"label":"demo-wave-boundaries-python","identifier":"demo-wave-boundaries-python","html_id":"demo-wave-boundaries-python","key":"CajUF6hifk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","position":{"start":{"line":502,"column":1},"end":{"line":502,"column":17}},"children":[{"type":"text","value":"Example ","key":"OQJ6kD30rq"},{"type":"text","value":"12.4.2","key":"fyg7XxpMhy"}],"template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"IDAbkpt92z"}],"key":"TVbByrQGPc"},{"type":"paragraph","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"text","value":"The variable wave speed is set to be re-used","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"key":"jV2q0qvF8P"}],"key":"n9U0ePy8sm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 120\nx, Dx, Dxx = FNC.diffcheb(m, [-1, 1])\nc = 1 + (sign(x) + 1) / 2\nu_init = exp(-100 * x**2)\nz_init = -u_init\nw_init = hstack([chop(u_init), z_init])\n\nsol = solve_ivp(dw_dt, (0, 5), w_init, dense_output=True, method=\"Radau\")\nu = lambda t: extend(sol.sol(t)[:m-1])","key":"AFnowX8DC1"},{"type":"output","id":"e7CUJ1xpW_ns2csxbQVqX","data":[],"key":"DTg9RGQQ3x"}],"key":"T7RiB8yJI5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"t = linspace(0, 5, 150)\nU = [u(tj) for tj in t]\ncontour(x, t, U, levels=24, cmap=\"RdBu\", vmin=-1, vmax=1)\nxlabel(\"$x$\"),  ylabel(\"$t$\")\ntitle(\"Wave equation with variable speed\");","key":"vmWvgg6P8h"},{"type":"output","id":"0vDknxUgZvBXVt8TRE7xP","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ce0bbb293094b398c9d3696193f91a94","path":"/build/ce0bbb293094b398c9d3696193f91a94.png"}}}],"key":"QDRyD63OYi"}],"key":"t5vgmQRzb1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ncurve = ax.plot(x, u_init)[0]\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$u(x,t)$\")\nax.set_ylim(-1.05, 1.05)\nax.set_title(\"Wave equation with variable speed\")\n\nanim = animation.FuncAnimation(\n    fig, snapshot, frames=linspace(0, 5, 251)\n    )\nanim.save(\"figures/wave-speed.mp4\", fps=30)\nclose()","visibility":"hide","key":"rRnLEA6gxS"},{"type":"output","id":"qboR1u6LA82c26WLG-dME","data":[],"visibility":"show","key":"ri70LSRvwD"}],"data":{"tags":[]},"visibility":"show","key":"NOiIQYi6Qn"},{"type":"image","url":"/build/wave-speed-1ec046830c7e90f79ff52c90bf2f6211.mp4","alt":"Wave equation with variable speed","position":{"start":{"line":543,"column":1},"end":{"line":543,"column":1}},"key":"rdmlWZIRgI","urlSource":"figures/wave-speed.mp4"},{"type":"paragraph","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"FHkc3ntThB"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"X6xjoyZZgv"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"LUIZRVeA8P"}],"key":"W2hw0zGYhL"}],"label":"demo-wave-speed-python","identifier":"demo-wave-speed-python","html_id":"demo-wave-speed-python","key":"oHLuhjxyId"}],"key":"kWcuoVDNJY"}],"key":"MV2MhnaXA5"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 11","url":"/chapter11-2","group":"Python codes"},"next":{"title":"Chapter 13","url":"/chapter13-2","group":"Python codes"}}},"domain":"http://localhost:3000"}