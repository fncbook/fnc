{"version":1,"kind":"Article","sha256":"763248bfcc7bee77d18632827887931e781c124703478867846e717313c09cee","slug":"quasinewton","location":"/chapter4/quasinewton.md","dependencies":[{"url":"/chapter4","label":"function-fdjac-julia","kind":"Notebook","slug":"chapter4","location":"/julia/chapter4.md","title":"Chapter 4"},{"url":"/chapter4-1","label":"function-fdjac-matlab","kind":"Notebook","slug":"chapter4-1","location":"/matlab/chapter4.md","title":"Chapter 4"},{"url":"/chapter4-2","label":"function-fdjac-python","kind":"Notebook","slug":"chapter4-2","location":"/python/chapter4.md","title":"Chapter 4"}],"frontmatter":{"title":"Quasi-Newton methods","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"enumerator":"4.6.%s"},"title":{"offset":1}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/chapter4/quasinewton.md","exports":[{"format":"md","filename":"quasinewton.md","url":"/build/quasinewton-fd1af1daef02c237eb1dce67347b4bce.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Newton’s method is a foundation for algorithms to solve equations and minimize quantities. But it is not ideal in its straightforward or pure form. Specifically, its least appealing features are the programming nuisance and computational expense of evaluating the Jacobian matrix, and the tendency of the iteration to diverge from many starting points. There are different ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"k2k4XhXtOj"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"quasi-Newton methods","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Bac4spKgil"}],"key":"HTsx2qD9B4"},{"type":"text","value":" that modify the basic idea in an attempt to overcome these issues.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pIvNM1FmeJ"}],"key":"MbqOeDyuCD"},{"type":"heading","depth":2,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Jacobian by finite differences","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XtEDZqy26m"}],"identifier":"jacobian-by-finite-differences","label":"Jacobian by finite differences","html_id":"jacobian-by-finite-differences","implicit":true,"enumerator":"4.6.1","key":"kouZBA5gb5"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"In the scalar case, we found an easy alternative to a direct evaluation of the derivative. In retrospect, we may interpret the secant formula ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RE05B3JJYv"},{"type":"crossReference","kind":"equation","identifier":"secant","label":"secant","children":[{"type":"text","value":"(","key":"pm3Yr5PLDM"},{"type":"text","value":"4.4.2","key":"mOtzWnrUFs"},{"type":"text","value":")","key":"SZDBXqgQUj"}],"template":"(%s)","enumerator":"4.4.2","resolved":true,"html_id":"secant","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"NfekqmFzen"},{"type":"text","value":" as the Newton formula ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LvG77PePKu"},{"type":"crossReference","kind":"equation","identifier":"newton","label":"newton","children":[{"type":"text","value":"(","key":"NHGHI601bi"},{"type":"text","value":"4.3.2","key":"EJjhXjso5z"},{"type":"text","value":")","key":"jeAi24EqhE"}],"template":"(%s)","enumerator":"4.3.2","resolved":true,"html_id":"newton","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"I0a55OJcNj"},{"type":"text","value":" with ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"hwdhV6PgJw"},{"type":"inlineMath","value":"f'(x_k)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f&#x27;(x_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"sAa1QqQEv4"},{"type":"text","value":" replaced by the difference quotient","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LzPCltgwKw"}],"indexEntries":[{"entry":"Jacobian matrix","emphasis":false},{"entry":"finite differences","emphasis":false}],"label":"index-HwpYbVdtT6","identifier":"index-hwpybvdtt6","html_id":"index-hwpybvdtt6","key":"lUfamZJyUW"},{"type":"math","value":"  \\frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}.","label":"secantfd","identifier":"secantfd","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>x</mi><mi>k</mi></msub><mo>−</mo><msub><mi>x</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\frac{f(x_k)-f(x_{k-1})}{x_k-x_{k-1}}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3213em;vertical-align:-0.8943em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8943em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.1","html_id":"secantfd","key":"BQDStYg0Je"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"If the sequence of ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"zueW8erQ8g"},{"type":"inlineMath","value":"x_k","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"NlH7H2ucJ3"},{"type":"text","value":" values converges to a root ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"qttnya7Z9X"},{"type":"inlineMath","value":"r","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"rV8drB3NFO"},{"type":"text","value":", then this quotient converges to ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ARajEnV1EX"},{"type":"inlineMath","value":"f'(r)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f&#x27;(r)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span></span></span></span>","key":"etdoPd7hDS"},{"type":"text","value":".","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"OROB9xPnZB"}],"key":"T5KpatFoPc"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"In the system case, replacing the Jacobian evaluation is more complicated: derivatives are needed with respect to ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"yoB7jIRhRC"},{"type":"inlineMath","value":"n","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"lxtBzBwyLY"},{"type":"text","value":" variables, not just one. From ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"je0ckK4Z7d"},{"type":"crossReference","kind":"equation","identifier":"jacobian","label":"jacobian","children":[{"type":"text","value":"(","key":"tq71tXAnMB"},{"type":"text","value":"4.5.4","key":"PykFIO8kcB"},{"type":"text","value":")","key":"CfXjmpqDiD"}],"template":"(%s)","enumerator":"4.5.4","resolved":true,"html_id":"jacobian","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"nf7mWEos8g"},{"type":"text","value":", we note that the ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hevd0B7Qxu"},{"type":"inlineMath","value":"j","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"kYbGqEO5CI"},{"type":"text","value":"th column of the Jacobian is","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"hacV1fII3Y"}],"key":"djY9Ya9bFG"},{"type":"math","value":"  \\mathbf{J}(\\mathbf{x}) \\mathbf{e}_j =\n  \\begin{bmatrix}\n    \\frac{\\partial{f_1}}{\\partial x_j} \\\\[2mm] \\frac{\\partial{f_2}}{\\partial x_j}\n    \\\\ \\vdots \\\\ \\frac{\\partial{f_n}}{\\partial x_j}\n  \\end{bmatrix}.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"bold\">e</mi><mi>j</mi></msub><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>f</mi><mn>1</mn></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>f</mi><mn>2</mn></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>f</mi><mi>n</mi></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{J}(\\mathbf{x}) \\mathbf{e}_j =\n  \\begin{bmatrix}\n    \\frac{\\partial{f_1}}{\\partial x_j} \\\\[2mm] \\frac{\\partial{f_2}}{\\partial x_j}\n    \\\\ \\vdots \\\\ \\frac{\\partial{f_n}}{\\partial x_j}\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:6.6703em;vertical-align:-3.0852em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.55em;\"><span style=\"top:-2.611em;\"><span class=\"pstrut\" style=\"height:5.016em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.758em;\"><span class=\"pstrut\" style=\"height:5.016em;\"></span><span style=\"height:3.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='3.016em' style='width:0.6667em' viewBox='0 0 666.67 3016' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V3016 H319z M319 0 H403 V3016 H319z'/></svg></span></span><span style=\"top:-7.4111em;\"><span class=\"pstrut\" style=\"height:5.016em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.05em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5852em;\"><span style=\"top:-6.3405em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5423em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-4.4792em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5423em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.4369em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.1446em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5423em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.0852em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.55em;\"><span style=\"top:-2.611em;\"><span class=\"pstrut\" style=\"height:5.016em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.758em;\"><span class=\"pstrut\" style=\"height:5.016em;\"></span><span style=\"height:3.016em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='3.016em' style='width:0.6667em' viewBox='0 0 666.67 3016' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V3016 H263z M263 0 H347 V3016 H263z'/></svg></span></span><span style=\"top:-7.4111em;\"><span class=\"pstrut\" style=\"height:5.016em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.05em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.2","key":"ASakn0pBYe"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"(As always, ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"NZGxSozwfw"},{"type":"inlineMath","value":"\\mathbf{e}_j","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">e</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{e}_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7305em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"jeQngEozyx"},{"type":"text","value":" represents the ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"nYpKRGIyWJ"},{"type":"inlineMath","value":"j","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"VYCUewKSBh"},{"type":"text","value":"th column of the identity matrix, here in ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"DrmatK8A1P"},{"type":"inlineMath","value":"n","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"fAyltzJ9VE"},{"type":"text","value":" dimensions.) Inspired by ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"O7h8wKcVm4"},{"type":"crossReference","kind":"equation","identifier":"secantfd","label":"secantfd","children":[{"type":"text","value":"(","key":"V1ZuQZfxhO"},{"type":"text","value":"4.6.1","key":"HhffB0fz5w"},{"type":"text","value":")","key":"rpqoEOMDbF"}],"template":"(%s)","enumerator":"4.6.1","resolved":true,"html_id":"secantfd","key":"c4TXWZ2lrF"},{"type":"text","value":", we can replace the differentiation with a quotient involving a change in only ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"D6RnbcLrKB"},{"type":"inlineMath","value":"x_j","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TJRPCvDffY"},{"type":"text","value":" while the other variables remain fixed:","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"uZGQWrW4hE"}],"key":"Oi2Qy6Y4rz"},{"type":"math","value":"  \\mathbf{J}(\\mathbf{x}) \\mathbf{e}_j \\approx\n  \\frac{\\mathbf{f}(\\mathbf{x}+\\delta \\mathbf{e}_j) - \\mathbf{f}(\\mathbf{x})}{\\delta}, \\qquad j=1,\\ldots,n.","label":"jacobianfd","identifier":"jacobianfd","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><msub><mi mathvariant=\"bold\">e</mi><mi>j</mi></msub><mo>≈</mo><mfrac><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo>+</mo><mi>δ</mi><msub><mi mathvariant=\"bold\">e</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo></mrow><mi>δ</mi></mfrac><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mi>j</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{J}(\\mathbf{x}) \\mathbf{e}_j \\approx\n  \\frac{\\mathbf{f}(\\mathbf{x}+\\delta \\mathbf{e}_j) - \\mathbf{f}(\\mathbf{x})}{\\delta}, \\qquad j=1,\\ldots,n.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord\"><span class=\"mord mathbf\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.3","html_id":"jacobianfd","key":"zYCFCe69VZ"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"For reasons explained in Chapter 5, ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"sgCNYXVErg"},{"type":"text","value":"δ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"Mx9sTV92N3"},{"type":"text","value":" is usually chosen close to ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"wpCitHg9Yu"},{"type":"inlineMath","value":"\\sqrt{\\epsilon}","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msqrt><mi>ϵ</mi></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{\\epsilon}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.2397em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8003em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.7603em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2397em;\"><span></span></span></span></span></span></span></span></span>","key":"DWyIPoS9Qz"},{"type":"text","value":", where ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"StIUwFe0qE"},{"type":"text","value":"ε","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"DmK5tqaetI"},{"type":"text","value":" represents the expected noise or uncertainty level in evaluation of ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"mCbJ1gp3ue"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"i4pTjdC4YV"},{"type":"text","value":". If the only source of noise is floating-point roundoff, then ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"ete07Khp63"},{"type":"inlineMath","value":"\\delta \\approx \\sqrt{\\epsilon_\\text{mach}}","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi><mo>≈</mo><msqrt><msub><mi>ϵ</mi><mtext>mach</mtext></msub></msqrt></mrow><annotation encoding=\"application/x-tex\">\\delta \\approx \\sqrt{\\epsilon_\\text{mach}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.3147em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7253em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.6853em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3147em;\"><span></span></span></span></span></span></span></span></span>","key":"Tubiyk7VFQ"},{"type":"text","value":".","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"Ng6SxIJEyR"}],"indexEntries":[{"entry":"machine epsilon","emphasis":false}],"label":"index-VWR0r46Rio","identifier":"index-vwr0r46rio","html_id":"index-vwr0r46rio","key":"vjcjgW78At"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"The finite-difference formula ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"NkFIiQAbPO"},{"type":"crossReference","kind":"equation","identifier":"jacobianfd","label":"jacobianfd","children":[{"type":"text","value":"(","key":"AkMNVv4jQb"},{"type":"text","value":"4.6.3","key":"se1DSKFPYL"},{"type":"text","value":")","key":"j57bVLKemm"}],"template":"(%s)","enumerator":"4.6.3","resolved":true,"html_id":"jacobianfd","key":"gKP5IUTuF9"},{"type":"text","value":" is implemented by ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"JFun0urYwy"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fdjac","label":"function-fdjac","children":[{"type":"text","value":"Function ","key":"Zj4LdvXOah"},{"type":"text","value":"4.6.1","key":"hSfWdF06Vv"}],"template":"Algorithm %s","enumerator":"4.6.1","resolved":true,"html_id":"function-fdjac","key":"zi0s4yAyVS"},{"type":"text","value":".","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"lqawk3sSnD"}],"key":"Ah8kuCilu9"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"fdjac","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"nz2NK661Q9"}],"key":"iOT0I24Xw0"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter4","label":"function-fdjac-julia","kind":"Notebook","slug":"chapter4","location":"/julia/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"DmHYSS0xZ7"}],"key":"vnr0FaOEXq"},{"type":"include","file":"FNCFunctions/src/chapter04.jl","literal":true,"filter":{"startAfter":"# begin fdjac","endBefore":"# end fdjac"},"children":[{"type":"code","value":"\"\"\"\n    fdjac(f, x₀ [,y₀])\n\nCompute a finite-difference approximation of the Jacobian matrix for\n`f` at `x₀`, where `y₀`=`f(x₀)` may be given.\n\"\"\"\nfunction fdjac(f, x₀, y₀ = f(x₀))\n    δ = sqrt(eps()) * max(norm(x₀), 1)    # near-optimum FD step size\n    m, n = length(y₀), length(x₀)\n    if n == 1\n        # Vector result for univariate functions.\n        J = (f(x₀ + δ) - y₀) / δ\n    else\n        J = zeros(m, n)\n        x = copy(x₀)\n        for j in 1:n\n            # Difference in the jth direction.\n            x[j] += δ\n            J[:, j] = (f(x) - y₀) / δ\n            x[j] -= δ\n        end\n    end\n    return J\nend","lang":"julia","showLineNumbers":true,"filename":"fdjac.jl","key":"Rdjt9H1MQe"}],"key":"w4OxSZ91sb"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"XSKjQ3Vt6M"}],"key":"zX23cNgwID"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fdjac","label":"function-fdjac","children":[{"type":"text","value":"Function ","key":"vHyaUaDisL"},{"type":"text","value":"4.6.1","key":"i14E4XD2bG"}],"template":"Algorithm %s","enumerator":"4.6.1","resolved":true,"html_id":"function-fdjac","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"v3nj65PnAD"},{"type":"text","value":" is written to accept the case where ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"JRUOUgazFO"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"sh6m62JRIM"},{"type":"text","value":" maps ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"GliWNoqFoN"},{"type":"inlineMath","value":"n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"bE05ksnE5I"},{"type":"text","value":" variables to ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"C79N9hoRIs"},{"type":"inlineMath","value":"m","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"Ufnhz3Zlow"},{"type":"text","value":" values with ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"Kt1ccLNoE7"},{"type":"inlineMath","value":"m\\neq n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo mathvariant=\"normal\">≠</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m\\neq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"NPafZpeodz"},{"type":"text","value":", in anticipation of ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"hh5oFfQ8qX"},{"type":"link","kind":"numref","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"EvgMeYTXOm"}],"key":"LPThWjXv8C"},{"type":"text","value":".","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"kqwJBHhfuZ"}],"key":"oG498TES2s"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Note that a default value is given for the third argument ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"hQkVBnVaEE"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"Ovi826brow"},{"type":"text","value":", and it refers to earlier arguments in the list. The reason is that in some contexts, the caller of ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"JzBo9UY55E"},{"type":"inlineCode","value":"fdjac","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"LWcqxyNhq9"},{"type":"text","value":" may have already computed ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"ftUwso84lg"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"WUAbptQDNo"},{"type":"text","value":" and can supply it without computational cost, while in other contexts, it must be computed fresh. The configuration here adapts to either situation.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"NHoDa6kzCn"}],"key":"dTrP8lrVkW"}],"class":"dropdown","key":"ngKARIC1p4"}],"key":"od5mkW1vF7"}],"key":"U031PX7W4m"}],"key":"tjmzNpPMGY"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter4-1","label":"function-fdjac-matlab","kind":"Notebook","slug":"chapter4-1","location":"/matlab/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"xPtPYjdTEg"}],"key":"x94S4YzNQ2"},{"type":"include","file":"FNC-matlab/fdjac.m","literal":true,"children":[{"type":"code","value":"function J = fdjac(f,x0,y0)\n% FDJAC   Finite-difference approximation of a Jacobian.\n% Input:\n%   f        function to be differentiated\n%   x0       evaluation point (n-vector)\n%   y0       value of f at x0 (m-vector)\n% Output       \n%   J        approximate Jacobian (m-by-n)\n\ndelta = sqrt(eps);   % FD step size\nm = length(y0);  n = length(x0);\nJ = zeros(m,n);\nI = eye(n);\nfor j = 1:n\n    J(:,j) = ( f(x0+delta*I(:,j)) - y0) / delta;\nend","lang":"matlab","showLineNumbers":true,"filename":"fdjac.m","key":"ZnEnzgat5T"}],"key":"A6LKuoq5ZI"}],"key":"diqcyNgoye"}],"key":"jLlQCfDlme"}],"key":"uKTIsMPmvS"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter4-2","label":"function-fdjac-python","kind":"Notebook","slug":"chapter4-2","location":"/python/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"tutbp6lR4k"}],"key":"mbf7jThyMa"},{"type":"include","file":"fncbook/fncbook/chapter04.py","literal":true,"filter":{"lines":[[99,113]]},"children":[{"type":"code","value":"def fdjac(f, x0, y0):\n    \"\"\"\n    fdjac(f,x0,y0)\n\n    Compute a finite-difference approximation of the Jacobian matrix for f at x0,\n    where y0=f(x0) is given.\n    \"\"\"\n\n    delta = np.sqrt(np.finfo(float).eps)  # FD step size\n    m, n = len(y0), len(x0)\n    J = np.zeros((m, n))\n    I = np.eye(n)\n    for j in range(n):\n        J[:, j] = (f(x0 + delta * I[:, j]) - y0) / delta\n    return J","lang":"python","showLineNumbers":true,"filename":"fdjac.py","key":"UTAx3liTfV"}],"key":"jj3NWy5KCS"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"YZgd52GH6N"}],"key":"glXUC6DEw0"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fdjac","label":"function-fdjac","children":[{"type":"text","value":"Function ","key":"YTMju5nlS1"},{"type":"text","value":"4.6.1","key":"mGzcFoVz5m"}],"template":"Algorithm %s","enumerator":"4.6.1","resolved":true,"html_id":"function-fdjac","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"nTSbH6Ef3u"},{"type":"text","value":" is written to accept the case where ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"gSRkvhbCUO"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"HB8B2AN5Qa"},{"type":"text","value":" maps ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"A571ccnBY6"},{"type":"inlineMath","value":"n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Z23hwkotN2"},{"type":"text","value":" variables to ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"SgiofOi3Gm"},{"type":"inlineMath","value":"m","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"cEZdbSxIq9"},{"type":"text","value":" values with ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"dm0rLeBgGX"},{"type":"inlineMath","value":"m\\neq n","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo mathvariant=\"normal\">≠</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m\\neq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"cHwlxq3mhU"},{"type":"text","value":", in anticipation of ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"lxIFwSoy2I"},{"type":"link","kind":"numref","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"pOe2vEX7Z6"}],"key":"U1Lki1pnFg"},{"type":"text","value":".","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"VZ07UsmuqB"}],"key":"jtuZc2TRA1"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Note that a default value is given for the third argument ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"uhMnHysiow"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"TiBYuKftck"},{"type":"text","value":", and it refers to earlier arguments in the list. The reason is that in some contexts, the caller of ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"zTGSs9rAep"},{"type":"inlineCode","value":"fdjac","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"DvNhPNVVUM"},{"type":"text","value":" may have already computed ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"bLE54RWLJx"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"hAkLeUINeR"},{"type":"text","value":" and can supply it without computational cost, while in other contexts, it must be computed fresh. The configuration here adapts to either situation.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"IgZhK2yj4D"}],"key":"BlFUHfXz5s"}],"class":"dropdown","key":"tAwUBOJoYT"}],"key":"CYGaPovsIR"}],"key":"k3wXOJQdS3"}],"key":"tRFkaidBAp"}],"key":"flYjqetjT3"}],"label":"function-fdjac","identifier":"function-fdjac","html_id":"function-fdjac","enumerator":"4.6.1","key":"IdEgWyvqTv"},{"type":"heading","depth":2,"position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"Broyden’s update","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"VpytgGYa69"}],"identifier":"broydens-update","label":"Broyden’s update","html_id":"broydens-update","implicit":true,"enumerator":"4.6.2","key":"lUeHD5WNOM"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"The finite-difference Jacobian is easy to conceive and use. But, as you can see from ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"aU3NfWFiW0"},{"type":"crossReference","kind":"equation","identifier":"jacobianfd","label":"jacobianfd","children":[{"type":"text","value":"(","key":"uDhF1JmaNM"},{"type":"text","value":"4.6.3","key":"jZ84PM5uvq"},{"type":"text","value":")","key":"x39WX4xrEi"}],"template":"(%s)","enumerator":"4.6.3","resolved":true,"html_id":"jacobianfd","key":"K0mf8oXgOh"},{"type":"text","value":", it requires ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"z55GFbpbm5"},{"type":"inlineMath","value":"n","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"thtUq6V2st"},{"type":"text","value":" additional evaluations of the system function at each iteration, which can be unacceptably slow in some applications. Conceptually these function evaluations seem especially wasteful given that the root estimates, and thus presumably the Jacobian matrix, are supposed to change little as the iteration converges. This is a good time to step in with the principle of approximate approximation, which suggests looking for a shortcut in the form of a cheap-but-good-enough way to update the Jacobian from one iteration to the next.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"zc9HcldWp9"}],"key":"dkqgRBS5B7"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Recall that the Newton iteration is derived by solving the linear model implied by ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"GQLx7Z58Q2"},{"type":"crossReference","kind":"equation","identifier":"multitaylor","label":"multitaylor","children":[{"type":"text","value":"(","key":"sfpZ4S5Qn2"},{"type":"text","value":"4.5.3","key":"lsncQxhFpS"},{"type":"text","value":")","key":"VzDpUyRmmF"}],"template":"(%s)","enumerator":"4.5.3","resolved":true,"html_id":"multitaylor","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"QQGEDw7GYH"},{"type":"text","value":":","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"UTPsDZurEF"}],"key":"mEAUXsKOhl"},{"type":"math","value":"  \\mathbf{f}(\\mathbf{x}_{k+1}) \\approx \\mathbf{f}(\\mathbf{x}_k) + \\mathbf{J}(\\mathbf{x}_k)\\,(\\mathbf{x}_{k+1}-\\mathbf{x}_k) = \\boldsymbol{0}.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>≈</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">0</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{f}(\\mathbf{x}_{k+1}) \\approx \\mathbf{f}(\\mathbf{x}_k) + \\mathbf{J}(\\mathbf{x}_k)\\,(\\mathbf{x}_{k+1}-\\mathbf{x}_k) = \\boldsymbol{0}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">0</span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.4","key":"qKgEkLUDaU"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"j28wvzE6t8"},{"type":"inlineMath","value":"\\mathbf{s}_k=\\mathbf{x}_{k+1}-\\mathbf{x}_k","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{s}_k=\\mathbf{x}_{k+1}-\\mathbf{x}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"wVoEqTMTHr"},{"type":"text","value":"  be the Newton step. Let ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"SLzhlOPbwE"},{"type":"inlineMath","value":"\\mathbf{y}_k=\\mathbf{f}(\\mathbf{x}_k)","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}_k=\\mathbf{f}(\\mathbf{x}_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Z0rGDJenTt"},{"type":"text","value":", and now we replace ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"pPCw6kDYzY"},{"type":"inlineMath","value":"\\mathbf{J}(\\mathbf{x}_k)","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{J}(\\mathbf{x}_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"fmb7bd9Cpc"},{"type":"text","value":" by a matrix ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"ahd3sLga7O"},{"type":"inlineMath","value":"\\mathbf{A}_{k}","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_{k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HZ5Ynv53h6"},{"type":"text","value":" that is meant to approximate the Jacobian. Hence the Newton step is considered to be defined, as in ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"ufCfoB4vE8"},{"type":"crossReference","kind":"proof:algorithm","identifier":"algorithm-nonlineqn-newtonsys","label":"algorithm-nonlineqn-newtonsys","children":[{"type":"text","value":"Algorithm ","key":"XDzRyGMUpz"},{"type":"text","value":"4.5.1","key":"HvkfGDjrmt"}],"template":"Algorithm %s","enumerator":"4.5.1","resolved":true,"html_id":"algorithm-nonlineqn-newtonsys","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"GuIurINy6C"},{"type":"text","value":", by","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"o48SpGqzbi"}],"key":"dL57b0u6i9"},{"type":"math","value":"  \\mathbf{A}_k \\mathbf{s}_k = -\\mathbf{y}_k.","label":"quasinewton-step","identifier":"quasinewton-step","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><mo>−</mo><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{A}_k \\mathbf{s}_k = -\\mathbf{y}_k.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.5","html_id":"quasinewton-step","key":"FWunjXp23c"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"Once ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"Bx7CUS7bR7"},{"type":"inlineMath","value":"\\mathbf{x}_{k+1}","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_{k+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ibRc2FxUD3"},{"type":"text","value":" is obtained, we should update the approximate Jacobian to a new ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"s6H9qQyrvV"},{"type":"inlineMath","value":"\\mathbf{A}_{k+1}","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_{k+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vO4PKSO2KO"},{"type":"text","value":". If we think one-dimensionally for a moment, the secant method would assume that ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"hV3Ib4Apay"},{"type":"inlineMath","value":"A_{k+1}=(f_{k+1}-f_k)/(x_{k+1}-x_k)","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>f</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>f</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">A_{k+1}=(f_{k+1}-f_k)/(x_{k+1}-x_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Lhe17BRlTq"},{"type":"text","value":". It’s not easy to generalize a fraction to vectors, but we can do it if we instead write it as","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"aFSBZUt0Qx"}],"key":"h5HMIZ8uNA"},{"type":"math","value":"  \\mathbf{y}_{k+1}-\\mathbf{y}_k = \\mathbf{A}_{k+1} (\\mathbf{x}_{k+1}-\\mathbf{x}_k) = \\mathbf{A}_{k+1} \\mathbf{s}_k.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">y</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><mo>=</mo><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{y}_{k+1}-\\mathbf{y}_k = \\mathbf{A}_{k+1} (\\mathbf{x}_{k+1}-\\mathbf{x}_k) = \\mathbf{A}_{k+1} \\mathbf{s}_k.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.6","key":"HWiDKjZdSw"},{"type":"paragraph","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"This is used to justify the following requirement:","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"fnGdJWHqNc"}],"key":"Nq8CZZr7dk"},{"type":"math","value":"  \\mathbf{A}_{k+1} \\mathbf{s}_k = \\mathbf{y}_{k+1}-\\mathbf{y}_k.","label":"secantsys","identifier":"secantsys","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><msub><mi mathvariant=\"bold\">y</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{A}_{k+1} \\mathbf{s}_k = \\mathbf{y}_{k+1}-\\mathbf{y}_k.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.7","html_id":"secantsys","key":"lx6BTshKMB"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"This isn’t enough to uniquely determine ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"GFsJBXrKrX"},{"type":"inlineMath","value":"\\mathbf{A}_{k+1}","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_{k+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SkFzVP8fRQ"},{"type":"text","value":". However, if we also require that ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"YxlVswvDmA"},{"type":"inlineMath","value":"\\mathbf{A}_{k+1}-\\mathbf{A}_k","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_{k+1}-\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"IK3EqPsXMb"},{"type":"text","value":" is a matrix of rank 1, then one arrives at the following.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"zYbpyazz6O"}],"indexEntries":[{"entry":"Broyden update","emphasis":true}],"label":"index-J1qUY96DLR","identifier":"index-j1quy96dlr","html_id":"index-j1quy96dlr","key":"UO6JLS3Hq2"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Broyden update formula","position":{"start":{"line":107,"column":1},"end":{"line":107,"column":1}},"key":"YhsUHYoGiM"}],"key":"tDY00J9aT8"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"Using the definitions above,","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"eZ0VyJjRw3"}],"key":"AjwytGcLfb"},{"type":"math","value":"  \\mathbf{A}_{k+1} = \\mathbf{A}_k + \\frac{1}{\\mathbf{s}_k^T \\mathbf{s}_k}(\\mathbf{y}_{k+1} - \\mathbf{y}_k -\\mathbf{A}_k \\mathbf{s}_k)\\, \\mathbf{s}_k^T.","label":"broyden","identifier":"broyden","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><mo>+</mo><mfrac><mn>1</mn><mrow><msubsup><mi mathvariant=\"bold\">s</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub></mrow></mfrac><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">y</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><mo>−</mo><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><msubsup><mi mathvariant=\"bold\">s</mi><mi>k</mi><mi>T</mi></msubsup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{A}_{k+1} = \\mathbf{A}_k + \\frac{1}{\\mathbf{s}_k^T \\mathbf{s}_k}(\\mathbf{y}_{k+1} - \\mathbf{y}_k -\\mathbf{A}_k \\mathbf{s}_k)\\, \\mathbf{s}_k^T.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3359em;vertical-align:-1.0144em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.2869em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8231em;\"><span style=\"top:-2.3987em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.0448em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3013em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0144em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.8","html_id":"broyden","key":"oq57ALw12T"}],"enumerator":"4.6.1","key":"jwbHckG7gv"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"Observe that ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"SwJvqgyfEg"},{"type":"inlineMath","value":"\\mathbf{A}_{k+1}-\\mathbf{A}_k","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_{k+1}-\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"La3AG91P15"},{"type":"text","value":" is proportional to the outer product of two vectors, and that computing it requires no extra evaluations of ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"tzmf5NWPBm"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"u45z1jcDqx"},{"type":"text","value":". Remarkably, under reasonable assumptions, the sequence of ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"E0KDKe5YYp"},{"type":"inlineMath","value":"\\mathbf{x}_k","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"dgV0OiyrAm"},{"type":"text","value":" resulting when Broyden updates are used converges superlinearly, even though the matrices ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"Smb1PlQFAV"},{"type":"inlineMath","value":"\\mathbf{A}_k","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QUneAqpGO6"},{"type":"text","value":" do not necessarily converge to the Jacobian of ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"aUTDOJ187n"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"wxXqOa5vWI"},{"type":"text","value":".","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"KwQaeGAc8q"}],"indexEntries":[{"entry":"outer product","emphasis":false}],"label":"index-BQ1uEsjqnh","identifier":"index-bq1uesjqnh","html_id":"index-bq1uesjqnh","key":"jaID2gAo7y"},{"type":"paragraph","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"In practice, one typically uses finite differences to initialize the Jacobian at iteration ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"nUuKPUcT06"},{"type":"inlineMath","value":"k=1","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">k=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"kZhCwnpBXU"},{"type":"text","value":". If for some ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"LNNQIHenks"},{"type":"inlineMath","value":"k","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"sHqWJjfjml"},{"type":"text","value":" the step computed by the update formula fails to make enough improvement in the residual, then ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"uq62D6pOJ6"},{"type":"inlineMath","value":"\\mathbf{A}_k","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"nl9c366Gfw"},{"type":"text","value":" is reinitialized by finite differences and the step is recalculated.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"vYJp7VXvT8"}],"key":"Ny7huAz9CL"},{"type":"heading","depth":2,"position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"ww2imFNeYl"}],"identifier":"levenbergs-method","label":"Levenberg’s method","html_id":"levenbergs-method","implicit":true,"enumerator":"4.6.3","key":"c027Ia6PEf"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"The most difficult part of many rootfinding problems is finding a starting point that will lead to convergence. The linear model implicitly constructed during a Newton iteration—whether we use an exact, finite-difference, or iteratively updated Jacobian matrix—becomes increasingly inaccurate as one ventures farther from the most recent root estimate, eventually failing to resemble the exact function much at all.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"f4CxzStycy"}],"key":"mk7bWr9Q3o"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"Although one could imagine trying to do a detailed accuracy analysis of each linear model as we go, in practice simple strategies are valuable here. Suppose, after computing the step suggested by the linear model, we ask a binary question: Would taking that step improve our situation? Since we are trying to find a root of ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"zyLxPOP1vC"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"n7x1ydfBMf"},{"type":"text","value":", we have a quantitative way to pose this question: Does the backward error ","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"JyssOwaPOC"},{"type":"inlineMath","value":"\\|\\mathbf{f}\\|","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mord\">∥</span></span></span></span>","key":"mwxm6tLcYb"},{"type":"text","value":" decrease? If not, we should reject the step and find an alternative.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"EFmVaK0kqO"}],"key":"J2YCp5BhSJ"},{"type":"paragraph","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"There are several ways to find alternatives to the standard step, but we will consider just one of them, based on the parameterized equation","position":{"start":{"line":129,"column":1},"end":{"line":129,"column":1}},"key":"AKjfjMAmpj"}],"key":"CSLX1QGQo1"},{"type":"math","value":"  (\\mathbf{A}_k^T \\mathbf{A}_k + \\lambda \\mathbf{I})\\,\\mathbf{s}_k = -\\mathbf{A}_k^T \\mathbf{f}_k.","label":"levenberg","identifier":"levenberg","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><msubsup><mi mathvariant=\"bold\">A</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><mo>+</mo><mi>λ</mi><mi mathvariant=\"bold\">I</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><mo>−</mo><msubsup><mi mathvariant=\"bold\">A</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant=\"bold\">f</mi><mi>k</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  (\\mathbf{A}_k^T \\mathbf{A}_k + \\lambda \\mathbf{I})\\,\\mathbf{s}_k = -\\mathbf{A}_k^T \\mathbf{f}_k.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord mathbf\">I</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1383em;vertical-align:-0.247em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.9","html_id":"levenberg","key":"Zq940NBkTM"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"byZLCEFtKF"}],"key":"s4F8Hs82Rk"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"Given ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"iGRoEl6049"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"NKnG7seYdW"},{"type":"text","value":", a starting value ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"nFhRmFVaIq"},{"type":"inlineMath","value":"\\mathbf{x}_1","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Dwlk5gn629"},{"type":"text","value":", and a scalar ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"yrwUlGK8Xg"},{"type":"text","value":"λ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"VLgBiY4uX5"},{"type":"text","value":", for each ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"VQg0irZy0n"},{"type":"inlineMath","value":"k=1,2,3,\\ldots","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mo>…</mo></mrow><annotation encoding=\"application/x-tex\">k=1,2,3,\\ldots</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span></span></span></span>","key":"dAnuoqm9gF"}],"key":"QeTqugxTzB"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":143,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"Compute ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"Rfx8qFiqPY"},{"type":"inlineMath","value":"\\mathbf{y}_k = \\mathbf{f}(\\mathbf{x}_k)","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">y</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}_k = \\mathbf{f}(\\mathbf{x}_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.016em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"T9qyqQSWIL"},{"type":"text","value":", and let ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"XwFaADJYM7"},{"type":"inlineMath","value":"\\mathbf{A}_k","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"OktaAnWFAt"},{"type":"text","value":" be an exact or approximate Jacobian matrix.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"zQ8OvRxmDj"}],"key":"vf21MLb0te"},{"type":"listItem","spread":true,"position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"Solve the linear system ","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"HpoNI91PFx"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"TG3pGsVe55"},{"type":"text","value":"4.6.9","key":"PvIxpEuO31"},{"type":"text","value":")","key":"JSWYCvWTC8"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"elaTC97eOt"},{"type":"text","value":" for ","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"RD3lPxXTQc"},{"type":"inlineMath","value":"\\mathbf{s}_k","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{s}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iODhqlJ4rN"},{"type":"text","value":".","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"Qmi6y5Jzcs"}],"key":"BYy7RtID6W"},{"type":"listItem","spread":true,"position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"EfoUNZScbJ"},{"type":"inlineMath","value":"\\hat{\\mathbf{x}} = \\mathbf{x}_k + \\mathbf{s}_k","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">x</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo>+</mo><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{x}} = \\mathbf{x}_k + \\mathbf{s}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7079em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7079em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">x</span></span><span style=\"top:-3.0134em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"dEQLSpNV3e"},{"type":"text","value":".","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"FNzWQbGMxX"}],"key":"pxzsBTHyca"},{"type":"listItem","spread":true,"position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"If the residual is reduced at ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"yOXHCCxW67"},{"type":"inlineMath","value":"\\hat{\\mathbf{x}}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{x}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7079em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7079em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">x</span></span><span style=\"top:-3.0134em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"WFQO4sHkiA"},{"type":"text","value":", then let ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"QZHlkh3dhd"},{"type":"inlineMath","value":"\\mathbf{x}_{k+1}=\\hat{\\mathbf{x}}","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mover accent=\"true\"><mi mathvariant=\"bold\">x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_{k+1}=\\hat{\\mathbf{x}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7079em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7079em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">x</span></span><span style=\"top:-3.0134em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"W2hhWWGnQW"},{"type":"text","value":".","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"y64gWe0RPe"}],"key":"nTFJydXc76"},{"type":"listItem","spread":true,"position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"Update ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"jQntVNfp63"},{"type":"text","value":"λ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"qSa4If9iGt"},{"type":"text","value":" and update ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"JbuYtEQobi"},{"type":"inlineMath","value":"\\mathbf{A}_k","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TVSoSwToIN"},{"type":"text","value":" to ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"r4dniV0sCM"},{"type":"inlineMath","value":"\\mathbf{A}_{k+1}","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_{k+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"U0z8aqqMNY"},{"type":"text","value":".","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"gX4B9HGTHv"}],"key":"pZv0nLI9v6"}],"key":"EQzciUqCTJ"}],"label":"algorithm-nonlineqn-levenberg","identifier":"algorithm-nonlineqn-levenberg","html_id":"algorithm-nonlineqn-levenberg","indexEntries":[{"entry":"Levenberg's method","emphasis":true}],"enumerator":"4.6.2","key":"jXGhw23rkO"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"Some justification of ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"sKarRaMzeW"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"NtUKky4rwY"},{"type":"text","value":"4.6.9","key":"Vmwhd2Xf4s"},{"type":"text","value":")","key":"I7ezK2AbiP"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"TgZxSrubxH"},{"type":"text","value":" comes from considering extreme cases for ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"hCvGXUmkvW"},{"type":"text","value":"λ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"c6M4nykfB4"},{"type":"text","value":". If ","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"HpQ2lx8ApP"},{"type":"inlineMath","value":"\\lambda=0","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"pLgLij09FD"},{"type":"text","value":", then","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"J8xpYqABSP"}],"key":"lzGkS6DjJS"},{"type":"math","value":"  \\mathbf{A}_k^T \\mathbf{A}_k \\mathbf{s}_k = -\\mathbf{A}_k^T \\mathbf{f}_k,","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi mathvariant=\"bold\">A</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><mo>−</mo><msubsup><mi mathvariant=\"bold\">A</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant=\"bold\">f</mi><mi>k</mi></msub><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">  \\mathbf{A}_k^T \\mathbf{A}_k \\mathbf{s}_k = -\\mathbf{A}_k^T \\mathbf{f}_k,</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1383em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1383em;vertical-align:-0.247em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"4.6.10","key":"YHf00XQxdY"},{"type":"paragraph","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"children":[{"type":"text","value":"which is equivalent to the definition of the usual linear model (i.e., Newton or quasi-Newton) step ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"jdlQZq7SBJ"},{"type":"crossReference","kind":"equation","identifier":"quasinewton-step","label":"quasinewton-step","children":[{"type":"text","value":"(","key":"NOUkOShiMf"},{"type":"text","value":"4.6.5","key":"ukJMW9krM2"},{"type":"text","value":")","key":"O39wCxEfVd"}],"template":"(%s)","enumerator":"4.6.5","resolved":true,"html_id":"quasinewton-step","key":"zDtKhcG73z"},{"type":"text","value":". On the other hand, as ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"tUVLtotQ9E"},{"type":"inlineMath","value":"\\lambda\\to\\infty","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda\\to\\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"EHoICCEvUc"},{"type":"text","value":", Equation ","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"SNFKXpOs4v"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"Cto5asOZEx"},{"type":"text","value":"4.6.9","key":"oHaEMsyLb6"},{"type":"text","value":")","key":"DuFVQz1yNZ"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"K9h5kGXgqe"},{"type":"text","value":" approaches","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"SfIvVFAd41"}],"key":"sXi0mzUvTW"},{"type":"math","value":"  \\lambda \\mathbf{s}_k = - \\mathbf{A}_k^T \\mathbf{f}_k.","label":"steepest","identifier":"steepest","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>λ</mi><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub><mo>=</mo><mo>−</mo><msubsup><mi mathvariant=\"bold\">A</mi><mi>k</mi><mi>T</mi></msubsup><msub><mi mathvariant=\"bold\">f</mi><mi>k</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  \\lambda \\mathbf{s}_k = - \\mathbf{A}_k^T \\mathbf{f}_k.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1383em;vertical-align:-0.247em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.11","html_id":"steepest","key":"Tb8BTMm2Pe"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"To interpret this equation, define the scalar residual function","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"MlETrHPV2k"}],"key":"OC4Afa4mBz"},{"type":"math","value":"\\phi(\\mathbf{x})=\\mathbf{f}(\\mathbf{x})^T\\mathbf{f}(\\mathbf{x}) = \\|\\mathbf{f}(\\mathbf{x})\\|^2.","position":{"start":{"line":165,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>ϕ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\phi(\\mathbf{x})=\\mathbf{f}(\\mathbf{x})^T\\mathbf{f}(\\mathbf{x}) = \\|\\mathbf{f}(\\mathbf{x})\\|^2.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.12","key":"pu1Fndxqxd"},{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"Finding a root of ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"pTyUlhhbcW"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"N7Xxj4Qazj"},{"type":"text","value":" is equivalent to minimizing ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"shvJNl82vL"},{"type":"text","value":"ϕ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"F7lh3vSv8X"},{"type":"text","value":". A calculation shows that the gradient of ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"ubdKsZhBjJ"},{"type":"text","value":"ϕ","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"A9PkcQk4ed"},{"type":"text","value":" is","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"ZYjzwnr81s"}],"key":"ttkf3mKVKW"},{"type":"math","value":"   \\nabla \\phi(\\mathbf{x}) = 2 \\mathbf{J}(\\mathbf{x})^T \\mathbf{f}(\\mathbf{x}).","label":"nlsgradient","identifier":"nlsgradient","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">∇</mi><mi>ϕ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">   \\nabla \\phi(\\mathbf{x}) = 2 \\mathbf{J}(\\mathbf{x})^T \\mathbf{f}(\\mathbf{x}).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∇</span><span class=\"mord mathnormal\">ϕ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.13","html_id":"nlsgradient","key":"yLGEXCrgsY"},{"type":"paragraph","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"text","value":"Hence, if ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"ZJ8jQy6Rf9"},{"type":"inlineMath","value":"\\mathbf{A}_k=\\mathbf{J}(\\mathbf{x}_k)","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mi>k</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_k=\\mathbf{J}(\\mathbf{x}_k)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"VzC31H84uI"},{"type":"text","value":", then ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"FYgWlwNz0H"},{"type":"inlineMath","value":"\\mathbf{s}_k","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{s}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"WrlUhG5zrT"},{"type":"text","value":" from ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"OwBMLBhrMh"},{"type":"crossReference","kind":"equation","identifier":"steepest","label":"steepest","children":[{"type":"text","value":"(","key":"GkJEkvw6uG"},{"type":"text","value":"4.6.11","key":"S9wPLEeDgD"},{"type":"text","value":")","key":"ZoMno4vTd9"}],"template":"(%s)","enumerator":"4.6.11","resolved":true,"html_id":"steepest","key":"Eec2h6IXUk"},{"type":"text","value":" is in the opposite direction from the gradient vector. In vector calculus you learn that this direction is the one of most rapid decrease or ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"X7YH9EKdei"},{"type":"strong","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"text","value":"steepest descent","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"vNzLusxZ4a"}],"key":"FuSkKjzXuF"},{"type":"text","value":". A small enough step in this direction is guaranteed in all but pathological cases to decrease ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"LgzZGibP6x"},{"type":"text","value":"ϕ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"qkQJxHsnVF"},{"type":"text","value":", which is exactly what we want from a backup plan.","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"o8TyIB7s7u"}],"indexEntries":[{"entry":"steepest descent","emphasis":false}],"label":"index-uZmUWQJOTx","identifier":"index-uzmuwqjotx","html_id":"index-uzmuwqjotx","key":"RCm6xDorFs"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"In effect, the ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"xdhPueLQ7A"},{"type":"text","value":"λ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"RyE6NZrPmI"},{"type":"text","value":" parameter in ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"blJDPoyZLp"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"tAwMCb9Uhc"},{"type":"text","value":"4.6.9","key":"uvAuiUk1Rm"},{"type":"text","value":")","key":"kbGvmpDF60"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"MAjugc5jbW"},{"type":"text","value":" allows a smooth transition between the pure Newton step, for which convergence is very rapid near a root, and a small step in the gradient descent direction, which guarantees progress for the iteration when we are far from a root.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"SNoMfgrwmV"}],"key":"dAMI9i7XE7"},{"type":"heading","depth":2,"position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Implementation","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"GF1Zr8dFUp"}],"identifier":"implementation","label":"Implementation","html_id":"implementation","implicit":true,"enumerator":"4.6.4","key":"qC4kSJGQ7M"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"To a large extent, the incorporation of finite differences, Jacobian updates, and Levenberg step are independent decisions. ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"iMqceZtGdW"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"xZ3TiLnWfu"},{"type":"text","value":"4.6.3","key":"KKSpdej5G6"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","key":"zCIY1yfH2e"},{"type":"text","value":" shows how they might be combined. This function is one of the most logically complex we have encountered so far.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"cyf452jEUo"}],"key":"qLhg5d3dLg"},{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Each pass through the loop starts by using ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"CsnZFM2nem"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"IhbqGfyEqA"},{"type":"text","value":"4.6.9","key":"P1oEzZqksf"},{"type":"text","value":")","key":"hsIk7RgQi6"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"BbPEmX55tA"},{"type":"text","value":" to propose a step ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"knEUCg3Vl6"},{"type":"inlineMath","value":"\\mathbf{s}_k","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">s</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{s}_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cr0tGtn203"},{"type":"text","value":". The function then asks whether using this step would decrease the value of ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"n9mRcA6Fek"},{"type":"inlineMath","value":"\\|\\mathbf{f}\\|","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mord\">∥</span></span></span></span>","key":"G97f9HmlU7"},{"type":"text","value":" from its present value. If so, we accept the new root estimate, we decrease ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"awURvjKOii"},{"type":"text","value":"λ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"dbTc9teElP"},{"type":"text","value":" in order to get more Newton-like (since things have gone well), and we apply the Broyden formula to get a cheap update of the Jacobian. If the proposed step is not successful, we increase ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"YBIrCrVA4o"},{"type":"text","value":"λ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"uGDKAHeEt7"},{"type":"text","value":" to get more gradient-like (since we just failed) and, if the current Jacobian was the result of a cheap update, use finite differences to reevaluate it.","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"Y1td7jO8L5"}],"key":"AYM281dIH0"},{"type":"proof","kind":"algorithm","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"levenberg","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"kdMJZn8pee"}],"key":"ydo5Nhdt43"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter4","label":"function-levenberg-julia","kind":"Notebook","slug":"chapter4","location":"/julia/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"QeqsX8ecjh"}],"key":"vbPKcS4lZq"},{"type":"include","file":"FNCFunctions/src/chapter04.jl","literal":true,"filter":{"startAfter":"# begin levenberg","endBefore":"# end levenberg"},"children":[{"type":"code","value":"\"\"\"\n    levenberg(f, x₁ [;maxiter, ftol, xtol])\n\nUse Levenberg's quasi-Newton iteration to find a root of the system\n`f` starting from `x₁` Returns the history of root estimates as a\nvector of vectors.\n\nThe optional keyword parameters set the maximum number of iterations\nand the stopping tolerance for values of `f` and changes in `x`.\n\n\"\"\"\nfunction levenberg(f, x₁; maxiter = 40, ftol = 1e-12, xtol = 1e-12)\n    x = [float(x₁)]\n    yₖ = f(x₁)\n    k = 1\n    s = Inf\n    A = fdjac(f, x[k], yₖ)   # start with FD Jacobian\n    jac_is_new = true\n\n    λ = 10\n    while (norm(s) > xtol) && (norm(yₖ) > ftol)\n        # Compute the proposed step.\n        B = A' * A + λ * I\n        z = A' * yₖ\n        s = -(B \\ z)\n\n        x̂ = x[k] + s\n        ŷ = f(x̂)\n\n        # Do we accept the result?\n        if norm(ŷ) < norm(yₖ)    # accept\n            λ = λ / 10   # get closer to Newton\n            # Broyden update of the Jacobian.\n            A += (ŷ - yₖ - A * s) * (s' / (s' * s))\n            jac_is_new = false\n\n            push!(x, x̂)\n            yₖ = ŷ\n            k += 1\n        else    # don't accept\n            # Get closer to gradient descent.\n            λ = 4λ\n            # Re-initialize the Jacobian if it's out of date.\n            if !jac_is_new\n                A = fdjac(f, x[k], yₖ)\n                jac_is_new = true\n            end\n        end\n\n        if k == maxiter\n            @warn \"Maximum number of iterations reached.\"\n            break\n        end\n    end\n    return x\nend","lang":"julia","showLineNumbers":true,"filename":"levenberg.jl","key":"k1mHFNjxuv"}],"key":"X8xbB0l3Rt"}],"key":"qfns1pLLeV"}],"key":"FBY5clKUMa"}],"key":"J7VdvAB7GK"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter4-1","label":"function-levenberg-matlab","kind":"Notebook","slug":"chapter4-1","location":"/matlab/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"V0sB8xuKTv"}],"key":"g8DBDnddFE"},{"type":"include","file":"FNC-matlab/levenberg.m","literal":true,"children":[{"type":"code","value":"function x = levenberg(f,x1,tol)\r\n% LEVENBERG   Quasi-Newton method for nonlinear systems.\r\n% Input:\r\n%   f         objective function \r\n%   x1        initial root approximation\r\n%   tol       stopping tolerance (default is 1e-12)\r\n% Output       \r\n%   x         array of approximations (one per column)\r\n\r\n% Operating parameters.\r\nif nargin < 3, tol = 1e-12; end\r\nftol = tol;  xtol = tol;  maxiter = 40;\r\n\r\nx = x1(:);     fk = f(x1);\r\nk = 1;  s = Inf;        \r\nAk = fdjac(f,x(:,1),fk);   % start with FD Jacobian\r\njac_is_new = true;\r\nI = eye(length(x));\r\n\r\nlambda = 10; \r\nwhile (norm(s) > xtol) && (norm(fk) > ftol) && (k < maxiter)\r\n    % Compute the proposed step.\r\n    B = Ak'*Ak + lambda*I;\r\n    z = Ak'*fk;\r\n    s = -(B\\z);\r\n\r\n    xnew = x(:,k) + s;   fnew = f(xnew);\r\n    \r\n    % Do we accept the result?\r\n    if norm(fnew) < norm(fk)    % accept\r\n        y = fnew - fk;\r\n        x(:,k+1) = xnew;  fk = fnew;  \r\n        k = k+1;\r\n        \r\n        lambda = lambda/10;  % get closer to Newton\r\n        % Broyden update of the Jacobian.\r\n        Ak = Ak + (y-Ak*s)*(s'/(s'*s));\r\n        jac_is_new = false;\r\n    else                       % don't accept\r\n        % Get closer to steepest descent.\r\n        lambda = lambda*4;\r\n        % Re-initialize the Jacobian if it's out of date.\r\n        if ~jac_is_new\r\n            Ak = fdjac(f,x(:,k),fk);\r\n            jac_is_new = true;\r\n        end\r\n    end\r\nend\r\n\r\nif (norm(fk) > 1e-3)\r\n    warning('Iteration did not find a root.')\r\nend","lang":"matlab","showLineNumbers":true,"filename":"levenberg.m","key":"V4T13CTHUK"}],"key":"jNvueLKkzd"}],"key":"YT2Q6uSNnH"}],"key":"OgSjlMCLu1"}],"key":"U3mLm1BY8G"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter4-2","label":"function-levenberg-python","kind":"Notebook","slug":"chapter4-2","location":"/python/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"LPKfYcnc5U"}],"key":"CesstsGtqM"},{"type":"include","file":"fncbook/fncbook/chapter04.py","literal":true,"filter":{"lines":[[115,169]]},"children":[{"type":"code","value":"def levenberg(f, x1, tol=1e-12):\n    \"\"\"\n    levenberg(f,x1,tol)\n\n    Use Levenberg's quasi-Newton iteration to find a root of the system f, \n    starting from x1, with tol as the stopping tolerance in both step size and residual norm. Returns root estimates as a matrix, one estimate per column.\n    \"\"\"\n\n    # Operating parameters.\n    ftol = tol\n    xtol = tol\n    maxiter = 40\n\n    n = len(x1)\n    x = np.zeros((maxiter+1, n))\n    x[0] = x1\n    fk = f(x1)\n    k = 0\n    s = 10.0\n    Ak = fdjac(f, x[0], fk)  # start with FD Jacobian\n    jac_is_new = True\n\n    lam = 10\n    while (norm(s) > xtol) and (norm(fk) > ftol) and (k < maxiter):\n        # Compute the proposed step.\n        B = Ak.T @ Ak + lam * np.eye(n)\n        z = Ak.T @ fk\n        s = -lstsq(B, z)[0]\n\n        xnew = x[k] + s\n        fnew = f(xnew)\n\n        # Do we accept the result?\n        if norm(fnew) < norm(fk):  # accept\n            y = fnew - fk\n            x[k + 1] = xnew\n            fk = fnew\n            k = k + 1\n\n            lam = lam / 10  # get closer to Newton\n            # Broyden update of the Jacobian.\n            Ak = Ak + np.outer(y - Ak @ s, s / np.dot(s, s))\n            jac_is_new = False\n        else:  # don't accept\n            # Get closer to steepest descent.\n            lam = lam * 4\n            # Re-initialize the Jacobian if it's out of date.\n            if not jac_is_new:\n                Ak = fdjac(f, x[k], fk)\n                jac_is_new = True\n\n    if norm(fk) > 1e-3:\n        warnings.warn(\"Iteration did not find a root.\")\n    return x[:k+1]\n","lang":"python","showLineNumbers":true,"filename":"levenberg.py","key":"PT5cutUjJh"}],"key":"UUAOHWevPz"}],"key":"UWlZhR5UsD"}],"key":"ZS8Rv0e2Zk"}],"key":"AhQTpaVndu"}],"key":"QBLCTeQl0L"}],"label":"function-levenberg","identifier":"function-levenberg","html_id":"function-levenberg","enumerator":"4.6.3","key":"S8NmZCZQIh"},{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"In some cases our simple logic in ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"V6LtCPt3gK"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"ZnklAbMoi9"},{"type":"text","value":"4.6.3","key":"TnbQOlOFq2"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","key":"n6Lg7KOS9x"},{"type":"text","value":" can make ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"p40AeVNg5e"},{"type":"text","value":"λ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"oNL4R2Rrkq"},{"type":"text","value":" oscillate between small and large values; several better but more complicated strategies for controlling ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"xtzue2V0Up"},{"type":"text","value":"λ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"zkD5C71zVd"},{"type":"text","value":" are known. In addition, the linear system ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"rB2j7Og7M6"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"cXMWjylUjX"},{"type":"text","value":"4.6.9","key":"L2PkLH4OWd"},{"type":"text","value":")","key":"hgLheQzSze"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"FWYGlSqKEP"},{"type":"text","value":" is usually modified to get the well-known ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"U4XObL5AGn"},{"type":"strong","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"Levenberg–Marquardt","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"Q9HkSnxyrQ"}],"key":"N7hJEwmKrk"},{"type":"text","value":" algorithm, which does a superior job in some problems as ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"Fb3FZpK7Wf"},{"type":"inlineMath","value":"\\lambda\\to \\infty","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>→</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda\\to \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span>","key":"P8Gnbj7Oyx"},{"type":"text","value":".","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"ULFVhXEHCG"}],"key":"VNruZxUJgs"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Using Levenberg’s method","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"Knlu3lZdco"}],"key":"dANEhvBwt3"},{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"embed","source":{"url":"/chapter4","label":"demo-quasi-levenberg-julia","kind":"Notebook","slug":"chapter4","location":"/julia/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","position":{"start":{"line":733,"column":1},"end":{"line":733,"column":22}},"children":[{"type":"text","value":"Example ","key":"hJM1AjERPp"},{"type":"text","value":"4.6.1","key":"jVNSzH2jZT"}],"template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"fbn6l7fPwY"}],"key":"LjPqWThZ3f"},{"type":"paragraph","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":1}},"key":"qFDClqiJkR"}],"key":"z5elgzr6Gn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = \n    [\n        exp(x[2] - x[1]) - 2,\n        x[1] * x[2] + x[3],\n        x[2] * x[3] + x[1]^2 - x[2]\n    ]","key":"Vr1PyKmUsy"},{"type":"output","id":"qO6ByxVfYxpBF4BL2RNCy","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/plain":{"content":"f (generic function with 1 method)","content_type":"text/plain"}}}],"key":"PpU7ryvKz2"}],"data":{},"key":"Yt9upjg3io"},{"type":"paragraph","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"XhtRBrx01e"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"CTGWGTClnX"},{"type":"text","value":" function.","position":{"start":{"line":746,"column":1},"end":{"line":746,"column":1}},"key":"Iln74WrYvk"}],"key":"KrqI48F3MR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x₁ = [0.0, 0.0, 0.0]\nx = FNC.levenberg(f, x₁)","key":"CANHKGJy2F"},{"type":"output","id":"x5_7UGgS0ICusCeKWvyxF","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/plain":{"content":"12-element Vector{Vector{Float64}}:\n [0.0, 0.0, 0.0]\n [-0.08396946536317919, 0.07633587873004255, 0.0]\n [-0.42205075841965206, 0.21991260740534585, 0.012997569823167984]\n [-0.48610710938504953, 0.2138968287772044, 0.09771872586402451]\n [-0.45628390809556546, 0.24211047709245145, 0.10100440258901365]\n [-0.4556388336696561, 0.23470443548745376, 0.10854665717226099]\n [-0.45839614510679244, 0.2353095686241835, 0.10739828073307472]\n [-0.45804340381597397, 0.2351212406112955, 0.10768079583159752]\n [-0.45803332584412787, 0.23511390840121466, 0.10768998049540802]\n [-0.45803327880719313, 0.23511389867393448, 0.10768999250671268]\n [-0.4580332805601996, 0.2351138998630789, 0.10768999097568899]\n [-0.458033280641234, 0.23511389991865284, 0.10768999090414473]","content_type":"text/plain"}}}],"key":"BARdTW6Msv"}],"data":{},"key":"CAhPphn4yL"},{"type":"paragraph","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":753,"column":1},"end":{"line":753,"column":1}},"key":"NhnJX0am7Z"}],"key":"ZjPeDXOLgT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]\nprintln(\"backward error = $(norm(f(r)))\")","key":"dyT7ctLMqf"},{"type":"output","id":"F8CTiP7ARnXASJPu8phLh","data":[{"output_type":"stream","name":"stdout","text":"backward error = 1.2707848769787674e-13\n"}],"key":"QUIFFeu1vp"}],"data":{},"key":"eyXWHJbw9w"},{"type":"paragraph","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"children":[{"type":"text","value":"Looking at the convergence in norm, we find a convergence rate between linear and quadratic, like with the secant method.","position":{"start":{"line":760,"column":1},"end":{"line":760,"column":1}},"key":"BYAb0VTDhV"}],"key":"BwYy76asHR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = [log(norm(r - x[k])) for k in 1:length(x)-1]\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"log error\", \"ratio\"] [eachindex(logerr) logerr ratios]","key":"kbXnxbMz9Y"},{"type":"output","id":"rW9lBAxnt4KqCep_YVNnS","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">iteration</th>\n      <th style = \"text-align: right;\">log error</th>\n      <th style = \"text-align: right;\">ratio</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">1.0</td>\n      <td style = \"text-align: right;\">-0.642465</td>\n      <td style = \"text-align: right;\">NaN</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">2.0</td>\n      <td style = \"text-align: right;\">-0.866562</td>\n      <td style = \"text-align: right;\">1.34881</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">3.0</td>\n      <td style = \"text-align: right;\">-2.27855</td>\n      <td style = \"text-align: right;\">2.62941</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">4.0</td>\n      <td style = \"text-align: right;\">-3.30839</td>\n      <td style = \"text-align: right;\">1.45197</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">5.0</td>\n      <td style = \"text-align: right;\">-4.6219</td>\n      <td style = \"text-align: right;\">1.39702</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">6.0</td>\n      <td style = \"text-align: right;\">-5.96158</td>\n      <td style = \"text-align: right;\">1.28986</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">7.0</td>\n      <td style = \"text-align: right;\">-7.5909</td>\n      <td style = \"text-align: right;\">1.2733</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">8.0</td>\n      <td style = \"text-align: right;\">-11.0733</td>\n      <td style = \"text-align: right;\">1.45876</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">9.0</td>\n      <td style = \"text-align: right;\">-16.8698</td>\n      <td style = \"text-align: right;\">1.52347</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">10.0</td>\n      <td style = \"text-align: right;\">-19.7171</td>\n      <td style = \"text-align: right;\">1.16878</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">11.0</td>\n      <td style = \"text-align: right;\">-22.8307</td>\n      <td style = \"text-align: right;\">1.15792</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"AG9OuBFR28"}],"data":{},"key":"xnd4tqyZcW"}],"key":"zB1LSloh2y"}],"key":"c69WevSvgK"}],"key":"EAkQJMH4jq"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"embed","source":{"url":"/chapter4-1","label":"demo-quasi-levenberg-matlab","kind":"Notebook","slug":"chapter4-1","location":"/matlab/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","position":{"start":{"line":660,"column":1},"end":{"line":660,"column":22}},"children":[{"type":"text","value":"Example ","key":"xLkPFc6UIt"},{"type":"text","value":"4.6.1","key":"rkXdQUS2wf"}],"template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"q5sPbJBJeA"}],"key":"tNS8sFQ9P4"},{"type":"paragraph","position":{"start":{"line":663,"column":1},"end":{"line":663,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":663,"column":1},"end":{"line":663,"column":1}},"key":"PJNN4c1V00"}],"key":"TyclajSjfB"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"xT0IxaAyU3"}],"key":"kEII7aubzo"},{"type":"paragraph","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"children":[{"type":"text","value":"A rule of thumb is that if you use a function as an input argument for another function, there needs to be an ","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"jDkl3zKFyC"},{"type":"inlineCode","value":"@","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"J6bUBmRtP2"},{"type":"text","value":" involved once: either for an anonymous definition or to reference a function defined elsewhere.","position":{"start":{"line":666,"column":1},"end":{"line":666,"column":1}},"key":"iBXDOL9GQp"}],"key":"zFcOVccsKk"},{"type":"include","file":"f45_nlsystem.m","literal":true,"children":[{"type":"code","value":"function [f, J] = nlsystem(x)\n    f = zeros(3, 1);   % ensure a column vector output\n    f(1) = exp(x(2) - x(1)) - 2;\n    f(2) = x(1) * x(2) + x(3);\n    f(3) = x(2) * x(3) + x(1)^2 - x(2);\n    J(1, :) = [-exp(x(2) - x(1)), exp(x(2) - x(1)), 0];\n    J(2, :) = [x(2), x(1), 1];\n    J(3, :) = [2 * x(1), x(3)-1, x(2)];\nend","lang":"matlab","filename":"f45_nlsystem.m","key":"cM8DH2jWZF"}],"key":"dc8rWuVkmO"}],"class":"dropdown","key":"PwVXhjtSTK"},{"type":"paragraph","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"ifHJCAhpbn"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"B5dXd0bPKR"},{"type":"text","value":" function.","position":{"start":{"line":670,"column":1},"end":{"line":670,"column":1}},"key":"Cu9rcA0JJ1"}],"key":"ALu5sut9Ju"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @f46_nlsystem;\nx1 = [0; 0; 0];   \nx = levenberg(f, x1);","key":"jWzepJtIM5"},{"type":"output","id":"G7gBHEu7Mj3bJTv1VF8w9","data":[],"key":"Nu9wf9QxPc"}],"data":{},"key":"tQdyOOtcWz"},{"type":"paragraph","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":676,"column":1},"end":{"line":676,"column":1}},"key":"ono4HGey20"}],"key":"nmxlHeItxR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = x(:, end)\nbackward_err = norm(f(r))","key":"LsxgjAMmrU"},{"type":"output","id":"X0B7MoOvY_Tu3MQWahbq0","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = 3×1 double\n  -4.5803e-01\n   2.3511e-01\n   1.0769e-01\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>backward_err = \n   1.2708e-13\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"backward_err = \n   1.2708e-13\n","content_type":"text/plain"}}}],"key":"Si4ZwiTYaR"}],"data":{},"key":"dFSYOktPUp"},{"type":"paragraph","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"children":[{"type":"text","value":"Looking at the convergence of the first component, we find a rate between linear and quadratic, like with the secant method.","position":{"start":{"line":681,"column":1},"end":{"line":681,"column":1}},"key":"j6a7OryTIt"}],"key":"z07igCKeHs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"log10( abs(x(1, 1:end-1) - r(1)) )'","key":"qKjzO7i2zT"},{"type":"output","id":"Ilc94CLddO0HWl9QXVVW2","data":[{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 11×1 double\n  -3.3910e-01\n  -4.2705e-01\n  -1.4439e+00\n  -1.5517e+00\n  -2.7571e+00\n  -2.6208e+00\n  -3.4403e+00\n  -4.9947e+00\n  -7.3448e+00\n  -8.7366e+00\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 11×1 double\n  -3.3910e-01\n  -4.2705e-01\n  -1.4439e+00\n  -1.5517e+00\n  -2.7571e+00\n  -2.6208e+00\n  -3.4403e+00\n  -4.9947e+00\n  -7.3448e+00\n  -8.7366e+00\n...","content_type":"text/plain"}}}],"key":"LP56QmIgpd"}],"data":{},"key":"RA60grZTUy"}],"key":"Bxx54xHNTw"}],"key":"UPs1peuqME"}],"key":"cQmlrfdvmg"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"embed","source":{"url":"/chapter4-2","label":"demo-quasi-levenberg-python","kind":"Notebook","slug":"chapter4-2","location":"/python/chapter4.md","title":"Chapter 4"},"children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-quasi-levenberg","label":"demo-quasi-levenberg","kind":"proof:example","position":{"start":{"line":735,"column":1},"end":{"line":735,"column":22}},"children":[{"type":"text","value":"Example ","key":"dur5Haz2e4"},{"type":"text","value":"4.6.1","key":"eMfrODut8a"}],"template":"Example %s","enumerator":"4.6.1","resolved":true,"html_id":"demo-quasi-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"ei8LXS0CFX"}],"key":"cmwCWTnGax"},{"type":"paragraph","position":{"start":{"line":737,"column":1},"end":{"line":737,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":737,"column":1},"end":{"line":737,"column":1}},"key":"RqcNKefB25"}],"key":"WGytdWjcPp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def func(x):\n    return array([\n        exp(x[1] - x[0]) - 2, \n        x[0] * x[1] + x[2], \n        x[1] * x[2] + x[0]**2 - x[1]\n    ])","key":"eF9W6hlTsO"},{"type":"output","id":"e-fhBxo8nbHtSOQDsnPg9","data":[],"key":"s6uqB3q84L"}],"data":{},"key":"WrXDkkp9LJ"},{"type":"paragraph","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"key":"IPeqMWMyrs"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"key":"EcMVfcJn1N"},{"type":"text","value":" function.","position":{"start":{"line":748,"column":1},"end":{"line":748,"column":1}},"key":"cZfx4Xft8p"}],"key":"pcws7qAUZT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = zeros(3)\nx = FNC.levenberg(func, x1)\nprint(f\"Took {len(x) - 1} iterations.\")","key":"ge0nx1IAhU"},{"type":"output","id":"dveJfE65SnwrrYN1-3Mkq","data":[{"output_type":"stream","name":"stdout","text":"Took 11 iterations.\n"}],"key":"CvxhkfWZRh"}],"data":{},"key":"nhvsx3ySbW"},{"type":"paragraph","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":756,"column":1},"end":{"line":756,"column":1}},"key":"OvJ7SZJ30G"}],"key":"YQCOJ8ShRw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r = x[-1]\nprint(\"backward error:\", norm(func(r)))","key":"iTqBRf272f"},{"type":"output","id":"DnInyQOksBbBpRQox5PgV","data":[{"output_type":"stream","name":"stdout","text":"backward error: 1.2708308198538738e-13\n"}],"key":"xtcjhrzGdm"}],"data":{},"key":"qzzGuNsB95"},{"type":"paragraph","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"children":[{"type":"text","value":"Looking at the convergence in norm, we find a convergence rate between linear and quadratic, like with the secant method:","position":{"start":{"line":762,"column":1},"end":{"line":762,"column":1}},"key":"zoXs6BnYvB"}],"key":"nIhKYVOAZX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logerr = [log(norm(x[k] - r)) for k in range(len(x) - 1)]\nfor k in range(len(logerr) - 1):\n    print(logerr[k+1] / logerr[k])","key":"Ezd4In3J1e"},{"type":"output","id":"6ait7jyz0jqv9xtuDO9bc","data":[{"output_type":"stream","name":"stdout","text":"1.3488093916747845\n2.6294109965748875\n1.4519728849832465\n1.3970235480592712\n1.2898554702767009\n1.273302844194998\n1.458758688582501\n1.5234698304213956\n1.1687771474875415\n1.1579168503648603\n"}],"key":"tPW2xDlD9s"}],"data":{},"key":"mk6xZT7qd9"}],"key":"CG0sS4yiKr"}],"key":"ElJ9ORpPUx"}],"key":"Q6HIyKRLEx"}],"key":"DpC4bbzNUU"}],"label":"demo-quasi-levenberg","identifier":"demo-quasi-levenberg","html_id":"demo-quasi-levenberg","enumerator":"4.6.1","key":"hg1bAksNfY"},{"type":"heading","depth":2,"position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"N62nVpg1j6"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"4.6.5","key":"D5EqU4LKT8"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":240,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":240,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"⌨ (Variation on ","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"PAv4iYg8Nr"},{"type":"crossReference","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"Exercise 4.5.2","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"IRsdwiJM1i"}],"identifier":"problem-newtonsys-spherepotential","label":"problem-newtonsys-spherepotential","kind":"list","template":"List","resolved":true,"html_id":"problem-newtonsys-spherepotential","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"OK7qa8xRxp"},{"type":"text","value":".) Two curves in the ","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"fyTpXVE9gV"},{"type":"inlineMath","value":"(u,v)","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><mi>v</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(u,v)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mclose\">)</span></span></span></span>","key":"kbszZuh0RI"},{"type":"text","value":" plane are defined implicitly by the equations ","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"Gjp52FEF7P"},{"type":"inlineMath","value":"u\\log u + v \\log v = -0.3","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mi>log</mi><mo>⁡</mo><mi>u</mi><mo>+</mo><mi>v</mi><mi>log</mi><mo>⁡</mo><mi>v</mi><mo>=</mo><mo>−</mo><mn>0.3</mn></mrow><annotation encoding=\"application/x-tex\">u\\log u + v \\log v = -0.3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.3</span></span></span></span>","key":"FJ9X8vpsPg"},{"type":"text","value":" and ","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"AMOYQi6VcS"},{"type":"inlineMath","value":"u^4 + v^2 = 1","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mn>4</mn></msup><mo>+</mo><msup><mi>v</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u^4 + v^2 = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"SmO6I8r68V"},{"type":"text","value":".","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"nCKMoEoBi1"}],"key":"JUpfuIIA31"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"strong","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"Qf4UE8hpHz"}],"key":"rFlnvugpOJ"},{"type":"text","value":" ✍ Write the intersection of these curves in the form ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"XQnj5uyoRV"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{x}) = \\boldsymbol{0}","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">0</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x}) = \\boldsymbol{0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">0</span></span></span></span></span></span>","key":"FG1gTE8VjR"},{"type":"text","value":" for two-dimensional ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"oK9xXkDcSl"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"x7LdLhUuF6"},{"type":"text","value":" and ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"NpAjWvotdx"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"owc4ZHNMD9"},{"type":"text","value":".","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"S4H0AQjuWu"}],"key":"w9uESoQsBU"},{"type":"paragraph","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"strong","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"Su0cXL4a4M"}],"key":"aWJIglVyaE"},{"type":"text","value":" ⌨ Use ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"CSLoipn67K"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"zfzsh9tXFO"},{"type":"text","value":"4.6.3","key":"GW2M6AX2TZ"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","key":"LGQDoWOMeU"},{"type":"text","value":" to find an intersection point starting from ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"J9MO2KCvXm"},{"type":"inlineMath","value":"u=1","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"ihI0p4Orcl"},{"type":"text","value":", ","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"Eyld216INo"},{"type":"inlineMath","value":"v=0.1","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">v=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"u8hdeOf4Zv"},{"type":"text","value":".","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":1}},"key":"zN02gYpo6v"}],"key":"rT96saWMlU"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"strong","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"(d)","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"BBRG6ycPNs"}],"key":"iyr9YgRdB0"},{"type":"text","value":" ⌨ Use ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"iwSHWqAvIz"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"DcjQySNwNF"},{"type":"text","value":"4.6.3","key":"WfYhV6qVhN"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","key":"XBDY9OwAB0"},{"type":"text","value":" to find an intersection point starting from ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"ZXADNWxgIS"},{"type":"inlineMath","value":"u=0.1","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">u=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.1</span></span></span></span>","key":"cY8e9tFU0e"},{"type":"text","value":", ","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"X225ARWBAH"},{"type":"inlineMath","value":"v=1","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">v=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"dwlHakoyN7"},{"type":"text","value":".","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"JNviSjyrnN"}],"key":"qmpGrPKh1A"}],"key":"c3xq3qFdNW"},{"type":"listItem","spread":true,"position":{"start":{"line":248,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"⌨ (Variation on ","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"dZYV4WXnE4"},{"type":"crossReference","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"Exercise 4.5.4","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"OXHJ2i8I1B"}],"identifier":"problem-newtonsys-orbitintersect","label":"problem-newtonsys-orbitintersect","kind":"list","template":"List","resolved":true,"html_id":"problem-newtonsys-orbitintersect","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"u4l50B1xSk"},{"type":"text","value":") Two elliptical orbits ","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"F5KsXKAPEr"},{"type":"inlineMath","value":"(x_1(s),y_1(s))","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_1(s),y_1(s))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">))</span></span></span></span>","key":"lxgzK0Z0zy"},{"type":"text","value":" and ","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"KHvgxbhTKJ"},{"type":"inlineMath","value":"(x_2(t),y_2(t))","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_2(t),y_2(t))</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">))</span></span></span></span>","key":"XLmVuUAvnF"},{"type":"text","value":" are described by the equations","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"GqnzMUNfmf"}],"key":"yKOSdpdk83"},{"type":"math","value":"\\begin{bmatrix}\n  x_1(t) \\\\ y_1(t)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n  -5+10\\cos(t) \\\\ 6\\sin(t)\n\\end{bmatrix}, \\qquad\n\\begin{bmatrix}\n  x_2(t)\\\\y_2(t)\n\\end{bmatrix} =\n\\begin{bmatrix}\n  8\\cos(t) \\\\ 1+12\\sin(t)\n\\end{bmatrix},","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>5</mn><mo>+</mo><mn>10</mn><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>6</mn><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo><mspace width=\"2em\"/><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>y</mi><mn>2</mn></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>8</mn><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>1</mn><mo>+</mo><mn>12</mn><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n  x_1(t) \\\\ y_1(t)\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n  -5+10\\cos(t) \\\\ 6\\sin(t)\n\\end{bmatrix}, \\qquad\n\\begin{bmatrix}\n  x_2(t)\\\\y_2(t)\n\\end{bmatrix} =\n\\begin{bmatrix}\n  8\\cos(t) \\\\ 1+12\\sin(t)\n\\end{bmatrix},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">10</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">6</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">8</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">12</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"4.6.14","key":"bT3PlqmmfG"},{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"jimaAQdLx9"},{"type":"inlineMath","value":"t","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"qEhShOST1y"},{"type":"text","value":" represents time.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"gUN0PGe9an"}],"key":"l7jgMnfq3h"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"strong","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"KECjrcAI9Q"}],"key":"Kuc4ZZMu9G"},{"type":"text","value":" ✍ Write out a ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"eZZn0zwwFk"},{"type":"inlineMath","value":"2\\times 2","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2\\times 2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"NN3avuaGSt"},{"type":"text","value":" nonlinear system of equations that describes an intersection of these orbits. (Note: An intersection is not the same as a collision—they don’t have to occupy the same point at the same time.)","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"efuasIE4YW"}],"key":"aDlcuOKcZd"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"strong","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"VByjpD9RaM"}],"key":"eUrjYzDi5K"},{"type":"text","value":" ⌨ Use ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"cksWPZc5Ay"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"q3Z3mSLF3l"},{"type":"text","value":"4.6.3","key":"BqcAwFxLRG"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","key":"bMm2eBzrrN"},{"type":"text","value":" to find all of the unique intersections.","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"o77g3JYssY"}],"key":"a6iqDr4Kif"}],"key":"DfwgJrW574"},{"type":"listItem","spread":true,"position":{"start":{"line":272,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"⌨  (Variation on ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"LYFGEDg6BI"},{"type":"crossReference","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"Exercise 4.5.5","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"FrbjVHN7xR"}],"identifier":"problem-newtonsys-ellipsemin","label":"problem-newtonsys-ellipsemin","kind":"list","template":"List","resolved":true,"html_id":"problem-newtonsys-ellipsemin","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"XHj1psOTVY"},{"type":"text","value":") Suppose one wants to find the points on the ellipsoid ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"TQiwaUGiaP"},{"type":"inlineMath","value":"x^2/25 + y^2/16 + z^2/9 = 1","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mi mathvariant=\"normal\">/</mi><mn>25</mn><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mi mathvariant=\"normal\">/</mi><mn>16</mn><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup><mi mathvariant=\"normal\">/</mi><mn>9</mn><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x^2/25 + y^2/16 + z^2/9 = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">/25</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">/16</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mord\">/9</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"zUc8v9c10V"},{"type":"text","value":" that are closest to and farthest from the point ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"jBNiXGyriT"},{"type":"inlineMath","value":"(5,4,3)","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>4</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(5,4,3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span></span>","key":"j67Ue3aQSs"},{"type":"text","value":". The method of Lagrange multipliers implies that any such point satisfies","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"sRonA73uo3"}],"key":"sDnLUJJ6yw"},{"type":"math","value":"\\begin{split}\n    x-5 &= \\frac{\\lambda x}{25}, \\\\[1mm]\n    y-4 &= \\frac{\\lambda y}{16}, \\\\[1mm]\n    z-3 &= \\frac{\\lambda z}{9}, \\\\[1mm]\n    1 &=  \\frac{1}{25}x^2 + \\frac{1}{16}y^2 + \\frac{1}{9}z^2\n\\end{split}","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>x</mi><mo>−</mo><mn>5</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi><mi>x</mi></mrow><mn>25</mn></mfrac><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>y</mi><mo>−</mo><mn>4</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi><mi>y</mi></mrow><mn>16</mn></mfrac><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>z</mi><mo>−</mo><mn>3</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi><mi>z</mi></mrow><mn>9</mn></mfrac><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mn>25</mn></mfrac><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mfrac><mn>1</mn><mn>16</mn></mfrac><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><mfrac><mn>1</mn><mn>9</mn></mfrac><msup><mi>z</mi><mn>2</mn></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{split}\n    x-5 &amp;= \\frac{\\lambda x}{25}, \\\\[1mm]\n    y-4 &amp;= \\frac{\\lambda y}{16}, \\\\[1mm]\n    z-3 &amp;= \\frac{\\lambda z}{9}, \\\\[1mm]\n    1 &amp;=  \\frac{1}{25}x^2 + \\frac{1}{16}y^2 + \\frac{1}{9}z^2\n\\end{split}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:9.3798em;vertical-align:-4.4399em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.9399em;\"><span style=\"top:-6.9399em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">5</span></span></span><span style=\"top:-4.5824em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">4</span></span></span><span style=\"top:-2.225em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">3</span></span></span><span style=\"top:0.0824em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4399em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.9399em;\"><span style=\"top:-6.9399em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">25</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-4.5824em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">16</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.225em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">9</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:0.0824em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">25</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">16</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">9</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4399em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4.6.15","key":"LYuzoJY4EA"},{"type":"paragraph","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"children":[{"type":"text","value":"for an unknown value of ","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"J3Nk3hubER"},{"type":"text","value":"λ","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"aBTYxPfulj"},{"type":"text","value":".","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"Epn87m6gNk"}],"key":"mI37zFUF9D"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"strong","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"SiBOvImrZb"}],"key":"avCqUafQV0"},{"type":"text","value":" Write out this system in the form ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"rMfpYMH2jp"},{"type":"inlineMath","value":"\\mathbf{f}(\\mathbf{u}) = \\boldsymbol{0}","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">u</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"bold\">0</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{u}) = \\boldsymbol{0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">u</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">0</span></span></span></span></span></span>","key":"jA7SppskXr"},{"type":"text","value":". (Note that the system has four variables to go with the four equations.)","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"F9Y2PJTj8V"}],"key":"pCHIpSIXJ4"},{"type":"paragraph","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"strong","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"PBuAc0n5t3"}],"key":"J2LGcnjcfj"},{"type":"text","value":" Use ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"CRNAUVGEZw"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"Tahm0Bm3uk"},{"type":"text","value":"4.6.3","key":"v9mFxvmC3e"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","key":"rIQDLY3dP5"},{"type":"text","value":" with different initial guesses to find the two roots of this system. Which is the closest point to ","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"NOwsASniHJ"},{"type":"inlineMath","value":"(5,4,3)","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>5</mn><mo separator=\"true\">,</mo><mn>4</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(5,4,3)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span></span>","key":"pOlx82irjC"},{"type":"text","value":", and which is the farthest?","position":{"start":{"line":287,"column":1},"end":{"line":287,"column":1}},"key":"xQ48zaeILl"}],"key":"C3YCa2S4jz"}],"key":"rRbAY8of1d"},{"type":"listItem","spread":true,"position":{"start":{"line":290,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"✍ The Broyden update formula ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"vtr7K6WoD4"},{"type":"crossReference","kind":"equation","identifier":"broyden","label":"broyden","children":[{"type":"text","value":"(","key":"rtM8RDKiKK"},{"type":"text","value":"4.6.8","key":"tWd5jmNhKh"},{"type":"text","value":")","key":"X3ilT01ylq"}],"template":"(%s)","enumerator":"4.6.8","resolved":true,"html_id":"broyden","key":"kbOCoLu8ad"},{"type":"text","value":" is just one instance of so-called rank-1 updating. Verify the  ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"XfqCppwTTC"},{"type":"emphasis","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"Sherman–Morrison formula","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"JhvAus8xPE"}],"key":"veSSu6oqW9"},{"type":"text","value":",","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"v7yQyIYja3"}],"key":"QofXFYt6DO"},{"type":"math","value":"(\\mathbf{A}+\\mathbf{u}\\mathbf{v}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\frac{\\mathbf{u}\\mathbf{v}^T}{1+\\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u}}\\mathbf{A}^{-1},","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">A</mi><mo>+</mo><mi mathvariant=\"bold\">u</mi><msup><mi mathvariant=\"bold\">v</mi><mi>T</mi></msup><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant=\"bold\">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><msup><mi mathvariant=\"bold\">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mfrac><mrow><mi mathvariant=\"bold\">u</mi><msup><mi mathvariant=\"bold\">v</mi><mi>T</mi></msup></mrow><mrow><mn>1</mn><mo>+</mo><msup><mi mathvariant=\"bold\">v</mi><mi>T</mi></msup><msup><mi mathvariant=\"bold\">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant=\"bold\">u</mi></mrow></mfrac><msup><mi mathvariant=\"bold\">A</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">(\\mathbf{A}+\\mathbf{u}\\mathbf{v}^T)^{-1} = \\mathbf{A}^{-1} - \\mathbf{A}^{-1}\\frac{\\mathbf{u}\\mathbf{v}^T}{1+\\mathbf{v}^T\\mathbf{A}^{-1}\\mathbf{u}}\\mathbf{A}^{-1},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">u</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2877em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5183em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7673em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord mathbf\">u</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"4.6.16","key":"QPTtcgFymc"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"which is valid whenever ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"YGlwFC8ekp"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"IVb9rWNYLb"},{"type":"text","value":" is invertible and the denominator above is nonzero. (Hint: Show that ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"R1CmUSr3m7"},{"type":"inlineMath","value":"\\mathbf{A}+\\mathbf{u}\\mathbf{v}^T","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mo>+</mo><mi mathvariant=\"bold\">u</mi><msup><mi mathvariant=\"bold\">v</mi><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}+\\mathbf{u}\\mathbf{v}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7694em;vertical-align:-0.0833em;\"></span><span class=\"mord mathbf\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8413em;\"></span><span class=\"mord mathbf\">u</span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"kXbsicPT2T"},{"type":"text","value":" times the matrix above simplifies to the identity matrix.)","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"eFmLkx57UK"}],"key":"df55RdZGYM"}],"key":"zAuepho6QD"},{"type":"listItem","spread":true,"position":{"start":{"line":298,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"✍ Derive Equation ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"JZhJzZLXam"},{"type":"crossReference","kind":"equation","identifier":"nlsgradient","label":"nlsgradient","children":[{"type":"text","value":"(","key":"C1yeyzwo8t"},{"type":"text","value":"4.6.13","key":"UrXIEyScXK"},{"type":"text","value":")","key":"Ju7jssdiG5"}],"template":"(%s)","enumerator":"4.6.13","resolved":true,"html_id":"nlsgradient","key":"RYFQZVJmOi"},{"type":"text","value":".","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"WBmXUdZgDu"}],"key":"ansAxvwDZt"}],"key":"zx00r8f1Gl"},{"type":"listItem","spread":true,"position":{"start":{"line":300,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"⌨ (See also ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"WUhTt3TZi1"},{"type":"crossReference","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"Exercise 4.5.11","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"iejtV2oloB"}],"identifier":"problem-newtonsys-byhand","label":"problem-newtonsys-byhand","kind":"list","template":"List","resolved":true,"html_id":"problem-newtonsys-byhand","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"XxdMVtOVGg"},{"type":"text","value":".) Suppose that","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"u8hSMNdzfh"}],"key":"T26K3dYMwP"},{"type":"math","value":"\\mathbf{f}(\\mathbf{x}) =\n\\begin{bmatrix}\n  x_1x_2+x_2^2-1 \\\\[1mm] x_1x_2^3 + x_1^2x_2^2 + 1\n\\end{bmatrix}.","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo>−</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>x</mi><mn>1</mn></msub><msubsup><mi>x</mi><mn>2</mn><mn>3</mn></msubsup><mo>+</mo><msubsup><mi>x</mi><mn>1</mn><mn>2</mn></msubsup><msubsup><mi>x</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}(\\mathbf{x}) =\n\\begin{bmatrix}\n  x_1x_2+x_2^2-1 \\\\[1mm] x_1x_2^3 + x_1^2x_2^2 + 1\n\\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5923em;\"><span style=\"top:-3.7523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-2.2677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4519em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2481em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0923em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.17","key":"SVk8TqnTcv"},{"type":"paragraph","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"pTdwpibtvl"},{"type":"inlineMath","value":"\\mathbf{x}_1=[-2,1]^T","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub><mo>=</mo><mo stretchy=\"false\">[</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}_1=[-2,1]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"wcqR9FF4gi"},{"type":"text","value":" and let ","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"Zy8poaqAez"},{"type":"inlineMath","value":"\\mathbf{A}_1=\\mathbf{J}(\\mathbf{x}_1)","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">A</mi><mn>1</mn></msub><mo>=</mo><mi mathvariant=\"bold\">J</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}_1=\\mathbf{J}(\\mathbf{x}_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">J</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ryoyX84pKD"},{"type":"text","value":" be the exact Jacobian.","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"KSXqcdXpsE"}],"key":"KQBwgTmrUX"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"strong","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"mxwApOAtk3"}],"key":"YVvRfLCl32"},{"type":"text","value":" Solve ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"bPAdi0ikEB"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"JLWH0U4AwT"},{"type":"text","value":"4.6.9","key":"TOKwcI39vb"},{"type":"text","value":")","key":"HqNlyHlCip"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"Z9R9UivzPl"},{"type":"text","value":" for ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"JMWyOcMaxs"},{"type":"inlineMath","value":"\\mathbf{s}_1","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">s</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{s}_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5944em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"KEpkdqsptU"},{"type":"text","value":" with ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"gNMvXi93Tb"},{"type":"inlineMath","value":"\\lambda=0","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\lambda=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"baSbnWJdGM"},{"type":"text","value":"; this is the “pure” Newton step. Show numerically that ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"ekf8Pfp4l2"},{"type":"inlineMath","value":"\\|\\mathbf{f}(\\mathbf{x}_1+\\mathbf{s}_1)\\| > \\|\\mathbf{f}(\\mathbf{x}_1)\\|","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant=\"bold\">s</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∥</mi><mo>&gt;</mo><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}(\\mathbf{x}_1+\\mathbf{s}_1)\\| &gt; \\|\\mathbf{f}(\\mathbf{x}_1)\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∥</span></span></span></span>","key":"MTEalTHlMp"},{"type":"text","value":". (Thus, the Newton step made us go to a point seemingly farther from a root than where we started.)","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"zA89jXEfp9"}],"key":"tTGgnYZAAQ"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"strong","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"lUQ7zkGfs9"}],"key":"xDXzuT1S8o"},{"type":"text","value":" Now repeat part (a) with ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"xtJzUyCRJO"},{"type":"inlineMath","value":"\\lambda=0.01j","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.01</mn><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">\\lambda=0.01j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0.01</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"rY61WH8tWJ"},{"type":"text","value":" for ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"mvPoKd4lZk"},{"type":"inlineMath","value":"j=1,2,3,\\ldots.","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo separator=\"true\">,</mo><mo>…</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">j=1,2,3,\\ldots.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span>","key":"STJSOdb8Z9"},{"type":"text","value":" What is the smallest value of ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"L0giggOHeX"},{"type":"inlineMath","value":"j","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"EKVHGlEnh5"},{"type":"text","value":" such that ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"QpB8Vfj6nv"},{"type":"inlineMath","value":"\\|\\mathbf{f}(\\mathbf{x}_1+\\mathbf{s}_1)\\| < \\|\\mathbf{f}(\\mathbf{x}_1)\\|","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant=\"bold\">s</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∥</mi><mo>&lt;</mo><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">f</mi><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∥</mi></mrow><annotation encoding=\"application/x-tex\">\\|\\mathbf{f}(\\mathbf{x}_1+\\mathbf{s}_1)\\| &lt; \\|\\mathbf{f}(\\mathbf{x}_1)\\|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∥</span></span></span></span>","key":"JnDnFUy4ca"},{"type":"text","value":"?","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"PliHTglByy"}],"key":"QbyJv7hub3"}],"key":"AfQips4AB3"},{"type":"listItem","spread":true,"position":{"start":{"line":315,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"✍ Show that Equation ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"rQ6TiB3VAn"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"mXiFIxkEGi"},{"type":"text","value":"4.6.9","key":"BqIT6K2nhT"},{"type":"text","value":")","key":"yXZ0oChy34"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"ORkJAbhtZz"},{"type":"text","value":" is equivalent to the linear least-squares problem","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"PxPGR31mW4"}],"key":"KE6aOOHYrw"},{"type":"math","value":"\\min_{\\mathbf{v}} \\Bigl(  \\bigl\\|\\mathbf{A}_k\\mathbf{v} + \\mathbf{f}_k\\bigr\\|_2^2 +\n\\lambda^2 \\bigl\\| \\mathbf{v} \\bigr\\|_2^2 \\Bigr).","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munder><mrow><mi>min</mi><mo>⁡</mo></mrow><mi mathvariant=\"bold\">v</mi></munder><mo fence=\"true\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">(</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><msub><mi mathvariant=\"bold\">A</mi><mi>k</mi></msub><mi mathvariant=\"bold\">v</mi><mo>+</mo><msub><mi mathvariant=\"bold\">f</mi><mi>k</mi></msub><msubsup><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><msup><mi>λ</mi><mn>2</mn></msup><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><mi mathvariant=\"bold\">v</mi><msubsup><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">∥</mo><mn>2</mn><mn>2</mn></msubsup><mo fence=\"true\" stretchy=\"true\" minsize=\"1.8em\" maxsize=\"1.8em\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\min_{\\mathbf{v}} \\Bigl(  \\bigl\\|\\mathbf{A}_k\\mathbf{v} + \\mathbf{f}_k\\bigr\\|_2^2 +\n\\lambda^2 \\bigl\\| \\mathbf{v} \\bigr\\|_2^2 \\Bigr).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.85em;vertical-align:-0.7em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-2.4em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\" style=\"margin-right:0.01597em;\">v</span></span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span><span class=\"mop\">min</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7em;\"><span></span></span></span></span></span><span class=\"mopen\"><span class=\"delimsizing size2\">(</span></span><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.4657em;vertical-align:-0.3997em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.066em;\"><span style=\"top:-2.3003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.3149em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.8em;vertical-align:-0.65em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">v</span><span class=\"mclose\"><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.862em;\"><span style=\"top:-2.256em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span><span style=\"top:-2.854em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span style=\"height:0.016em;width:0.5556em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.5556em' height='0.016em' style='width:0.5556em' viewBox='0 0 555.5600000000001 16' preserveAspectRatio='xMinYMin'><path d='M145 0 H188 V16 H145z M145 0 H188 V16 H145zM367 0 H410 V16 H367z M367 0 H410 V16 H367z'/></svg></span></span><span style=\"top:-2.862em;\"><span class=\"pstrut\" style=\"height:2.606em;\"></span><span class=\"delimsizinginner delim-size1\"><span>∥</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.066em;\"><span style=\"top:-2.3003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.3149em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3997em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing size2\">)</span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4.6.18","key":"r0IO4WCobX"},{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"(Hint: Express the minimized quantity using block matrix notation, such that ","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"TMDHsTY0E0"},{"type":"crossReference","kind":"equation","identifier":"levenberg","label":"levenberg","children":[{"type":"text","value":"(","key":"yKMBvfMYt1"},{"type":"text","value":"4.6.9","key":"z75kpnr92v"},{"type":"text","value":")","key":"nBrom80r58"}],"template":"(%s)","enumerator":"4.6.9","resolved":true,"html_id":"levenberg","key":"PtasXVVa9e"},{"type":"text","value":" becomes the normal equations for it.)","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"gQK4HBnGX8"}],"key":"uXZmmulhs8"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"Thus, another interpretation of Levenberg’s method is that it is the Newton step plus a penalty, weighted by ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"I6QfLwy3C7"},{"type":"text","value":"λ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"sMDlp6GYTD"},{"type":"text","value":", for taking large steps.","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"VuHWzaJjpj"}],"key":"ZX25ELo5eu"}],"key":"AE8ozev5SL"}],"key":"fX2VCrHpCe"}],"key":"NAv3STWFO8"}],"key":"myjyEBOQTA"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Newton for nonlinear systems","url":"/newtonsys","group":"Preface"},"next":{"title":"Nonlinear least squares","url":"/nlsq","group":"Preface"}}},"domain":"http://localhost:3000"}