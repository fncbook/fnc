{"kind":"Notebook","sha256":"5ed8f9eaa5edad74898157dea12b17b069de80da5f49aa5d8ef9e9a8d8d5d689","slug":"chapter13-1","location":"/matlab/chapter13.md","dependencies":[],"frontmatter":{"title":"Chapter 13","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter13.md","url":"/fnc/build/chapter13-687771327d9b1cd37885d8cc5d6d8876.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Q8xlxJ75l2"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"Fnq9ARrTHS"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Create a tensor-product grid","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"IEeJmVd2WB"}],"key":"PXaXtGOl4b"},{"type":"include","file":"FNC-matlab/tensorgrid.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y)\n% TENSORGRID Tensor-product grid.\n% Input:\n%   x, y           1d projections of the grid nodes (lengths m and n)\n% Output:\n%   mtx            evaluate a function on the grid (function)\n%   X, Y           mtx applied to the coordinate functions (m×n)\n%   vec            convert grid shape to vector shape (function)\n%   unvec          convert vector shape to grid shape (function)\n%   is_boundary    indicator of boundary nodes (logical m×n)\n    m = length(x) - 1;\n    n = length(y) - 1;\n    vec = @(U) U(:);\n    unvec = @(u) reshape(u, m+1, n+1);\n    [X, Y] = ndgrid(x, y);\n    function F = grideval(f)\n        F = zeros(size(X));\n        for k = 1:numel(X)\n            F(k) = f(X(k), Y(k));\n        end\n    end\n    mtx = @grideval;\n    \n    % Identify boundary points.\n    is_boundary = true(m+1, n+1);\n    is_boundary(2:m, 2:n) = false;\nend","lang":"matlab","showLineNumbers":true,"filename":"tensorgrid.m","key":"hflfJ5nRdy"}],"key":"pdWKhwzg30"}],"label":"function-tensorgrid-matlab","identifier":"function-tensorgrid-matlab","html_id":"function-tensorgrid-matlab","key":"Ayuci4rQJF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of Poisson’s equation by finite differences","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"YLvPecT569"}],"key":"DnZof84wCd"},{"type":"include","file":"FNC-matlab/poissonfd.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [X, Y, U] = poissonfd(f,g,m,xspan,n,yspan)\r\n%POISSONFD   Solve Poisson's equation by finite differences.\r\n% Input:\r\n%   f            forcing function (function of x,y)\r\n%   g            boundary condition (function of x,y)\r\n%   m            number of grid points in x (integer)\r\n%   xspan        endpoints of the domain of x (2-vector)\r\n%   n            number of grid points in y (integer)\r\n%   yspan        endpoints of the domain of y (2-vector)\r\n%\r\n% Output:\r\n%   U            solution (m+1 by n+1)\r\n%   X,Y          grid matrices (m+1 by n+1)\r\n\r\n% Discretize the domain.\r\n[x, Dx, Dxx] = diffmat2(m, xspan);\r\n[y, Dy, Dyy] = diffmat2(n, yspan);\r\n[mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y);\r\n\r\n% Form the collocated PDE as a linear system. \r\nIx = speye(m+1);  Iy = speye(n+1);\r\nA = kron(Iy, sparse(Dxx)) + kron(sparse(Dyy), Ix);  % Laplacian matrix\r\nb = vec(mtx(f));\r\n\r\n% Replace collocation equations on the boundary.\r\nscale = max(abs(A(n+2, :)));\r\nI = speye(size(A));\r\nidx = vec(is_boundary);\r\nA(idx, :) = scale * I(idx, :);           % Dirichet assignment\r\nb(idx) = scale * g( X(idx),Y(idx) );     % assigned values\r\n\r\n% Solve the linear sytem and reshape the output.\r\nu = A \\ b;\r\nU = unvec(u);","lang":"matlab","showLineNumbers":true,"filename":"poissonfd.m","key":"D5IllRYvpy"}],"key":"ltBECjbLE2"}],"label":"function-poissonfd-matlab","identifier":"function-poissonfd-matlab","html_id":"function-poissonfd-matlab","key":"YqbtBwmcZm"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of elliptic ","key":"xIRlymvDGs"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"nmtVNldpVN"}],"key":"smGkzBHvMQ"},{"type":"text","value":" by Chebyshev collocation","key":"ASjWtwwc5x"}],"key":"lAQLKdFOw3"},{"type":"include","file":"FNC-matlab/elliptic.m","literal":true,"filter":{},"children":[{"type":"code","value":"function u = elliptic(phi, g, m, xspan, n, yspan)\n%ELLIPTIC   Solve an elliptic PDE in 2d.\n% Input:\n%   phi          defines phi)(x,y,u,u_x,u_xx,u_y,u_yy) = 0 (function)\n%   g            boundary condition (function)\n%   m, xspan     size and interval of x discretization (integer, 2-vector)\n%   n, yspan     size and interval of y discretization (integer, 2-vector)\n% Output:\n%   U            solution (n+1 by n+1)\n%   X,Y          coordinate matrices (n+1 by n+1)\n\n    % Discretize the domain.\n    [x, Dx, Dxx] = diffcheb(m, xspan);\n    [y, Dy, Dyy] = diffcheb(n, yspan);\n    [mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y);\n\n    % Identify boundary locations and evaluate the boundary condition.\n    idx = vec(is_boundary);\n    gb = g(X(idx), Y(idx));\n\n    % Evaluate the PDE+BC residual.\n    function r = residual(u)\n        U = unvec(u);\n        R = phi(X, Y, U, Dx * U, Dxx * U, U * Dy', U * Dyy');  % PDE\n        R(idx) = u(idx) - gb;                                  % boundary\n        r = vec(R);\n    end\n\n    % Solve the equation.\n    u = levenberg(@residual, vec(zeros(size(X))));\n    U = unvec(u(:, end));\n\n    function u = evaluate(xi, eta)\n        v = zeros(1, n+1);\n        for j = 1:n+1\n            v(j) = chebinterp(x, U(:, j), xi);\n        end\n        u = chebinterp(y, v, eta);\n    end\n\n    u = @evaluate;\nend\n\nfunction f = chebinterp(x, v, xi)\n    n = length(x) - 1;\n    w = (-1.0) .^ (0:n)';\n    w([1, n+1]) = w([1, n+1]) / 2;\n\n    terms = w ./ (xi - x(:));\n    if any(isinf(terms))     % exactly at a node\n        f = v(xi == x);\n    else\n        f = sum(v(:) .* terms) / sum(terms);\n    end\nend\n","lang":"matlab","showLineNumbers":true,"filename":"elliptic.m","key":"G5aYliausM"}],"key":"azOu5fGMFv"}],"label":"function-elliptic-matlab","identifier":"function-elliptic-matlab","html_id":"function-elliptic-matlab","key":"QgAHhWWY6i"},{"type":"heading","depth":2,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"kmI83MrN1Q"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"xrn9PsCfcZ"}],"key":"vtMRcnLvC6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"eye9om06Np"},{"type":"output","id":"VtP0r9RNJ1xBf-K4qHglL","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"kiamkCBf1l"}],"data":{"tags":[]},"visibility":"remove","key":"owVTGZReQk"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"13.1 ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"bk1cD8aO8J"},{"type":"link","identifier":"section-twodim-tensorprod","label":"section-twodim-tensorprod","kind":"narrative","position":{"start":{"line":48,"column":6},"end":{"line":48,"column":32}},"url":"/tensorprod","internal":true,"dataUrl":"/tensorprod.json","children":[{"type":"text","value":"Tensor-product discretizations","key":"JoKFjyyFOP"}],"key":"snehRXa8Fu"}],"identifier":"id-13-1","label":"13.1 ","html_id":"id-13-1","implicit":true,"key":"MgiJyer1lN"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-gridfun","label":"demo-tensorprod-gridfun","kind":"proof:example","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":25}},"children":[{"type":"text","value":"Example ","key":"H3LR2lb3Ru"},{"type":"text","value":"13.1.2","key":"qGtso96c1D"}],"template":"Example %s","enumerator":"13.1.2","resolved":true,"html_id":"demo-tensorprod-gridfun","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"YqQPkwx8HK"}],"key":"qjVA0leunD"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"Here is the grid from ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"MeTAl3eIE2"},{"type":"crossReference","kind":"proof:example","identifier":"example-tensorprod-smallgrid","label":"example-tensorprod-smallgrid","children":[{"type":"text","value":"Example ","key":"y5kCFCyDaZ"},{"type":"text","value":"13.1.1","key":"NojHZKeWvx"}],"template":"Example %s","enumerator":"13.1.1","resolved":true,"html_id":"example-tensorprod-smallgrid","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"XWdp9xsKiR"},{"type":"text","value":".","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"Vr4LijG4Rg"}],"key":"lh21uzrgAw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 4;   \nx = linspace(0, 2, m+1);\nn = 2;   \ny = linspace(1, 3, n+1);","key":"BHhNS5q7zR"},{"type":"output","id":"dMPIpjxb1zzf7PwMFbVcP","data":[],"key":"rqECXiljig"}],"data":{},"key":"DIS3uJpIOQ"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"For a given ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"vDyFDKk3x9"},{"type":"inlineMath","value":"f(x,y)","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"GMY8rOsf4t"},{"type":"text","value":" we can find ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"tihWnQOH4r"},{"type":"inlineMath","value":"\\operatorname{mtx}(f)","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">mtx</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\operatorname{mtx}(f)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">mtx</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span></span></span></span>","key":"r9AVNB5IAL"},{"type":"text","value":" by using a comprehension syntax.","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"N1PHchHGjv"}],"key":"IevdAtd2bH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[mtx, X, Y] = tensorgrid(x, y);\nf = @(x, y) cos(pi * x .* y - y);\nF = mtx(f)","key":"ywFano3WnL"},{"type":"output","id":"VlugfXtQ8IoS0fl4iwBV_","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>F = 5×3 double\n    0.5403   -0.4161   -0.9900\n    0.8415    0.4161   -0.1411\n   -0.5403   -0.4161    0.9900\n   -0.8415    0.4161    0.1411\n    0.5403   -0.4161   -0.9900\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"F = 5×3 double\n    0.5403   -0.4161   -0.9900\n    0.8415    0.4161   -0.1411\n   -0.5403   -0.4161    0.9900\n   -0.8415    0.4161    0.1411\n    0.5403   -0.4161   -0.9900\n","content_type":"text/plain"}}}],"key":"NEDKRO8uis"}],"data":{},"key":"rXezfLxZjS"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"We can make a nice plot of the function by first choosing a much finer grid. However, the contour and surface plotting functions expect the ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"KbiUCzGX2N"},{"type":"emphasis","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"transpose","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"r3RyV8miqs"}],"key":"JeGuwAuP1C"},{"type":"text","value":" of mtx(","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"fjZvLBnQJD"},{"type":"inlineMath","value":"f","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"ptTNN2KbYZ"},{"type":"text","value":").","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"OwZ6TLGzBD"}],"key":"jKh1cI35zJ"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"FUwfSRvZmE"}],"key":"E5MAB7M6Ix"},{"type":"paragraph","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"To emphasize departures from a zero level, use a colormap such as ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"Zi9HQ2iS5Q"},{"type":"inlineCode","value":"redsblues","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"f01nODRV5P"},{"type":"text","value":" and set the color limits to be symmetric around zero.","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"ge3BX4BZbc"}],"key":"RcDaZs9kB0"}],"class":"dropdown","key":"bwfqRlwmQm"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"JHvASDI5tq"}],"key":"W2tPej29DR"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"The contour and surface plotting functions expect the ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"h5kwtTSYp2"},{"type":"emphasis","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"transpose","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"L2Gy8fBcWi"}],"key":"aE80omfk6b"},{"type":"text","value":" of the outputs of ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"v5N2PSh3ux"},{"type":"inlineCode","value":"mtx","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"hGxmcuMOlq"},{"type":"text","value":". If you forget to do that, the ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"sV9QOCcGIk"},{"type":"inlineMath","value":"x","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Cb7a3XW8et"},{"type":"text","value":" and ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"R3fhfwS7rY"},{"type":"inlineMath","value":"y","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"cw7FSPrzEv"},{"type":"text","value":" axes will be swapped.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"DAIAyu2JwZ"}],"key":"mObDJk8Jve"}],"key":"zW0pxDw3Gs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 80;  x = linspace(0, 2, m+1);\nn = 60;  y = linspace(1, 3, n+1);\n[mtx, X, Y] = tensorgrid(x, y);\nF = mtx(f);\n\npcolor(X', Y', F')\nshading interp\ncolormap(redsblues),  colorbar\naxis equal\nxlabel(\"x\"),  ylabel(\"y\")","key":"tOLtjnVX5d"},{"type":"output","id":"OTu8cWvTqHPz25QcRLS7T","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7e1b8e95d4aaffb7cbb3cc5549d493aa","path":"/fnc/build/7e1b8e95d4aaffb7cbb3cc5549d493aa.png"}}}],"key":"Rc8vBv3oF0"}],"data":{},"key":"FWx8Ofgez0"}],"label":"demo-tensorprod-gridfun-matlab","identifier":"demo-tensorprod-gridfun-matlab","html_id":"demo-tensorprod-gridfun-matlab","key":"z7lki00JcI"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-disksphere","label":"demo-tensorprod-disksphere","kind":"proof:example","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":28}},"children":[{"type":"text","value":"Example ","key":"ENDG17NUWy"},{"type":"text","value":"13.1.3","key":"ySIGW9vcGj"}],"template":"Example %s","enumerator":"13.1.3","resolved":true,"html_id":"demo-tensorprod-disksphere","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"OLmUdH3bxy"}],"key":"QiHGJM458g"},{"type":"paragraph","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"For a function given in polar form, such as ","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"Unl0bjcfwQ"},{"type":"inlineMath","value":"f(r,\\theta)=1-r^4","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>r</mi><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">f(r,\\theta)=1-r^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>","key":"ffmzuvAky6"},{"type":"text","value":", construction of a function over the unit disk is straightforward using a grid in ","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"jHS4nmGzyF"},{"type":"inlineMath","value":"(r,\\theta)","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span>","key":"s01CZikcLY"},{"type":"text","value":" space.","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"ZsS46uFbIk"}],"key":"fppFSGr75z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = linspace(0, 1, 41);\ntheta = linspace(0, 2*pi, 121);\n[mtx, R, Theta] = tensorgrid(r, theta);\nF = mtx(@(r, theta) 1 - r.^4);\nclf,  colormap(parula)\ncontourf(R', Theta', F', 20)\nshading flat\nxlabel(\"r\"),  ylabel(\"\\theta\"), \ntitle(\"A polar function\")","key":"Q8xIgOxLTj"},{"type":"output","id":"j4KKPdL_O5MAR3haWE9lD","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"36c7e3aac7b1a8bb2708a926545e1a09","path":"/fnc/build/36c7e3aac7b1a8bb2708a926545e1a09.png"}}}],"key":"ki0Obs0AGp"}],"data":{},"key":"Cag5YSFIrO"},{"type":"paragraph","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"Of course, we are used to seeing such plots over the ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"dIAPaba1qR"},{"type":"inlineMath","value":"(x,y)","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"WzrjYv6Wzw"},{"type":"text","value":" plane, not the ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"j7a7E8hDZP"},{"type":"inlineMath","value":"(r,\\theta)","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span>","key":"qXk3geOHWo"},{"type":"text","value":" plane. For this we create matrices for the coordinate functions ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"smlw9IXtkk"},{"type":"inlineMath","value":"x","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"V1vgjQwJtZ"},{"type":"text","value":" and ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"JwlDF1J3EU"},{"type":"inlineMath","value":"y","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"rLFiCBeEeg"},{"type":"text","value":".","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"Hyvv1PrKhH"}],"key":"C1puvFamn2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"X = R .* cos(Theta);  Y = R .* sin(Theta);\ncontourf(X', Y', F', 20)\naxis equal,  shading interp  \nxlabel('x'),  ylabel('y')\ntitle('Function over the unit disk')","key":"jXi2SWIwRp"},{"type":"output","id":"-_3t1pTm2fv9qB70FEhhq","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0611eae8074303d24c9c3f1527c9fc15","path":"/fnc/build/0611eae8074303d24c9c3f1527c9fc15.png"}}}],"key":"H51qkvJAIn"}],"data":{},"key":"MpHDBqGo5K"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"In such functions the values along the line ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"lgpmsu2e3J"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"EiJ17dx5iu"},{"type":"text","value":" must be identical, and the values on the line ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"K7HRmbnBeW"},{"type":"inlineMath","value":"\\theta=0","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\theta=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"PX0ReXjTs7"},{"type":"text","value":" should be identical to those on ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"cpYToj3lS5"},{"type":"inlineMath","value":"\\theta=2\\pi","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\theta=2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"Q8YVZzuEz4"},{"type":"text","value":". Otherwise the interpretation of the domain as the unit disk is nonsensical. If the function is defined in terms of ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"iGMavyzZMA"},{"type":"inlineMath","value":"x","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"ZGEAfBXiFI"},{"type":"text","value":" and ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"bVHCv3jR3f"},{"type":"inlineMath","value":"y","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"W84ulrMjoE"},{"type":"text","value":", then those can be defined in terms of ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"sPwCirW9mf"},{"type":"inlineMath","value":"r","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"ktBEr2YtAn"},{"type":"text","value":" and ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"S6dljARGhC"},{"type":"text","value":"θ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"nap2xVrHjN"},{"type":"text","value":" using ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"mwQkkuSiyb"},{"type":"crossReference","kind":"equation","identifier":"unitdiskparam","label":"unitdiskparam","children":[{"type":"text","value":"(","key":"Mk8bAcuXIa"},{"type":"text","value":"13.1.6","key":"CZUAfkIzzO"},{"type":"text","value":")","key":"OCraay7ZH0"}],"template":"(%s)","enumerator":"13.1.6","resolved":true,"html_id":"unitdiskparam","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"lLuw5ChiVo"},{"type":"text","value":".","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"J0x7hWKML0"}],"key":"OTptkgM9me"}],"label":"demo-tensorprod-disksphere-matlab","identifier":"demo-tensorprod-disksphere-matlab","html_id":"demo-tensorprod-disksphere-matlab","key":"TRVKlgiZVb"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-diff","label":"demo-tensorprod-diff","kind":"proof:example","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":22}},"children":[{"type":"text","value":"Example ","key":"F8zZPNFeT3"},{"type":"text","value":"13.1.4","key":"n183Sm6unC"}],"template":"Example %s","enumerator":"13.1.4","resolved":true,"html_id":"demo-tensorprod-diff","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"qUN0DqObPG"}],"key":"aUOsBPXZSv"},{"type":"paragraph","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"We define a function and, for reference, its two exact partial derivatives.","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"Up3QbvOQu3"}],"key":"J1kv30J686"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = @(x, y) sin(pi * x .* y - y);\ndu_dx = @(x, y) pi * y .* cos(pi * x .* y - y);\ndu_dy = @(x, y) (pi * x - 1) .* cos(pi * x .* y - y);","key":"bG5CtuxIcW"},{"type":"output","id":"eqk8vO6J7TdZXwvgUilqv","data":[],"key":"S4ITEEa42C"}],"data":{},"key":"q8KRNe37oY"},{"type":"paragraph","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"We will use an equispaced grid and second-order finite differences as implemented by ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"u65QS9jSsY"},{"type":"inlineCode","value":"diffmat2","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"xLIvLfRqVy"},{"type":"text","value":". First, we have a look at a plots of the exact partial derivatives.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"uJ1RWBjk2P"}],"key":"b09lHvXIIK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 80;  [x, Dx] = diffmat2(m, [0, 2]);\nn = 60;  [y, Dy] = diffmat2(n, [1, 4]);\n[mtx, X, Y] = tensorgrid(x, y);\nU = mtx(u);\ndU_dX = mtx(du_dx);\ndU_dY = mtx(du_dy);","key":"UqCR4c342o"},{"type":"output","id":"iIXb90WBQGW4yWbV_yUml","data":[],"key":"Wq2RWV4cz1"}],"data":{},"key":"rvVDKCJ6by"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  subplot(1, 2, 1)\npcolor(X', Y', dU_dX')\naxis equal,  shading interp\ntitle('∂u/∂x')\nsubplot(1, 2, 2)\npcolor(X', Y', dU_dY')\naxis equal,  shading interp\ntitle('∂u/∂y')","key":"if1x8KC7vC"},{"type":"output","id":"_tMdUxrseL7LepgOQQF7s","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"11e5c5095451db778626f72bd3680493","path":"/fnc/build/11e5c5095451db778626f72bd3680493.png"}}}],"key":"tcjjsfdKId"}],"data":{},"key":"FWRWQDf9xl"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"Now we compare the exact partial derivatives with their finite-difference approximations. Since these are signed errors, we use a colormap that is symmetric around zero.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"i5HLIP46fZ"}],"key":"PD7AHEi9Xk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = dU_dX - Dx * U;\nsubplot(1, 2, 1)\npcolor(X', Y', err')\ncolorbar,  clim([-.4, .4])\naxis equal,  shading interp\ntitle('error in ∂u/∂x')\n\nerr = dU_dY - U * Dy';\nsubplot(1,2,2)\npcolor(X', Y', err')\ncolorbar,  clim([-.1, .1])\naxis equal,  shading interp\ncolormap(redsblues)\ntitle('error in ∂u/∂y')","key":"zyrjgF9fQM"},{"type":"output","id":"aCEgjfl7dXC8mnp-S4t9y","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f9207061054d9c16133c28372e5c67ae","path":"/fnc/build/f9207061054d9c16133c28372e5c67ae.png"}}}],"key":"codTTuFSj0"}],"data":{},"key":"G0eiQSzEWV"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"text","value":"Not surprisingly, the errors are largest where the derivatives themselves are largest.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"ubxClyRQUK"}],"key":"PHqTDYlTgR"}],"label":"demo-tensorprod-diff-matlab","identifier":"demo-tensorprod-diff-matlab","html_id":"demo-tensorprod-diff-matlab","key":"NEYnLs9my2"},{"type":"heading","depth":3,"position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"13.2 ","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"gzUC6prPs1"},{"type":"link","identifier":"section-twodim-diffadv","label":"section-twodim-diffadv","kind":"narrative","position":{"start":{"line":177,"column":6},"end":{"line":177,"column":29}},"url":"/diffadv","internal":true,"dataUrl":"/diffadv.json","children":[{"type":"text","value":"Two-dimensional diffusion and advection","key":"id0cGdAlJk"}],"key":"FoWcX8ijUT"}],"identifier":"id-13-2","label":"13.2 ","html_id":"id-13-2","implicit":true,"key":"CXJmu7tfUf"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-vec","label":"demo-diffadv-vec","kind":"proof:example","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":18}},"children":[{"type":"text","value":"Example ","key":"rrmQJew5Rk"},{"type":"text","value":"13.2.1","key":"EstAMYmqa3"}],"template":"Example %s","enumerator":"13.2.1","resolved":true,"html_id":"demo-diffadv-vec","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"qt7sgikNh3"}],"key":"iZTPpxYFJW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 4;  n = 3;\nx = linspace(0, 2, m+1);\ny = linspace(-3, 0, n+1);\n\nf = @(x, y) cos(0.75*pi * x .* y - 0.5*pi * y);\n[mtx, X, Y, vec, unvec] = tensorgrid(x, y);\nF = mtx(f);\ndisp(\"function on a 4x3 grid:\")\ndisp(F)","key":"jA51Y0dxwl"},{"type":"output","id":"MkVxttZuue1CVhLYJWesU","data":[{"output_type":"stream","name":"stdout","text":"function on a 4x3 grid:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"   -0.0000   -1.0000    0.0000    1.0000\n    0.3827    0.7071    0.9239    1.0000\n   -0.7071    0.0000    0.7071    1.0000\n    0.9239   -0.7071   -0.3827    1.0000\n   -1.0000    1.0000   -1.0000    1.0000\n\n"}],"key":"QllzmVg9bA"}],"data":{},"key":"swsSVW7Lmo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"vec(F):\")\ndisp(vec(F))","key":"imyHGOrHfb"},{"type":"output","id":"vLx4t4k7KqbYnpCJ0yX6e","data":[{"output_type":"stream","name":"stdout","text":"vec(F):"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"   -0.0000\n    0.3827\n   -0.7071\n    0.9239\n   -1.0000\n   -1.0000\n    0.7071\n    0.0000\n   -0.7071\n    1.0000\n    0.0000\n    0.9239\n    0.7071\n   -0.3827\n   -1.0000\n    1.0000\n    1.0000\n    1.0000\n    1.0000\n    1.0000\n\n"}],"key":"GOJjZacYIu"}],"data":{},"key":"Luf32tci5D"},{"type":"paragraph","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"hRyDFBEFtC"},{"type":"inlineCode","value":"unvec","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"TQHAZdybBR"},{"type":"text","value":" operation is the inverse of vec.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"UJ3Q9hgWnQ"}],"key":"oMKoHKgdFp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"unvec(vec(F)):\")\ndisp(unvec(vec(F)))","key":"w6RNJxcy8j"},{"type":"output","id":"lX17ZaPnBcrqrBp9qekVn","data":[{"output_type":"stream","name":"stdout","text":"unvec(vec(F)):"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"   -0.0000   -1.0000    0.0000    1.0000\n    0.3827    0.7071    0.9239    1.0000\n   -0.7071    0.0000    0.7071    1.0000\n    0.9239   -0.7071   -0.3827    1.0000\n   -1.0000    1.0000   -1.0000    1.0000\n\n"}],"key":"oQ08k1tOXS"}],"data":{},"key":"Py0Eyez26L"}],"label":"demo-diffadv-vec-matlab","identifier":"demo-diffadv-vec-matlab","html_id":"demo-diffadv-vec-matlab","key":"hqpLMFAu37"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-heat","label":"demo-diffadv-heat","kind":"proof:example","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":19}},"children":[{"type":"text","value":"Example ","key":"VpneBbeq9T"},{"type":"text","value":"13.2.2","key":"lxcAzhcIlP"}],"template":"Example %s","enumerator":"13.2.2","resolved":true,"html_id":"demo-diffadv-heat","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"pMQVRWhOVl"}],"key":"pujFHXOKhX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 60;  n = 40;\n[x, Dx, Dxx] = diffper(m, [-1, 1]);\n[y, Dy, Dyy] = diffper(n, [-1, 1]);\n[mtx, X, Y, vec, unvec] = tensorgrid(x, y);","key":"FBi3AZqyxg"},{"type":"output","id":"03kZSs-0nLlHs5Kelzk0n","data":[],"key":"CfCRYWJLv9"}],"data":{},"key":"rzTneTeogq"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"Note that the initial condition should also be periodic on the domain.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"p3r9cAW4cf"}],"key":"h63tBgTN2P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U0 = sin(4*pi*X) .* exp( cos(pi*Y) );\nclf,  surf(X', Y', U0')\nmx = max(abs(vec(U0)));\nclim([-mx, mx]),  shading interp\ncolormap(redsblues)\nxlabel('x'),  ylabel('y')  \ntitle('Initial condition')","key":"PRvme2ch5j"},{"type":"output","id":"Q2ugs7O-6YzWM0IguG-mj","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6f31170d3821ac2d6bc0376b863b6f48","path":"/fnc/build/6f31170d3821ac2d6bc0376b863b6f48.png"}}}],"key":"Hx6NrpGGIR"}],"data":{},"key":"k1ulGNrOBE"},{"type":"paragraph","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"text","value":"This function computes the time derivative for the unknowns. The actual calculations take place using the matrix shape.","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"y2b5iu99Sp"}],"key":"JVDMqpDte5"},{"type":"include","file":"f13_2_heat.m","literal":true,"filter":{},"children":[{"type":"code","value":"function du_dt = timederiv(t, u, p)\n    [alpha, Dxx, Dyy, vec, unvec] = p{:};\n    U = unvec(u);\n    Uxx = Dxx * U;  Uyy = U * Dyy';     % 2nd partials\n    dU_dt = alpha * (Uxx + Uyy);  % PDE\n    du_dt = vec(dU_dt);\nend","lang":"matlab","filename":"f13_2_heat.m","key":"QHtCUN8QIj"}],"key":"iIe1F6xiJ6"},{"type":"paragraph","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"Since this problem is parabolic, a stiff integrator is appropriate.","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"E9f7UaRaNI"}],"key":"PupxWhYA8P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_heat);\nivp.InitialTime = 0;\nivp.InitialValue = vec(U0);\nivp.Parameters = {0.1, Dxx, Dyy, vec, unvec};\nivp.Solver = \"stiff\";\nsol = solutionFcn(ivp, 0, 0.2);\nU = @(t) unvec(sol(t));","key":"igzy5d24AH"},{"type":"output","id":"-dK6wieusNxz8dEw0SIce","data":[],"key":"nRnsep5QDL"}],"data":{},"key":"oD6mFDA1NZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"surf(X', Y', U0')\nmx = max(abs(vec(U0)));\nclim([-mx, mx]),  shading interp\ncolormap(redsblues)\nxlabel('x'),  ylabel('y')  \ntitle('Initial condition')","visibility":"hide","key":"bxNV7MOM5j"},{"type":"output","id":"XCzG0bG8DyNQeVq5ugrIW","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02c4568ed05425fca1073bb41b583122","path":"/fnc/build/02c4568ed05425fca1073bb41b583122.png"}}}],"visibility":"show","key":"gJnDdC04AP"}],"data":{"tags":[]},"visibility":"show","key":"drvhMiudx7"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"Here is an animation of the solution.","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"rX8Y7v4Fho"}],"key":"QR6XUeU9C9"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"pySsMtfV9k"}],"key":"kE9Dy2WcDT"},{"type":"paragraph","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"MaEffVMOWP"},{"type":"inlineCode","value":"clims","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"GavNVGN7fP"},{"type":"text","value":" are set so that colors remain at fixed values throughout the animation.","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"vLoyFuLqAE"}],"key":"sTunkGAlBY"}],"class":"dropdown","key":"SGqcwW3OQ2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"title('Heat equation on a periodic domain')\nvid = VideoWriter(\"figures/2d-heat.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 0.2, 61)\n    cla, surf(X', Y', U(t)')\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-0.9, 0.75, 2, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","key":"m9NSWlD5Hp"},{"type":"output","id":"rtIZp6cjjUOYK9xY2xwIS","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02fa2ef999bd2becb4400cfbc0b091d3","path":"/fnc/build/02fa2ef999bd2becb4400cfbc0b091d3.png"}}},{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9d7f3cc10b951fd68ae04b4f7264bcc2","path":"/fnc/build/9d7f3cc10b951fd68ae04b4f7264bcc2.png"}}}],"key":"kggDf4JkZq"}],"data":{},"key":"ZAHpQjhCTu"},{"type":"image","url":"/fnc/build/2d-heat-f6fc8d15fe521fcd410c1748dd39fc42.mp4","alt":"Heat equation in 2d","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"RSzKT5t5aw","urlSource":"figures/2d-heat.mp4"}],"label":"demo-diffadv-heat-matlab","identifier":"demo-diffadv-heat-matlab","html_id":"demo-diffadv-heat-matlab","key":"aPnqE0HyOs"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","kind":"proof:example","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":22}},"children":[{"type":"text","value":"Example ","key":"Hr2GnS3HEA"},{"type":"text","value":"13.2.3","key":"hS1OyOkQBq"}],"template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"mKnZw6ns7S"}],"key":"eLE74smjLp"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"The first step is to define a discretization of the domain and the initial state.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"eEkBmZwqC7"}],"key":"ShM0kx7A3Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 50;  n = 40;\n[x, Dx, Dxx] = diffcheb(m, [-1, 1]);\n[y, Dy, Dyy] = diffcheb(n, [-1, 1]);\n[mtx, X, Y] = tensorgrid(x, y);\nu_init = @(x, y) (1+y) .* (1-x).^4 .* (1+x).^2 .* (1-y.^4);","key":"Ba13qFQvrP"},{"type":"output","id":"NI2mnx4JrMp_8zGEM59Zo","data":[],"key":"IE6CjkMm3m"}],"data":{},"key":"Y6YWQuYGrJ"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"There are really two grids now: the full grid and the subset grid of interior points. Since the ","key":"WbyY2xZ44R"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"Q92cmq3eQs"}],"key":"p8EFpXIM6k"},{"type":"text","value":" unknowns are on the interior grid, that is the one we need to change shapes on. We also need the functions ","key":"KkFnFbZdTR"},{"type":"inlineCode","value":"extend","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"jYERRRkiRr"},{"type":"text","value":" and ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"rLUjacjeRC"},{"type":"inlineCode","value":"chop","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"LsSGcXM4R5"},{"type":"text","value":" to add and remove boundary values.","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"Qq5SGUYHas"}],"key":"nTwFGImCy8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, ~, ~, vec, unvec] = tensorgrid(x(2:m), y(2:n));\nchop = @(U) U(2:m, 2:n);\nz = zeros(1, n-1);\nextend = @(U) [ zeros(m+1, 1) [z; U; z] zeros(m+1, 1)];\npack = @(U) vec(chop(U));\nunpack = @(u) extend(unvec(u));","key":"tnJVWYaAyO"},{"type":"output","id":"CARt5k3QWYtMbnbKbRVBR","data":[],"key":"EcTcM2CtIZ"}],"data":{},"key":"kI5blcaDuF"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"Now we can define and solve the ","key":"vzsvHS1KXE"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"aBdbwXvJ5L"}],"key":"k5acAZDyLN"},{"type":"text","value":" using a stiff solver.","key":"dmLoBVZMLe"}],"key":"vkGlKTfkNI"},{"type":"include","file":"f13_2_advdiff.m","literal":true,"filter":{},"children":[{"type":"code","value":"function du_dt = timederiv(t, u, p)\n    [ep, Dx, Dxx, Dy, Dyy, pack, unpack] = p{:};\n    U = unpack(u);\n    Uxx = Dxx * U;  Uyy = U * Dyy'; \n    dU_dt = 1 - Dx * U + ep * (Uxx + Uyy);  % PDE\n    du_dt = pack(dU_dt);\nend","lang":"matlab","filename":"f13_2_advdiff.m","key":"BMu4GobHeZ"}],"key":"j9SR9F0D3D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_advdiff);\nivp.InitialTime = 0;\nivp.InitialValue = pack(mtx(u_init));\nivp.Parameters = {0.05, Dx, Dxx, Dy, Dyy, pack, unpack};\nivp.Solver = \"stiff\";\nsol = solutionFcn(ivp, 0, 2);","key":"mW7u5h2cFB"},{"type":"output","id":"yuRwO2XT7nM4ZJ7-Dp8v3","data":[],"key":"x1gTqODLQc"}],"data":{},"key":"BWWcoOXefg"},{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"When we evaluate the solution at a particular value of ","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"r4801SV2IG"},{"type":"inlineMath","value":"t","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"sj8MBBTGNI"},{"type":"text","value":", we get a vector of the interior grid values. The same ","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"NIyECulB6z"},{"type":"inlineCode","value":"unpack","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"xZgRxkKcdC"},{"type":"text","value":" function above converts this to a complete matrix of grid values.","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"V0qDynGouT"}],"key":"lpuclnNfOQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U = @(t) unpack(sol(t));\n\nclf,  pcolor(X', Y', U(0.5)')\nclim([0, 2]), shading interp\naxis equal,  colormap(sky), colorbar\ntitle('Advection-diffusion at t = 0.5')  \nxlabel('x'),  ylabel('y')","key":"dNthMNeDso"},{"type":"output","id":"VXvDWhS9RFlwp005QAv2q","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"de9e4d5c5b6f7ae2b05aff15b641f285","path":"/fnc/build/de9e4d5c5b6f7ae2b05aff15b641f285.png"}}}],"key":"adCsw7Zyj9"}],"data":{},"key":"tkXx05CXkE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nvid = VideoWriter(\"figures/2d-advdiff.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 2, 81)\n    cla, pcolor(X', Y', U(t)')\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-1.5, 0.75, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"A3QBG6c7cb"},{"type":"output","id":"v_3xz2w5f0ZUkOaaxXHni","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2ced81501b4a0dc4d6713692855c8a1a","path":"/fnc/build/2ced81501b4a0dc4d6713692855c8a1a.png"}}},{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"981b1c301b8322b7d96bb6c9c755c80c","path":"/fnc/build/981b1c301b8322b7d96bb6c9c755c80c.png"}}}],"visibility":"show","key":"JyY9aIkZTg"}],"data":{"tags":[]},"visibility":"show","key":"fIscrHJapk"},{"type":"image","url":"/fnc/build/2d-advdiff-33aa45af09b5798c3386e2115b8efe11.mp4","alt":"Advection-diffusion in 2d","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"qZPoGX3Tuu","urlSource":"figures/2d-advdiff.mp4"}],"label":"demo-diffadv-advdiff-matlab","identifier":"demo-diffadv-advdiff-matlab","html_id":"demo-diffadv-advdiff-matlab","key":"fGEEce0iNY"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","kind":"proof:example","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":19}},"children":[{"type":"text","value":"Example ","key":"Td08Gsuv5z"},{"type":"text","value":"13.2.4","key":"knhqByOeQY"}],"template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"hBrQV42MIA"}],"key":"AC35ICOHqU"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"We start with the discretization and initial condition.","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"MPQyjITDp9"}],"key":"nkiKXPDA2Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 40; n = 42;\n[x, Dx, Dxx] = diffcheb(m, [-2, 2]);\n[y, Dy, Dyy] = diffcheb(n, [-2, 2]);\n[mtx, X, Y] = tensorgrid(x, y);\n\nu_init = @(x, y) (x+0.2) .* exp(-12*(x.^2 + y.^2));\nU0 = mtx(u_init);\nV0 = zeros(size(U0));","key":"SivpM1mtCQ"},{"type":"output","id":"Eew5a8Fc-xn4_CnF7T7Or","data":[],"key":"RJVe2XP534"}],"data":{},"key":"MnachDlK96"},{"type":"paragraph","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"children":[{"type":"text","value":"Note that because ","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"IicEAdjpA9"},{"type":"inlineMath","value":"u","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"Ch6GsR87Tc"},{"type":"text","value":" is known on the boundary, while ","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"ofHgJUmfnO"},{"type":"inlineMath","value":"v","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"W74Qty0ja7"},{"type":"text","value":" is unknown over the full grid, there are two different sizes of vec/unvec operations. We also need to define functions to pack grid unknowns into a vector and to unpack them. When the unknowns for ","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"F5VJh0Qh9o"},{"type":"inlineMath","value":"u","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"hUv8EzApl6"},{"type":"text","value":" are packed, the boundary values are chopped off, and these are restored when unpacking.","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"MSOhsufLAk"}],"key":"T041fVJLOQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, ~, ~, vec_v, unvec_v] = tensorgrid(x, y);\n[~, ~, ~, vec_u, unvec_u] = tensorgrid(x(2:m), y(2:n));\n\nchop = @(U) U(2:m, 2:n);\nz = zeros(1, n-1);\nextend = @(U) [ zeros(m+1, 1) [z; U; z] zeros(m+1, 1)];\npack = @(U, V) [vec_u(chop(U)); vec_v(V)];\nN = (m-1) * (n-1);\nunpack = @(u) f13_2_wave_unpack(u, N, unvec_u, unvec_v, extend);","key":"SG7rtgw2vA"},{"type":"output","id":"WdUVuW0drggxMorf2o_KY","data":[],"key":"MkZHRVikXZ"}],"data":{},"key":"xjdHxbpQ2O"},{"type":"include","file":"f13_2_wave_unpack.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [U, V] = unpack(w, N, unvec_u, unvec_v, extend)\n    U = extend( unvec_u(w(1:N)) );\n    V = unvec_v(w(N+1:end));\nend","lang":"matlab","filename":"f13_2_wave_unpack.m","key":"jidxlXajis"}],"key":"GEcZWd60T4"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"We can now define and solve the ","key":"ZSgW1MJnM4"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"lCmmaoDQXy"}],"key":"kJ2fH4YQYO"},{"type":"text","value":". Since this problem is hyperbolic, not parabolic, a nonstiff integrator is faster than a stiff one.","key":"Vh9hYLwJoN"}],"key":"P8vjuTGPlu"},{"type":"include","file":"f13_2_wave.m","literal":true,"filter":{},"children":[{"type":"code","value":"function dw_dt = timederiv(t, w, p)\n    [Dxx, Dyy, pack, unpack] = p{:};\n    [U, V] = unpack(w);\n    dU_dt = V;\n    dV_dt = Dxx * U + U * Dyy';\n    dw_dt = pack(dU_dt, dV_dt);\nend","lang":"matlab","filename":"f13_2_wave.m","key":"MJpVsXXE0G"}],"key":"i7TChuytet"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_wave);\nivp.InitialTime = 0;\nivp.InitialValue = pack(U0, V0);\nivp.Parameters = {Dxx, Dyy, pack, unpack};\nivp.Solver = \"nonstiff\";\nsol = solutionFcn(ivp, 0, 4);","key":"OPEYpX6aUg"},{"type":"output","id":"aYqadogMWgMe6JdlUnIXu","data":[],"key":"yHuRvXpDAV"}],"data":{},"key":"Ite8GnrMo0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\n[U, V] = unpack(sol(0.5));\npcolor(X', Y', U')\naxis equal,  clim([-0.1, 0.1])\ncolormap(redsblues),  shading interp\nxlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Wave equation at t = 0.5\")","key":"E4bB23DO33"},{"type":"output","id":"M_jiNAzyDaXNA5AwqzOfa","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"36fb1aa80a354d18d458452dfdf59f29","path":"/fnc/build/36fb1aa80a354d18d458452dfdf59f29.png"}}}],"key":"T427mSNvgC"}],"data":{},"key":"eOTWuIrRA6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nvid = VideoWriter(\"figures/2d-wave.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 4, 121)\n    [U, V] = unpack(sol(t));\n    cla, pcolor(X, Y, U)\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-3, 1.75, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"bjcRsHJrL1"},{"type":"output","id":"PuiKxepsUinlfiRqQKM6U","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"36fb1aa80a354d18d458452dfdf59f29","path":"/fnc/build/36fb1aa80a354d18d458452dfdf59f29.png"}}},{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3cbb80aea0f2f2a5bf0077b86103f7d4","path":"/fnc/build/3cbb80aea0f2f2a5bf0077b86103f7d4.png"}}}],"visibility":"show","key":"Pa71gH3F2h"}],"data":{"tags":[]},"visibility":"show","key":"kHzj6R3H3L"},{"type":"image","url":"/fnc/build/2d-wave-ccd693a6b1b3e8fe5cdd847f1fe5edb3.mp4","alt":"Wave equation in 2d","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"xxrInUE4P6","urlSource":"figures/2d-wave.mp4"}],"label":"demo-diffadv-wave-matlab","identifier":"demo-diffadv-wave-matlab","html_id":"demo-diffadv-wave-matlab","key":"fDAJjM4F9M"},{"type":"heading","depth":3,"position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"13.3 ","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"oN6MUaxVC4"},{"type":"link","identifier":"section-twodim-laplace","label":"section-twodim-laplace","kind":"narrative","position":{"start":{"line":432,"column":6},"end":{"line":432,"column":29}},"url":"/laplace","internal":true,"dataUrl":"/laplace.json","children":[{"type":"text","value":"Laplace and Poisson equations","key":"oGEnbirTPR"}],"key":"MkLmV0C5d5"}],"identifier":"id-13-3","label":"13.3 ","html_id":"id-13-3","implicit":true,"key":"jmfOm00aKa"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-kron","label":"demo-laplace-kron","kind":"proof:example","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":19}},"children":[{"type":"text","value":"Example ","key":"NmrckcQckq"},{"type":"text","value":"13.3.1","key":"rjfNtxDH02"}],"template":"Example %s","enumerator":"13.3.1","resolved":true,"html_id":"demo-laplace-kron","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"Ark2EN7ZZp"}],"key":"zFSxocb5qe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [1, 2; -2, 0];\nB = [1, 10, 100; -5, 5, 3];\ndisp(\"A:\")\ndisp(A)\ndisp(\"B:\")\ndisp(B)","key":"Z3xzMgZyyM"},{"type":"output","id":"oLwQWA5NfOItldywSAvOG","data":[{"output_type":"stream","name":"stdout","text":"A:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"     1     2\n    -2     0\n\n"},{"output_type":"stream","name":"stdout","text":"B:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"     1    10   100\n    -5     5     3\n\n"}],"key":"hIg8TX6t5G"}],"data":{},"key":"iYw0ZpGgsI"},{"type":"paragraph","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"Applying the definition manually, we get","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"Dt9Gsbo0xn"}],"key":"A1XO41gjvY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_kron_B = [\n    A(1,1)*B  A(1,2)*B;\n    A(2,1)*B  A(2,2)*B\n    ]","key":"JEuDAopYX6"},{"type":"output","id":"TkPkU5KQ5nBjZUrRbjSLP","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_kron_B = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_kron_B = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n","content_type":"text/plain"}}}],"key":"LqgHsbDh9E"}],"data":{},"key":"mKwe3CBDdG"},{"type":"paragraph","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"children":[{"type":"text","value":"But it makes more sense to use ","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"a6DxUvSi4j"},{"type":"inlineCode","value":"kron","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"ERR5BoilKV"},{"type":"text","value":".","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"XVHky68lLG"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"kron","kind":"entry"},"emphasis":true}],"label":"index-EgQzWhzqeM","identifier":"index-egqzwhzqem","html_id":"index-egqzwhzqem","key":"vZjfZev9yP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"kron(A, B)","key":"S25WvxMoim"},{"type":"output","id":"kpH06hoeJhSiYIQWORyUs","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n","content_type":"text/plain"}}}],"key":"ekmIKnXKtO"}],"data":{},"key":"hHMg6ZNslP"}],"label":"demo-laplace-kron-matlab","identifier":"demo-laplace-kron-matlab","html_id":"demo-laplace-kron-matlab","key":"Hbr78X9UYQ"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-fd","label":"demo-laplace-fd","kind":"proof:example","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":17}},"children":[{"type":"text","value":"Example ","key":"SrbS6CttFb"},{"type":"text","value":"13.3.2","key":"imdsaOlQud"}],"template":"Example %s","enumerator":"13.3.2","resolved":true,"html_id":"demo-laplace-fd","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"tge3GD96x4"}],"key":"I7KpXiY5Nb"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"We make a crude discretization for illustrative purposes.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"NOY70W7qcu"}],"key":"If5ugqnZ8S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 6;  n = 5;\n[x, Dx, Dxx] = diffmat2(m, [0, 3]);\n[y, Dy, Dyy] = diffmat2(n, [-1, 1]);\n[mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y);","key":"SfszfeScTe"},{"type":"output","id":"oNAxtkApWhOmZFjPqEna5","data":[],"key":"c8SAM7dfAa"}],"data":{},"key":"lm9cObwbeh"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"Next, we define ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"MU5b3NrHhc"},{"type":"text","value":"ϕ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"xQg0K6DhWw"},{"type":"text","value":" and evaluate it on the grid to get the forcing vector of the linear system.","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"EERq7vIU4F"}],"key":"jYVuf9MqnY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(x, y) x.^2 - y + 2;\nb = vec(mtx(phi));","key":"FCniAs3Me7"},{"type":"output","id":"bv7KmNf8jzJzL6itZ9dMJ","data":[],"key":"SaL2WZB4Si"}],"data":{},"key":"Dwp2QrFJYX"},{"type":"paragraph","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"children":[{"type":"text","value":"Here are the coefficients for the ","key":"KPlHABFzfg"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"spgmzATB5j"}],"key":"V41Df2j2Tg"},{"type":"text","value":" collocation, before any modifications are made for the boundary conditions. The combination of Kronecker products and finite differences produces a characteristic sparsity pattern.","key":"K1XHHh8CfT"}],"key":"KPTkK6flbE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = kron(speye(n+1), sparse(Dxx)) + kron(sparse(Dyy), speye(m+1));\nclf,  spy(A)\ntitle(\"System matrix before boundary conditions\")","key":"wYNlP8qwm8"},{"type":"output","id":"regEY2Is3jCJO0UVrhtPs","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64b59bc1e048e02057b1b3fe5b4bf8ca","path":"/fnc/build/64b59bc1e048e02057b1b3fe5b4bf8ca.png"}}}],"key":"ioB7lYPwMa"}],"data":{},"key":"it2BcUJvlb"},{"type":"paragraph","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"children":[{"type":"text","value":"The number of equations is equal to ","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"key":"lgjWpx3uhi"},{"type":"inlineMath","value":"(m+1)(n+1)","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(m+1)(n+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"Dd8IZPFfwH"},{"type":"text","value":", which is the total number of points on the grid.","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"key":"B60DjqQGPq"}],"key":"MoZvf24N1M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"N = length(b)","key":"hAxaBqLF7M"},{"type":"output","id":"dWrtlwvi2-vXVVwqGdaIp","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>N = 42</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"N = 42","content_type":"text/plain"}}}],"key":"zVxtjRhMXp"}],"data":{},"key":"QB7pylCM8e"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"We now use the Boolean array that indicates where the boundary points lie in the grid.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"ulg41h1r54"}],"key":"hhytV9KTRG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"spy(is_boundary)\ntitle(\"Boundary points\")","key":"ca5GM1FZZY"},{"type":"output","id":"zAi3-oKd0qBPzhcaiebEu","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f5eb0ab6eeecbeaaee791e4a09e96577","path":"/fnc/build/f5eb0ab6eeecbeaaee791e4a09e96577.png"}}}],"key":"O7Ro6HrGWR"}],"data":{},"key":"fjJGSx6GoT"},{"type":"paragraph","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"text","value":"In order to impose Dirichlet boundary conditions, we replace the boundary rows of the system by rows of the identity.","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"key":"D6VPmWM2Bn"}],"key":"VDwCOnCNn0"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"BZiF3814sZ"}],"key":"JRKKEMqawl"},{"type":"paragraph","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"Changing rows of a sparse array requires that the operands be in a particular sparse representation called ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"CuatWsaaIr"},{"type":"inlineCode","value":"lil","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"GJxOmlEep1"},{"type":"text","value":". The conversion isn’t done automatically because it can be slow and you are encouraged to avoid it when possible. We’re just trying to keep things conceptually simple here.","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"N3QcYflcug"}],"key":"IL7jgLh87L"}],"class":"dropdown","key":"GYqUwlvfmm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"I = speye(N);\nidx = vec(is_boundary);\nA(idx, :) = I(idx, :);\n\nspy(A)\ntitle(\"System matrix with boundary conditions\")","key":"gy5rm1pOHl"},{"type":"output","id":"1CxOMStxCimiiKjDC5dNG","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c4e3af073661f1ba19f1b69965ecc6df","path":"/fnc/build/c4e3af073661f1ba19f1b69965ecc6df.png"}}}],"key":"dP6D1F7hVf"}],"data":{},"key":"Gzz2NXre0z"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"Finally, we must replace the rows in the vector ","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"koVveAUoqD"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Tar7Ypn5Y8"},{"type":"text","value":" by the boundary values being assigned to the boundary points. Here, we let the boundary values be zero everywhere.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"WDrDJSNTze"}],"key":"mz1kzo6K3I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b(idx) = 0;","key":"T2a4s8IqZW"},{"type":"output","id":"3plnIlX_bDybxbVL4WIuv","data":[],"key":"ZsMiSDemUb"}],"data":{},"key":"oD0SLuBpjh"},{"type":"paragraph","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"children":[{"type":"text","value":"Now we can solve for ","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"Lygpeujbb6"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"g34gasSyC4"},{"type":"text","value":" and reinterpret it as the matrix-shaped ","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"HIQFGhRvry"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"OJyiwueBkt"},{"type":"text","value":", the solution on our grid.","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"ZT4SCduB9r"}],"key":"HVu0Bgtr4E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = A \\ b;\nU = unvec(u)","key":"riftcWZkmH"},{"type":"output","id":"96Lnz8KSVtDqkdNYhwedQ","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 7×6 double\n         0         0         0         0         0         0\n         0   -0.5493   -0.7583   -0.7121   -0.4534         0\n         0   -0.9179   -1.3027   -1.2438   -0.7985         0\n         0   -1.2193   -1.7406   -1.6791   -1.0954         0\n         0   -1.3987   -1.9768   -1.9179   -1.2793         0\n         0   -1.2102   -1.6584   -1.6123   -1.1143         0\n         0         0         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 7×6 double\n         0         0         0         0         0         0\n         0   -0.5493   -0.7583   -0.7121   -0.4534         0\n         0   -0.9179   -1.3027   -1.2438   -0.7985         0\n         0   -1.2193   -1.7406   -1.6791   -1.0954         0\n         0   -1.3987   -1.9768   -1.9179   -1.2793         0\n         0   -1.2102   -1.6584   -1.6123   -1.1143         0\n         0         0         0         0         0         0\n","content_type":"text/plain"}}}],"key":"eSQp6k6WFN"}],"data":{},"key":"DtxKSUEpP0"}],"label":"demo-laplace-fd-matlab","identifier":"demo-laplace-fd-matlab","html_id":"demo-laplace-fd-matlab","key":"NwiD62sC1A"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-poisson","label":"demo-laplace-poisson","kind":"proof:example","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":22}},"children":[{"type":"text","value":"Example ","key":"quboAyA9Cj"},{"type":"text","value":"13.3.3","key":"VwyErzVnbA"}],"template":"Example %s","enumerator":"13.3.3","resolved":true,"html_id":"demo-laplace-poisson","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"J5Dri6MLNN"}],"key":"Q2tL27eNEW"},{"type":"paragraph","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"children":[{"type":"text","value":"First we define the problem on ","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"key":"MRZMNSpj0o"},{"type":"inlineMath","value":"[0,1]\\times[0,2]","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>×</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]\\times[0,2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">]</span></span></span></span>","key":"ojvMOkzOIO"},{"type":"text","value":".","position":{"start":{"line":536,"column":1},"end":{"line":536,"column":1}},"key":"MZ2em9u4X7"}],"key":"CPWemP8ixk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x, y) -sin(3*x .* y - 4*y) .* (9*y.^2 + (3*x - 4).^2);\ng = @(x, y) sin(3*x .* y - 4*y);\nxspan = [0, 1];\nyspan = [0, 2];","key":"l9QVrlYN5l"},{"type":"output","id":"55Zc5ZMGrqHaA832hjzzO","data":[],"key":"uvENWua2cO"}],"data":{},"key":"vyVoJhmVw0"},{"type":"paragraph","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"children":[{"type":"text","value":"Here is the finite-difference solution.","position":{"start":{"line":545,"column":1},"end":{"line":545,"column":1}},"key":"tS7hHsx6pf"}],"key":"QvQvxx19ua"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[X, Y, U] = poissonfd(f, g, 40, xspan, 60, yspan);\n\nclf, surf(X', Y', U')\ncolormap(parula),  shading interp\ncolorbar\ntitle(\"Solution of Poisson's equation\")\nxlabel(\"x\"),  ylabel(\"y\"),  zlabel(\"u(x,y)\")","key":"cUBXqJZ9iF"},{"type":"output","id":"1cYkmLB0TXxCZOMM0sP8c","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f0f33d3cfbf2338d5231f5bca52bebd9","path":"/fnc/build/f0f33d3cfbf2338d5231f5bca52bebd9.png"}}}],"key":"bEsLVKZVpG"}],"data":{},"key":"YhrEcKzD9h"},{"type":"paragraph","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"children":[{"type":"text","value":"Since this is an artificial problem with a known solution, we can plot the error, which is a smooth function of ","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"WZshftfgLY"},{"type":"inlineMath","value":"x","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"mf1MeUph5P"},{"type":"text","value":" and ","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"t1cgEN0yU3"},{"type":"inlineMath","value":"y","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"BRkDEhHSCM"},{"type":"text","value":". It must be zero on the boundary; otherwise, we have implemented boundary conditions incorrectly.","position":{"start":{"line":557,"column":1},"end":{"line":557,"column":1}},"key":"aqVNyiXIQR"}],"key":"uNarea3Wrw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = g(X, Y) - U;\nmx = max(abs(vec(err)));\npcolor(X', Y', err')\ncolormap(redsblues),  shading interp\nclim([-mx, mx]),  colorbar\naxis equal,  xlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Error\")","key":"JHBC9uwazK"},{"type":"output","id":"7S8CEVZhh6opFKcMuO8L0","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5d0079ed0bc3fdb19ff60643056ddb14","path":"/fnc/build/5d0079ed0bc3fdb19ff60643056ddb14.png"}}}],"key":"uAwxZ45Wbu"}],"data":{},"key":"py23NzxgjR"}],"label":"demo-laplace-poisson-matlab","identifier":"demo-laplace-poisson-matlab","html_id":"demo-laplace-poisson-matlab","key":"Rl56Rr4W5x"},{"type":"heading","depth":3,"position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"children":[{"type":"text","value":"13.4 ","position":{"start":{"line":570,"column":1},"end":{"line":570,"column":1}},"key":"vt3gwVwCB5"},{"type":"link","identifier":"section-twodim-nonlinear","label":"section-twodim-nonlinear","kind":"narrative","position":{"start":{"line":570,"column":6},"end":{"line":570,"column":31}},"url":"/nonlinear-1","internal":true,"dataUrl":"/nonlinear-1.json","children":[{"type":"text","value":"Nonlinear elliptic PDEs","key":"zTRXTDJEsS"}],"key":"sbZejlemA1"}],"identifier":"id-13-4","label":"13.4 ","html_id":"id-13-4","implicit":true,"key":"RpCHmKksrr"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear2d-mems","label":"demo-nonlinear2d-mems","kind":"proof:example","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":23}},"children":[{"type":"text","value":"Example ","key":"ZzCWzpAjr3"},{"type":"text","value":"13.4.2","key":"ddBMYkhCoq"}],"template":"Example %s","enumerator":"13.4.2","resolved":true,"html_id":"demo-nonlinear2d-mems","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"jvLkO0AlUc"}],"key":"TEIKbxdwfx"},{"type":"paragraph","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"children":[{"type":"text","value":"All we need to define are ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"XGGkgTTy0V"},{"type":"text","value":"ϕ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"S5QGqy7g49"},{"type":"text","value":" from ","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":1}},"key":"ZHTWgVGBE3"},{"type":"crossReference","kind":"equation","identifier":"nonlinpdepde","label":"nonlinpdepde","children":[{"type":"text","value":"(","key":"MXh4xfznkA"},{"type":"text","value":"13.4.2","key":"X0bfQZ4pDb"},{"type":"text","value":")","key":"E5LxVzLF4O"}],"template":"(%s)","enumerator":"13.4.2","resolved":true,"html_id":"nonlinpdepde","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"zH4cBaeIMP"},{"type":"text","value":" for the ","key":"S55RWa3KIG"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"ZxJ9KjUhgX"}],"key":"r2TInUxqtA"},{"type":"text","value":", and a trivial zero function for the boundary condition.","key":"XM8aOx6BXD"}],"key":"TVqdd7fsJD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 1.5;\nphi = @(X, Y, U, Ux, Uxx, Uy, Uyy) Uxx + Uyy - lambda ./ (U + 1).^2;\ng = @(x, y) zeros(size(x));","key":"BHhyWIcHD8"},{"type":"output","id":"LgAXnXpekkiEb_EflbRl3","data":[],"key":"WxYporn7io"}],"data":{},"key":"C9SLfwkzXk"},{"type":"paragraph","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":1}},"children":[{"type":"text","value":"Here is the solution for ","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":1}},"key":"PKrmzTbeQM"},{"type":"inlineMath","value":"m=15","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>15</mn></mrow><annotation encoding=\"application/x-tex\">m=15</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">15</span></span></span></span>","key":"ZwJLWovMCg"},{"type":"text","value":", ","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":1}},"key":"zGHYOP5v8d"},{"type":"inlineMath","value":"n=8","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">n=8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8</span></span></span></span>","key":"na3qzfcsPh"},{"type":"text","value":".","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":1}},"key":"lEfy65B15A"}],"key":"qYWLObbFIV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = elliptic(phi, g, 15, [0, 2.5], 8, [0, 1]);\ndisp(sprintf(\"solution at (2, 0.6) is %.7f\", u(2, 0.6)))","key":"UNr2ZbijRT"},{"type":"output","id":"Vs7KKUua8D0Y7Gqq0brUd","data":[{"output_type":"stream","name":"stdout","text":"solution at (2, 0.6) is -0.2264594"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"W0iOTloqCc"}],"data":{},"key":"oWhNDsiApQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(0, 2.5, 91);\ny = linspace(0, 1, 51);\n[mtx, X, Y] = tensorgrid(x, y);\nclf,  pcolor(x, y, mtx(u)')\ncolormap(flipud(sky)),  shading interp,  colorbar\naxis equal\nxlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Deflection of a MEMS membrane\")","visibility":"hide","key":"r3piPDxBal"},{"type":"output","id":"MhZ-EFstqNlISkkEIr9fu","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d43a493209edb8e6ee39761b331bcd2e","path":"/fnc/build/d43a493209edb8e6ee39761b331bcd2e.png"}}}],"visibility":"show","key":"QfQXLD9dFL"}],"data":{"tags":[]},"visibility":"show","key":"FEMNDaypLB"},{"type":"paragraph","position":{"start":{"line":601,"column":1},"end":{"line":601,"column":1}},"children":[{"type":"text","value":"In the absence of an exact solution, how can we be confident that the solution is accurate? First, the Levenberg iteration converged without issuing a warning, so we should feel confident that the discrete equations were solved. Assuming that we encoded the ","key":"oSZEdGpOyj"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"AKEiGqviKp"}],"key":"T5LA4q9kOL"},{"type":"text","value":" correctly, the remaining source of error is truncation from the discretization. We can estimate that by refining the grid a bit and seeing how much the numerical solution changes.","key":"ogebpJJd2j"}],"key":"cGfqd8ZRIR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_test = linspace(0, 2.5, 6);\ny_test = linspace(0, 1 , 5);\nmtx_test = tensorgrid(x_test, y_test);\nformat long\nmtx_test(u)","key":"MU1HQei3fF"},{"type":"output","id":"oAa0frlhm4rxEk9U6G-JB","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×5 double\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n   0.000000000000000  -0.174520738821158  -0.236562036535841  -0.174520738821158   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014285  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014284  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.174520738821157  -0.236562036535841  -0.174520738821157   0.000000000000000\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×5 double\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n   0.000000000000000  -0.174520738821158  -0.236562036535841  -0.174520738821158   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014285  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014284  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.174520738821157  -0.236562036535841  -0.174520738821157   0.000000000000000\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n","content_type":"text/plain"}}}],"key":"eSRlNp28iW"}],"data":{},"key":"sCeHca5ueS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = elliptic(phi, g, 25, [0, 2.5], 14, [0, 1]);\nmtx_test(u)","key":"G1G7CE8NoZ"},{"type":"output","id":"J1SeoxSWZYVzEWey4HibV","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×5 double\n                   0  -0.000000000000000   0.000000000000000  -0.000000000000000                   0\n  -0.000000000000000  -0.174516201277333  -0.236553894009285  -0.174516201277333  -0.000000000000000\n  -0.000000000000000  -0.232550238149297  -0.320474598914872  -0.232550238149296  -0.000000000000000\n  -0.000000000000000  -0.232550238149297  -0.320474598914872  -0.232550238149297  -0.000000000000000\n  -0.000000000000000  -0.174516201277334  -0.236553894009286  -0.174516201277333  -0.000000000000000\n                   0   0.000000000000000   0.000000000000000  -0.000000000000000                   0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×5 double\n                   0  -0.000000000000000   0.000000000000000  -0.000000000000000                   0\n  -0.000000000000000  -0.174516201277333  -0.236553894009285  -0.174516201277333  -0.000000000000000\n  -0.000000000000000  -0.232550238149297  -0.320474598914872  -0.232550238149296  -0.000000000000000\n  -0.000000000000000  -0.232550238149297  -0.320474598914872  -0.232550238149297  -0.000000000000000\n  -0.000000000000000  -0.174516201277334  -0.236553894009286  -0.174516201277333  -0.000000000000000\n                   0   0.000000000000000   0.000000000000000  -0.000000000000000                   0\n","content_type":"text/plain"}}}],"key":"nLGtNmsH26"}],"data":{},"key":"wrz96mn09v"},{"type":"paragraph","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"children":[{"type":"text","value":"The original solution seems to be accurate to about four digits.","position":{"start":{"line":616,"column":1},"end":{"line":616,"column":1}},"key":"dpjVHoVfKg"}],"key":"FKDfCHQDWK"}],"label":"demo-nonlinear2d-mems-matlab","identifier":"demo-nonlinear2d-mems-matlab","html_id":"demo-nonlinear2d-mems-matlab","key":"cqs8rkaqon"}],"key":"LCpfCPFst4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format","visibility":"show","key":"LAhXA8zQVx"},{"type":"output","id":"jmsGy1ZDyHUT9-oIoWkBN","data":[],"visibility":"show","key":"PsJExbqPIB"}],"data":{"tags":[]},"visibility":"remove","key":"ZwsUI77lSI"},{"type":"block","children":[{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-advdiff","label":"demo-nonlinear-advdiff","kind":"proof:example","position":{"start":{"line":626,"column":1},"end":{"line":626,"column":24}},"children":[{"type":"text","value":"Example ","key":"uDSWbmBev3"},{"type":"text","value":"13.4.3","key":"nQe37OTHwa"}],"template":"Example %s","enumerator":"13.4.3","resolved":true,"html_id":"demo-nonlinear-advdiff","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"JzIONtcctl"}],"key":"VbnLwfEKKX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(X, Y, U, Ux, Uxx, Uy, Uyy) 1 - Ux - 2*Uy + 0.05*(Uxx + Uyy);\ng = @(x, y) zeros(size(x));\nu = elliptic(phi, g, 32, [-1, 1], 32, [-1, 1]);","key":"iNJ0fNxhKm"},{"type":"output","id":"k1FY27Iuh3NLw6K5QSAYv","data":[],"key":"KgDAXibfUV"}],"data":{},"key":"NOAawNuLZz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(-1, 1, 80);\ny = x;\nmtx = tensorgrid(x, y);\nclf,  pcolor(x, y, mtx(u)')\ncolormap(parula),  shading interp,  colorbar\naxis equal,  xlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Steady advection–diffusion\")","visibility":"hide","key":"lwv3hfU2Hw"},{"type":"output","id":"Xjwtu4wneJtsx0G3YzFx1","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0d19d921aa7600c5fa04b5329b825b56","path":"/fnc/build/0d19d921aa7600c5fa04b5329b825b56.png"}}}],"visibility":"show","key":"VyQM68eKku"}],"data":{"tags":[]},"visibility":"show","key":"yTF01cRBIN"}],"label":"demo-nonlinear-advdiff-matlab","identifier":"demo-nonlinear-advdiff-matlab","html_id":"demo-nonlinear-advdiff-matlab","key":"LHHcIGGYEh"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear2d-allencahn","label":"demo-nonlinear2d-allencahn","kind":"proof:example","position":{"start":{"line":648,"column":1},"end":{"line":648,"column":28}},"children":[{"type":"text","value":"Example ","key":"d3hC7zBWrg"},{"type":"text","value":"13.4.4","key":"D65lbI3NUn"}],"template":"Example %s","enumerator":"13.4.4","resolved":true,"html_id":"demo-nonlinear2d-allencahn","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"cDBq8BhYK1"}],"key":"z9V9QlGAXq"},{"type":"paragraph","position":{"start":{"line":650,"column":1},"end":{"line":650,"column":1}},"children":[{"type":"text","value":"The following defines the ","key":"c11fOAbgd4"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"lnjmcZdfkv"}],"key":"oExXc48QLa"},{"type":"text","value":" and a nontrivial Dirichlet boundary condition for the square ","key":"FOQ4jAx6I4"},{"type":"inlineMath","value":"[0,1]^2","position":{"start":{"line":650,"column":1},"end":{"line":650,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">[0,1]^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"pOVyrRA9OY"},{"type":"text","value":".","position":{"start":{"line":650,"column":1},"end":{"line":650,"column":1}},"key":"IXQ7OsvNyi"}],"key":"YhO5y3DhIm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(X, Y, U, Ux, Uxx, Uy, Uyy) U .* (1-U.^2) + 0.05*(Uxx + Uyy);\ng = @(x, y) tanh(5*(x + 2*y - 1));","key":"PoppJGaBJH"},{"type":"output","id":"J_Qn_QGOhFWHA5We9F7xl","data":[],"key":"UmfJUIaXoE"}],"data":{},"key":"L2F7HcVHcr"},{"type":"paragraph","position":{"start":{"line":657,"column":1},"end":{"line":657,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"IDuzQlPjb7"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"FI2kjdLs7O"}],"key":"llD9JSx2ui"},{"type":"text","value":" and then plot the result.","key":"tJFqt2kGaz"}],"key":"rBCHpfLjj8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = elliptic(phi, g, 36, [0, 1], 36, [0, 1]);","key":"wMMs7lLCxC"},{"type":"output","id":"MbKXQEF4YRJyQ5e-7YOlf","data":[],"key":"pTWnTFxl8i"}],"data":{},"key":"tFz6C3htAE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(0, 1, 80);\ny = x;\nmtx = tensorgrid(x, y);\nclf,  pcolor(x, y, mtx(u)')\ncolormap(parula),  shading interp,  colorbar\naxis equal,  xlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Steady Allen–Cahn\")","visibility":"hide","key":"ecvdNmG55E"},{"type":"output","id":"aZa-rHXyY0E7huT63Ze9a","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"afc98e411cc7a34b192fbf62d1be19ba","path":"/fnc/build/afc98e411cc7a34b192fbf62d1be19ba.png"}}}],"visibility":"show","key":"eMXAh0uD1k"}],"data":{"tags":[]},"visibility":"show","key":"iwk9rQxpYe"}],"label":"demo-nonlinear2d-allencahn-matlab","identifier":"demo-nonlinear2d-allencahn-matlab","html_id":"demo-nonlinear2d-allencahn-matlab","key":"tBbmDk1Flu"}],"key":"HIS8OLQApY"}],"key":"p7YPe3hVoU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 12","url":"/chapter12-1","group":"MATLAB codes"},"next":{"title":"Python setup","url":"/setup-2","group":"Python codes"}}},"domain":"http://localhost:3000"}