{"kind":"Notebook","sha256":"781b65ea15574bb2b4cd7ce7d6cd337d1e4252d162c779e36008cc44a60b39d3","slug":"chapter13-1","location":"/matlab/chapter13.md","dependencies":[],"frontmatter":{"title":"Chapter 13","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter13.md","url":"/fnc/build/chapter13-16e0738b3417a663fcd956df95143add.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"N8DU2FkFIF"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"SUYzWnaZwC"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Create a tensor-product grid","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qUCVl1ZWDA"}],"key":"WuqrvWFKiJ"},{"type":"include","file":"fnc/tensorgrid.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y)\n% TENSORGRID Tensor-product grid.\n% Input:\n%   x, y           1d projections of the grid nodes (lengths m and n)\n% Output:\n%   mtx            evaluate a function on the grid (function)\n%   X, Y           mtx applied to the coordinate functions (m×n)\n%   vec            convert grid shape to vector shape (function)\n%   unvec          convert vector shape to grid shape (function)\n%   is_boundary    indicator of boundary nodes (logical m×n)\n    m = length(x) - 1;\n    n = length(y) - 1;\n    vec = @(U) U(:);\n    unvec = @(u) reshape(u, m+1, n+1);\n    [X, Y] = ndgrid(x, y);\n    function F = grideval(f)\n        F = zeros(size(X));\n        for k = 1:numel(X)\n            F(k) = f(X(k), Y(k));\n        end\n    end\n    mtx = @grideval;\n    \n    % Identify boundary points.\n    is_boundary = true(m+1, n+1);\n    is_boundary(2:m, 2:n) = false;\nend","lang":"matlab","showLineNumbers":true,"filename":"tensorgrid.m","key":"EhZ7xwBkXn"}],"key":"gu7cJZpPLV"}],"label":"function-tensorgrid-matlab","identifier":"function-tensorgrid-matlab","html_id":"function-tensorgrid-matlab","key":"p2uBkVpIsF"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solution of Poisson’s equation by finite differences","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"VZ88HXosiV"}],"key":"oORBtY8Ggj"},{"type":"include","file":"fnc/poissonfd.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [X, Y, U] = poissonfd(f,g,m,xspan,n,yspan)\r\n%POISSONFD   Solve Poisson's equation by finite differences.\r\n% Input:\r\n%   f            forcing function (function of x,y)\r\n%   g            boundary condition (function of x,y)\r\n%   m            number of grid points in x (integer)\r\n%   xspan        endpoints of the domain of x (2-vector)\r\n%   n            number of grid points in y (integer)\r\n%   yspan        endpoints of the domain of y (2-vector)\r\n%\r\n% Output:\r\n%   U            solution (m+1 by n+1)\r\n%   X,Y          grid matrices (m+1 by n+1)\r\n\r\n% Discretize the domain.\r\n[x, Dx, Dxx] = diffmat2(m, xspan);\r\n[y, Dy, Dyy] = diffmat2(n, yspan);\r\n[mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y);\r\n\r\n% Form the collocated PDE as a linear system. \r\nIx = speye(m+1);  Iy = speye(n+1);\r\nA = kron(Iy, sparse(Dxx)) + kron(sparse(Dyy), Ix);  % Laplacian matrix\r\nb = vec(mtx(f));\r\n\r\n% Replace collocation equations on the boundary.\r\nscale = max(abs(A(n+2, :)));\r\nI = speye(size(A));\r\nidx = vec(is_boundary);\r\nA(idx, :) = scale * I(idx, :);           % Dirichet assignment\r\nb(idx) = scale * g( X(idx),Y(idx) );     % assigned values\r\n\r\n% Solve the linear sytem and reshape the output.\r\nu = A \\ b;\r\nU = unvec(u);","lang":"matlab","showLineNumbers":true,"filename":"poissonfd.m","key":"mrN4Z5mMAT"}],"key":"Mi5crV3fVx"}],"label":"function-poissonfd-matlab","identifier":"function-poissonfd-matlab","html_id":"function-poissonfd-matlab","key":"X7GPIgOiOc"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solution of elliptic ","key":"LFcJTUXUGo"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"z6ffSCnCmt"}],"key":"xgoO5saxd3"},{"type":"text","value":" by Chebyshev collocation","key":"wyA4Xcm7s0"}],"key":"Q2QZdJokEC"},{"type":"include","file":"fnc/elliptic.m","literal":true,"filter":{},"children":[{"type":"code","value":"function u = elliptic(phi, g, m, xspan, n, yspan)\n%ELLIPTIC   Solve an elliptic PDE in 2d.\n% Input:\n%   phi          defines phi)(x,y,u,u_x,u_xx,u_y,u_yy) = 0 (function)\n%   g            boundary condition (function)\n%   m, xspan     size and interval of x discretization (integer, 2-vector)\n%   n, yspan     size and interval of y discretization (integer, 2-vector)\n% Output:\n%   U            solution (n+1 by n+1)\n%   X,Y          coordinate matrices (n+1 by n+1)\n\n    % Discretize the domain.\n    [x, Dx, Dxx] = diffcheb(m, xspan);\n    [y, Dy, Dyy] = diffcheb(n, yspan);\n    [mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y);\n\n    % Identify boundary locations and evaluate the boundary condition.\n    idx = vec(is_boundary);\n    gb = g(X(idx), Y(idx));\n\n    % Evaluate the PDE+BC residual.\n    function r = residual(u)\n        U = unvec(u);\n        R = phi(X, Y, U, Dx * U, Dxx * U, U * Dy', U * Dyy');  % PDE\n        R(idx) = u(idx) - gb;                                  % boundary\n        r = vec(R);\n    end\n\n    % Solve the equation.\n    u = levenberg(@residual, vec(zeros(size(X))));\n    U = unvec(u(:, end));\n\n    function u = evaluate(xi, eta)\n        v = zeros(1, n+1);\n        for j = 1:n+1\n            v(j) = chebinterp(x, U(:, j), xi);\n        end\n        u = chebinterp(y, v, eta);\n    end\n\n    u = @evaluate;\nend\n\nfunction f = chebinterp(x, v, xi)\n    n = length(x) - 1;\n    w = (-1.0) .^ (0:n)';\n    w([1, n+1]) = w([1, n+1]) / 2;\n\n    terms = w ./ (xi - x(:));\n    if any(isinf(terms))     % exactly at a node\n        f = v(xi == x);\n    else\n        f = sum(v(:) .* terms) / sum(terms);\n    end\nend\n","lang":"matlab","showLineNumbers":true,"filename":"elliptic.m","key":"PtA0azO5dA"}],"key":"mID50tDpqc"}],"label":"function-elliptic-matlab","identifier":"function-elliptic-matlab","html_id":"function-elliptic-matlab","key":"DL6xpMylh9"},{"type":"heading","depth":2,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"avq5ZaF0iP"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"k1FfDHaksi"}],"key":"ayf5ciwdVL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"addpath /Users/driscoll/Documents/GitHub/fnc/matlab/fnc\naddpath /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"W80IMcVzCe"},{"type":"output","id":"Xx831u_L756sJ0UPot3UP","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (3) with properties:\n\n      Number: 3\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (3) with properties:\n\n      Number: 3\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"Fyl3a1FiOY"}],"data":{"tags":[]},"visibility":"remove","key":"pmZYpqeMYh"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"13.1 ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"oG1PukW5Dk"},{"type":"link","identifier":"section-twodim-tensorprod","label":"section-twodim-tensorprod","kind":"narrative","position":{"start":{"line":46,"column":6},"end":{"line":46,"column":32}},"url":"/tensorprod","internal":true,"dataUrl":"/tensorprod.json","children":[{"type":"text","value":"Tensor-product discretizations","key":"zYpMzzDrBI"}],"key":"lPtEPv3Yqr"}],"identifier":"id-13-1","label":"13.1 ","html_id":"id-13-1","implicit":true,"key":"lqfD7CLyB1"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-gridfun","label":"demo-tensorprod-gridfun","kind":"proof:example","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":25}},"children":[{"type":"text","value":"Example ","key":"RIyrinyBPE"},{"type":"text","value":"13.1.2","key":"rFo7tip5LY"}],"template":"Example %s","enumerator":"13.1.2","resolved":true,"html_id":"demo-tensorprod-gridfun","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"QH9PuJYNlY"}],"key":"Ik93AF4DUz"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Here is the grid from ","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"qkXvyjYmNY"},{"type":"crossReference","kind":"proof:example","identifier":"example-tensorprod-smallgrid","label":"example-tensorprod-smallgrid","children":[{"type":"text","value":"Example ","key":"lXazRmXRRU"},{"type":"text","value":"13.1.1","key":"lZlMnOspEF"}],"template":"Example %s","enumerator":"13.1.1","resolved":true,"html_id":"example-tensorprod-smallgrid","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"JdMqLifiNu"},{"type":"text","value":".","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"IVScY37o7f"}],"key":"XI5LfcyELj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 4;   \nx = linspace(0, 2, m+1);\nn = 2;   \ny = linspace(1, 3, n+1);","key":"eDNwtrToio"},{"type":"output","id":"vYDiEXsk7y8qW7PhJ57RJ","data":[],"key":"Z1CyfbCQm0"}],"data":{},"key":"MfhoPHKkvk"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"For a given ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"tk0STHDXkt"},{"type":"inlineMath","value":"f(x,y)","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"H0mLn8P9dj"},{"type":"text","value":" we can find ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"DYJDb76Nio"},{"type":"inlineMath","value":"\\operatorname{mtx}(f)","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">mtx</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>f</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\operatorname{mtx}(f)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">mtx</span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mclose\">)</span></span></span></span>","key":"R28UzzYIxz"},{"type":"text","value":" by using a comprehension syntax.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"KqfKHoPbrT"}],"key":"Hdhi13QUzQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[mtx, X, Y] = tensorgrid(x, y);\nf = @(x, y) cos(pi * x .* y - y);\nF = mtx(f)","key":"l52S0gZ51V"},{"type":"output","id":"sOUP4TRFa-EKm3sXb4UQ6","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>F = 201×3 double\n    0.5403   -0.4161   -0.9900\n    0.6415   -0.1769   -0.8685\n    0.7326    0.0734   -0.6251\n    0.8121    0.3191   -0.2938\n    0.8789    0.5448    0.0787\n    0.9317    0.7362    0.4401\n    0.9699    0.8814    0.7398\n    0.9928    0.9712    0.9355\n    1.0000    0.9999    0.9999\n    0.9914    0.9659    0.9238\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"F = 201×3 double\n    0.5403   -0.4161   -0.9900\n    0.6415   -0.1769   -0.8685\n    0.7326    0.0734   -0.6251\n    0.8121    0.3191   -0.2938\n    0.8789    0.5448    0.0787\n    0.9317    0.7362    0.4401\n    0.9699    0.8814    0.7398\n    0.9928    0.9712    0.9355\n    1.0000    0.9999    0.9999\n    0.9914    0.9659    0.9238\n...","content_type":"text/plain"}}}],"key":"rKUdWTMGbD"}],"data":{},"key":"cXfizwbMH8"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"We can make a nice plot of the function by first choosing a much finer grid. However, the contour and surface plotting functions expect the ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"yM84A7wtnz"},{"type":"emphasis","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"transpose","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"yqPwIcQ65L"}],"key":"JgRmwhur5R"},{"type":"text","value":" of mtx(","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"A9k25akAN0"},{"type":"inlineMath","value":"f","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"Hz9Iw3qJPg"},{"type":"text","value":").","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"JecE5axBhE"}],"key":"SXjLhtSChm"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"To emphasize departures from a zero level, use a colormap such as ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"j83aD3UUVx"},{"type":"inlineCode","value":"redsblues","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"vsSp8dhRxv"},{"type":"text","value":" and set the color limits to be symmetric around zero.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"BeyYZiNqJV"}],"key":"QByHqQ5ZXJ"}],"key":"tqRyfcy1Mw"}],"key":"fxSdlFIk2t"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"X6B0LYnWJC"}],"key":"JgpI2Jgkgb"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"The contour and surface plotting functions expect the ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"n3x1F4fkJR"},{"type":"emphasis","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"transpose","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"nroJWBuRuY"}],"key":"NviVDJplWa"},{"type":"text","value":" of the outputs of ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"xrwIXIAqvx"},{"type":"inlineCode","value":"mtx","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"MgeiwxFIdj"},{"type":"text","value":". If you forget to do that, the ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"ibAoTi0cbg"},{"type":"inlineMath","value":"x","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"pKwj99leRO"},{"type":"text","value":" and ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"XwLvzFEf9S"},{"type":"inlineMath","value":"y","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"pM2X5St4Y2"},{"type":"text","value":" axes will be swapped.","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"t1vJFrxOuq"}],"key":"x9nvStZIs7"}],"key":"HQUaiMi2qh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 80;  x = linspace(0, 2, m+1);\nn = 60;  y = linspace(1, 3, n+1);\n[mtx, X, Y] = tensorgrid(x, y);\nF = mtx(f);\n\npcolor(X', Y', F')\nshading interp\ncolormap(redsblues),  colorbar\naxis equal\nxlabel(\"x\"),  ylabel(\"y\")","key":"xlO2fgt1SJ"},{"type":"output","id":"KhtXsk3kUiH9iEEQ0wIV7","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8919fa26f6893e4b98611f8c4e3a56f7","path":"/fnc/build/8919fa26f6893e4b98611f8c4e3a56f7.png"}}}],"key":"SY7EYDplLy"}],"data":{},"key":"HbNjbGQHjS"}],"label":"demo-tensorprod-gridfun-matlab","identifier":"demo-tensorprod-gridfun-matlab","html_id":"demo-tensorprod-gridfun-matlab","key":"QTOHBiWBT9"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-disksphere","label":"demo-tensorprod-disksphere","kind":"proof:example","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":28}},"children":[{"type":"text","value":"Example ","key":"kE2XJm55he"},{"type":"text","value":"13.1.3","key":"WFCnNtYQKb"}],"template":"Example %s","enumerator":"13.1.3","resolved":true,"html_id":"demo-tensorprod-disksphere","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"kiQIfafTpq"}],"key":"caHuNRNjxZ"},{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"For a function given in polar form, such as ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"DkcwhU7Nb8"},{"type":"inlineMath","value":"f(r,\\theta)=1-r^4","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>r</mi><mn>4</mn></msup></mrow><annotation encoding=\"application/x-tex\">f(r,\\theta)=1-r^4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span></span>","key":"pn9FkpzFuj"},{"type":"text","value":", construction of a function over the unit disk is straightforward using a grid in ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"PZyHsDpon3"},{"type":"inlineMath","value":"(r,\\theta)","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span>","key":"u2pf7QruOe"},{"type":"text","value":" space.","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"J442Q3zAQo"}],"key":"XM7Axmmd8F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"r = linspace(0, 1, 41);\ntheta = linspace(0, 2*pi, 121);\n[mtx, R, Theta] = tensorgrid(r, theta);\nF = mtx(@(r, theta) 1 - r.^4);\nclf,  colormap(parula)\ncontourf(R', Theta', F', 20)\nshading flat\nxlabel(\"r\"),  ylabel(\"\\theta\"), \ntitle(\"A polar function\")","key":"EMcN4KFwNz"},{"type":"output","id":"gU6yJrRIqP81DpvJJiotm","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c743406ec36a45a77f23a39d482c27bd","path":"/fnc/build/c743406ec36a45a77f23a39d482c27bd.png"}}}],"key":"v7Q9CwovOu"}],"data":{},"key":"Of2Mes28RQ"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"Of course, we are used to seeing such plots over the ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"h22wvausXd"},{"type":"inlineMath","value":"(x,y)","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"igG2Bkmuis"},{"type":"text","value":" plane, not the ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"aSoExoVYzG"},{"type":"inlineMath","value":"(r,\\theta)","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\theta)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span>","key":"JzB1W0QZCW"},{"type":"text","value":" plane. For this we create matrices for the coordinate functions ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"jCyO9C0Gl2"},{"type":"inlineMath","value":"x","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"d4gUtnLfyL"},{"type":"text","value":" and ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"o2556AX81P"},{"type":"inlineMath","value":"y","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"GJIe38HCkb"},{"type":"text","value":".","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"TqaV2hgcUX"}],"key":"qLIrsmhh3D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"X = R .* cos(Theta);  Y = R .* sin(Theta);\ncontourf(X', Y', F', 20)\naxis equal,  shading interp  \nxlabel('x'),  ylabel('y')\ntitle('Function over the unit disk')","key":"F5l4md3jHZ"},{"type":"output","id":"2Gi7ZM4JCShQjSXi2zqx7","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4da992ad23347a40a6d0e3b44b316625","path":"/fnc/build/4da992ad23347a40a6d0e3b44b316625.png"}}}],"key":"qjet1epEXM"}],"data":{},"key":"e9KBSHRVIv"},{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"In such functions the values along the line ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"xilsbpLfYF"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">r=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"z12ZRBrwiB"},{"type":"text","value":" must be identical, and the values on the line ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"u3qNhN0WTV"},{"type":"inlineMath","value":"\\theta=0","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\theta=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"DZK08Ti9cE"},{"type":"text","value":" should be identical to those on ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"THpCt881LX"},{"type":"inlineMath","value":"\\theta=2\\pi","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi><mo>=</mo><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\theta=2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"ObuzoJ6VHw"},{"type":"text","value":". Otherwise the interpretation of the domain as the unit disk is nonsensical. If the function is defined in terms of ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"xv24umT9ma"},{"type":"inlineMath","value":"x","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Cv5seNcuf6"},{"type":"text","value":" and ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"S2uZYa7HbM"},{"type":"inlineMath","value":"y","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"j5OT0wtTKA"},{"type":"text","value":", then those can be defined in terms of ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"EcTtaGRh4c"},{"type":"inlineMath","value":"r","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span></span>","key":"dE7OZD462u"},{"type":"text","value":" and ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"wbGGD3T2Kk"},{"type":"text","value":"θ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"MHZUuGmO0q"},{"type":"text","value":" using ","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"rCH7A43EQq"},{"type":"crossReference","kind":"equation","identifier":"unitdiskparam","label":"unitdiskparam","children":[{"type":"text","value":"(","key":"PNgivzd9YW"},{"type":"text","value":"13.1.6","key":"scKi6mnD09"},{"type":"text","value":")","key":"ggzcZY66f2"}],"template":"(%s)","enumerator":"13.1.6","resolved":true,"html_id":"unitdiskparam","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"kFaOJgmBjf"},{"type":"text","value":".","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"qZVcqkDjda"}],"key":"Ph87fvw1PB"}],"label":"demo-tensorprod-disksphere-matlab","identifier":"demo-tensorprod-disksphere-matlab","html_id":"demo-tensorprod-disksphere-matlab","key":"w6NzUbGROC"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tensorprod-diff","label":"demo-tensorprod-diff","kind":"proof:example","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":22}},"children":[{"type":"text","value":"Example ","key":"iUWCG8baJS"},{"type":"text","value":"13.1.4","key":"qQ6wtFZxCc"}],"template":"Example %s","enumerator":"13.1.4","resolved":true,"html_id":"demo-tensorprod-diff","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"djsFv8fzzb"}],"key":"iXRYULG0hs"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"We define a function and, for reference, its two exact partial derivatives.","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"XcmF9yDUvF"}],"key":"HRA9igq5X7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = @(x, y) sin(pi * x .* y - y);\ndu_dx = @(x, y) pi * y .* cos(pi * x .* y - y);\ndu_dy = @(x, y) (pi * x - 1) .* cos(pi * x .* y - y);","key":"QjrO6UF8nX"},{"type":"output","id":"cKFSD3qhKe-qEaHZf5YNY","data":[],"key":"jikUG1wN7k"}],"data":{},"key":"Eu38XCmPjF"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"We will use an equispaced grid and second-order finite differences as implemented by ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"DBivewFnPT"},{"type":"inlineCode","value":"diffmat2","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"qIzJWS924q"},{"type":"text","value":". First, we have a look at a plots of the exact partial derivatives.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"bSBjSq2KRc"}],"key":"S8Xbcpd3Qn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 80;  [x, Dx] = diffmat2(m, [0, 2]);\nn = 60;  [y, Dy] = diffmat2(n, [1, 4]);\n[mtx, X, Y] = tensorgrid(x, y);\nU = mtx(u);\ndU_dX = mtx(du_dx);\ndU_dY = mtx(du_dy);","key":"X6lO65ZfkH"},{"type":"output","id":"904kTWsmyDZDYPkOmgzh-","data":[],"key":"ekj5esXvzS"}],"data":{},"key":"mp3uGrGzh4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  subplot(1, 2, 1)\npcolor(X', Y', dU_dX')\naxis equal,  shading interp\ntitle('∂u/∂x')\nsubplot(1, 2, 2)\npcolor(X', Y', dU_dY')\naxis equal,  shading interp\ntitle('∂u/∂y')","key":"IdvPfT2yD1"},{"type":"output","id":"NtWTO3ebpf4UQ120j60gZ","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d8bd401b7b762527ffb6f6a5327fecde","path":"/fnc/build/d8bd401b7b762527ffb6f6a5327fecde.png"}}}],"key":"NElMDR4Pqs"}],"data":{},"key":"tX8jVkkckZ"},{"type":"paragraph","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"Now we compare the exact partial derivatives with their finite-difference approximations. Since these are signed errors, we use a colormap that is symmetric around zero.","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"pYWPkTmpfg"}],"key":"xr51syk2fV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = dU_dX - Dx * U;\nsubplot(1, 2, 1)\npcolor(X', Y', err')\ncolorbar,  clim([-.4, .4])\naxis equal,  shading interp\ntitle('error in ∂u/∂x')\n\nerr = dU_dY - U * Dy';\nsubplot(1,2,2)\npcolor(X', Y', err')\ncolorbar,  clim([-.1, .1])\naxis equal,  shading interp\ncolormap(redsblues)\ntitle('error in ∂u/∂y')","key":"ZWpJV2gtYw"},{"type":"output","id":"-cn-sOfv_5jQ4v18-yjaf","data":[{"output_type":"stream","name":"stderr","text":"Error using -\nArrays have incompatible sizes for this operation."}],"key":"KSTRr1OQRO"}],"data":{},"key":"a5ygvPaPBK"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"Not surprisingly, the errors are largest where the derivatives themselves are largest.","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"I0YgGAVBl4"}],"key":"pd3GOofRQM"}],"label":"demo-tensorprod-diff-matlab","identifier":"demo-tensorprod-diff-matlab","html_id":"demo-tensorprod-diff-matlab","key":"cStRhbK59m"},{"type":"heading","depth":3,"position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"13.2 ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"sQjSnG6uOa"},{"type":"link","identifier":"section-twodim-diffadv","label":"section-twodim-diffadv","kind":"narrative","position":{"start":{"line":176,"column":6},"end":{"line":176,"column":29}},"url":"/diffadv","internal":true,"dataUrl":"/diffadv.json","children":[{"type":"text","value":"Two-dimensional diffusion and advection","key":"m7oqolGZAG"}],"key":"mZDxzfcCyS"}],"identifier":"id-13-2","label":"13.2 ","html_id":"id-13-2","implicit":true,"key":"TJOVqlCKLG"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-vec","label":"demo-diffadv-vec","kind":"proof:example","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":18}},"children":[{"type":"text","value":"Example ","key":"VsmAZhI3Xo"},{"type":"text","value":"13.2.1","key":"yEk8RsT74S"}],"template":"Example %s","enumerator":"13.2.1","resolved":true,"html_id":"demo-diffadv-vec","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"BYDhGkqajc"}],"key":"yD3vE23jed"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 4;  n = 3;\nx = linspace(0, 2, m+1);\ny = linspace(-3, 0, n+1);\n\nf = @(x, y) cos(0.75*pi * x .* y - 0.5*pi * y);\n[mtx, X, Y, vec, unvec] = tensorgrid(x, y);\nF = mtx(f);\ndisp(\"function on a 4x3 grid:\")\ndisp(F)","key":"qz24FtI8nt"},{"type":"output","id":"SnzAZXTbFdrBkG97Nzk19","data":[{"output_type":"stream","name":"stdout","text":"function on a 4x3 grid:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"   -0.0000   -1.0000    0.0000    1.0000\n    0.3827    0.7071    0.9239    1.0000\n   -0.7071    0.0000    0.7071    1.0000\n    0.9239   -0.7071   -0.3827    1.0000\n   -1.0000    1.0000   -1.0000    1.0000\n\n"}],"key":"NkeJ0PHOaX"}],"data":{},"key":"LdpQR61qDX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"vec(F):\")\ndisp(vec(F))","key":"W3LyGhRW36"},{"type":"output","id":"tvgXYFlUXR_DF4ifxMnMw","data":[{"output_type":"stream","name":"stdout","text":"vec(F):"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"   -0.0000\n    0.3827\n   -0.7071\n    0.9239\n   -1.0000\n   -1.0000\n    0.7071\n    0.0000\n   -0.7071\n    1.0000\n    0.0000\n    0.9239\n    0.7071\n   -0.3827\n   -1.0000\n    1.0000\n    1.0000\n    1.0000\n    1.0000\n    1.0000\n\n"}],"key":"mIGAiEwk0C"}],"data":{},"key":"N4UT6yUXph"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"g0YKkhsTWw"},{"type":"inlineCode","value":"unvec","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"iiHilTRwn3"},{"type":"text","value":" operation is the inverse of vec.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"Q29dUZmhue"}],"key":"ZMrDaefjBT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"unvec(vec(F)):\")\ndisp(unvec(vec(F)))","key":"AvZ3YCnXPi"},{"type":"output","id":"WGNQwtnWxBgnER-nceZuy","data":[{"output_type":"stream","name":"stdout","text":"unvec(vec(F)):"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"   -0.0000   -1.0000    0.0000    1.0000\n    0.3827    0.7071    0.9239    1.0000\n   -0.7071    0.0000    0.7071    1.0000\n    0.9239   -0.7071   -0.3827    1.0000\n   -1.0000    1.0000   -1.0000    1.0000\n\n"}],"key":"oj9ZuuTGbA"}],"data":{},"key":"Sm88420tl1"}],"label":"demo-diffadv-vec-matlab","identifier":"demo-diffadv-vec-matlab","html_id":"demo-diffadv-vec-matlab","key":"NRaSQnFzsj"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-heat","label":"demo-diffadv-heat","kind":"proof:example","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":19}},"children":[{"type":"text","value":"Example ","key":"i2yaBOZzDZ"},{"type":"text","value":"13.2.2","key":"uggMuVPSef"}],"template":"Example %s","enumerator":"13.2.2","resolved":true,"html_id":"demo-diffadv-heat","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"uTpExs0866"}],"key":"f5YJO6cNP0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 60;  n = 40;\n[x, Dx, Dxx] = diffper(m, [-1, 1]);\n[y, Dy, Dyy] = diffper(n, [-1, 1]);\n[mtx, X, Y, vec, unvec] = tensorgrid(x, y);","key":"gqhkb1JxzZ"},{"type":"output","id":"tQSL3yB_QmVptf34eWLjl","data":[],"key":"eKzHtPxJpR"}],"data":{},"key":"UtnhlDwHsw"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Note that the initial condition should also be periodic on the domain.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"jeXgUy1XVn"}],"key":"H1GlppTX6s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U0 = sin(4*pi*X) .* exp( cos(pi*Y) );\nclf,  surf(X', Y', U0')\nmx = max(abs(vec(U0)));\nclim([-mx, mx]),  shading interp\ncolormap(redsblues)\nxlabel('x'),  ylabel('y')  \ntitle('Initial condition')","key":"M46UFVTWPd"},{"type":"output","id":"sMrocQOZrySnGXU76-KAm","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cc623746d0ca2e574fc3cfe4296693d7","path":"/fnc/build/cc623746d0ca2e574fc3cfe4296693d7.png"}}}],"key":"CgXuvkDxc0"}],"data":{},"key":"syKpjb8k5b"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"This function computes the time derivative for the unknowns. The actual calculations take place using the matrix shape.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"AdkYUoJdis"}],"key":"ckqfZAK4V2"},{"type":"include","file":"f13_2_heat.m","literal":true,"filter":{},"children":[{"type":"code","value":"function du_dt = timederiv(t, u, p)\n    [alpha, Dxx, Dyy, vec, unvec] = p{:};\n    U = unvec(u);\n    Uxx = Dxx * U;  Uyy = U * Dyy';     % 2nd partials\n    dU_dt = alpha * (Uxx + Uyy);  % PDE\n    du_dt = vec(dU_dt);\nend","lang":"matlab","filename":"f13_2_heat.m","key":"cN4fGR0FR4"}],"key":"q6Hr0Yniit"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"Since this problem is parabolic, a stiff integrator is appropriate.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"UQRqkksq6V"}],"key":"BT5qNX3YTw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_heat);\nivp.InitialTime = 0;\nivp.InitialValue = vec(U0);\nivp.Parameters = {0.1, Dxx, Dyy, vec, unvec};\nivp.Solver = \"stiff\";\nsol = solutionFcn(ivp, 0, 0.2);\nU = @(t) unvec(sol(t));","key":"frGCirWi0z"},{"type":"output","id":"m7DrgMNQpkBvpNLNjHNbt","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.\n\nError in f13_2_heat (line 4)\n    Uxx = Dxx * U;  Uyy = U * Dyy';     % 2nd partials\n\nError in odearguments (line 93)\nf0 = ode(t0,y0,args{:});\n\nError in ode15s (line 148)\n    odearguments(odeIsFuncHandle, odeTreatAsMFile, solver_name, ode, tspan, y0, options, varargin);\n\nError in matlab.ode.internal.LegacySolver/extend (line 56)\n                obj.sol = obj.SolverFcn(args{:});\n\nError in matlab.ode.internal.SolverPair/extend (line 162)\n                [obj.rSolver,tmax] = obj.rSolver.extend(t2);\n\nError in ode/solutionFcn (line 382)\n            [ODESOL,L,R] = ODESOL.extend(L,R);"}],"key":"omDmDNR7rj"}],"data":{},"key":"zzjYL2XnKT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"surf(X', Y', U0')\nmx = max(abs(vec(U0)));\nclim([-mx, mx]),  shading interp\ncolormap(redsblues)\nxlabel('x'),  ylabel('y')  \ntitle('Initial condition')","visibility":"hide","key":"qRYzsgLGcw"},{"type":"output","id":"Wyv7TyuCFI3tcwte8C_zh","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ec3b21b69d5ab34321f5934930561c5","path":"/fnc/build/7ec3b21b69d5ab34321f5934930561c5.png"}}}],"visibility":"show","key":"skBe96fJK7"}],"data":{"tags":[]},"visibility":"show","key":"N3wxot4vJP"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"Here is an animation of the solution.","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"LX9HbKTT6r"}],"key":"ThGn0wQqvs"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"XNgwrttWg7"},{"type":"inlineCode","value":"clims","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"lD3lqAXxVs"},{"type":"text","value":" are set so that colors remain at fixed values throughout the animation.","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"YixXGrIFjQ"}],"key":"h5yqW8on7C"}],"key":"lH3Eep8AGN"}],"key":"UBCet37QTP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"title('Heat equation on a periodic domain')\nvid = VideoWriter(\"figures/2d-heat.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 0.2, 61)\n    cla, surf(X', Y', U(t)')\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-0.9, 0.75, 2, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","key":"PgtcMBMNu1"},{"type":"output","id":"0MSGM9-AOrdIilNlUyP12","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ebeb29dcfb066f73d4bff7bde1ff9fc1","path":"/fnc/build/ebeb29dcfb066f73d4bff7bde1ff9fc1.png"}}},{"output_type":"stream","name":"stderr","text":"Cannot create file figures/2d-heat.mp4. Permission Denied."}],"key":"j6zDj1HSu9"}],"data":{},"key":"Nr165RyG8z"},{"type":"image","url":"/fnc/build/2d-heat-e75910dcc116d212feed993ecb032287.mp4","alt":"Heat equation in 2d","position":{"start":{"line":278,"column":1},"end":{"line":278,"column":1}},"key":"ebgGeLM2Nf","urlSource":"figures/2d-heat.mp4"}],"label":"demo-diffadv-heat-matlab","identifier":"demo-diffadv-heat-matlab","html_id":"demo-diffadv-heat-matlab","key":"wOpA7ufF74"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","kind":"proof:example","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":22}},"children":[{"type":"text","value":"Example ","key":"EWAUOuKXis"},{"type":"text","value":"13.2.3","key":"YVG729rFF4"}],"template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"mQLYkSvCry"}],"key":"rMdVTRLi58"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"The first step is to define a discretization of the domain and the initial state.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"CDt3l0WQXQ"}],"key":"rCd0Z8YmHA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 50;  n = 40;\n[x, Dx, Dxx] = diffcheb(m, [-1, 1]);\n[y, Dy, Dyy] = diffcheb(n, [-1, 1]);\n[mtx, X, Y] = tensorgrid(x, y);\nu_init = @(x, y) (1+y) .* (1-x).^4 .* (1+x).^2 .* (1-y.^4);","key":"HcrBBMrcR3"},{"type":"output","id":"6INZd_Evc3BXG1PPsvX0H","data":[],"key":"GioWxgC532"}],"data":{},"key":"vx0SRL3KYU"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"There are really two grids now: the full grid and the subset grid of interior points. Since the ","key":"irt8G0WVCe"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"zQh09TccSB"}],"key":"MdpMkWkMHB"},{"type":"text","value":" unknowns are on the interior grid, that is the one we need to change shapes on. We also need the functions ","key":"KyLhPJS4hh"},{"type":"inlineCode","value":"extend","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"NXdnp8oAIf"},{"type":"text","value":" and ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"nmRHcuCsjE"},{"type":"inlineCode","value":"chop","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"BDe5Wit5pp"},{"type":"text","value":" to add and remove boundary values.","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"YjYlbSho9T"}],"key":"Blcb96opMn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, ~, ~, vec, unvec] = tensorgrid(x(2:m), y(2:n));\nchop = @(U) U(2:m, 2:n);\nz = zeros(1, n-1);\nextend = @(U) [ zeros(m+1, 1) [z; U; z] zeros(m+1, 1)];\npack = @(U) vec(chop(U));\nunpack = @(u) extend(unvec(u));","key":"wZ6ZBKQy57"},{"type":"output","id":"WdnkFe7js4v9KDCnDwkZR","data":[],"key":"h3LlQInYt0"}],"data":{},"key":"zRDYwrsvPd"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"Now we can define and solve the ","key":"v4RDBMUSDG"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"BgucytsmrU"}],"key":"APFPufZL2U"},{"type":"text","value":" using a stiff solver.","key":"Av9l3uNDsf"}],"key":"D94j0G2SNu"},{"type":"include","file":"f13_2_advdiff.m","literal":true,"filter":{},"children":[{"type":"code","value":"function du_dt = timederiv(t, u, p)\n    [ep, Dx, Dxx, Dy, Dyy, pack, unpack] = p{:};\n    U = unpack(u);\n    Uxx = Dxx * U;  Uyy = U * Dyy'; \n    dU_dt = 1 - Dx * U + ep * (Uxx + Uyy);  % PDE\n    du_dt = pack(dU_dt);\nend","lang":"matlab","filename":"f13_2_advdiff.m","key":"DDUj1icq80"}],"key":"TKOOdmcHZx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_advdiff);\nivp.InitialTime = 0;\nivp.InitialValue = pack(mtx(u_init));\nivp.Parameters = {0.05, Dx, Dxx, Dy, Dyy, pack, unpack};\nivp.Solver = \"stiff\";\nsol = solutionFcn(ivp, 0, 2);","key":"Pzcqi1aiu9"},{"type":"output","id":"tUdQc6JlwruXlLKJFeITr","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.\n\nError in f13_2_advdiff (line 4)\n    Uxx = Dxx * U;  Uyy = U * Dyy'; \n\nError in odearguments (line 93)\nf0 = ode(t0,y0,args{:});\n\nError in ode15s (line 148)\n    odearguments(odeIsFuncHandle, odeTreatAsMFile, solver_name, ode, tspan, y0, options, varargin);\n\nError in matlab.ode.internal.LegacySolver/extend (line 56)\n                obj.sol = obj.SolverFcn(args{:});\n\nError in matlab.ode.internal.SolverPair/extend (line 162)\n                [obj.rSolver,tmax] = obj.rSolver.extend(t2);\n\nError in ode/solutionFcn (line 382)\n            [ODESOL,L,R] = ODESOL.extend(L,R);"}],"key":"SdlwMah9NH"}],"data":{},"key":"NnHvCttD7o"},{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"When we evaluate the solution at a particular value of ","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"efTupQK338"},{"type":"inlineMath","value":"t","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"XOWG6qPwsB"},{"type":"text","value":", we get a vector of the interior grid values. The same ","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"SR8XS3rnqm"},{"type":"inlineCode","value":"unpack","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"CwU8NkXEjH"},{"type":"text","value":" function above converts this to a complete matrix of grid values.","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"BgVpBFxirL"}],"key":"jJGVa18CEU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"U = @(t) unpack(sol(t));\n\nclf,  pcolor(X', Y', U(0.5)')\nclim([0, 2]), shading interp\naxis equal,  colormap(sky), colorbar\ntitle('Advection-diffusion at t = 0.5')  \nxlabel('x'),  ylabel('y')","key":"vQywfZ30Ey"},{"type":"output","id":"dK6CkpvWcJCIEUxOQf0AD","data":[{"output_type":"stream","name":"stderr","text":"Array indices must be positive integers or logical values.\n\nError in Notebook>@(t)unpack(sol(t)) (line 1)\nU = @(t) unpack(sol(t));"}],"key":"X4TcMPyM9t"}],"data":{},"key":"ZkTqcpZzcd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nvid = VideoWriter(\"figures/2d-advdiff.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 2, 81)\n    cla, pcolor(X', Y', U(t)')\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-1.5, 0.75, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"VhrDWTwZFV"},{"type":"output","id":"rjn5P_soZc1DPN6twFzOz","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d08d894851c8c53a7a2fd29d1e832d08","path":"/fnc/build/d08d894851c8c53a7a2fd29d1e832d08.png"}}},{"output_type":"stream","name":"stderr","text":"Cannot create file figures/2d-advdiff.mp4. Permission Denied."}],"visibility":"show","key":"GOZ37O1Jj5"}],"data":{"tags":[]},"visibility":"show","key":"LGVM08aPRl"},{"type":"image","url":"/fnc/build/2d-advdiff-7867f4436b623464fe6c952b2f68396c.mp4","alt":"Advection-diffusion in 2d","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"l1RZAlcsDY","urlSource":"figures/2d-advdiff.mp4"}],"label":"demo-diffadv-advdiff-matlab","identifier":"demo-diffadv-advdiff-matlab","html_id":"demo-diffadv-advdiff-matlab","key":"Q123Kaub2k"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","kind":"proof:example","position":{"start":{"line":353,"column":1},"end":{"line":353,"column":19}},"children":[{"type":"text","value":"Example ","key":"wdFnEu1HXe"},{"type":"text","value":"13.2.4","key":"SpiT4Fxu4w"}],"template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"Q4X5eveR91"}],"key":"W5A07mOHXg"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"We start with the discretization and initial condition.","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"jziMcBOC8s"}],"key":"l4U7FBdyuO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 40; n = 42;\n[x, Dx, Dxx] = diffcheb(m, [-2, 2]);\n[y, Dy, Dyy] = diffcheb(n, [-2, 2]);\n[mtx, X, Y] = tensorgrid(x, y);\n\nu_init = @(x, y) (x+0.2) .* exp(-12*(x.^2 + y.^2));\nU0 = mtx(u_init);\nV0 = zeros(size(U0));","key":"YMobBwJVKf"},{"type":"output","id":"naYVpxrA12oSfprhvxgQ5","data":[],"key":"VrtQXTfTDe"}],"data":{},"key":"JPHWgctbt5"},{"type":"paragraph","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"children":[{"type":"text","value":"Note that because ","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"Hay91AB4eP"},{"type":"inlineMath","value":"u","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"qZRHzADIWh"},{"type":"text","value":" is known on the boundary, while ","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"WsmVO1Z3ye"},{"type":"inlineMath","value":"v","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"MzSns4HAqE"},{"type":"text","value":" is unknown over the full grid, there are two different sizes of vec/unvec operations. We also need to define functions to pack grid unknowns into a vector and to unpack them. When the unknowns for ","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"jOmCRrgibi"},{"type":"inlineMath","value":"u","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"GzcJdtMPsq"},{"type":"text","value":" are packed, the boundary values are chopped off, and these are restored when unpacking.","position":{"start":{"line":367,"column":1},"end":{"line":367,"column":1}},"key":"Tov9AlS1Xh"}],"key":"mpcul1HRFF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, ~, ~, vec_v, unvec_v] = tensorgrid(x, y);\n[~, ~, ~, vec_u, unvec_u] = tensorgrid(x(2:m), y(2:n));\n\nchop = @(U) U(2:m, 2:n);\nz = zeros(1, n-1);\nextend = @(U) [ zeros(m+1, 1) [z; U; z] zeros(m+1, 1)];\npack = @(U, V) [vec_u(chop(U)); vec_v(V)];\nN = (m-1) * (n-1);\nunpack = @(u) f13_2_wave_unpack(u, N, unvec_u, unvec_v, extend);","key":"meXt22SYHJ"},{"type":"output","id":"icX5hH2gRYMcqzP0eW2A6","data":[],"key":"eeVXdZwD1R"}],"data":{},"key":"okrFhO9mMZ"},{"type":"include","file":"f13_2_wave_unpack.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [U, V] = unpack(w, N, unvec_u, unvec_v, extend)\n    U = extend( unvec_u(w(1:N)) );\n    V = unvec_v(w(N+1:end));\nend","lang":"matlab","filename":"f13_2_wave_unpack.m","key":"nzCTYe9TQw"}],"key":"bR8A5rLHCP"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"We can now define and solve the ","key":"zJIFYO7US1"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"gJy1Ww8HDU"}],"key":"ycVRT3SsrT"},{"type":"text","value":". Since this problem is hyperbolic, not parabolic, a nonstiff integrator is faster than a stiff one.","key":"i8hXtcEF4H"}],"key":"PeBPRRLz0W"},{"type":"include","file":"f13_2_wave.m","literal":true,"filter":{},"children":[{"type":"code","value":"function dw_dt = timederiv(t, w, p)\n    [Dxx, Dyy, pack, unpack] = p{:};\n    [U, V] = unpack(w);\n    dU_dt = V;\n    dV_dt = Dxx * U + U * Dyy';\n    dw_dt = pack(dU_dt, dV_dt);\nend","lang":"matlab","filename":"f13_2_wave.m","key":"yyphlIysi4"}],"key":"nJiqF3SpqE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_wave);\nivp.InitialTime = 0;\nivp.InitialValue = pack(U0, V0);\nivp.Parameters = {Dxx, Dyy, pack, unpack};\nivp.Solver = \"nonstiff\";\nsol = solutionFcn(ivp, 0, 4);","key":"F5jYQuuqGs"},{"type":"output","id":"RF_h_Gq86Z6Ed7SNEwzbL","data":[],"key":"e3R31sTe52"}],"data":{},"key":"Fe92GUDM5a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\n[U, V] = unpack(sol(0.5));\npcolor(X', Y', U')\naxis equal,  clim([-0.1, 0.1])\ncolormap(redsblues),  shading interp\nxlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Wave equation at t = 0.5\")","key":"cStyTGTIm1"},{"type":"output","id":"rBJmZFRap8uV0HMCmcUvZ","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"820b8dfc3884fa7f42845f34f4614d94","path":"/fnc/build/820b8dfc3884fa7f42845f34f4614d94.png"}}}],"key":"PJegFNYj2a"}],"data":{},"key":"X6l425uijT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nvid = VideoWriter(\"figures/2d-wave.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 4, 121)\n    [U, V] = unpack(sol(t));\n    cla, pcolor(X, Y, U)\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-3, 1.75, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"TgLkYI1szj"},{"type":"output","id":"ktg6ezOJ670UnPVSmVnJC","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"276c3ea687c55ed63ec3b0c76506c340","path":"/fnc/build/276c3ea687c55ed63ec3b0c76506c340.png"}}},{"output_type":"stream","name":"stderr","text":"Cannot create file figures/2d-wave.mp4. Permission Denied."}],"visibility":"show","key":"VNgzQXrqDE"}],"data":{"tags":[]},"visibility":"show","key":"K8ThrMWVtQ"},{"type":"image","url":"/fnc/build/2d-wave-c2e3e3e79f60b95caa4eedcd877cad54.mp4","alt":"Wave equation in 2d","position":{"start":{"line":429,"column":1},"end":{"line":429,"column":1}},"key":"PHvz9ajsdg","urlSource":"figures/2d-wave.mp4"}],"label":"demo-diffadv-wave-matlab","identifier":"demo-diffadv-wave-matlab","html_id":"demo-diffadv-wave-matlab","key":"b3Xm3CE6tN"},{"type":"heading","depth":3,"position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"13.3 ","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"zHPbGgivCW"},{"type":"link","identifier":"section-twodim-laplace","label":"section-twodim-laplace","kind":"narrative","position":{"start":{"line":432,"column":6},"end":{"line":432,"column":29}},"url":"/laplace","internal":true,"dataUrl":"/laplace.json","children":[{"type":"text","value":"Laplace and Poisson equations","key":"iIixTzB7SB"}],"key":"ODvYqQNKg1"}],"identifier":"id-13-3","label":"13.3 ","html_id":"id-13-3","implicit":true,"key":"ADCPq4D3NT"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-kron","label":"demo-laplace-kron","kind":"proof:example","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":19}},"children":[{"type":"text","value":"Example ","key":"n9UAimPWXm"},{"type":"text","value":"13.3.1","key":"B5uoAvpGbU"}],"template":"Example %s","enumerator":"13.3.1","resolved":true,"html_id":"demo-laplace-kron","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"IPErGhFEPy"}],"key":"XuFc3orgha"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [1, 2; -2, 0];\nB = [1, 10, 100; -5, 5, 3];\ndisp(\"A:\")\ndisp(A)\ndisp(\"B:\")\ndisp(B)","key":"ZRxEE6teRt"},{"type":"output","id":"bwBz57pHkirin069VVNAN","data":[{"output_type":"stream","name":"stdout","text":"A:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"     1     2\n    -2     0\n\n"},{"output_type":"stream","name":"stdout","text":"B:"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"     1    10   100\n    -5     5     3\n\n"}],"key":"nZpzgSOZiQ"}],"data":{},"key":"KMcsbQVwTC"},{"type":"paragraph","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"children":[{"type":"text","value":"Applying the definition manually, we get","position":{"start":{"line":446,"column":1},"end":{"line":446,"column":1}},"key":"qoRyiRhUbV"}],"key":"brqIb0jhGs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A_kron_B = [\n    A(1,1)*B  A(1,2)*B;\n    A(2,1)*B  A(2,2)*B\n    ]","key":"Y4djWV05ti"},{"type":"output","id":"Sdrgi2HxlgyzcTYl2Scqt","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A_kron_B = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A_kron_B = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n","content_type":"text/plain"}}}],"key":"N53P8jgjvR"}],"data":{},"key":"PjteEy14mN"},{"type":"paragraph","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"children":[{"type":"text","value":"But it makes more sense to use ","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"AV0AklcDpJ"},{"type":"inlineCode","value":"kron","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"G7VTlyv3AR"},{"type":"text","value":".","position":{"start":{"line":458,"column":1},"end":{"line":458,"column":1}},"key":"idou6QlsOJ"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"kron","kind":"entry"},"emphasis":true}],"label":"index-bBd8Qxk8MH","identifier":"index-bbd8qxk8mh","html_id":"index-bbd8qxk8mh","key":"Ja5wPTFFmS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"kron(A, B)","key":"IvGU75Wdg7"},{"type":"output","id":"UhHrFD_5bwB4pJeqWh6Ax","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×6 double\n     1    10   100     2    20   200\n    -5     5     3   -10    10     6\n    -2   -20  -200     0     0     0\n    10   -10    -6     0     0     0\n","content_type":"text/plain"}}}],"key":"KqRuresazt"}],"data":{},"key":"i4gascV2Ts"}],"label":"demo-laplace-kron-matlab","identifier":"demo-laplace-kron-matlab","html_id":"demo-laplace-kron-matlab","key":"byn353bDQ7"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-fd","label":"demo-laplace-fd","kind":"proof:example","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":17}},"children":[{"type":"text","value":"Example ","key":"SU47WTTPM7"},{"type":"text","value":"13.3.2","key":"WL9G4PHtU1"}],"template":"Example %s","enumerator":"13.3.2","resolved":true,"html_id":"demo-laplace-fd","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"WQvGIEKOgB"}],"key":"qJgtyj7Rx2"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"We make a crude discretization for illustrative purposes.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"nCvLiOMgtr"}],"key":"t4jZgYn2wf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 6;  n = 5;\n[x, Dx, Dxx] = diffmat2(m, [0, 3]);\n[y, Dy, Dyy] = diffmat2(n, [-1, 1]);\n[mtx, X, Y, vec, unvec, is_boundary] = tensorgrid(x, y);","key":"eS9iLYOE9B"},{"type":"output","id":"2RDN4BmqHzbC_xaqaVGuC","data":[],"key":"uDApftWdMY"}],"data":{},"key":"QZeLVrpcZB"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"Next, we define ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"LkbtuTYqLK"},{"type":"text","value":"ϕ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"b1s2qf2nBk"},{"type":"text","value":" and evaluate it on the grid to get the forcing vector of the linear system.","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"Yh5QYyjVsn"}],"key":"dJ1vpDApeQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(x, y) x.^2 - y + 2;\nb = vec(mtx(phi));","key":"l2qLMRZYgn"},{"type":"output","id":"-MV7K_A8xiDO8bbKvkpKG","data":[],"key":"q9Q9Lqvw8b"}],"data":{},"key":"exxldpl3GT"},{"type":"paragraph","position":{"start":{"line":483,"column":1},"end":{"line":483,"column":1}},"children":[{"type":"text","value":"Here are the coefficients for the ","key":"hmj1TPAhDj"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"kgCZStyvzW"}],"key":"cDDfgY0PRR"},{"type":"text","value":" collocation, before any modifications are made for the boundary conditions. The combination of Kronecker products and finite differences produces a characteristic sparsity pattern.","key":"wuwr1IE2M6"}],"key":"HGtotz0d5m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = kron(speye(n+1), sparse(Dxx)) + kron(sparse(Dyy), speye(m+1));\nclf,  spy(A)\ntitle(\"System matrix before boundary conditions\")","key":"mb5bYLG6Qb"},{"type":"output","id":"3h4SnbnxKJ3P3quGtEV6C","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e168f615acb78b2302ebbba5506a6a89","path":"/fnc/build/e168f615acb78b2302ebbba5506a6a89.png"}}}],"key":"gQNdD18HtO"}],"data":{},"key":"vzyPHRl1LD"},{"type":"paragraph","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"children":[{"type":"text","value":"The number of equations is equal to ","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"key":"uV9gwJZvNx"},{"type":"inlineMath","value":"(m+1)(n+1)","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(m+1)(n+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"vo2DGABJZe"},{"type":"text","value":", which is the total number of points on the grid.","position":{"start":{"line":491,"column":1},"end":{"line":491,"column":1}},"key":"BDBX6EEE4Y"}],"key":"lNqojwRWvX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"N = length(b)","key":"Ja8ESBZzVs"},{"type":"output","id":"D1rTHGC-MOqKjSoCOUb7T","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>N = \n    42\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"N = \n    42\n","content_type":"text/plain"}}}],"key":"YBezwSzRms"}],"data":{},"key":"MdyI7xhgee"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"We now use the Boolean array that indicates where the boundary points lie in the grid.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"b8uOn4UIod"}],"key":"YHmORaPArh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"spy(is_boundary)\ntitle(\"Boundary points\")","key":"XrxmaCOEgC"},{"type":"output","id":"WS6_RppVwgp-gsRUv9TvU","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b2af24d09ae8ac9f929ada844aa4388","path":"/fnc/build/5b2af24d09ae8ac9f929ada844aa4388.png"}}}],"key":"jUyJPztks8"}],"data":{},"key":"xGkMUT7jq8"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"children":[{"type":"text","value":"In order to impose Dirichlet boundary conditions, we replace the boundary rows of the system by rows of the identity.","position":{"start":{"line":505,"column":1},"end":{"line":505,"column":1}},"key":"O16hf6De44"}],"key":"p6i88ui0xZ"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"Changing rows of a sparse array requires that the operands be in a particular sparse representation called ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"vA5KMynH2U"},{"type":"inlineCode","value":"lil","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"l1qiED9gpq"},{"type":"text","value":". The conversion isn’t done automatically because it can be slow and you are encouraged to avoid it when possible. We’re just trying to keep things conceptually simple here.","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"sFx183b28v"}],"key":"jFZaGp7nDs"}],"key":"h4BgUoPInH"}],"key":"y7yEMuwGIs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"I = speye(N);\nidx = vec(is_boundary);\nA(idx, :) = I(idx, :);\n\nspy(A)\ntitle(\"System matrix with boundary conditions\")","key":"NsveWslxRz"},{"type":"output","id":"E8zherRAa6tKneaEN8oO7","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f517d7d1f7d0d23fe837a79e30eedc40","path":"/fnc/build/f517d7d1f7d0d23fe837a79e30eedc40.png"}}}],"key":"NSLVBnTEzk"}],"data":{},"key":"guUD2JsMhh"},{"type":"paragraph","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":1}},"children":[{"type":"text","value":"Finally, we must replace the rows in the vector ","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":1}},"key":"Bizel4Ep3X"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"SnXRbuilK0"},{"type":"text","value":" by the boundary values being assigned to the boundary points. Here, we let the boundary values be zero everywhere.","position":{"start":{"line":520,"column":1},"end":{"line":520,"column":1}},"key":"LfldJaE5MU"}],"key":"j5gFnyV8KU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b(idx) = 0;","key":"RN5xI4ARCu"},{"type":"output","id":"vDnir1Xm51UXsAKynJC3u","data":[],"key":"NWFxgfkig8"}],"data":{},"key":"PeWPUFSogu"},{"type":"paragraph","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"children":[{"type":"text","value":"Now we can solve for ","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"gAKEIfpkXu"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"tqLnYztpmE"},{"type":"text","value":" and reinterpret it as the matrix-shaped ","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"YnHjXqQxCa"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"HFvtHvLHg5"},{"type":"text","value":", the solution on our grid.","position":{"start":{"line":526,"column":1},"end":{"line":526,"column":1}},"key":"IVmgNpx4bS"}],"key":"ZkLQyjRFLQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = A \\ b;\nU = unvec(u)","key":"etMo3o8KlC"},{"type":"output","id":"wEUGfFTYYQntPGry1hCq7","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>U = 7×6 double\n         0         0         0         0         0         0\n         0   -0.5493   -0.7583   -0.7121   -0.4534         0\n         0   -0.9179   -1.3027   -1.2438   -0.7985         0\n         0   -1.2193   -1.7406   -1.6791   -1.0954         0\n         0   -1.3987   -1.9768   -1.9179   -1.2793         0\n         0   -1.2102   -1.6584   -1.6123   -1.1143         0\n         0         0         0         0         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"U = 7×6 double\n         0         0         0         0         0         0\n         0   -0.5493   -0.7583   -0.7121   -0.4534         0\n         0   -0.9179   -1.3027   -1.2438   -0.7985         0\n         0   -1.2193   -1.7406   -1.6791   -1.0954         0\n         0   -1.3987   -1.9768   -1.9179   -1.2793         0\n         0   -1.2102   -1.6584   -1.6123   -1.1143         0\n         0         0         0         0         0         0\n","content_type":"text/plain"}}}],"key":"SWHYA52o0t"}],"data":{},"key":"YsttrWMfRa"}],"label":"demo-laplace-fd-matlab","identifier":"demo-laplace-fd-matlab","html_id":"demo-laplace-fd-matlab","key":"xGxa2wPEjq"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-laplace-poisson","label":"demo-laplace-poisson","kind":"proof:example","position":{"start":{"line":535,"column":1},"end":{"line":535,"column":22}},"children":[{"type":"text","value":"Example ","key":"OS5div9ogf"},{"type":"text","value":"13.3.3","key":"dsAEI92G7n"}],"template":"Example %s","enumerator":"13.3.3","resolved":true,"html_id":"demo-laplace-poisson","remote":true,"url":"/laplace","dataUrl":"/laplace.json","key":"ScjDFTXNka"}],"key":"g05LckQXPs"},{"type":"paragraph","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"children":[{"type":"text","value":"First we define the problem on ","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"PV7RWLGZm1"},{"type":"inlineMath","value":"[0,1]\\times[0,2]","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>×</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0,1]\\times[0,2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\">]</span></span></span></span>","key":"i2tiFr6j9Y"},{"type":"text","value":".","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"aOwmMm7hra"}],"key":"xvhJNXwZ8Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"f = @(x, y) -sin(3*x .* y - 4*y) .* (9*y.^2 + (3*x - 4).^2);\ng = @(x, y) sin(3*x .* y - 4*y);\nxspan = [0, 1];\nyspan = [0, 2];","key":"vL7NYYHN5h"},{"type":"output","id":"oqp7UY2WSWIjshJduRmip","data":[],"key":"JEf20efqML"}],"data":{},"key":"vOl4jQQpX7"},{"type":"paragraph","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"children":[{"type":"text","value":"Here is the finite-difference solution.","position":{"start":{"line":546,"column":1},"end":{"line":546,"column":1}},"key":"CSebwZ49sL"}],"key":"jbiZWurEfA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[X, Y, U] = poissonfd(f, g, 40, xspan, 60, yspan);\n\nclf, surf(X', Y', U')\ncolormap(parula),  shading interp\ncolorbar\ntitle(\"Solution of Poisson's equation\")\nxlabel(\"x\"),  ylabel(\"y\"),  zlabel(\"u(x,y)\")","key":"Pek4ykw6hI"},{"type":"output","id":"cnXo_aI5aXKMlRUEh0ewq","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4bd476aaed508a7500bb1f5ff9e522f2","path":"/fnc/build/4bd476aaed508a7500bb1f5ff9e522f2.png"}}}],"key":"jv7EObU6OK"}],"data":{},"key":"YeOTPl5IPC"},{"type":"paragraph","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"children":[{"type":"text","value":"Since this is an artificial problem with a known solution, we can plot the error, which is a smooth function of ","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"jsgyoExsto"},{"type":"inlineMath","value":"x","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"Cb63OBqR4d"},{"type":"text","value":" and ","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"Ju2MVun1Zc"},{"type":"inlineMath","value":"y","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"zsXRjGggEB"},{"type":"text","value":". It must be zero on the boundary; otherwise, we have implemented boundary conditions incorrectly.","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"R2fnGPjsUI"}],"key":"nihiONu5Nr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = g(X, Y) - U;\nmx = max(abs(vec(err)));\npcolor(X', Y', err')\ncolormap(redsblues),  shading interp\nclim([-mx, mx]),  colorbar\naxis equal,  xlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Error\")","key":"GFAqlSilvf"},{"type":"output","id":"JXeGRf7KgL5AMdX99hHQK","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9cd4a731def28a292d32b932803cd207","path":"/fnc/build/9cd4a731def28a292d32b932803cd207.png"}}}],"key":"dNGVWGkeIQ"}],"data":{},"key":"EXfgPV4ITf"}],"label":"demo-laplace-poisson-matlab","identifier":"demo-laplace-poisson-matlab","html_id":"demo-laplace-poisson-matlab","key":"v2Ocu0xNcU"},{"type":"heading","depth":3,"position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"children":[{"type":"text","value":"13.4 ","position":{"start":{"line":571,"column":1},"end":{"line":571,"column":1}},"key":"bKq0l5eSfG"},{"type":"link","identifier":"section-twodim-nonlinear","label":"section-twodim-nonlinear","kind":"narrative","position":{"start":{"line":571,"column":6},"end":{"line":571,"column":31}},"url":"/nonlinear-1","internal":true,"dataUrl":"/nonlinear-1.json","children":[{"type":"text","value":"Nonlinear elliptic PDEs","key":"gzHybHWMjE"}],"key":"eyB8u1KlPN"}],"identifier":"id-13-4","label":"13.4 ","html_id":"id-13-4","implicit":true,"key":"qiY8rOvEgu"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear2d-mems","label":"demo-nonlinear2d-mems","kind":"proof:example","position":{"start":{"line":574,"column":1},"end":{"line":574,"column":23}},"children":[{"type":"text","value":"Example ","key":"MbmJF5jhO7"},{"type":"text","value":"13.4.2","key":"ID2fjdcMQ3"}],"template":"Example %s","enumerator":"13.4.2","resolved":true,"html_id":"demo-nonlinear2d-mems","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"PgLEl1k8VW"}],"key":"WBEIgZM5Ad"},{"type":"paragraph","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"children":[{"type":"text","value":"All we need to define are ","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"key":"lS0c2ZHGbh"},{"type":"text","value":"ϕ","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"key":"zCypeS4SAO"},{"type":"text","value":" from ","position":{"start":{"line":575,"column":1},"end":{"line":575,"column":1}},"key":"gjczDvwRWb"},{"type":"crossReference","kind":"equation","identifier":"nonlinpdepde","label":"nonlinpdepde","children":[{"type":"text","value":"(","key":"JnOlP4WrI8"},{"type":"text","value":"13.4.2","key":"dbL4VvMoPB"},{"type":"text","value":")","key":"UFVKYxEvyJ"}],"template":"(%s)","enumerator":"13.4.2","resolved":true,"html_id":"nonlinpdepde","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"Od9ig2VO3D"},{"type":"text","value":" for the ","key":"H1LSqu5Mae"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"bDOzKGZlzX"}],"key":"JHUkZtOvn2"},{"type":"text","value":", and a trivial zero function for the boundary condition.","key":"uyvcAjuqxf"}],"key":"BILoYAMRXV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 1.5;\nphi = @(X, Y, U, Ux, Uxx, Uy, Uyy) Uxx + Uyy - lambda ./ (U + 1).^2;\ng = @(x, y) zeros(size(x));","key":"USeNfUgXdW"},{"type":"output","id":"sQIiSEk4tvGSVRNNObPQZ","data":[],"key":"cAXLOQGUPU"}],"data":{},"key":"YrPu3ibaC4"},{"type":"paragraph","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"children":[{"type":"text","value":"Here is the solution for ","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"tAmPN0nt9Q"},{"type":"inlineMath","value":"m=15","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>15</mn></mrow><annotation encoding=\"application/x-tex\">m=15</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">15</span></span></span></span>","key":"cV353XY6Sr"},{"type":"text","value":", ","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"JmtJmFfRt7"},{"type":"inlineMath","value":"n=8","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding=\"application/x-tex\">n=8</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">8</span></span></span></span>","key":"ve47JLyQQO"},{"type":"text","value":".","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"DwgMmgUtCt"}],"key":"Y2oYUvhrma"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = elliptic(phi, g, 15, [0, 2.5], 8, [0, 1]);\ndisp(sprintf(\"solution at (2, 0.6) is %.7f\", u(2, 0.6)))","key":"uPAHskJAib"},{"type":"output","id":"vvsOjmfTaMXJcFnskcssx","data":[{"output_type":"stream","name":"stdout","text":"solution at (2, 0.6) is -0.2264594"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"WCkJ8LDrdJ"}],"data":{},"key":"ZCONuybWD3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(0, 2.5, 91);\ny = linspace(0, 1, 51);\n[mtx, X, Y] = tensorgrid(x, y);\nclf,  pcolor(x, y, mtx(u)')\ncolormap(flipud(sky)),  shading interp,  colorbar\naxis equal\nxlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Deflection of a MEMS membrane\")","visibility":"hide","key":"mL20uJOUBZ"},{"type":"output","id":"B-ISWgAeXG6545vh6tj0c","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"961a66dcdb6f7138ecd537f438599286","path":"/fnc/build/961a66dcdb6f7138ecd537f438599286.png"}}}],"visibility":"show","key":"NmD2h0IZ7G"}],"data":{"tags":[]},"visibility":"show","key":"wqBi7MqQWm"},{"type":"paragraph","position":{"start":{"line":602,"column":1},"end":{"line":602,"column":1}},"children":[{"type":"text","value":"In the absence of an exact solution, how can we be confident that the solution is accurate? First, the Levenberg iteration converged without issuing a warning, so we should feel confident that the discrete equations were solved. Assuming that we encoded the ","key":"aPUe4hx0PC"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"q2j2Ph1ptU"}],"key":"NWXcjIZxh5"},{"type":"text","value":" correctly, the remaining source of error is truncation from the discretization. We can estimate that by refining the grid a bit and seeing how much the numerical solution changes.","key":"SgZjwfIWaI"}],"key":"fDb6mHOBjL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_test = linspace(0, 2.5, 6);\ny_test = linspace(0, 1 , 5);\nmtx_test = tensorgrid(x_test, y_test);\nformat long\nmtx_test(u)","key":"Aq7nCi8kFb"},{"type":"output","id":"9DmUqHXSauAoF45UZY5f0","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×5 double\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n   0.000000000000000  -0.174520738821158  -0.236562036535841  -0.174520738821158   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014285  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014284  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.174520738821157  -0.236562036535841  -0.174520738821157   0.000000000000000\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×5 double\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n   0.000000000000000  -0.174520738821158  -0.236562036535841  -0.174520738821158   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014285  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.232549828809534  -0.320497790014284  -0.232549828809534   0.000000000000000\n   0.000000000000000  -0.174520738821157  -0.236562036535841  -0.174520738821157   0.000000000000000\n                   0   0.000000000000000   0.000000000000000   0.000000000000000                   0\n","content_type":"text/plain"}}}],"key":"zzJS929S7O"}],"data":{},"key":"oSgekdLtGP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = elliptic(phi, g, 25, [0, 2.5], 14, [0, 1]);\nmtx_test(u)","key":"vhjrIUoVff"},{"type":"output","id":"s5QEJ7K0p249SAWiOz9mH","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×5 double\n            0  -8.4257e-24   4.0802e-22  -1.1700e-22            0\n  -8.1258e-22  -1.7452e-01  -2.3655e-01  -1.7452e-01  -4.4157e-22\n  -4.8295e-21  -2.3255e-01  -3.2047e-01  -2.3255e-01  -5.6941e-22\n  -4.8153e-21  -2.3255e-01  -3.2047e-01  -2.3255e-01  -9.1234e-22\n  -6.7675e-22  -1.7452e-01  -2.3655e-01  -1.7452e-01  -3.8831e-22\n            0   9.8025e-23   2.1031e-22  -3.5583e-23            0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×5 double\n            0  -8.4257e-24   4.0802e-22  -1.1700e-22            0\n  -8.1258e-22  -1.7452e-01  -2.3655e-01  -1.7452e-01  -4.4157e-22\n  -4.8295e-21  -2.3255e-01  -3.2047e-01  -2.3255e-01  -5.6941e-22\n  -4.8153e-21  -2.3255e-01  -3.2047e-01  -2.3255e-01  -9.1234e-22\n  -6.7675e-22  -1.7452e-01  -2.3655e-01  -1.7452e-01  -3.8831e-22\n            0   9.8025e-23   2.1031e-22  -3.5583e-23            0\n","content_type":"text/plain"}}}],"key":"JNrfV9Z8bh"}],"data":{},"key":"QnnBoNi5US"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format","visibility":"show","key":"SwleVNS0Me"},{"type":"output","id":"UV63sz01KowQ9uTtSQ9lJ","data":[],"visibility":"show","key":"gA3tpewKKH"}],"data":{"tags":[]},"visibility":"remove","key":"fKrnpPHO95"},{"type":"paragraph","position":{"start":{"line":622,"column":1},"end":{"line":622,"column":1}},"children":[{"type":"text","value":"The original solution seems to be accurate to about four digits.","position":{"start":{"line":622,"column":1},"end":{"line":622,"column":1}},"key":"tUHNlQE3Wh"}],"key":"FxxFASI9Wz"}],"label":"demo-nonlinear2d-mems-matlab","identifier":"demo-nonlinear2d-mems-matlab","html_id":"demo-nonlinear2d-mems-matlab","key":"SegJwYouJX"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-advdiff","label":"demo-nonlinear-advdiff","kind":"proof:example","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":24}},"children":[{"type":"text","value":"Example ","key":"XgSnmyrrFR"},{"type":"text","value":"13.4.3","key":"MdDZfwKAqq"}],"template":"Example %s","enumerator":"13.4.3","resolved":true,"html_id":"demo-nonlinear-advdiff","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"u9gYUsHw8n"}],"key":"x3w5PVibYi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(X, Y, U, Ux, Uxx, Uy, Uyy) 1 - Ux - 2*Uy + 0.05*(Uxx + Uyy);\ng = @(x, y) zeros(size(x));\nu = elliptic(phi, g, 32, [-1, 1], 32, [-1, 1]);","key":"zUQlzrj1Ck"},{"type":"output","id":"LEUU1Uj6i4Tcp1L0IC-sP","data":[],"key":"l2Etq41LNk"}],"data":{},"key":"GaqMEx1DRP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(-1, 1, 80);\ny = x;\nmtx = tensorgrid(x, y);\nclf,  pcolor(x, y, mtx(u)')\ncolormap(parula),  shading interp,  colorbar\naxis equal,  xlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Steady advection–diffusion\")","visibility":"hide","key":"R7TY3brfU6"},{"type":"output","id":"AyRngb83WpH7i6OIoXxvl","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"45f788f1fcd0ee4415b550676767c402","path":"/fnc/build/45f788f1fcd0ee4415b550676767c402.png"}}}],"visibility":"show","key":"CgqoOL7quQ"}],"data":{"tags":[]},"visibility":"show","key":"y9OxMLS0yI"}],"label":"demo-nonlinear-advdiff-matlab","identifier":"demo-nonlinear-advdiff-matlab","html_id":"demo-nonlinear-advdiff-matlab","key":"duRb8GPG27"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear2d-allencahn","label":"demo-nonlinear2d-allencahn","kind":"proof:example","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":28}},"children":[{"type":"text","value":"Example ","key":"nC6073xAWd"},{"type":"text","value":"13.4.4","key":"BHp8O7JRIX"}],"template":"Example %s","enumerator":"13.4.4","resolved":true,"html_id":"demo-nonlinear2d-allencahn","remote":true,"url":"/nonlinear-1","dataUrl":"/nonlinear-1.json","key":"i0QTaNmdXq"}],"key":"YJoTRtkB7O"},{"type":"paragraph","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"children":[{"type":"text","value":"The following defines the ","key":"lqfhpwg83x"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"TfGal4jq2e"}],"key":"C01xHk4SZ9"},{"type":"text","value":" and a nontrivial Dirichlet boundary condition for the square ","key":"aiCygBIt2v"},{"type":"inlineMath","value":"[0,1]^2","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">[0,1]^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"POiF91LjqZ"},{"type":"text","value":".","position":{"start":{"line":651,"column":1},"end":{"line":651,"column":1}},"key":"Ytso4n9uOQ"}],"key":"eSVGQmlGj9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"phi = @(X, Y, U, Ux, Uxx, Uy, Uyy) U .* (1-U.^2) + 0.05*(Uxx + Uyy);\ng = @(x, y) tanh(5*(x + 2*y - 1));","key":"ZRJpTUhjL4"},{"type":"output","id":"GbFFVrYCzJq2NwtOxk95c","data":[],"key":"PwbS0O0fV1"}],"data":{},"key":"axkMo9PWVV"},{"type":"paragraph","position":{"start":{"line":658,"column":1},"end":{"line":658,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"IJgW4t7nR9"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"qQ8pOFvkpv"}],"key":"xbagnCWTGp"},{"type":"text","value":" and then plot the result.","key":"jI8SpbpGi9"}],"key":"eQCP7d4FGD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = elliptic(phi, g, 36, [0, 1], 36, [0, 1]);","key":"JsJjhjrSws"},{"type":"output","id":"LwN7GQ6wgNN-dOuzPaE7V","data":[],"key":"v1S03HZOco"}],"data":{},"key":"s6WaTG0Exg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = linspace(0, 1, 80);\ny = x;\nmtx = tensorgrid(x, y);\nclf,  pcolor(x, y, mtx(u)')\ncolormap(parula),  shading interp,  colorbar\naxis equal,  xlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Steady Allen–Cahn\")","visibility":"hide","key":"sMKVB1ktdb"},{"type":"output","id":"yNJekfXM3nLcdJNld56_J","data":[{"output_type":"execute_result","execution_count":53,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"04c3bc2f1dc8f9e69333626e95819902","path":"/fnc/build/04c3bc2f1dc8f9e69333626e95819902.png"}}}],"visibility":"show","key":"EN6ltbE3qE"}],"data":{"tags":[]},"visibility":"show","key":"naDbZMEGQV"}],"label":"demo-nonlinear2d-allencahn-matlab","identifier":"demo-nonlinear2d-allencahn-matlab","html_id":"demo-nonlinear2d-allencahn-matlab","key":"HA7BrMWI9J"}],"key":"uGUknjQUM7"}],"key":"HETaGt92ec"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 12","url":"/chapter12-1","group":"MATLAB codes"},"next":{"title":"Chapter 1","url":"/chapter1-2","group":"Python codes"}}},"domain":"http://localhost:3000"}