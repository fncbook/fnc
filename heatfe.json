{"kind":"Notebook","sha256":"0c70d06472d0724083310ae96ef80e9bc12b67c9e3854b4cf11ce9db9b22192f","slug":"heatfe","location":"/chapter11/section2/julia/heatFE.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"julia-1.11","display_name":"Julia 1.11.2","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"heatFE.ipynb","url":"/fnc/build/heatFE-55c86f09b12a5b1312bfe9d4d3c81949.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"RyDuM0wiKY"},{"type":"text","value":"11.2.2","key":"sGsH8zmBYW"}],"key":"pP9cqWexVX"}],"identifier":"demo-methodlines-heatfe","label":"demo-methodlines-heatFE","kind":"proof:example","template":"Example %s","enumerator":"11.2.2","resolved":true,"html_id":"demo-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"dxupBROqX3"}],"key":"Z2KpJ3t6QV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s implement the method of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kgTR3LfWKF"},{"type":"crossReference","kind":"proof:example","identifier":"example-methodlines-heatfe","label":"example-methodlines-heatFE","children":[{"type":"text","value":"Example ","key":"kPyxSDARM5"},{"type":"text","value":"11.2.1","key":"hmYzeWxJgF"}],"template":"Example %s","enumerator":"11.2.1","resolved":true,"html_id":"example-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"lJcT0nP3wd"},{"type":"text","value":" with second-order space semidiscretization.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jv2jkiepnx"}],"key":"GttxYpAUdn"}],"key":"Gbqagy09wz"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:01.404000Z","iopub.status.busy":"2025-01-14T15:17:58.041000Z","iopub.execute_input":"2025-01-14T15:17:58.662000Z","shell.execute_reply":"2025-01-14T15:18:01.401000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m = 100\nx, Dx, Dxx = FNC.diffper(m, [0, 1]);\ntfinal = 0.15 \nn = 2400           # number of time steps\nτ = tfinal / n     # time step    \nt = τ * (0:n)      # time values","key":"a9AwpO5M2Q"},{"type":"output","id":"71GFio9L3A42ft6LYdNZ6","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"0.0:6.25e-5:0.15","content_type":"text/plain"}}}],"key":"PuJFfOf4Hg"}],"key":"sZS1Wep1T7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we set an initial condition. It isn’t mathematically periodic, but the end values and derivatives are so small that for numerical purposes it may as well be.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vr9YFKLE6m"}],"key":"SHUwIbc0Gf"}],"key":"NWN0U4dK5F"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:10.726000Z","iopub.status.busy":"2025-01-14T15:18:01.436000Z","iopub.execute_input":"2025-01-14T15:18:01.436000Z","shell.execute_reply":"2025-01-14T15:18:10.725000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U = zeros(m, n+1);\nU[:, 1] = @. exp( -60 * (x - 0.5)^2 )\nplot(x, U[:, 1];\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,0)\"),\n    title=\"Initial condition\")","key":"XNlbdtoyz9"},{"type":"output","id":"-wHjr8DFuca6-JRrknpkb","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d1a9ee3095e8be27ad4ee5759ac6bdcc","path":"/fnc/build/d1a9ee3095e8be27ad4ee5759ac6bdcc.png"},"text/html":{"content_type":"text/html","hash":"9f94a60fce4ea60b5d60c4df369aca54","path":"/fnc/build/9f94a60fce4ea60b5d60c4df369aca54.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"eb97a23a477e77944696fe464ebe06cd","path":"/fnc/build/eb97a23a477e77944696fe464ebe06cd.svg"}}}],"key":"CpdcCbE7jl"}],"key":"UeHXNXMPl5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Euler time stepping simply multiplies ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Il0gl0QOtH"},{"type":"inlineMath","value":"\\mathbf{u}_j","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">u</mi><mi>j</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}_j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7305em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ETDETYO9M4"},{"type":"text","value":" by the constant matrix in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rQg4slMm7i"},{"type":"crossReference","kind":"equation","identifier":"eulerxx","label":"Eulerxx","children":[{"type":"text","value":"(","key":"Mwj8rX1Ist"},{"type":"text","value":"11.2.6","key":"osdjqiFNg9"},{"type":"text","value":")","key":"JcDOsKKDnQ"}],"template":"(%s)","enumerator":"11.2.6","resolved":true,"html_id":"eulerxx","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"RtoSASR0Qa"},{"type":"text","value":" at each time step. Since that matrix is sparse, we will declare it as such, even though the run-time savings may not be detectable for this small value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UjXS8bdPHO"},{"type":"inlineMath","value":"m","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"n5xdYzuwTt"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LTzmvZCM0T"}],"key":"P0BVC4OZdQ"}],"key":"N5aGs4O7Ah"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:11.418000Z","iopub.status.busy":"2025-01-14T15:18:10.735000Z","iopub.execute_input":"2025-01-14T15:18:10.736000Z","shell.execute_reply":"2025-01-14T15:18:11.417000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using SparseArrays\nA = sparse(I + τ * Dxx)\nfor j in 1:n\n    U[:, j+1] = A * U[:, j]\nend\n\nplot_idx = 1:10:31\nplot_times = round.(t[plot_idx], digits=4)\nlabels = [\"t = $t\" for t in plot_times]\nplot(x, U[:, plot_idx];\n    label=reshape(labels, 1, :),  legend=:topleft,  \n    title=\"Heat equation by forward Euler\",\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,0)\", [-0.25, 1]))","key":"ZuFfnDvxxw"},{"type":"output","id":"7j9tqkHFPoDY2opuIYhux","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8b4585cf2bce8ec7de13b9975e6fa8ab","path":"/fnc/build/8b4585cf2bce8ec7de13b9975e6fa8ab.png"},"text/html":{"content_type":"text/html","hash":"b12c8f1fd7a5997310297323b063ef8b","path":"/fnc/build/b12c8f1fd7a5997310297323b063ef8b.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"98ceeb9764f514bc0afdb77548387728","path":"/fnc/build/98ceeb9764f514bc0afdb77548387728.svg"}}}],"key":"rxZAOCxpMu"}],"key":"NCTDNZALGd"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Things seem to start well, with the initial peak widening and shrinking. But then there is a nonphysical growth in the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pzWWKd4hpy"}],"key":"vgfRw6FKXl"}],"key":"apxMlHIlhu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:22.843000Z","iopub.status.busy":"2025-01-14T15:18:11.426000Z","iopub.execute_input":"2025-01-14T15:18:11.426000Z","shell.execute_reply":"2025-01-14T15:18:22.834000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for j in 1:101\n    plot(x, U[:, j];\n    label=@sprintf(\"t=%.5f\", t[j]),\n    xaxis=(L\"x\"),  yaxis=(L\"u(x,t)\", [-1, 2]),\n    dpi=150,  title=\"Heat equation by forward Euler\")\nend\nmp4(anim, \"diffusionFE.mp4\")","visibility":"hide","key":"OFZ5RRL01k"},{"type":"output","id":"ku3dQze_2s4ldUjJnk2t2","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter11/section2/julia/diffusionFE.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter11/section2/julia/diffusionFE.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"b3b9c7913b94254f791ed9015e7e5726","path":"/fnc/build/b3b9c7913b94254f791ed9015e7e5726.html"}}}],"visibility":"show","key":"l6oaBfFjZ6"}],"visibility":"show","key":"FWLIgMvRqI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The growth in norm is exponential in time.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AJpELBp6Q3"}],"key":"sjXTc9OVna"}],"key":"kCIZfuzVsl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:18:27.773000Z","iopub.status.busy":"2025-01-14T15:18:22.849000Z","iopub.execute_input":"2025-01-14T15:18:22.849000Z","shell.execute_reply":"2025-01-14T15:18:27.761000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"M = vec( maximum(abs, U, dims=1) )   \nplot(t[1:1000], M[1:1000];\n    xaxis=(L\"t\"),  yaxis=(:log10, L\"\\max_x |u(x,t)|\"),\n    title=\"Nonphysical growth\") ","key":"LpZzUirfld"},{"type":"output","id":"yN28YGZiNq5k_T-LUD9X_","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bbdb1b394b224cdd0c399c0be028b2f1","path":"/fnc/build/bbdb1b394b224cdd0c399c0be028b2f1.png"},"text/html":{"content_type":"text/html","hash":"03d41d69848592ef6dbe0fce559f9266","path":"/fnc/build/03d41d69848592ef6dbe0fce559f9266.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"82c6bc97903ce835f4e79967886d5b0d","path":"/fnc/build/82c6bc97903ce835f4e79967886d5b0d.svg"}}}],"key":"MjuFpKT7fd"}],"key":"EzuWDDqfnN"}],"key":"iJsOCtH5dJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Unstable","url":"/unstable-2","group":"Chapter 11"},"next":{"title":"HeatBE","url":"/heatbe","group":"Chapter 11"}}},"domain":"http://localhost:3000"}