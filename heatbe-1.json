{"kind":"Notebook","sha256":"72107dc2a1989589bcd3b4e6d1fb4273568775470202b94593ce4dcc4f9b8c85","slug":"heatbe-1","location":"/chapter11/section2/matlab/heatBE.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"heatBE.ipynb","url":"/fnc/build/heatBE-54881e2d86968e6226553c5e9dbdbb5b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"LqLfU6HngV"},{"type":"text","value":"11.2.4","key":"f6jd7MBfKe"}],"key":"LEuGNJGP50"}],"identifier":"demo-methodlines-heatbe","label":"demo-methodlines-heatBE","kind":"proof:example","template":"Example %s","enumerator":"11.2.4","resolved":true,"html_id":"demo-methodlines-heatbe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"Wzpnzf28Fq"}],"key":"WmNjMtQJtY"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we apply backward Euler to the heat equation. Mathematically this means multiplying by the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UXqC2iel3d"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"inverse","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BGnwHYJbJB"}],"key":"LH2MnJWtr7"},{"type":"text","value":" of a matrix, but we interpret that numerically as a linear system solution. We will reuse the setup from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"InkGuZMovQ"},{"type":"crossReference","kind":"proof:example","identifier":"demo-methodlines-heatfe","label":"demo-methodlines-heatFE","children":[{"type":"text","value":"Demo ","key":"cI0XJUomIL"},{"type":"text","value":"11.2.2","key":"JqekC1oj5d"}],"template":"Example %s","enumerator":"11.2.2","resolved":true,"html_id":"demo-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"TEhaIx230M"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OAcuLDWWmO"}],"key":"XyGlF7ClJF"}],"key":"w4mItOg6t0"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"B = sparse(Ix - tau * Dxx);\n[l, u] = lu(B);\nfor j = 1:n\n    U(:, j+1) = u \\ (l \\ U(:, j));\nend\n\nindex_times = 1:600:n+1;\nshow_times = t(index_times);\nclf\nfor j = index_times\n    str = sprintf(\"t = %.2e\", t(j));\n    plot(x, U(:, j), displayname=str) \n    hold on\nend\nlegend(location=\"northwest\")\nxlabel('x'), ylabel('u(x,t)')\ntitle('Heat equation by backward Euler')","key":"Tmov2zW80N"},{"type":"output","id":"23-GxLkH9rFGzawD1VOZb","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eab3dcc1c421e576a6b472778fe746b8","path":"/fnc/build/eab3dcc1c421e576a6b472778fe746b8.png"}}}],"key":"vDKTG60zuf"}],"key":"bc0H7g6pgw"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nindex_times = 1:24:n+1;\nplot(x, U(:, 1))\nhold on,  grid on\naxis([0, 1, -0.25, 1])\ntitle('Heat equation by backward Euler') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/diffusionBE.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = index_times\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.3f\", t(frame));\n    text(0.05, 0.92, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid) ","visibility":"hide","key":"FTM0nn7D8U"},{"type":"output","id":"z54_bdc7V1mpq6SXUoP6s","data":[],"visibility":"remove","key":"uwGt8eDLi2"}],"visibility":"show","key":"mKF3trze4g"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This solution looks physically plausible, as the large concentration in the center diffuses outward until the solution is essentially constant. Observe that the solution remains periodic in space for all time.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oDEBeFLnox"}],"key":"dLJ4XdrlEs"}],"key":"IJDXrQS4UV"}],"key":"afn0OFVlZu"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"HeatFE","url":"/heatfe-1","group":"Chapter 11"},"next":{"title":"Auto","url":"/auto-1","group":"Chapter 11"}}},"domain":"http://localhost:3000"}