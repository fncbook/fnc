{"kind":"Notebook","sha256":"d8c225315ad1dd57c6e42f64ad2c9e10d3f8c00c5eebe23a6f54e9f6b40d1b14","slug":"chapter3-1","location":"/matlab/chapter3.md","dependencies":[],"frontmatter":{"title":"Chapter 3","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"chapter3.md","url":"/fnc/build/chapter3-cb189a355dec13612aae3fb28ec21fed.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"MATLAB implementations","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Sx5VUscmYV"}],"key":"leUrIyRvJ2"},{"type":"heading","depth":2,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"osJ0k4qdCw"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"oxvtXQgBxp"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by the normal equations","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"N4cv1IatnU"}],"key":"rN4wvEl0Qd"},{"type":"include","file":"../matlab/fnc/lsnormal.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = lsnormal(A,b)\r\n% LSNORMAL   Solve linear least squares by normal equations.\r\n% Input: \r\n%   A     coefficient matrix (m by n, m>n)\r\n%   b     right-hand side (m by 1)\r\n% Output:\r\n%   x     minimizer of || b-Ax ||\r\n\r\nN = A'*A;  z = A'*b;\r\nR = chol(N);\r\nw = forwardsub(R',z);                   % solve R'z=c\r\nx = backsub(R,w);                       % solve Rx=z","lang":"matlab","showLineNumbers":true,"filename":"lsnormal.m","key":"c0N2IOOop0"}],"key":"bMcuXLzpxB"}],"label":"function-lsnormal-matlab","identifier":"function-lsnormal-matlab","html_id":"function-lsnormal-matlab","key":"e8wlBjgWRq"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by QR factorization","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"BryeBDQ4Gf"}],"key":"SIbQyknhvl"},{"type":"include","file":"../matlab/fnc/lsqrfact.m","literal":true,"filter":{},"children":[{"type":"code","value":"function x = lsqrfact(A,b)\r\n% LSQRFACT   Solve linear least squares by QR factorization.\r\n% Input: \r\n%   A     coefficient matrix (m by n, m>n)\r\n%   b     right-hand side (m by 1)\r\n% Output:\r\n%   x     minimizer of || b-Ax ||\r\n\r\n[Q,R] = qr(A,0);                        % compressed factorization\r\nc = Q'*b;\r\nx = backsub(R,c);                       ","lang":"matlab","showLineNumbers":true,"filename":"lsqrfact.m","key":"Ii5Jrm6mLA"}],"key":"n8sN4M7prQ"}],"label":"function-lsqrfact-matlab","identifier":"function-lsqrfact-matlab","html_id":"function-lsqrfact-matlab","key":"cQfWgQ4fK1"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"QR factorization by Householder reflections","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"HuYADkP1EH"}],"key":"IKv3D08DUK"},{"type":"include","file":"../matlab/fnc/qrfact.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [Q,R] = qrfact(A)\r\n% QRFACT   QR factorization by Householder reflections.\r\n% (demo only--not efficient)\r\n% Input:\r\n%   A      m-by-n matrix\r\n% Output:\r\n%   Q,R    A=QR, Q m-by-m orthogonal, R m-by-n upper triangular\r\n\r\n[m,n] = size(A);\r\nQ = eye(m);\r\nfor k = 1:n\r\n  z = A(k:m,k);\r\n  v = [ -sign(z(1))*norm(z) - z(1); -z(2:end) ];\r\n  nrmv = norm(v);\r\n  if nrmv < eps, continue, end       % nothing is done in this iteration\r\n  v = v / nrmv;                      % removes v'*v in other formulas\r\n  % Apply the reflection to each relevant column of A and Q\r\n  for j = 1:n\r\n    A(k:m,j) = A(k:m,j) - v*( 2*(v'*A(k:m,j)) );\r\n  end\r\n  for j = 1:m\r\n    Q(k:m,j) = Q(k:m,j) - v*( 2*(v'*Q(k:m,j)) );\r\n  end\r\nend\r\n\r\nQ = Q';\r\nR = triu(A);                         % enforce exact triangularity","lang":"matlab","showLineNumbers":true,"filename":"qrfact.m","key":"cUd8hoKqGv"}],"key":"JgORftxwiQ"}],"label":"function-qrfact-matlab","identifier":"function-qrfact-matlab","html_id":"function-qrfact-matlab","key":"K9HMRv6aqd"},{"type":"heading","depth":2,"position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"H3sjVQouE6"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"WtiRthk6Jg"}],"key":"QMazzPvOEP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"addpath /Users/driscoll/Documents/GitHub/fnc/matlab/fnc\naddpath /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"qofSWlWcOE"},{"type":"output","id":"xI-6iGrR54rrDshVrBwAv","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (2) with properties:\n\n      Number: 2\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (2) with properties:\n\n      Number: 2\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"NrweRTVbiv"}],"data":{"tags":[]},"visibility":"remove","key":"PMoUAxoaXT"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"3.1 ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"i8oiY2dwTm"},{"type":"link","identifier":"section-leastsq-fitting","label":"section-leastsq-fitting","kind":"narrative","position":{"start":{"line":51,"column":5},"end":{"line":51,"column":29}},"url":"/fitting","internal":true,"dataUrl":"/fitting.json","children":[{"type":"text","value":"Fitting functions to data","key":"M7kHZgzWNI"}],"key":"mfLqT76gx0"}],"identifier":"id-3-1","label":"3.1 ","html_id":"id-3-1","implicit":true,"key":"cGDztsqSIQ"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempinterp","label":"demo-fitting-tempinterp","kind":"proof:example","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":25}},"children":[{"type":"text","value":"Example ","key":"nOwNPiyU4M"},{"type":"text","value":"3.1.1","key":"JMumamDtXb"}],"template":"Example %s","enumerator":"3.1.1","resolved":true,"html_id":"demo-fitting-tempinterp","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"tv5pUBIe95"}],"key":"wNYvA2RaAK"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Here are 5-year averages of the worldwide temperature anomaly as compared to the 1951–1980 average (source: NASA).","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"GKzu0AKZVB"}],"key":"GSdH7vl1wu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = (1955:5:2000)';\ny = [ -0.0480; -0.0180; -0.0360; -0.0120; -0.0040;\n    0.1180; 0.2100; 0.3320; 0.3340; 0.4560 ];\nscatter(t, y), axis tight\nxlabel('year')\nylabel(('anomaly ({\\circ}C)'));","key":"S4tNT1npcz"},{"type":"output","id":"fkV7Wv43gB5z108Hy6ubT","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5fb23ae5f503ed320ef0e8351533fadc","path":"/fnc/build/5fb23ae5f503ed320ef0e8351533fadc.png"}}}],"key":"PLa0DYo5Rh"}],"data":{},"key":"PvbLWiH0rK"},{"type":"paragraph","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"A polynomial interpolant can be used to fit the data. Here we build one using a Vandermonde matrix. First, though, we express time as decades since 1950, as it improves the condition number of the matrix.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"laE2dcqQdr"}],"key":"RNWPu9GHGw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = (t - 1950) / 10;  \nn = length(t);\nV = ones(n, 1);    % t^0\nfor j = 1:n-1\n    V(:, j+1) = t .* V(:,j);\nend\nc = V \\ y;    % solve for coefficients","key":"g6vU1Hd0IA"},{"type":"output","id":"yOVCxDoYl8Kepk2zyzL1z","data":[],"key":"nOrsPxPvpS"}],"data":{},"key":"uZVoQfmONL"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"We created the Vandermonde matrix columns in increasing-degree order. Thus, the coefficients in ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"VbKmXPSyAQ"},{"type":"inlineCode","value":"c","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"SLG6Hzx9XE"},{"type":"text","value":" also follow that ordering, which is the opposite of what MATLAB uses. We need to flip the coefficients before using them in ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"bwnh7MGoih"},{"type":"inlineCode","value":"polyval","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"PyGnylMnfm"},{"type":"text","value":".","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"XNLvLZQ5Yo"}],"key":"qpYL5R66PT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(year) polyval(c(end:-1:1), (year - 1950) / 10);\nhold on\nfplot(p, [1955, 2000])    % plot the interpolating function","key":"ffyLzWGVE6"},{"type":"output","id":"ZnkrQ3X1sJUKhwmQCx239","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c1c374ec7b3d50f1340ba81e227ff164","path":"/fnc/build/c1c374ec7b3d50f1340ba81e227ff164.png"}}}],"key":"RswRGfp2ko"}],"data":{},"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"fplot","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"polyval","kind":"entry"},"emphasis":false}],"label":"index-dIpuvgTKCT","identifier":"index-dipuvgtkct","html_id":"index-dipuvgtkct","key":"caWH55q0J6"}],"label":"demo-fitting-tempinterp-matlab","identifier":"demo-fitting-tempinterp-matlab","html_id":"demo-fitting-tempinterp-matlab","key":"N5j3tOqsLV"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempfit","label":"demo-fitting-tempfit","kind":"proof:example","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":22}},"children":[{"type":"text","value":"Example ","key":"f45Xtwg9mQ"},{"type":"text","value":"3.1.2","key":"FnHq8kiNnI"}],"template":"Example %s","enumerator":"3.1.2","resolved":true,"html_id":"demo-fitting-tempfit","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"HEe6tXaH6U"}],"key":"LTr31aLWuz"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Here are the 5-year temperature averages again.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"BqZyAYCwNN"}],"key":"vlcz0mdmLc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"year = (1955:5:2000)';\ny = [ -0.0480; -0.0180; -0.0360; -0.0120; -0.0040;\n    0.1180; 0.2100; 0.3320; 0.3340; 0.4560 ];","key":"XfFA1JHaq4"},{"type":"output","id":"2ijKlPz3N8F95plnEt_Vg","data":[],"key":"XRZEM3ILMW"}],"data":{},"key":"tQIg6UcSb8"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"The standard best-fit line results from using a linear polynomial that meets the least-squares criterion.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"DpEYsgvV2t"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":true}],"label":"index-PULxhHE13g","identifier":"index-pulxhhe13g","html_id":"index-pulxhhe13g","key":"P1c9pWSwlw"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"QoBbRehxHZ"}],"key":"oXYH6b7XSO"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Backslash solves overdetermined linear systems in a least-squares sense.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"cMZb0YD2Hb"}],"key":"YUSUQYu9PJ"}],"class":"dropdown","key":"maW94KNB61"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = (year - 1955) / 10;    % better matrix conditioning later\nV = [ t.^0 t ];            % Vandermonde-ish matrix\nsize(V)","key":"r9pRMfY3Uw"},{"type":"output","id":"gzjDieWmbgcu2dT1peTHC","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n    10     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n    10     2\n","content_type":"text/plain"}}}],"key":"LraV1ECYkK"}],"data":{},"key":"JxCsTyY8Ey"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = V \\ y;\nf = @(year) polyval(c(end:-1:1), (year - 1955) / 10);","key":"JmJAs4i64C"},{"type":"output","id":"15PXwxPjm2Wqt4i8lMmNR","data":[],"key":"Cgz03hxIF1"}],"data":{},"key":"frjbe6dXJZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nscatter(year, y), axis tight\nxlabel('year'), ylabel('anomaly ({\\circ}C)')\nhold on\nfplot(f, [1955, 2000])","key":"CHhYleK1cW"},{"type":"output","id":"MI0kCgY43DnY2BEJIBSor","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4724c499008a50dd5375aafd4540f886","path":"/fnc/build/4724c499008a50dd5375aafd4540f886.png"}}}],"key":"BYJFGskJ1i"}],"data":{},"key":"m8TDPxhWXF"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"If we use a global cubic polynomial, the points are fit more closely.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"TmoUvgcR0C"}],"key":"ijk5SwlZSm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"V = [t.^0, t.^1, t.^2, t.^3];    % Vandermonde-ish matrix  \nsize(V)","key":"z40mBAwFqz"},{"type":"output","id":"Ku9--lh6mxI0oJVYD2HsO","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n    10     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n    10     4\n","content_type":"text/plain"}}}],"key":"uUFQIAGMU2"}],"data":{},"key":"B4L2IxQmE3"},{"type":"paragraph","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"Now we solve the new least-squares problem to redefine the fitting polynomial.","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"PTyLq1NjBs"}],"key":"DFOU5Hoz7t"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"SLzHXisHcu"}],"key":"D73BlUJLTv"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"The definition of ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"HgKu0L9ELa"},{"type":"inlineCode","value":"f","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"qMFHX66M5F"},{"type":"text","value":" above is in terms of ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"iYApXTn107"},{"type":"inlineCode","value":"c","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"ECjgbtZuEv"},{"type":"text","value":". When ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"NkovVOX95N"},{"type":"inlineCode","value":"c","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"GDYRfiPlvX"},{"type":"text","value":" is changed, then ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"nVQXUPimDu"},{"type":"inlineCode","value":"f","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"HJZyRLxdzU"},{"type":"text","value":" has to be redefined.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"iqBdxDtzZB"}],"key":"k9bnz76VsI"}],"class":"dropdown","key":"nfUwDntlvY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = V \\ y;\nf = @(year) polyval(c(end:-1:1), (year - 1955) / 10);\nfplot(f, [1955, 2000]) \nlegend('data', 'linear', 'cubic', 'Location', 'northwest');","key":"RkSzaFIIEe"},{"type":"output","id":"TSz6QWyhC_sPMHFR_OAtQ","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"763cface3da72dd048cf165faaa77fca","path":"/fnc/build/763cface3da72dd048cf165faaa77fca.png"}}}],"key":"fripDFgTdP"}],"data":{},"key":"EryfIcLQ3l"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"If we were to continue increasing the degree of the polynomial, the residual at the data points would get smaller, but overfitting would increase.","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"YhZxniEDra"}],"key":"v9qloqGhg9"}],"label":"demo-fitting-tempfit-matlab","identifier":"demo-fitting-tempfit-matlab","html_id":"demo-fitting-tempfit-matlab","key":"ooPtzhHtpV"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-pirate","label":"demo-fitting-pirate","kind":"proof:example","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":21}},"children":[{"type":"text","value":"Example ","key":"bFh2ZJyUSl"},{"type":"text","value":"3.1.3","key":"QFIQ6HUkjt"}],"template":"Example %s","enumerator":"3.1.3","resolved":true,"html_id":"demo-fitting-pirate","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"uDCntVCRUA"}],"key":"aNsbnXLvnz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"k = (1:100)';\na = 1./k.^2;      % sequence\ns = cumsum(a);    % cumulative summation\np = sqrt(6*s);\nclf\nplot(k, p, 'o-')\nxlabel('k'), ylabel('p_k')\ntitle(('Sequence converging to \\pi'));","key":"iD5N6uPdR4"},{"type":"output","id":"J2h8tmW_pu7ebsbYl1zWC","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"319037e5a8ddff4e8162b3ea6a7eb318","path":"/fnc/build/319037e5a8ddff4e8162b3ea6a7eb318.png"}}}],"key":"uHJIpdrNfO"}],"data":{},"key":"cgC2s8t9yn"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"This graph suggests that maybe ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"KudJ93YDHJ"},{"type":"inlineMath","value":"p_k\\to \\pi","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>→</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">p_k\\to \\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"ZmU3qJu3DJ"},{"type":"text","value":", but it’s far from clear how close the sequence gets. It’s more informative to plot the sequence of errors, ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"lGIQm6SSXU"},{"type":"inlineMath","value":"\\epsilon_k= |\\pi-p_k|","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>π</mi><mo>−</mo><msub><mi>p</mi><mi>k</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k= |\\pi-p_k|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>","key":"WfrT8ZPYFv"},{"type":"text","value":". By plotting the error sequence on a log-log scale, we can see a nearly linear relationship.","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"b9C3xdpkyj"}],"key":"MytrKX9M3S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = abs(pi - p);    % error sequence\nloglog(k, ep, 'o')\ntitle('Convergence')\nxlabel('k'), ylabel('|p_k - \\pi|'), axis tight","key":"nC88ebkBDv"},{"type":"output","id":"mONcUVbxAc9UU8_i6mVrg","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b8bc16df0bb558c4244ded394a1144da","path":"/fnc/build/b8bc16df0bb558c4244ded394a1144da.png"}}}],"key":"m4t7N5LQl5"}],"data":{},"key":"RvbVr4Dh1t"},{"type":"paragraph","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"The straight line on the log-log scale suggests a power-law relationship where ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"hyrLgm91r0"},{"type":"inlineMath","value":"\\epsilon_k\\approx a k^b","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>a</mi><msup><mi>k</mi><mi>b</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k\\approx a k^b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6331em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span></span></span></span>","key":"CkmegwfPCD"},{"type":"text","value":", or ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"AVT89jQRoB"},{"type":"inlineMath","value":"\\log \\epsilon_k \\approx b (\\log k) + \\log a","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>b</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">\\log \\epsilon_k \\approx b (\\log k) + \\log a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"xxyN5QOnNS"},{"type":"text","value":".","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"ob9O62pQV2"}],"key":"Rtj3jalXm5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"V = [ k.^0, log(k) ];    % fitting matrix\nc = V \\ log(ep)          % coefficients of linear fit","key":"u18D1V52bH"},{"type":"output","id":"Gj1JE8zsB5HXL2dvKPAM0","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>c = 2×1 double\n   -0.1824\n   -0.9674\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"c = 2×1 double\n   -0.1824\n   -0.9674\n","content_type":"text/plain"}}}],"key":"KLow8Msvtd"}],"data":{},"key":"oBtLI9e5DW"},{"type":"paragraph","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"text","value":"In terms of the parameters ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"RtPgkejHgQ"},{"type":"inlineMath","value":"a","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"MOChrp7ef8"},{"type":"text","value":" and ","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"LRlhSHVp2o"},{"type":"inlineMath","value":"b","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"gkXrxQnc05"},{"type":"text","value":" used above, we have","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"jCbBy53qEu"}],"key":"yPBictuMBF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"a = exp(c(1)),  b = c(2)","key":"zIrtfFzfsX"},{"type":"output","id":"RI1xA54D-hAzFusURUIgJ","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>a = 0.8333</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"a = 0.8333","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>b = -0.9674</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"b = -0.9674","content_type":"text/plain"}}}],"key":"uEA10psLo8"}],"data":{},"key":"k4zxDERmif"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"It’s tempting to conjecture that the slope ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"I7R8EBXL4y"},{"type":"inlineMath","value":"b\\to -1","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>→</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">b\\to -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"bY7vfLZc9n"},{"type":"text","value":" asymptotically. Here is how the numerical fit compares to the original convergence curve.","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"MUvelPjODg"}],"key":"psyv3AU9TU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nloglog(k, a * k.^b)\nlegend('sequence', 'power-law fit');","key":"KZp58pVCKf"},{"type":"output","id":"x8X1K7wooBDELVNGp7css","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e63c4c200e516bc56f0a081b27a6ef30","path":"/fnc/build/e63c4c200e516bc56f0a081b27a6ef30.png"}}}],"key":"bS1jEFgsu1"}],"data":{},"key":"BgVrcpCSdw"}],"label":"demo-fitting-pirate-matlab","identifier":"demo-fitting-pirate-matlab","html_id":"demo-fitting-pirate-matlab","key":"uM5SNl45tY"},{"type":"heading","depth":3,"position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"3.2 ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"fTcwpcMbT2"},{"type":"link","identifier":"section-leastsq-normaleqns","label":"section-leastsq-normaleqns","kind":"narrative","position":{"start":{"line":194,"column":5},"end":{"line":194,"column":32}},"url":"/normaleqns","internal":true,"dataUrl":"/normaleqns.json","children":[{"type":"text","value":"The normal equations","key":"c0p0JIuDtn"}],"key":"rN7tUvvMri"}],"identifier":"id-3-2","label":"3.2 ","html_id":"id-3-2","implicit":true,"key":"Cl8QGffHXL"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","kind":"proof:example","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":24}},"children":[{"type":"text","value":"Example ","key":"hVkQypNMuS"},{"type":"text","value":"3.2.1","key":"Zui1zMdw0K"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"CoTzHRqkhb"}],"key":"q5unDr432h"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Because the functions ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"zntX5IYhk3"},{"type":"inlineMath","value":"\\sin^2(t)","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1219em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">sin</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8719em;\"><span style=\"top:-3.1208em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"er1L6JzhG5"},{"type":"text","value":", ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"SuYbdOCsXC"},{"type":"inlineMath","value":"\\cos^2(t)","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>cos</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\cos^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">cos</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"ekybSyDwsd"},{"type":"text","value":", and ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"o6gLGcKETl"},{"type":"text","value":"1","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"rXgtFswASC"},{"type":"text","value":" are linearly dependent, we should find that the following matrix is somewhat ill-conditioned.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"fYv4cyNiTo"}],"key":"Jtpv2Vl66z"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"V6emWdBiBl"}],"key":"P2eJQhpzgX"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"The local variable scoping rule for loops applies to comprehensions as well.","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"gIvTiwFkfG"}],"key":"Tz5L0I8e8t"}],"class":"dropdown","key":"tyRD08dZ4z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 3, 400)';\nA = [ sin(t).^2, cos((1+1e-7)*t).^2, t.^0 ];\nkappa = cond(A)","key":"jIopGeVKyr"},{"type":"output","id":"tQSuCNrxbpJWXc79R7Qzh","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>kappa = 1.8253e+07</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"kappa = 1.8253e+07","content_type":"text/plain"}}}],"key":"yymrtqcI4O"}],"data":{},"key":"QkDVVIPX3B"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Now we set up an artificial linear least-squares problem with a known exact solution that actually makes the residual zero.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"SvHmmqqOjX"}],"key":"M6HNLzJf3o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [1; 2; 1];\nb = A * x;","key":"BDaU1fYa9m"},{"type":"output","id":"q2w92yUvqG0nE_80kgMQh","data":[],"key":"HWhBN8Pjez"}],"data":{},"key":"EoF0Hazzs6"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"Using backslash to find the least-squares solution, we get a relative error that is well below ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"s10XYpg3jZ"},{"type":"text","value":"κ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"LkrV7bVPWP"},{"type":"text","value":" times machine epsilon.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"F8J7Ra9w8i"}],"key":"rcTmQpC3D8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_BS = A \\ b;\nobserved_err = norm(x_BS - x) / norm(x)\nmax_err = kappa * eps","key":"y0QMkoi4XZ"},{"type":"output","id":"2DEj493FPgoI3S_TImuvM","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>observed_err = 9.8998e-11</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"observed_err = 9.8998e-11","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>max_err = 4.0530e-09</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"max_err = 4.0530e-09","content_type":"text/plain"}}}],"key":"Lb5VykDpmC"}],"data":{},"key":"v9zlUMguFd"},{"type":"paragraph","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"If we formulate and solve via the normal equations, we get a much larger relative error. With ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"eeGJbPDzZl"},{"type":"inlineMath","value":"\\kappa^2\\approx 10^{14}","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>κ</mi><mn>2</mn></msup><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa^2\\approx 10^{14}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span></span></span></span></span></span></span></span></span></span></span></span>","key":"LIhX2LY6bQ"},{"type":"text","value":", we may not be left with more than about 2 accurate digits.","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"DWR3sHO2kI"}],"key":"PjHxFZI0Tw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"N = A'*A;\nx_NE = N\\(A'*b);\nobserved_err = norm(x_NE - x) / norm(x)\ndigits = -log10(observed_err)","key":"ZLO95dakU9"},{"type":"output","id":"3DvYJBvtWxiVAXMLFky63","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>observed_err = 0.0937</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"observed_err = 0.0937","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>digits = 1.0282</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"digits = 1.0282","content_type":"text/plain"}}}],"key":"LqO5Fp20gR"}],"data":{},"key":"M6rLI6SMdq"}],"label":"demo-normaleqns-instab-matlab","identifier":"demo-normaleqns-instab-matlab","html_id":"demo-normaleqns-instab-matlab","key":"TECOMCPj5j"},{"type":"heading","depth":3,"position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"children":[{"type":"text","value":"3.3 ","position":{"start":{"line":235,"column":1},"end":{"line":235,"column":1}},"key":"s892L2kuz3"},{"type":"link","identifier":"section-leastsq-qr","label":"section-leastsq-qr","kind":"narrative","position":{"start":{"line":235,"column":5},"end":{"line":235,"column":24}},"url":"/qr","internal":true,"dataUrl":"/qr.json","children":[{"type":"text","value":"The QR factorization","key":"UEhVCv9tPd"}],"key":"rt2jzSJczy"}],"identifier":"id-3-3","label":"3.3 ","html_id":"id-3-3","implicit":true,"key":"pTqdS9Dggv"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-qrfact","label":"demo-qr-qrfact","kind":"proof:example","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":16}},"children":[{"type":"text","value":"Example ","key":"dnZehbWpf7"},{"type":"text","value":"3.3.1","key":"iwziThtnJZ"}],"template":"Example %s","enumerator":"3.3.1","resolved":true,"html_id":"demo-qr-qrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"PoyXA4reRx"}],"key":"oTwgashZos"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"text","value":"MATLAB provides access to both the thin and full forms of the QR factorization.","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"IvGIox7YYo"}],"key":"okHJoo1u8N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = magic(5);\nA = A(:, 1:4);\n[m, n] = size(A)","key":"lQnrg1JxXi"},{"type":"output","id":"uPaTb--cc2Qw4RR5SeRMp","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>m = 5</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"m = 5","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>n = 4</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"n = 4","content_type":"text/plain"}}}],"key":"N48PLZ1RZY"}],"data":{},"key":"kN0HHEXjZP"},{"type":"paragraph","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"children":[{"type":"text","value":"Here is the full form:","position":{"start":{"line":247,"column":1},"end":{"line":247,"column":1}},"key":"fXdA6vPQnb"}],"key":"srMJMTi0OX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q, R] = qr(A);\nszQ = size(Q), szR = size(R)","key":"vL4NbjngQg"},{"type":"output","id":"ym1jQx0itmCRxx4fUrwDF","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szQ = 1×2 double\n     5     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szQ = 1×2 double\n     5     5\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szR = 1×2 double\n     5     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szR = 1×2 double\n     5     4\n","content_type":"text/plain"}}}],"key":"EXrj93Q96D"}],"data":{},"key":"HHHzfocyf6"},{"type":"paragraph","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"text","value":"We can test that ","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"dHpLtX2hxf"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"ex4kvEhOzc"},{"type":"text","value":" is an orthogonal matrix:","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"Y4IxR6aso1"}],"key":"oQjv3rrEiR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"QTQ = Q' * Q\nnorm(QTQ - eye(m))","key":"TBNVMKqkdl"},{"type":"output","id":"6rBxANDyNKY3G2dcSMKW5","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>QTQ = 5×5 double\n    1.0000   -0.0000    0.0000         0    0.0000\n   -0.0000    1.0000    0.0000   -0.0000    0.0000\n    0.0000    0.0000    1.0000         0   -0.0000\n         0   -0.0000         0    1.0000   -0.0000\n    0.0000    0.0000   -0.0000   -0.0000    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"QTQ = 5×5 double\n    1.0000   -0.0000    0.0000         0    0.0000\n   -0.0000    1.0000    0.0000   -0.0000    0.0000\n    0.0000    0.0000    1.0000         0   -0.0000\n         0   -0.0000         0    1.0000   -0.0000\n    0.0000    0.0000   -0.0000   -0.0000    1.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4.7051e-16</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4.7051e-16","content_type":"text/plain"}}}],"key":"GUw86m5Lr4"}],"data":{},"key":"pC2UaCWAk1"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"With a second input argument given to ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"h0nmuVg3VT"},{"type":"inlineCode","value":"qr","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"R8SVaVXTsF"},{"type":"text","value":", the thin form is returned. (This is usually the one we want in practice.)","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"dg9Hqotqxb"}],"key":"A3NvobHrm5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q_hat, R_hat] = qr(A, 0);\nszQ_hat = size(Q_hat), szR_hat = size(R_hat)","key":"QAoc8Iw46H"},{"type":"output","id":"HXqMppdBMtoNYx6Rb8jEH","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szQ_hat = 1×2 double\n     5     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szQ_hat = 1×2 double\n     5     4\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szR_hat = 1×2 double\n     4     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szR_hat = 1×2 double\n     4     4\n","content_type":"text/plain"}}}],"key":"kr51yzpaxj"}],"data":{},"key":"Yh9uKiDZds"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"yPhdaIzCRP"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"LcH2pcyURG"},{"type":"text","value":" cannot be an orthogonal matrix, because it is not square, but it is still ","key":"OgfTpMSplW"},{"type":"abbreviation","title":"matrix with orthonormal columns","children":[{"type":"text","value":"ONC","key":"MDwmW81alK"}],"key":"T38jWTa1k0"},{"type":"text","value":". Mathematically, ","key":"LINTJF7emg"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}^T \\hat{\\mathbf{Q}}","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover><mi>T</mi></msup><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}^T \\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"s5NwpCbjqj"},{"type":"text","value":" is a ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"XOGoSgKrzV"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"gTNeB8pmjS"},{"type":"text","value":" identity matrix.","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"e8RzolEtdu"}],"key":"qLW5JyyLTI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Q_hat' * Q_hat - eye(n)","key":"iHQ6jytPNW"},{"type":"output","id":"C3NldUiscz-HCJ_rDVkLM","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n1.0e-15 *\n\n   -0.2220   -0.0555    0.0833         0\n   -0.0555    0.4441    0.0833   -0.0555\n    0.0833    0.0833   -0.2220         0\n         0   -0.0555         0         0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n1.0e-15 *\n\n   -0.2220   -0.0555    0.0833         0\n   -0.0555    0.4441    0.0833   -0.0555\n    0.0833    0.0833   -0.2220         0\n         0   -0.0555         0         0\n","content_type":"text/plain"}}}],"key":"hvOcWueQYf"}],"data":{},"key":"mHsDdMbp7m"}],"label":"demo-qr-qrfact-matlab","identifier":"demo-qr-qrfact-matlab","html_id":"demo-qr-qrfact-matlab","key":"fkGj9tWvOH"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-stable","label":"demo-qr-stable","kind":"proof:example","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":16}},"children":[{"type":"text","value":"Example ","key":"Xy3nIqzDRz"},{"type":"text","value":"3.3.2","key":"oNwETY30Vk"}],"template":"Example %s","enumerator":"3.3.2","resolved":true,"html_id":"demo-qr-stable","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"hr4rPemtKj"}],"key":"G0RL3s6Q2y"},{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"We’ll repeat the experiment of ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"uBDwxrFh11"},{"type":"crossReference","kind":"proof:example","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","children":[{"type":"text","value":"Demo ","key":"cL6IVYBte4"},{"type":"text","value":"3.2.1","key":"UXP3D3dsUP"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"z5g6gphycK"},{"type":"text","value":", which exposed instability in the normal equations.","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"AM9WDYVJWf"}],"key":"dpl38JX3E6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 3, 400)';\nA = [ sin(t).^2, cos((1+1e-7)*t).^2, t.^0 ];\nx = [1; 2; 1];\nb = A * x;","key":"sgTDsMIERP"},{"type":"output","id":"5JHqaMYxgheqZ8sc-ODQn","data":[],"key":"FvyZPrnmcQ"}],"data":{},"key":"W7tdLAdz6w"},{"type":"paragraph","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"children":[{"type":"text","value":"The error in the solution by ","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"cqZSVWZt8X"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lsqrfact","label":"function-lsqrfact","children":[{"type":"text","value":"Function ","key":"SMgcNFOxTB"},{"type":"text","value":"3.3.2","key":"dUhgKfHQaK"}],"template":"Algorithm %s","enumerator":"3.3.2","resolved":true,"html_id":"function-lsqrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"YcrATfqs1B"},{"type":"text","value":" is similar to the bound predicted by the condition number.","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":1}},"key":"PKVthGrA52"}],"key":"QjT48U3HWY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"observed_error = norm(lsqrfact(A, b) - x) / norm(x)\nerror_bound = cond(A) * eps","key":"ePg1dSok34"},{"type":"output","id":"vzriqc6KD-4Aoqsjxly9E","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>observed_error = 8.8581e-10</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"observed_error = 8.8581e-10","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>error_bound = 4.0530e-09</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"error_bound = 4.0530e-09","content_type":"text/plain"}}}],"key":"gzYt89q89M"}],"data":{},"key":"yNEDJhgkPR"}],"label":"demo-qr-stable-matlab","identifier":"demo-qr-stable-matlab","html_id":"demo-qr-stable-matlab","key":"Ataor0Y6XY"},{"type":"heading","depth":3,"position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"3.4 ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"yTDEz3mhY6"},{"type":"link","identifier":"section-leastsq-house","label":"section-leastsq-house","kind":"narrative","position":{"start":{"line":294,"column":5},"end":{"line":294,"column":27}},"url":"/house","internal":true,"dataUrl":"/house.json","children":[{"type":"text","value":"Computing QR factorizations","key":"cbNBKosvjD"}],"key":"fhAkA6cvRL"}],"identifier":"id-3-4","label":"3.4 ","html_id":"id-3-4","implicit":true,"key":"uOHko4rEEh"},{"type":"details","children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-house-qr","label":"demo-house-qr","kind":"proof:example","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":15}},"children":[{"type":"text","value":"Example ","key":"PDdiDGMUpm"},{"type":"text","value":"3.4.1","key":"WynQs1RUig"}],"template":"Example %s","enumerator":"3.4.1","resolved":true,"html_id":"demo-house-qr","remote":true,"url":"/house","dataUrl":"/house.json","key":"SPIX9c9xox"}],"key":"GLhwGFeOcU"},{"type":"paragraph","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"We will use Householder reflections to produce a QR factorization of a matrix.","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"XZGI99jTeC"}],"key":"D3cT7VVfk2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = magic(6);\nA = A(:, 1:4);\n[m, n] = size(A)","key":"Syy6bxgJO6"},{"type":"output","id":"lCM0XNYU5zq32vNY9gUe5","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>m = 6</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"m = 6","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>n = 4</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"n = 4","content_type":"text/plain"}}}],"key":"xQf5xUOp4V"}],"data":{},"key":"fxfCzfvCWD"},{"type":"paragraph","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"Our first step is to introduce zeros below the diagonal in column 1 by using ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"OhYHY2LKUv"},{"type":"crossReference","kind":"equation","identifier":"hhvector","label":"hhvector","children":[{"type":"text","value":"(","key":"m22SCZCuqu"},{"type":"text","value":"3.4.4","key":"O4NztqwStB"},{"type":"text","value":")","key":"A3pzF76SbD"}],"template":"(%s)","enumerator":"3.4.4","resolved":true,"html_id":"hhvector","remote":true,"url":"/house","dataUrl":"/house.json","key":"uzIhvzdSqL"},{"type":"text","value":" and ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"bamhACQLHF"},{"type":"crossReference","kind":"equation","identifier":"hhreflect","label":"hhreflect","children":[{"type":"text","value":"(","key":"Ov4wu4mqbs"},{"type":"text","value":"3.4.1","key":"Ni6gCUjKY1"},{"type":"text","value":")","key":"U8fAxO7pif"}],"template":"(%s)","enumerator":"3.4.1","resolved":true,"html_id":"hhreflect","remote":true,"url":"/house","dataUrl":"/house.json","key":"JPPdQkH1Ki"},{"type":"text","value":".","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"lZbIfVh508"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"eye","kind":"entry"},"emphasis":true}],"label":"index-XvVxmGJhqY","identifier":"index-xvvxmgjhqy","html_id":"index-xvvxmgjhqy","key":"Jmb58RixqT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = A(:, 1);\nv = z - norm(z) * eye(m,1);\nP_1 = eye(m) - 2 / (v' * v) * (v * v');","key":"nCpXUA7u74"},{"type":"output","id":"o3ge9fMBzoyjgku-SrPt0","data":[],"key":"nTmnapvsLD"}],"data":{},"key":"L4ZfhHgEMa"},{"type":"paragraph","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"text","value":"We check that this reflector introduces zeros as it should:","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"fYL8Efee8M"}],"key":"X74vDdfeco"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"P_1 * z","key":"Z92gKi2xgv"},{"type":"output","id":"k_KIMcXhVdltWuX1IUnFV","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×1 double\n   56.3471\n    0.0000\n   -0.0000\n   -0.0000\n   -0.0000\n   -0.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×1 double\n   56.3471\n    0.0000\n   -0.0000\n   -0.0000\n   -0.0000\n   -0.0000\n","content_type":"text/plain"}}}],"key":"hgzqlbEdUR"}],"data":{},"key":"t3oBgSn5FO"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"Now we replace ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"IwZZD8dlkS"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"SYuOJ5GLUg"},{"type":"text","value":" by ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"mfEvH9sY44"},{"type":"inlineMath","value":"\\mathbf{P}_1\\mathbf{A}","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">P</mi><mn>1</mn></msub><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}_1\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"w42IavjZXe"},{"type":"text","value":".","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"UddW0gzo5u"}],"key":"MLgm0Y93A2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = P_1 * A","key":"IfQSy9N1RK"},{"type":"output","id":"XSI0urUs3ITps6pjGM-NR","data":[{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 6×4 double\n   56.3471   16.4693   30.0459   39.0969\n   -0.0000   29.8260    3.6207   19.1594\n   -0.0000  -13.4643  -32.9191    2.9808\n   -0.0000   22.2028   23.9886   12.0918\n   -0.0000  -16.7397    0.2073   -6.4056\n   -0.0000   33.1014   24.4943   10.5459\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 6×4 double\n   56.3471   16.4693   30.0459   39.0969\n   -0.0000   29.8260    3.6207   19.1594\n   -0.0000  -13.4643  -32.9191    2.9808\n   -0.0000   22.2028   23.9886   12.0918\n   -0.0000  -16.7397    0.2073   -6.4056\n   -0.0000   33.1014   24.4943   10.5459\n","content_type":"text/plain"}}}],"key":"yGeFgjHZKr"}],"data":{},"key":"AcipMmiSB6"},{"type":"paragraph","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"text","value":"We are set to put zeros into column 2. We must not use row 1 in any way, lest it destroy the zeros we just introduced. So we leave it out of the next reflector.","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"key":"erWli38Vtb"}],"key":"MbmtZgjW0Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = A(2:m, 2);\nv = z - norm(z) * eye(m-1, 1);\nP_2 = eye(m-1) - 2 / (v' * v) * (v * v');","key":"KJ8J94RQn8"},{"type":"output","id":"CGB0BUl9h4QnrP4RJRJ2X","data":[],"key":"ByZGxM8RiE"}],"data":{},"key":"Qul8A1kQx0"},{"type":"paragraph","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"We now apply this reflector to rows 2 and below only.","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"bUGlu5UE4h"}],"key":"bZmtXs20lJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A(2:m, 2:n) = P_2 * A(2:m, 2:n)","key":"SNMpGoZl5x"},{"type":"output","id":"0ZUnpQ9bo48fdazKmujLf","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 6×4 double\n   56.3471   16.4693   30.0459   39.0969\n   -0.0000   54.2196   34.8797   23.1669\n   -0.0000    0.0000  -15.6653    5.1928\n   -0.0000         0   -4.4630    8.4443\n   -0.0000   -0.0000   21.6583   -3.6556\n   -0.0000    0.0000  -17.9233    5.1079\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 6×4 double\n   56.3471   16.4693   30.0459   39.0969\n   -0.0000   54.2196   34.8797   23.1669\n   -0.0000    0.0000  -15.6653    5.1928\n   -0.0000         0   -4.4630    8.4443\n   -0.0000   -0.0000   21.6583   -3.6556\n   -0.0000    0.0000  -17.9233    5.1079\n","content_type":"text/plain"}}}],"key":"aD4mgNDLJJ"}],"data":{},"key":"cEOq5zVjBl"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"We need to iterate the process for the last two columns.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"LWFvnl6nXG"}],"key":"XYIY1Zvkni"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for j = 3:n\n    z = A(j:m,j);\n    k = m-j+1;\n    v = z - norm(z) * eye(k, 1);\n    P = eye(k) - 2 / (v' * v) * (v * v');\n    A(j:m, j:n) = P * A(j:m, j:n);\nend","key":"aNTTCqDlIO"},{"type":"output","id":"M3cghMrAUd2NhENImodwt","data":[],"key":"c2c8PdmdEH"}],"data":{},"key":"tZZ9PfWMPe"},{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"We have now reduced the original to an upper triangular matrix using four orthogonal Householder reflections:","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"UcZ3DI1tX0"}],"key":"pZHv9GFtlT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"R = A","key":"WHcaGJqH7s"},{"type":"output","id":"bE0OG86frMgcDF4r4kzSV","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>R = 6×4 double\n   56.3471   16.4693   30.0459   39.0969\n   -0.0000   54.2196   34.8797   23.1669\n   -0.0000    0.0000   32.4907   -8.9182\n   -0.0000         0   -0.0000    7.6283\n   -0.0000   -0.0000    0.0000    0.0000\n   -0.0000    0.0000         0   -0.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"R = 6×4 double\n   56.3471   16.4693   30.0459   39.0969\n   -0.0000   54.2196   34.8797   23.1669\n   -0.0000    0.0000   32.4907   -8.9182\n   -0.0000         0   -0.0000    7.6283\n   -0.0000   -0.0000    0.0000    0.0000\n   -0.0000    0.0000         0   -0.0000\n","content_type":"text/plain"}}}],"key":"hCShUkj8I2"}],"data":{},"key":"z2Pr7DpemR"}],"label":"demo-house-qr-matlab","identifier":"demo-house-qr-matlab","html_id":"demo-house-qr-matlab","key":"kKglfaxGQl"}],"key":"oLByzdPHaT"}],"key":"Y4yHU87AAs"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 2","url":"/chapter2-1","group":"MATLAB codes"},"next":{"title":"Chapter 4","url":"/chapter4-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}