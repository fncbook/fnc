{"version":1,"kind":"Notebook","sha256":"ad79000ba0534d7053640684f691599061c7d7f5d0017d3d99111ec044b1dc66","slug":"chapter3-1","location":"/matlab/chapter3.md","dependencies":[],"frontmatter":{"title":"Chapter 3","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter3.md","exports":[{"format":"md","filename":"chapter3.md","url":"/build/chapter3-6904f65be03e97370baee48b170f474c.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"fhVjoGMM25"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"oU4RswjbXJ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by the normal equations","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"l1FQyjcGKK"}],"key":"HXOx5O0F2h"},{"type":"include","file":"FNC-matlab/lsnormal.m","literal":true,"children":[{"type":"code","value":"function x = lsnormal(A,b)\r\n% LSNORMAL   Solve linear least squares by normal equations.\r\n% Input: \r\n%   A     coefficient matrix (m by n, m>n)\r\n%   b     right-hand side (m by 1)\r\n% Output:\r\n%   x     minimizer of || b-Ax ||\r\n\r\nN = A'*A;  z = A'*b;\r\nR = chol(N);\r\nw = forwardsub(R',z);                   % solve R'z=c\r\nx = backsub(R,w);                       % solve Rx=z","lang":"matlab","showLineNumbers":true,"filename":"lsnormal.m","key":"zEAvYnoEWQ"}],"key":"jFs247eSC8"}],"label":"function-lsnormal-matlab","identifier":"function-lsnormal-matlab","html_id":"function-lsnormal-matlab","key":"B3adofNGkG"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of least squares by QR factorization","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"zy54WHjHwC"}],"key":"UbPBKPcxtI"},{"type":"include","file":"FNC-matlab/lsqrfact.m","literal":true,"children":[{"type":"code","value":"function x = lsqrfact(A,b)\r\n% LSQRFACT   Solve linear least squares by QR factorization.\r\n% Input: \r\n%   A     coefficient matrix (m by n, m>n)\r\n%   b     right-hand side (m by 1)\r\n% Output:\r\n%   x     minimizer of || b-Ax ||\r\n\r\n[Q,R] = qr(A,0);                        % compressed factorization\r\nc = Q'*b;\r\nx = backsub(R,c);                       ","lang":"matlab","showLineNumbers":true,"filename":"lsqrfact.m","key":"KpV7Zbgps8"}],"key":"cISJ3iqDbp"}],"label":"function-lsqrfact-matlab","identifier":"function-lsqrfact-matlab","html_id":"function-lsqrfact-matlab","key":"eINZlLIrRt"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"QR factorization by Householder reflections","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"YFGRN8KV0X"}],"key":"S10a6Zc1sR"},{"type":"include","file":"FNC-matlab/qrfact.m","literal":true,"children":[{"type":"code","value":"function [Q,R] = qrfact(A)\r\n% QRFACT   QR factorization by Householder reflections.\r\n% (demo only--not efficient)\r\n% Input:\r\n%   A      m-by-n matrix\r\n% Output:\r\n%   Q,R    A=QR, Q m-by-m orthogonal, R m-by-n upper triangular\r\n\r\n[m,n] = size(A);\r\nQ = eye(m);\r\nfor k = 1:n\r\n  z = A(k:m,k);\r\n  v = [ -sign(z(1))*norm(z) - z(1); -z(2:end) ];\r\n  nrmv = norm(v);\r\n  if nrmv < eps, continue, end       % nothing is done in this iteration\r\n  v = v / nrmv;                      % removes v'*v in other formulas\r\n  % Apply the reflection to each relevant column of A and Q\r\n  for j = 1:n\r\n    A(k:m,j) = A(k:m,j) - v*( 2*(v'*A(k:m,j)) );\r\n  end\r\n  for j = 1:m\r\n    Q(k:m,j) = Q(k:m,j) - v*( 2*(v'*Q(k:m,j)) );\r\n  end\r\nend\r\n\r\nQ = Q';\r\nR = triu(A);                         % enforce exact triangularity","lang":"matlab","showLineNumbers":true,"filename":"qrfact.m","key":"dcnmMTL4ew"}],"key":"f83cS0Rxm6"}],"label":"function-qrfact-matlab","identifier":"function-qrfact-matlab","html_id":"function-qrfact-matlab","key":"I9J0rFGVgE"},{"type":"heading","depth":2,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"FDyeFkNuQn"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"zdchKnWTiK"}],"key":"VzaCno7n3Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;;\npwd;;","visibility":"show","key":"TdytptyuvF"},{"type":"output","id":"b01Szao0JE2igau34pqhm","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."}],"visibility":"show","key":"phsB21HXa4"}],"data":{"tags":[]},"visibility":"remove","key":"YDbnAywQVD"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"3.1 ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ZH2TT7jXmM"},{"type":"link","identifier":"section-leastsq-fitting","label":"section-leastsq-fitting","kind":"narrative","position":{"start":{"line":49,"column":5},"end":{"line":49,"column":29}},"url":"/fitting","internal":true,"dataUrl":"/fitting.json","children":[{"type":"text","value":"Fitting functions to data","key":"TLGDTsTakN"}],"key":"D8uuatzucV"}],"identifier":"id-3-1","label":"3.1 ","html_id":"id-3-1","implicit":true,"key":"owfOSIkfRk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempinterp","label":"demo-fitting-tempinterp","kind":"proof:example","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":25}},"children":[{"type":"text","value":"Example ","key":"Ucl2gHiPN5"},{"type":"text","value":"3.1.1","key":"ZckSYAsTQV"}],"template":"Example %s","enumerator":"3.1.1","resolved":true,"html_id":"demo-fitting-tempinterp","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"xWUPo01Rxh"}],"key":"J8XsD4EQC2"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Here are 5-year averages of the worldwide temperature anomaly as compared to the 1951–1980 average (source: NASA).","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"nrxMVrHigm"}],"key":"dl5SBlFA6W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"year = (1955:5:2000)';\ny = [ -0.0480; -0.0180; -0.0360; -0.0120; -0.0040;\n    0.1180; 0.2100; 0.3320; 0.3340; 0.4560 ];\nscatter(year, y), axis tight\nxlabel('year')\nylabel(('anomaly ({\\circ}C)'));","key":"bowkD9aANS"},{"type":"output","id":"F3f1fEno2d4-8coETemh-","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"312e868b10e7c2777de43a76082252e5","path":"/build/312e868b10e7c2777de43a76082252e5.png"}}}],"key":"RPi6W3yh2y"}],"data":{},"key":"ONk8ivArCL"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"A polynomial interpolant can be used to fit the data. Here we build one using a Vandermonde matrix. First, though, we express time as decades since 1950, as it improves the condition number of the matrix.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"jcLgsdfCqj"}],"key":"KuzD8aDXxx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = (year - 1950) / 10;  \nn = length(t);\nV = ones(n, 1);    % t^0\nfor j = 1:n-1\n    V(:, j+1) = t .* V(:,j);\nend\nc = V \\ y;    % solve for coefficients","key":"tgP80h7eWW"},{"type":"output","id":"0iHCH1Nsswojv0UTYElbP","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"Nczo037jFm"}],"data":{},"key":"IZZIpWoY22"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"We created the Vandermonde matrix columns in increasing-degree order. Thus, the coefficients in ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"rzSqDIdTic"},{"type":"inlineCode","value":"c","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"EqhXc6a69j"},{"type":"text","value":" also follow that ordering, which is the opposite of what MATLAB uses. We need to flip the coefficients before using them in ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"w986GvXvHR"},{"type":"inlineCode","value":"polyval","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"sMveGHKzgR"},{"type":"text","value":".","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"rURvOmQEGT"}],"key":"CrOC4uqnl0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"p = @(year) polyval(c(end:-1:1), (year - 1950) / 10);\nhold on\nfplot(p, [1955, 2000])    % plot the interpolating function","key":"G8EUbOcxeZ"},{"type":"output","id":"AcBS103MBYAr-MMkKlrOR","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"976de40c9f8c870ed99804ef21c0ebe1","path":"/build/976de40c9f8c870ed99804ef21c0ebe1.png"}}}],"key":"B7dIEIR7t5"}],"data":{},"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"fplot","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"polyval","kind":"entry"},"emphasis":false}],"label":"index-VIzT3WHs9t","identifier":"index-vizt3whs9t","html_id":"index-vizt3whs9t","key":"K6UTc2rjHK"}],"label":"demo-fitting-tempinterp-matlab","identifier":"demo-fitting-tempinterp-matlab","html_id":"demo-fitting-tempinterp-matlab","key":"hFwXAMIrQz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-tempfit","label":"demo-fitting-tempfit","kind":"proof:example","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":22}},"children":[{"type":"text","value":"Example ","key":"Ic80x6fvzB"},{"type":"text","value":"3.1.2","key":"zQgnK7g8zk"}],"template":"Example %s","enumerator":"3.1.2","resolved":true,"html_id":"demo-fitting-tempfit","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"JG67csoAKq"}],"key":"v4zo9ruzYZ"},{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Here are the 5-year temperature averages again.","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"aWHSAv13I3"}],"key":"Z6zHVXgYDm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"year = (1955:5:2000)';\ny = [ -0.0480; -0.0180; -0.0360; -0.0120; -0.0040;\n    0.1180; 0.2100; 0.3320; 0.3340; 0.4560 ];","key":"vRRKU6KKqC"},{"type":"output","id":"hy4xu8BEXhkDWe6ZzRFAA","data":[],"key":"XavJ50kMjC"}],"data":{},"key":"kl6UIX7uez"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"The standard best-fit line results from using a linear polynomial that meets the least-squares criterion.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"iWQQEj98PX"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":true}],"label":"index-EX4bCRV5bv","identifier":"index-ex4bcrv5bv","html_id":"index-ex4bcrv5bv","key":"FthuXrpDLb"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"oUM5sFWEuM"}],"key":"Gvqh4IuQYg"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Backslash solves overdetermined linear systems in a least-squares sense.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"whJhA2bBSA"}],"key":"sCW8mUfqBY"}],"class":"dropdown","key":"EqaGXCBRlo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = (year - 1955) / 10;    % better matrix conditioning later\nV = [ t.^0 t ];            % Vandermonde-ish matrix\nsize(V)","key":"HdJe6kHfYe"},{"type":"output","id":"1CJNj32ly_2tsc1XZgeK_","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n    10     2\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n    10     2\n","content_type":"text/plain"}}}],"key":"fF5gMIA1fT"}],"data":{},"key":"fDvB8P9vn5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = V \\ y;\nf = @(year) polyval(c(end:-1:1), (year - 1955) / 10);","key":"aVH1ansep0"},{"type":"output","id":"Nhuv2INVS6GepFGBWHTdm","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"QHhiSSwls5"}],"data":{},"key":"UEBIvWuQFU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nscatter(year, y), axis tight\nxlabel('year'), ylabel('anomaly ({\\circ}C)')\nhold on\nfplot(f, [1955, 2000])","key":"Xkt6YTQSsz"},{"type":"output","id":"KCHQ2oFOmrB67IOPXml5R","data":[{"output_type":"stream","name":"stderr","text":"Error using scatter (line 68)\nX and Y must be vectors of the same length, matrices of the same size, or a combination of a vector and a matrix where the length of the vector matches either the number of rows or columns of the matrix."}],"key":"skOHMopMZD"}],"data":{},"key":"YOIKxWo4lz"},{"type":"paragraph","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"children":[{"type":"text","value":"If we use a global cubic polynomial, the points are fit more closely.","position":{"start":{"line":127,"column":1},"end":{"line":127,"column":1}},"key":"nhcc31bxXJ"}],"key":"MBLAz0FlYS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"V = [t.^0, t.^1, t.^2, t.^3];    % Vandermonde-ish matrix  \nsize(V)","key":"ygnMqA0vGY"},{"type":"output","id":"tAowCADCGPZvjR4eUQogo","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n     1   404\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     1   404\n","content_type":"text/plain"}}}],"key":"cAowZhw9rS"}],"data":{},"key":"DBJyO58WHv"},{"type":"paragraph","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"Now we solve the new least-squares problem to redefine the fitting polynomial.","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"ZdLTBuWtxV"}],"key":"aUGfLc3cEy"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"oMDBL2CQSM"}],"key":"ILgukYpikg"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"The definition of ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"oOvIeoL4VS"},{"type":"inlineCode","value":"f","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"o6lDnZZu0o"},{"type":"text","value":" above is in terms of ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"v4UGBSD9BQ"},{"type":"inlineCode","value":"c","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"vvxLlHD4qC"},{"type":"text","value":". When ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"AMxXv2HYDD"},{"type":"inlineCode","value":"c","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"J4NHs6yEAX"},{"type":"text","value":" is changed, then ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"CruCvKEODH"},{"type":"inlineCode","value":"f","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"nbMZqeCPkI"},{"type":"text","value":" has to be redefined.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"QU028Z1gOt"}],"key":"MmIlwVdnaM"}],"class":"dropdown","key":"XeaQeD8YOP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"c = V \\ y;\nf = @(year) polyval(c(end:-1:1), (year - 1955) / 10);\nfplot(f, [1955, 2000]) \nlegend('data', 'linear', 'cubic', 'Location', 'northwest');","key":"yroUVKC3SB"},{"type":"output","id":"javhgzyGiaMZijKocwEvp","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"Fe6AgTthgs"}],"data":{},"key":"sVFxHPZsGq"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"If we were to continue increasing the degree of the polynomial, the residual at the data points would get smaller, but overfitting would increase.","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"hmOgNsnmWY"}],"key":"tPtG5Fmbbj"}],"label":"demo-fitting-tempfit-matlab","identifier":"demo-fitting-tempfit-matlab","html_id":"demo-fitting-tempfit-matlab","key":"x5WMV7gyuN"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-fitting-pirate","label":"demo-fitting-pirate","kind":"proof:example","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":21}},"children":[{"type":"text","value":"Example ","key":"PN2fcjYKUN"},{"type":"text","value":"3.1.3","key":"dMlYVzXjUK"}],"template":"Example %s","enumerator":"3.1.3","resolved":true,"html_id":"demo-fitting-pirate","remote":true,"url":"/fitting","dataUrl":"/fitting.json","key":"qkXEasmCKe"}],"key":"yLdKybKE8o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"k = (1:100)';\na = 1./k.^2;      % sequence\ns = cumsum(a);    % cumulative summation\np = sqrt(6*s);\nclf\nplot(k, p, 'o-')\nxlabel('k'), ylabel('p_k')\ntitle('Sequence converging to \\pi')","key":"zV8hTpSsYx"},{"type":"output","id":"ZJEkZUw5gdbxFQDTkoUrR","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2d89b4711a0f383ca39d9caf115a9777","path":"/build/2d89b4711a0f383ca39d9caf115a9777.png"}}}],"key":"X1YVOKXdTk"}],"data":{},"key":"JasgxeXA4D"},{"type":"paragraph","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"text","value":"This graph suggests that maybe ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"umscuGIT1y"},{"type":"inlineMath","value":"p_k\\to \\pi","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>→</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">p_k\\to \\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"gFUN8R566P"},{"type":"text","value":", but it’s far from clear how close the sequence gets. It’s more informative to plot the sequence of errors, ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"Fvkj75vq9W"},{"type":"inlineMath","value":"\\epsilon_k= |\\pi-p_k|","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>=</mo><mi mathvariant=\"normal\">∣</mi><mi>π</mi><mo>−</mo><msub><mi>p</mi><mi>k</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k= |\\pi-p_k|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span>","key":"V3C8BNm5uw"},{"type":"text","value":". By plotting the error sequence on a log-log scale, we can see a nearly linear relationship.","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"yhuN59Koa8"}],"key":"Fd7A8m68ow"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ep = abs(pi - p);    % error sequence\nloglog(k, ep, 'o')\ntitle('Convergence')\nxlabel('k'), ylabel('|p_k - \\pi|'), axis tight","key":"gyw65vcCDC"},{"type":"output","id":"_CbNOIj2Dae8AQdjNtZb_","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc86a48aa2349d93773cc45a2f76850a","path":"/build/fc86a48aa2349d93773cc45a2f76850a.png"}}}],"key":"b3LmHwa2Kr"}],"data":{},"key":"ZVOgS7JN7f"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"The straight line on the log-log scale suggests a power-law relationship where ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"eL7PTy526s"},{"type":"inlineMath","value":"\\epsilon_k\\approx a k^b","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>a</mi><msup><mi>k</mi><mi>b</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\epsilon_k\\approx a k^b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6331em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">b</span></span></span></span></span></span></span></span></span></span></span>","key":"BirHbLC7UE"},{"type":"text","value":", or ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"W6b0SkEf1H"},{"type":"inlineMath","value":"\\log \\epsilon_k \\approx b (\\log k) + \\log a","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>log</mi><mo>⁡</mo><msub><mi>ϵ</mi><mi>k</mi></msub><mo>≈</mo><mi>b</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">\\log \\epsilon_k \\approx b (\\log k) + \\log a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"IXb7rkwEQA"},{"type":"text","value":".","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"vg9ZckP17X"}],"key":"z3VNxm039C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"V = [ k.^0, log(k) ];    % fitting matrix\nc = V \\ log(ep)          % coefficients of linear fit","key":"dLfiDQE7Yh"},{"type":"output","id":"0GSUClbBS9B5t00_-XrvW","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"mPQ9eVCGOY"}],"data":{},"key":"ILaPQM7O40"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"In terms of the parameters ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"PbIMCU66cm"},{"type":"inlineMath","value":"a","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"Y6m5GG4Rdz"},{"type":"text","value":" and ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"f1VvRRyXcx"},{"type":"inlineMath","value":"b","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"dRdxocP4zc"},{"type":"text","value":" used above, we have","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"wsI7lXr5L0"}],"key":"DumYyi1UV3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"a = exp(c(1)),  b = c(2)","key":"iZe9OuFeOu"},{"type":"output","id":"Sz9h7XfWnNJM8HLRiJw86","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>a = \n   1.395612890290309\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"a = \n   1.395612890290309\n","content_type":"text/plain"}}},{"output_type":"stream","name":"stderr","text":"Index exceeds the number of array elements. Index must not exceed 1."}],"key":"WktZN9HJON"}],"data":{},"key":"xV3hzGEd6j"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"It’s tempting to conjecture that the slope ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"YbxGuRPLpq"},{"type":"inlineMath","value":"b\\to -1","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>→</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">b\\to -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"c74egVIqmX"},{"type":"text","value":" asymptotically. Here is how the numerical fit compares to the original convergence curve.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"usENQDKAFW"}],"key":"D4p3Koilbe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nloglog(k, a * k.^b)\nlegend('sequence', 'power-law fit');","key":"iMKGnReDdt"},{"type":"output","id":"MzSIXsGnrLLXiWdqFKQfc","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5fd4f7fd8721fc714e5381f9edccf372","path":"/build/5fd4f7fd8721fc714e5381f9edccf372.png"}}}],"key":"rdkwm7SQaD"}],"data":{},"key":"y3R0TJLv6u"}],"label":"demo-fitting-pirate-matlab","identifier":"demo-fitting-pirate-matlab","html_id":"demo-fitting-pirate-matlab","key":"Htao2GDT2u"},{"type":"heading","depth":3,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"3.2 ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"PPXLpn0rM0"},{"type":"link","identifier":"section-leastsq-normaleqns","label":"section-leastsq-normaleqns","kind":"narrative","position":{"start":{"line":195,"column":5},"end":{"line":195,"column":32}},"url":"/normaleqns","internal":true,"dataUrl":"/normaleqns.json","children":[{"type":"text","value":"The normal equations","key":"G3FJUvDIEQ"}],"key":"L427p1hlw9"}],"identifier":"id-3-2","label":"3.2 ","html_id":"id-3-2","implicit":true,"key":"RgRVGtZUz4"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","kind":"proof:example","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":24}},"children":[{"type":"text","value":"Example ","key":"GdccaeHxQ3"},{"type":"text","value":"3.2.1","key":"QiCoJzoYJ2"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"kBDswFyca2"}],"key":"fIptUkFVle"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Because the functions ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"VsiJlqkNZG"},{"type":"inlineMath","value":"\\sin^2(t)","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>sin</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sin^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1219em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">sin</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8719em;\"><span style=\"top:-3.1208em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"RV63UsG7FV"},{"type":"text","value":", ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"WTUGNpNsmT"},{"type":"inlineMath","value":"\\cos^2(t)","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow><mi>cos</mi><mo>⁡</mo></mrow><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\cos^2(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mop\">cos</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"Q4w6D9U1km"},{"type":"text","value":", and ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"Nte8oQvf8b"},{"type":"text","value":"1","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"DN1apwCoGz"},{"type":"text","value":" are linearly dependent, we should find that the following matrix is somewhat ill-conditioned.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"vbCCx3wfOW"}],"key":"YgkiYFLrr4"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"XJaxkDouKi"}],"key":"h6lJ5SFf3f"},{"type":"paragraph","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"children":[{"type":"text","value":"The local variable scoping rule for loops applies to comprehensions as well.","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"n1fUWmlvWw"}],"key":"Baxwddw9H1"}],"class":"dropdown","key":"e9OOkohm8Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 3, 400)';\nA = [ sin(t).^2, cos((1+1e-7)*t).^2, t.^0 ];\nkappa = cond(A)","key":"axuchEtrfa"},{"type":"output","id":"3XtptqHrjWuZIQ9FpjAWq","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>kappa = \n   1.8253e+07\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"kappa = \n   1.8253e+07\n","content_type":"text/plain"}}}],"key":"XIHOi9jjBC"}],"data":{},"key":"OSKXu79HGZ"},{"type":"paragraph","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"text","value":"Now we set up an artificial linear least-squares problem with a known exact solution that actually makes the residual zero.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"gvSlgIqb4O"}],"key":"iSRXNJHa7W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = [1; 2; 1];\nb = A * x;","key":"ubVChwWf9X"},{"type":"output","id":"RAc6GD57bOLqsosfmyMGX","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"Sc3McwZmuc"}],"data":{},"key":"OOd9oqOxto"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"Using backslash to find the least-squares solution, we get a relative error that is well below ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"YQgcXJrfGx"},{"type":"text","value":"κ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"iAe3JktiiW"},{"type":"text","value":" times machine epsilon.","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"HAiTodiXBe"}],"key":"M7K4wAHjnA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x_BS = A \\ b;\nobserved_err = norm(x_BS - x) / norm(x)\nmax_err = kappa * eps","key":"WMawOLNKbA"},{"type":"output","id":"9aisdXfG_GLVZ-Pto3GO4","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"A3XXR3H8Oi"}],"data":{},"key":"WPg0gEPxti"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"If we formulate and solve via the normal equations, we get a much larger relative error. With ","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"TjWnPRgcQ9"},{"type":"inlineMath","value":"\\kappa^2\\approx 10^{14}","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>κ</mi><mn>2</mn></msup><mo>≈</mo><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\kappa^2\\approx 10^{14}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">κ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">14</span></span></span></span></span></span></span></span></span></span></span></span>","key":"kTqoEDtM0L"},{"type":"text","value":", we may not be left with more than about 2 accurate digits.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"GeKqwHMciQ"}],"key":"ZysfaU8fws"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"N = A'*A;\nx_NE = N\\(A'*b);\nobserved_err = norm(x_NE - x) / norm(x)\ndigits = -log10(observed_err)","key":"j6lOOOJaHn"},{"type":"output","id":"3je68a19ntGcSKALu55fy","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>observed_err = \n   2.7340e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"observed_err = \n   2.7340e+00\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>digits = \n  -4.3681e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"digits = \n  -4.3681e-01\n","content_type":"text/plain"}}}],"key":"MufiRzaz4E"}],"data":{},"key":"NkMtoInPaQ"}],"label":"demo-normaleqns-instab-matlab","identifier":"demo-normaleqns-instab-matlab","html_id":"demo-normaleqns-instab-matlab","key":"RXzXbWnwzl"},{"type":"heading","depth":3,"position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"children":[{"type":"text","value":"3.3 ","position":{"start":{"line":237,"column":1},"end":{"line":237,"column":1}},"key":"f3W86yADEY"},{"type":"link","identifier":"section-leastsq-qr","label":"section-leastsq-qr","kind":"narrative","position":{"start":{"line":237,"column":5},"end":{"line":237,"column":24}},"url":"/qr","internal":true,"dataUrl":"/qr.json","children":[{"type":"text","value":"The QR factorization","key":"PTRKdODMox"}],"key":"GcW8dMI6YS"}],"identifier":"id-3-3","label":"3.3 ","html_id":"id-3-3","implicit":true,"key":"jp9J8F7D4V"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-qrfact","label":"demo-qr-qrfact","kind":"proof:example","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":16}},"children":[{"type":"text","value":"Example ","key":"V9AeFpgBWS"},{"type":"text","value":"3.3.1","key":"rH0o6SZWA6"}],"template":"Example %s","enumerator":"3.3.1","resolved":true,"html_id":"demo-qr-qrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"uCZfbYCS4w"}],"key":"ah3jf3wkxY"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"MATLAB provides access to both the thin and full forms of the QR factorization.","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"OPI2DwtLmw"}],"key":"QGWcm6lfzf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = magic(5);\nA = A(:, 1:4);\n[m, n] = size(A)","key":"tPXZHlA9s6"},{"type":"output","id":"JG2-OD4Qu_dN6Lce9XDhI","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>m = \n     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"m = \n     5\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>n = \n     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"n = \n     4\n","content_type":"text/plain"}}}],"key":"xABeKctWgS"}],"data":{},"key":"psRMO9s2T0"},{"type":"paragraph","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"Here is the full form:","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"XOZCF8lbPB"}],"key":"z78EmcvERZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q, R] = qr(A);\nszQ = size(Q), szR = size(R)","key":"CeDyYI8r0T"},{"type":"output","id":"qTFLgpkqZZFpRGogcKArN","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szQ = 1×2 double\n     5     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szQ = 1×2 double\n     5     5\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szR = 1×2 double\n     5     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szR = 1×2 double\n     5     4\n","content_type":"text/plain"}}}],"key":"KgJzKJBime"}],"data":{},"key":"l8RcWclx8x"},{"type":"paragraph","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"text","value":"We can test that ","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"lDU00owR6W"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"L15gw3NQ4b"},{"type":"text","value":" is an orthogonal matrix:","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"key":"EjRmNcvry5"}],"key":"ik3JpbeUbh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"QTQ = Q' * Q\nnorm(QTQ - eye(m))","key":"v66suv8Tb3"},{"type":"output","id":"urPouMX9zemJLJWBm5tMa","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>QTQ = \n       1              *              *              0              *       \n       *              1              *              *              *       \n       *              *              1              0              *       \n       0              *              0              1              *       \n       *              *              *              *              1       \n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"QTQ = \n       1              *              *              0              *       \n       *              1              *              *              *       \n       *              *              1              0              *       \n       0              *              0              1              *       \n       *              *              *              *              1       \n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n       1/2125337651807093\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n       1/2125337651807093\n","content_type":"text/plain"}}}],"key":"SG7W9jEfPO"}],"data":{},"key":"IC0HJC6dwo"},{"type":"paragraph","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"With a second input argument given to ","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"KcpmS865yI"},{"type":"inlineCode","value":"qr","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"OPOa5tr9Di"},{"type":"text","value":", the thin form is returned. (This is usually the one we want in practice.)","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"iLHn3kax2S"}],"key":"vSL5TsRR6T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q_hat, R_hat] = qr(A, 0);\nszQ_hat = size(Q_hat), szR_hat = size(R_hat)","key":"tVc8SWfnh9"},{"type":"output","id":"EqMIhwj8IC0oM4DSYXZ0U","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szQ_hat = 1×2 double\n     5     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szQ_hat = 1×2 double\n     5     4\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>szR_hat = 1×2 double\n     4     4\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"szR_hat = 1×2 double\n     4     4\n","content_type":"text/plain"}}}],"key":"f8VFv7PNAY"}],"data":{},"key":"lYSJsHWw9c"},{"type":"paragraph","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"pBo0UFw52c"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"kWSJNgSXVd"},{"type":"text","value":" cannot be an orthogonal matrix, because it is not square, but it is still ","key":"HM06dIgpi8"},{"type":"abbreviation","title":"matrix with orthonormal columns","children":[{"type":"text","value":"ONC","key":"psGLN1Vq4T"}],"key":"JvZMdkq12u"},{"type":"text","value":". Mathematically, ","key":"ZTQxsbr7K3"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}^T \\hat{\\mathbf{Q}}","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover><mi>T</mi></msup><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}^T \\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"ak5jrVPuBr"},{"type":"text","value":" is a ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"oxyKbKFR4O"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">4\\times 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"ysi7H4kgRR"},{"type":"text","value":" identity matrix.","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"IpFv11JXhU"}],"key":"LC3SbRNP2r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Q_hat' * Q_hat - eye(n)","key":"aj5SQ4w6k0"},{"type":"output","id":"LVYF2p1nOhfXDDpyk7fuT","data":[{"output_type":"stream","name":"stderr","text":"Error using eye\nSize inputs must be integers."}],"key":"O5FIR3ha4B"}],"data":{},"key":"yxhuuiFE1M"}],"label":"demo-qr-qrfact-matlab","identifier":"demo-qr-qrfact-matlab","html_id":"demo-qr-qrfact-matlab","key":"UkV0R5ulnU"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-qr-stable","label":"demo-qr-stable","kind":"proof:example","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":16}},"children":[{"type":"text","value":"Example ","key":"D3cw3VNIiB"},{"type":"text","value":"3.3.2","key":"hqvwSSEkx8"}],"template":"Example %s","enumerator":"3.3.2","resolved":true,"html_id":"demo-qr-stable","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"lsTndqV5Pw"}],"key":"HbxY6Tjyh5"},{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"We’ll repeat the experiment of ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"Ay2mo75F1y"},{"type":"crossReference","kind":"proof:example","identifier":"demo-normaleqns-instab","label":"demo-normaleqns-instab","children":[{"type":"text","value":"Demo ","key":"pEQmppVX5Q"},{"type":"text","value":"3.2.1","key":"ljVSBpOVGu"}],"template":"Example %s","enumerator":"3.2.1","resolved":true,"html_id":"demo-normaleqns-instab","remote":true,"url":"/normaleqns","dataUrl":"/normaleqns.json","key":"B5FHy8FLu9"},{"type":"text","value":", which exposed instability in the normal equations.","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"DZNwuVzR2G"}],"key":"t41BP7DANN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"t = linspace(0, 3, 400)';\nA = [ sin(t).^2, cos((1+1e-7)*t).^2, t.^0 ];\nx = [1; 2; 1];\nb = A * x;","key":"xdtKAGG7Eh"},{"type":"output","id":"XFAljrX_N1nG-sA6hudGE","data":[],"key":"UYJmA0XQeH"}],"data":{},"key":"yQKOENutAe"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"The error in the solution by ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"RqepztePal"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-lsqrfact","label":"function-lsqrfact","children":[{"type":"text","value":"Function ","key":"Po3WH16ETx"},{"type":"text","value":"3.3.2","key":"wAhajyND3C"}],"template":"Algorithm %s","enumerator":"3.3.2","resolved":true,"html_id":"function-lsqrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"ShAcr01UlP"},{"type":"text","value":" is similar to the bound predicted by the condition number.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"IZSjBnlO3u"}],"key":"fYwLdgfRRc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"observed_error = norm(lsqrfact(A, b) - x) / norm(x)\nerror_bound = cond(A) * eps","key":"Hubjffoh52"},{"type":"output","id":"T_b-2OymKYtWQIaKUOxia","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>observed_error = \n     8.858137427801303e-10\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"observed_error = \n     8.858137427801303e-10\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>error_bound = \n     4.053030228450514e-09\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"error_bound = \n     4.053030228450514e-09\n","content_type":"text/plain"}}}],"key":"UCyRCmh6EE"}],"data":{},"key":"F20X5ahIg5"}],"label":"demo-qr-stable-matlab","identifier":"demo-qr-stable-matlab","html_id":"demo-qr-stable-matlab","key":"FFrkvDTZti"},{"type":"heading","depth":3,"position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"3.4 ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"MLXibabkPu"},{"type":"link","identifier":"section-leastsq-house","label":"section-leastsq-house","kind":"narrative","position":{"start":{"line":298,"column":5},"end":{"line":298,"column":27}},"url":"/house","internal":true,"dataUrl":"/house.json","children":[{"type":"text","value":"Computing QR factorizations","key":"OROp26F72T"}],"key":"GiLWc13HCv"}],"identifier":"id-3-4","label":"3.4 ","html_id":"id-3-4","implicit":true,"key":"v3Glh03Nxb"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-house-qr","label":"demo-house-qr","kind":"proof:example","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":15}},"children":[{"type":"text","value":"Example ","key":"QwYmAjq4Oj"},{"type":"text","value":"3.4.1","key":"l8RMesMr4I"}],"template":"Example %s","enumerator":"3.4.1","resolved":true,"html_id":"demo-house-qr","remote":true,"url":"/house","dataUrl":"/house.json","key":"KdWyMAUi6o"}],"key":"zXiOrTmwHh"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"We will use Householder reflections to produce a QR factorization of a matrix.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"aOG60ZpEj0"}],"key":"T9NRyBeJ3m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = magic(6);\nA = A(:, 1:4);\n[m, n] = size(A)","key":"hjMSlnj4Z5"},{"type":"output","id":"IVUmRa0tDkgdYFNb8VCBZ","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>m = 6</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"m = 6","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>n = 4</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"n = 4","content_type":"text/plain"}}}],"key":"rSt8OvlGAw"}],"data":{},"key":"KZcDFD3Cpy"},{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"Our first step is to introduce zeros below the diagonal in column 1 by using ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"ASSOV0DGT4"},{"type":"crossReference","kind":"equation","identifier":"hhvector","label":"hhvector","children":[{"type":"text","value":"(","key":"DDFV4V72ub"},{"type":"text","value":"3.4.4","key":"WcHQLu4oJC"},{"type":"text","value":")","key":"zQWjg2y0tl"}],"template":"(%s)","enumerator":"3.4.4","resolved":true,"html_id":"hhvector","remote":true,"url":"/house","dataUrl":"/house.json","key":"FZFv24iufQ"},{"type":"text","value":" and ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"YpfQRGC3R8"},{"type":"crossReference","kind":"equation","identifier":"hhreflect","label":"hhreflect","children":[{"type":"text","value":"(","key":"w8c5aamFFu"},{"type":"text","value":"3.4.1","key":"vk5iHb8vO0"},{"type":"text","value":")","key":"h11mYacU97"}],"template":"(%s)","enumerator":"3.4.1","resolved":true,"html_id":"hhreflect","remote":true,"url":"/house","dataUrl":"/house.json","key":"JH1QDC9OSD"},{"type":"text","value":".","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"vntBXgMMYs"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"eye","kind":"entry"},"emphasis":true}],"label":"index-vjKQryAuFt","identifier":"index-vjkqryauft","html_id":"index-vjkqryauft","key":"hJGawKwADg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = A(:, 1);\nv = z - norm(z) * eye(m,1);\nP_1 = eye(m) - 2 / (v' * v) * (v * v');","key":"gx410A9fwK"},{"type":"output","id":"qYV7-o0ofAYUu4HgiS4kE","data":[],"key":"HemTyhqj4S"}],"data":{},"key":"JheJKiJzt1"},{"type":"paragraph","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"children":[{"type":"text","value":"We check that this reflector introduces zeros as it should:","position":{"start":{"line":323,"column":1},"end":{"line":323,"column":1}},"key":"nmvAiCi8Hm"}],"key":"AHZM94rpXm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"P_1 * z","key":"J7o9r7lv5O"},{"type":"output","id":"64LyeATbogoVkL0--KQ35","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 6×1 double\n  56.347138347923227\n   0.000000000000000\n  -0.000000000000005\n  -0.000000000000003\n  -0.000000000000005\n  -0.000000000000001\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 6×1 double\n  56.347138347923227\n   0.000000000000000\n  -0.000000000000005\n  -0.000000000000003\n  -0.000000000000005\n  -0.000000000000001\n","content_type":"text/plain"}}}],"key":"TBHyEZOaLK"}],"data":{},"key":"pIHinEuYTZ"},{"type":"paragraph","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"children":[{"type":"text","value":"Now we replace ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"GejaHL5LS4"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Omq26GMqgU"},{"type":"text","value":" by ","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"juuC2LIp94"},{"type":"inlineMath","value":"\\mathbf{P}_1\\mathbf{A}","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">P</mi><mn>1</mn></msub><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}_1\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"cgniI5hBqr"},{"type":"text","value":".","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"cyikDwqBPJ"}],"key":"eL7uebCCJ6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = P_1 * A","key":"q2wbs0mbuy"},{"type":"output","id":"rf1NLvXRDJ-oEWshtI1CL","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"J43WqrE5sk"}],"data":{},"key":"O2p1bBGnzY"},{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"We are set to put zeros into column 2. We must not use row 1 in any way, lest it destroy the zeros we just introduced. So we leave it out of the next reflector.","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"HC1oxwNTVQ"}],"key":"jEZQaJjIGl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = A(2:m, 2);\nv = z - norm(z) * eye(m-1, 1);\nP_2 = eye(m-1) - 2 / (v' * v) * (v * v');","key":"ufecmlrFL8"},{"type":"output","id":"cCV71VwHehHh4FhMut51h","data":[{"output_type":"stream","name":"stderr","text":"Index in position 1 exceeds array bounds. Index must not exceed 5."}],"key":"hA7LgmFxzl"}],"data":{},"key":"xXMIKvzpvw"},{"type":"paragraph","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"children":[{"type":"text","value":"We now apply this reflector to rows 2 and below only.","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":1}},"key":"oB4CLvKpSe"}],"key":"WCEiQ78iUg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A(2:m, 2:n) = P_2 * A(2:m, 2:n)","key":"rBGolycPae"},{"type":"output","id":"nScadH-6JvVusMXtvjwcg","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'P_2'."}],"key":"nnpAHlUF2i"}],"data":{},"key":"T3eT5GqqBf"},{"type":"paragraph","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"children":[{"type":"text","value":"We need to iterate the process for the last two columns.","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"p2G5SnWipl"}],"key":"g5OYjtDJOx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for j = 3:n\n    z = A(j:m,j);\n    k = m-j+1;\n    v = z - norm(z) * eye(k, 1);\n    P = eye(k) - 2 / (v' * v) * (v * v');\n    A(j:m, j:n) = P * A(j:m, j:n);\nend","key":"rew1IdjdBW"},{"type":"output","id":"CfPexWjZ-Ac_KD-LYyomE","data":[{"output_type":"stream","name":"stderr","text":"Index in position 1 exceeds array bounds. Index must not exceed 5."}],"key":"fKbuPUvyYz"}],"data":{},"key":"bFLMxkbHa2"},{"type":"paragraph","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"children":[{"type":"text","value":"We have now reduced the original to an upper triangular matrix using four orthogonal Householder reflections:","position":{"start":{"line":361,"column":1},"end":{"line":361,"column":1}},"key":"wXKxgsXw0y"}],"key":"c9BymNyep1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"R = A","key":"D2Pfh0G3aW"},{"type":"output","id":"F0z-pUfuuozxwRAYi5KR5","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>R = 20×20 double\n   12.8315    1.8667    1.4739   -0.2560    2.1255    0.8879    1.5822   -0.7727    1.5951    0.7585   -0.8390    0.1967   -0.3374    0.7389    0.1149    1.0086    0.6713    0.4072    1.1248   -0.1989\n    1.8667   11.5587   -0.5981    1.8579    1.0967    0.0557    0.6217   -1.3391   -1.7858    0.7896   -0.8180   -1.1537   -0.2435   -1.7659   -0.9165    1.4689    0.9333    0.4541   -0.5011   -1.1058\n    1.4739   -0.5981   15.1230    2.8101    0.9701   -2.1637   -1.1065    2.7481   -0.7184   -0.1013    0.4320   -0.2725   -0.1624   -1.5331    1.5870    1.9786   -0.3943    0.6312    0.1124    1.6670\n   -0.2560    1.8579    2.8101    9.7443   -1.4981   -0.3514   -0.3890    0.8749    0.3730    0.9965   -2.9684   -1.5212   -0.4876    1.2882    1.0165    0.5677    1.0450    0.2309    1.3477    2.6268\n    2.1255    1.0967    0.9701   -1.4981    9.0265    0.0246   -0.5091   -0.1700   -1.0898   -0.8819    3.2183    1.0012    0.2058    1.2526   -0.3534   -0.0691   -1.3036    0.2050    1.9228   -0.4630\n    0.8879    0.0557   -2.1637   -0.3514    0.0246    9.8820   -0.8622    2.4796    1.0540   -1.2389    2.8546    1.0179    1.8123   -0.3614   -0.1593    0.8257   -2.6467    1.9662   -1.0256    1.1069\n    1.5822    0.6217   -1.1065   -0.3890   -0.5091   -0.8622   11.5961   -0.0323    1.1276   -1.0839    0.3274   -0.0010    1.9871    0.6713   -1.8925    0.5240   -0.3680   -3.0671    0.3779    1.3854\n   -0.7727   -1.3391    2.7481    0.8749   -0.1700    2.4796   -0.0323   10.6108    1.1978   -1.0388    1.3861   -0.0571   -0.2325   -2.7344    0.5675   -0.5832   -0.3917   -1.0256   -1.5274    0.6098\n    1.5951   -1.7858   -0.7184    0.3730   -1.0898    1.0540    1.1276    1.1978    9.4160   -0.9420   -0.9683    2.2495    0.3361    0.2255   -1.4006   -0.8337    1.9026   -1.5828    0.7872    0.4034\n    0.7585    0.7896   -0.1013    0.9965   -0.8819   -1.2389   -1.0839   -1.0388   -0.9420   10.0784   -0.6396    2.7814    0.5262   -0.7498    2.8088   -0.9954   -1.4518    1.0861    0.2751   -1.6670\n...</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"R = 20×20 double\n   12.8315    1.8667    1.4739   -0.2560    2.1255    0.8879    1.5822   -0.7727    1.5951    0.7585   -0.8390    0.1967   -0.3374    0.7389    0.1149    1.0086    0.6713    0.4072    1.1248   -0.1989\n    1.8667   11.5587   -0.5981    1.8579    1.0967    0.0557    0.6217   -1.3391   -1.7858    0.7896   -0.8180   -1.1537   -0.2435   -1.7659   -0.9165    1.4689    0.9333    0.4541   -0.5011   -1.1058\n    1.4739   -0.5981   15.1230    2.8101    0.9701   -2.1637   -1.1065    2.7481   -0.7184   -0.1013    0.4320   -0.2725   -0.1624   -1.5331    1.5870    1.9786   -0.3943    0.6312    0.1124    1.6670\n   -0.2560    1.8579    2.8101    9.7443   -1.4981   -0.3514   -0.3890    0.8749    0.3730    0.9965   -2.9684   -1.5212   -0.4876    1.2882    1.0165    0.5677    1.0450    0.2309    1.3477    2.6268\n    2.1255    1.0967    0.9701   -1.4981    9.0265    0.0246   -0.5091   -0.1700   -1.0898   -0.8819    3.2183    1.0012    0.2058    1.2526   -0.3534   -0.0691   -1.3036    0.2050    1.9228   -0.4630\n    0.8879    0.0557   -2.1637   -0.3514    0.0246    9.8820   -0.8622    2.4796    1.0540   -1.2389    2.8546    1.0179    1.8123   -0.3614   -0.1593    0.8257   -2.6467    1.9662   -1.0256    1.1069\n    1.5822    0.6217   -1.1065   -0.3890   -0.5091   -0.8622   11.5961   -0.0323    1.1276   -1.0839    0.3274   -0.0010    1.9871    0.6713   -1.8925    0.5240   -0.3680   -3.0671    0.3779    1.3854\n   -0.7727   -1.3391    2.7481    0.8749   -0.1700    2.4796   -0.0323   10.6108    1.1978   -1.0388    1.3861   -0.0571   -0.2325   -2.7344    0.5675   -0.5832   -0.3917   -1.0256   -1.5274    0.6098\n    1.5951   -1.7858   -0.7184    0.3730   -1.0898    1.0540    1.1276    1.1978    9.4160   -0.9420   -0.9683    2.2495    0.3361    0.2255   -1.4006   -0.8337    1.9026   -1.5828    0.7872    0.4034\n    0.7585    0.7896   -0.1013    0.9965   -0.8819   -1.2389   -1.0839   -1.0388   -0.9420   10.0784   -0.6396    2.7814    0.5262   -0.7498    2.8088   -0.9954   -1.4518    1.0861    0.2751   -1.6670\n...","content_type":"text/plain"}}}],"key":"yYC8Vvn4Uu"}],"data":{},"key":"jvFF4nWrgr"}],"label":"demo-house-qr-matlab","identifier":"demo-house-qr-matlab","html_id":"demo-house-qr-matlab","key":"lNjMsblmxm"}],"key":"INvOqPxQm8"}],"key":"nnvgqoGS3K"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 2","url":"/chapter2-1","group":"MATLAB codes"},"next":{"title":"Chapter 4","url":"/chapter4-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}