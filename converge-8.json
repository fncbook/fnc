{"kind":"Notebook","sha256":"1bc0cb9d1d33e873c08ba2a4ed2fbd8717387fce363b7484def037c6928e0673","slug":"converge-8","location":"/chapter8/section6/julia/converge.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"converge.ipynb","url":"/fnc/build/converge-cdf35600819c3b8ea3fa35f51892b40d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"gBcUmAeRy1"},{"type":"text","value":"8.6.3","key":"S2yNZ7dAtU"}],"key":"afWnMwJ0W3"}],"identifier":"demo-minrescg-converge","label":"demo-minrescg-converge","kind":"proof:example","template":"Example %s","enumerator":"8.6.3","resolved":true,"html_id":"demo-minrescg-converge","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"TFhF5gHOvA"}],"key":"O4po65H3UF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will compare MINRES and CG on some quasi-random ","key":"oPlQeUvz7T"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"NMpz1cxSVI"}],"key":"HEGSNGgmwr"},{"type":"text","value":" problems.  The first matrix has a condition number of 100.","key":"hfCdC8Q4vP"}],"key":"ERW3YakxC8"}],"key":"ucJqXlgT0n"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:52.446000Z","iopub.status.busy":"2025-01-14T16:39:48.772000Z","iopub.execute_input":"2025-01-14T16:39:49.047000Z","shell.execute_reply":"2025-01-14T16:39:52.437000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"n = 5000\ndensity = 0.001\nA = FNC.sprandsym(n, density, 1 / 100)\nx = (1:n) / n\nb = A * x;","key":"URBbobuaAT"},{"type":"output","id":"C1yiL50KfssjPK5LSI3Ko","data":[],"key":"myJLzGsfCJ"}],"key":"ST8MOuK7CV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Now we apply both methods and compare the convergence of the system residuals, using implementations imported from ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"S787le1bYk"},{"type":"inlineCode","value":"IterativeSolvers","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"smRfI1I7j2"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ohQQUIVx8M"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"cg","kind":"entry"},"emphasis":true}],"label":"index-VmF2q8NtGu","identifier":"index-vmf2q8ntgu","html_id":"index-vmf2q8ntgu","key":"yDYU1CFySU"}],"key":"o0bZU7Jxfw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:58.000000Z","iopub.status.busy":"2025-01-14T16:39:52.453000Z","iopub.execute_input":"2025-01-14T16:39:52.453000Z","shell.execute_reply":"2025-01-14T16:39:57.998000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using IterativeSolvers\nplt = plot(title=\"Convergence of MINRES and CG\",\n    xaxis=(\"Krylov dimension\"),  yaxis=(:log10, \"relative residual norm\"))\nfor method in [minres, cg]\n    x̃, history = method(A, b, reltol=1e-6, maxiter=1000, log=true)\n    relres = history[:resnorm] / norm(b)\n    plot!(0:length(relres)-1, relres, label=\"$method\")\n    err = round(norm(x̃ - x) / norm(x), sigdigits=4)\n    println(\"$method error: $err\")\nend\nplt","key":"I1Nh6a1fw2"},{"type":"output","id":"8J_09ZObRKhjrBCrkkxYt","data":[{"name":"stdout","output_type":"stream","text":"minres error: 1.195e-5\n"},{"name":"stdout","output_type":"stream","text":"cg error: 4.166e-6\n"},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"614b96cddc553172ab0b48f38a9447ae","path":"/fnc/build/614b96cddc553172ab0b48f38a9447ae.png"},"text/html":{"content_type":"text/html","hash":"7f45baac68a319a96255017676e3d778","path":"/fnc/build/7f45baac68a319a96255017676e3d778.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"c2a71ce5f542b1af2b572947a8a9afa9","path":"/fnc/build/c2a71ce5f542b1af2b572947a8a9afa9.svg"}}}],"key":"ZGlyQVWXNZ"}],"key":"wFlqqMGz47"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There is little difference between the two methods here. Next, we increase the condition number of the matrix by a factor of 25. The rule of thumb predicts that the number of iterations required should increase by a factor of about 5.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g11Yc66OFC"}],"key":"BgHih6S8RH"}],"key":"URZnj2IV3Y"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:59.655000Z","iopub.status.busy":"2025-01-14T16:39:58.037000Z","iopub.execute_input":"2025-01-14T16:39:58.037000Z","shell.execute_reply":"2025-01-14T16:39:59.653000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = FNC.sprandsym(n, density, 1 / 2500)\nb = A * x;","key":"BGK7jcLGmp"},{"type":"output","id":"4ZVJcLjLPvZo-dqFRkqy7","data":[],"key":"J6pISQPv2T"}],"key":"R2Gz9yeynk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:59.806000Z","iopub.status.busy":"2025-01-14T16:39:59.658000Z","iopub.execute_input":"2025-01-14T16:39:59.659000Z","shell.execute_reply":"2025-01-14T16:39:59.804000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(title=\"Convergence of MINRES and CG\",\n    xaxis=(\"Krylov dimension\"), yaxis=(:log10, \"relative residual norm\"))\nfor method in [minres, cg]\n    x̃, history = method(A, b, reltol=1e-6, maxiter=1000, log=true)\n    relres = history[:resnorm] / norm(b)\n    plot!(0:length(relres)-1, relres, label=\"$method\")\n    err = round(norm(x̃ - x) / norm(x), sigdigits=4)\n    println(\"$method error: $err\")\nend\nplt","visibility":"hide","key":"p5uQopHPob"},{"type":"output","id":"w6YZKRF_j8CazParnEsEc","data":[{"name":"stdout","output_type":"stream","text":"minres error: 0.0002433\ncg error: 3.93e-5\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"43dee0bce7da0e9d24e98421b3534b7d","path":"/fnc/build/43dee0bce7da0e9d24e98421b3534b7d.png"},"text/html":{"content_type":"text/html","hash":"f42d46ff1c4bec99b46ba8afd22dbdda","path":"/fnc/build/f42d46ff1c4bec99b46ba8afd22dbdda.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"46f739ccaf9cda960e437d41f65e7bf9","path":"/fnc/build/46f739ccaf9cda960e437d41f65e7bf9.svg"}}}],"visibility":"show","key":"IydLuRHyzy"}],"visibility":"show","key":"uqee5GvNJl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Both methods have an early superlinear phase that allow them to finish slightly sooner than the factor of 5 predicted: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qfGUV7lirn"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-minrescg-converge","label":"theorem-minrescg-converge","children":[{"type":"text","value":"Theorem ","key":"LWFR7DKPwv"},{"type":"text","value":"8.6.2","key":"gELAszXByq"}],"template":"Theorem %s","enumerator":"8.6.2","resolved":true,"html_id":"theorem-minrescg-converge","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"mtvXs2D7Ii"},{"type":"text","value":" is an upper bound, not necessarily an approximation. Both methods ultimately achieve the same reduction in the residual; MINRES stops earlier, but with a slightly larger error.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ModKCrNFY4"}],"key":"MFXySDjSq7"}],"key":"B994h5x5Th"}],"key":"t6MRiEwff6"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Indefinite","url":"/indefinite","group":"Chapter 8"},"next":{"title":"Blur","url":"/blur","group":"Chapter 8"}}},"domain":"http://localhost:3000"}