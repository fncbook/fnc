{"kind":"Notebook","sha256":"6a52939b997c2c0447dff0570812d81e71d9bbdeaa8874e95c518ee7ff07ec84","slug":"basic-1","location":"/chapter6/section5/matlab/basic.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"basic.ipynb","url":"/fnc/build/basic-5df41319c542457c1ce582e6b7cddaca.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ZHZBY5xCPD"},{"type":"text","value":"6.5.1","key":"XIqklfvZhb"}],"key":"TZqH2kd2DF"}],"identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"XVsNoInkN2"}],"key":"xihXUVgn3C"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H2ypBtNrvC"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"zC6OrJcUf3"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ceoZwXJMXn"}],"key":"fum0M1Pu5N"}],"key":"uZ9J3cXtwj"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) exp(t - u * sin(u));\nivp.InitialValue = 0;\na = 0;  b = 5;\n\n[t, u] = rk23(ivp, a, b, 1e-5);\nclf, plot(t, u)\nxlabel(\"t\");  ylabel(\"u(t)\")\ntitle((\"Adaptive IVP solution\"));","key":"Ums4qTgzD7"},{"type":"output","id":"bvBRtmwJnKv0NA_0tNF_m","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e5472307f84ae3dbce35e31021b8703c","path":"/fnc/build/e5472307f84ae3dbce35e31021b8703c.png"}}}],"key":"LQDfBp4OqO"}],"key":"h7gXYRGoN9"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DLC1163UM9"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"xv1G1Hij3Z"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cD5Wk4SxCj"}],"key":"HUnlc2ZrxX"}],"key":"O66fIHLVtU"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"Delta_t = diff(t);\nsemilogy(t(1:end-1), Delta_t) \nxlabel(\"t\");  ylabel(\"step size\")\ntitle((\"Adaptive step sizes\"));","key":"jWvjNIE95s"},{"type":"output","id":"xCJueq9XGhledoKuU5yDr","data":[{"output_type":"execute_result","execution_count":66,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"008ab2d1dcb25339c4b9c3f62f6e7b11","path":"/fnc/build/008ab2d1dcb25339c4b9c3f62f6e7b11.png"}}}],"key":"smlYh7iNBy"}],"key":"dCt0HsTfKS"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KiPFR97dGk"}],"key":"a0fMUWIbHq"}],"key":"ppLOLRzrLi"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"minimum step size = %.2e\", min(Delta_t))","key":"B0vDrfmr3m"},{"type":"output","id":"8eeGCKBszT3TxyfnO5qfY","data":[{"name":"stdout","output_type":"stream","text":"minimum step size = 4.61e-05"}],"key":"xepauDiFjb"}],"key":"CzwvPFhxV1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FcuxZ0qd2E"}],"key":"vqH5h7zgpo"}],"key":"soRvZJkKhp"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"average step size = %.2e\", mean(Delta_t))","key":"Xwe9lptdue"},{"type":"output","id":"z2DkRwshwbZwLqbysN4lZ","data":[{"name":"stdout","output_type":"stream","text":"average step size = 3.21e-02"}],"key":"o69qi1O11z"}],"key":"y0AaQphGGl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V26q69qq7X"}],"key":"c5iENRMOXh"}],"key":"aIY7JL7BBp"}],"key":"Ek6WtSMrna"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Converge","url":"/converge-17","group":"Chapter 6"},"next":{"title":"Sing","url":"/sing-3","group":"Chapter 6"}}},"domain":"http://localhost:3000"}