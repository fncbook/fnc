{"kind":"Notebook","sha256":"5351c9f74a5534d896f5f900cbf430ae10a75e336595bffd8cff79233f3424c9","slug":"chapter7-2","location":"/python/chapter7.md","dependencies":[],"frontmatter":{"title":"Chapter 7","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter7.md","url":"/fnc/build/chapter7-b311921f84a7b7f2d6a0e436539c9871.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"eEmVHuxBu2"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"e5Kwpl79za"}],"key":"h2H3O0QUh6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy import *\nfrom numpy.linalg import norm\nfrom matplotlib.pyplot import *\nfrom prettytable import PrettyTable\nimport sys\nsys.path.append('pkg/')\nimport FNC\nimport importlib\nimportlib.reload(FNC)","key":"zVpOLskoZf"},{"type":"output","id":"l3odchqEgPXUOBIJM7ubL","data":[],"key":"RhIpzUsEKk"}],"data":{},"key":"gf7pcXzzcb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# This (optional) block is for improving the display of plots.\nrcParams[\"figure.figsize\"] = [7, 4]\nrcParams[\"lines.linewidth\"] = 2\nrcParams[\"lines.markersize\"] = 4\nrcParams['animation.html'] = \"jshtml\"  # or try \"html5\"","visibility":"show","key":"IGKCApEjwg"},{"type":"output","id":"I1edWdaH04wPJCuNmEZPA","data":[],"visibility":"show","key":"pl3xz526Uf"}],"data":{"tags":[]},"visibility":"remove","key":"qZELbevgHQ"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Section 7.1","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"xsNH9lC1tb"}],"identifier":"section-7-1","label":"Section 7.1","html_id":"section-7-1","implicit":true,"key":"ARQIf7ew4N"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Adjacency matrix","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"ji6UNYUXsG"}],"key":"RLUchLasRZ"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Here we create an adjacency matrix for a graph on four nodes.","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"aKzqMmOevV"}],"key":"V0QY07WTXp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([[0, 1, 0, 0], [1, 0, 0, 0], [1, 1, 0, 1], [0, 1, 1, 0]])\nprint(A)","key":"jSr5Lbwpy8"},{"type":"output","id":"dlKGhup0u_LENRTaxtjs4","data":[{"output_type":"stream","name":"stdout","text":"[[0 1 0 0]\n [1 0 0 0]\n [1 1 0 1]\n [0 1 1 0]]\n"}],"key":"hSXtJKVnXi"}],"data":{},"key":"QjpSJ90KwV"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"jvtFxWEOfS"},{"type":"inlineCode","value":"networkx","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"bZprfvfDsR"},{"type":"text","value":" package has many functions for working with graphs. Here, we instruct it to create a directed graph from the adjacency matrix, then make a drawing of it.","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"rhaTOKzjll"}],"key":"FryUBArreg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import networkx as nx\nG = nx.from_numpy_array(A, create_using=nx.DiGraph)\nnx.draw(G, with_labels=True, node_color=\"yellow\")","key":"fSCHwLoXIU"},{"type":"output","id":"KE0lQrgydEq3cgkYNL0HQ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"df9d0e0f538716588cc1ae7806b7831a","path":"/fnc/build/df9d0e0f538716588cc1ae7806b7831a.png"}}}],"key":"kMD8eLsIQr"}],"data":{},"indexEntries":[{"entry":"Python","subEntry":{"value":"networkx","kind":"entry"},"emphasis":true}],"label":"index-ZHzwQhjBWD","identifier":"index-zhzwqhjbwd","html_id":"index-zhzwqhjbwd","key":"JFjxf94yZo"},{"type":"paragraph","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Here are the counts of all walks of length 3 in the graph:","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"l8gkVBKe3c"}],"key":"OT6BK018x3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(A**3)","key":"JekGOzgr8M"},{"type":"output","id":"nkaW_t-J_3ge8uK_x5YWw","data":[{"output_type":"stream","name":"stdout","text":"[[0 1 0 0]\n [1 0 0 0]\n [1 1 0 1]\n [0 1 1 0]]\n"}],"key":"jACaujJLOs"}],"data":{},"key":"WFwiPzSvqC"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"If the adjacency matrix is symmetric, the result is an undirected graph: all edges connect in both directions.","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"ePg8TV9bgl"}],"key":"MIzpGFN7La"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([[0, 1, 1, 0], [1, 0, 0, 1], [1, 0, 0, 0], [0, 1, 0, 0]])\nG = nx.from_numpy_array(A, create_using=nx.Graph)\nnx.draw(G, with_labels=True, node_color=\"yellow\")","key":"IkeeSB9dx5"},{"type":"output","id":"KonsebHGqk4FcPSvCEYut","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"39579fe9712e1d3b7d0cb41101319c0a","path":"/fnc/build/39579fe9712e1d3b7d0cb41101319c0a.png"}}}],"key":"Qba0MIu3K5"}],"data":{},"key":"mcD3Bm0kjv"}],"label":"demo-insight-graph-python","identifier":"demo-insight-graph-python","html_id":"demo-insight-graph-python","key":"MjhOwtcnY3"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Images as matrices","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"EwZQdWVODI"}],"key":"ngVgHyQzWp"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"We will use a test image from the well-known ","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"wQuaMudZGY"},{"type":"inlineCode","value":"scikit-image","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"hWfvs8rs6q"},{"type":"text","value":" package.","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"VgEDKt8J3V"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"Images","kind":"entry"},"emphasis":true}],"label":"index-ytBQovJlDy","identifier":"index-ytbqovjldy","html_id":"index-ytbqovjldy","key":"ikNfObqCSE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from skimage import data as testimages\nimg = getattr(testimages, \"coffee\")()\nimshow(img)","key":"Ab3nySv43S"},{"type":"output","id":"baDls9zIDujynQ0Pr-AU5","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"4ea946764ee66c7129f3842857b531ea","path":"/fnc/build/4ea946764ee66c7129f3842857b531ea.png"}}}],"key":"QJzHE4l5N9"}],"data":{},"key":"ECjlcpBkTF"},{"type":"paragraph","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"text","value":"The variable ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"EHtP4N12RX"},{"type":"inlineCode","value":"img","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"ZhYF5g8yUe"},{"type":"text","value":" is a matrix.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"AhBUZDpc5G"}],"key":"ALIviSvaDc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"size(img)","key":"owWy89IiPN"},{"type":"output","id":"mCGtg0bk5h2s29URvQpnO","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"720000","content_type":"text/plain"}}}],"key":"EL5dfl9Fvi"}],"data":{},"key":"xTPm6omSE3"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"However, its entries are colors, not numbers.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"yYeg2k10JH"}],"key":"FRryWmMP4z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"image has shape {img.shape}\")\nprint(f\"first pixel has value {img[0, 0]}\")","key":"tc4lFT2x9g"},{"type":"output","id":"mK02LeIGoukPmfgH6NeEL","data":[{"output_type":"stream","name":"stdout","text":"image has shape (400, 600, 3)\nfirst pixel has value [21 13  8]\n"}],"key":"G1b4G1sJJ4"}],"data":{},"key":"VRQe2rcdUA"},{"type":"paragraph","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"text","value":"The three values at each pixel are for intensities of red, green, and blue. We can convert each of those layers into an ordinary matrix of values between 0 and 255, which is maximum intensity.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"Glahlol3R0"}],"key":"Y0YD5sckAp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"R = img[:, :, 0]\nprint(\"upper left corner of the red plane is:\")\nprint(R[:5, :5])\nprint(f\"red channel values range from {R.min()} to {R.max()}\")","key":"sHOe9sXagy"},{"type":"output","id":"Cl3ocsfpVlAECkKWUMCIV","data":[{"output_type":"stream","name":"stdout","text":"upper left corner of the red plane is:\n[[21 21 20 21 21]\n [21 21 20 22 20]\n [21 23 20 21 21]\n [21 21 21 21 20]\n [21 21 21 21 21]]\nred channel values range from 0 to 255\n"}],"key":"M3XvWGO7B5"}],"data":{},"key":"BSwFfzRc9W"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"It may also be convenient to convert the image to grayscale, which has just one layer of values from zero (black) to one (white).","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"IRuENCn3Qw"}],"key":"EabXVOw6IQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from skimage.color import rgb2gray\nA = rgb2gray(img)\nA[:5, :5]\nprint(\"upper left corner of grayscale:\")\nprint(A[:5, :5])\nprint(f\"gray values range from {A.min()} to {A.max()}\")","key":"z9gVG6xOQG"},{"type":"output","id":"HUrJX1im3p9v6O5sy8eaO","data":[{"output_type":"stream","name":"stdout","text":"upper left corner of grayscale:\n[[0.05623333 0.05651608 0.04978902 0.05708157 0.05903882]\n [0.05595059 0.05651608 0.05792275 0.05987216 0.05511725]\n [0.05875608 0.05846549 0.05848824 0.05651608 0.06212706]\n [0.05566784 0.05651608 0.05623333 0.05679882 0.05174627]\n [0.0553851  0.05595059 0.05510235 0.05595059 0.05623333]]\ngray values range from 0.0002827450980392157 to 1.0\n"}],"key":"AuhQti6uxs"}],"data":{},"key":"jIYzXKvAhV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"imshow(A, cmap='gray')\naxis('off');","key":"fD9Jl4cwmO"},{"type":"output","id":"QeYPYuVy760UNMOu6NZeS","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1bc22d6026bfe2d398a26f33880d736f","path":"/fnc/build/1bc22d6026bfe2d398a26f33880d736f.png"}}}],"key":"Bv7vsAER1S"}],"data":{},"key":"L4fOnN5TrO"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Some changes we make to the grayscale matrix are easy to interpret visually.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"qdlkJYr6Al"}],"key":"R2z8u3Kji5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"imshow(flipud(A), cmap='gray')\naxis('off');","key":"Lxb3OUGvwg"},{"type":"output","id":"Dnhp1ZefzCJEXe5oxdYCJ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"1e5fd3b06b55c13a6e05de2f828c3b7f","path":"/fnc/build/1e5fd3b06b55c13a6e05de2f828c3b7f.png"}}}],"key":"zvrGHyybMr"}],"data":{},"key":"lzPuHmxQme"}],"label":"demo-insight-image-python","identifier":"demo-insight-image-python","html_id":"demo-insight-image-python","key":"uzg8IlT4L5"},{"type":"heading","depth":3,"position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Section 7.2","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"oQfpTCuxwg"}],"identifier":"section-7-2","label":"Section 7.2","html_id":"section-7-2","implicit":true,"key":"eVbYezMEgs"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Eigenvalues and eigenvectors","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"qZI8dB89hx"}],"key":"pe5AGuoebX"},{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"sznLcfgxpY"},{"type":"inlineCode","value":"eig","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"URtKHwOG2t"},{"type":"text","value":" function from ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"bdZlftdZGU"},{"type":"inlineCode","value":"scipy.linalg","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"IfVWqvxOf3"},{"type":"text","value":" will return a vector of eigenvalues and a matrix of associated eigenvectors.","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"FSnz8ddXi0"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"eig","kind":"entry"},"emphasis":true}],"label":"index-PxvGlyuoHl","identifier":"index-pxvglyuohl","html_id":"index-pxvglyuohl","key":"oYNzpn4cQr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import eig\nA = pi * ones([2, 2])\nd, V = eig(A)\nprint(\"eigenvalues:\", d)","key":"vbbLge6tfE"},{"type":"output","id":"xfOnRCFq7vyOn8_cNAe_o","data":[{"output_type":"stream","name":"stdout","text":"eigenvalues: [ 6.28318531e+00 -6.97573700e-16]\n"}],"key":"MWnSSTc8M8"}],"data":{},"key":"LDYKqZKXgu"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"We can check the fact that this is an EVD (although in practice we never invert a matrix).","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"fCX0K113Jr"}],"key":"iPEOP7UPde"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import inv\nD = diag(d)\nprint(f\"should be near zero: {norm(A - V @ D @ inv(V), 2):.2e}\")","key":"GfVTIHtigD"},{"type":"output","id":"XYgvfLF6wa4fay_kY75gE","data":[{"output_type":"stream","name":"stdout","text":"should be near zero: 1.26e-15\n"}],"key":"IQOWIa04ZX"}],"data":{},"key":"gxuRtMiFxr"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"If the matrix is not diagonalizable, no message is given, but ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"aQK18i5rLr"},{"type":"inlineCode","value":"V","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"SKB95HiWJ5"},{"type":"text","value":" will be singular. The robust way to detect that circumstance is via ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"HFSCMIGOQF"},{"type":"inlineMath","value":"\\kappa(\\mathbf{V})","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\kappa(\\mathbf{V})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mclose\">)</span></span></span></span>","key":"s2ypFOJf1X"},{"type":"text","value":".","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"M4WiaYeiC0"}],"key":"W7bWqebk0m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nA = array([[1, 1], [0, 1]])\nd, V = eig(A)\nprint(f\"cond(V) is {cond(V):.2e}\")","key":"OJNwc4BGa9"},{"type":"output","id":"gBKcunkPXWEE46MqAX0-G","data":[{"output_type":"stream","name":"stdout","text":"cond(V) is 9.01e+15\n"}],"key":"eSktvBhTbS"}],"data":{},"indexEntries":[{"entry":"Python","subEntry":{"value":"cond","kind":"entry"},"emphasis":false},{"entry":"condition number","subEntry":{"value":"of a matrix","kind":"entry"},"emphasis":false}],"label":"index-z1rZaCA4aN","identifier":"index-z1rzaca4an","html_id":"index-z1rzaca4an","key":"v5KQrfEPps"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"But even in the nondiagonalizable case, ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"kRS19klvcl"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">V</mi><mo>=</mo><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">AV</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">VD</span></span></span></span>","key":"n7FAFZcto7"},{"type":"text","value":" holds up to roundoff error.","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"FGEyR4qTFG"}],"key":"zoxd2cSWN3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"should be near zero: {norm(A @ V - V @ diag(d), 2):.2e}\")","key":"b1P0udz2nn"},{"type":"output","id":"rJkBPpQGVDqjgWSfMN8ag","data":[{"output_type":"stream","name":"stdout","text":"should be near zero: 2.22e-16\n"}],"key":"hlzFFMLLu9"}],"data":{},"key":"Ki3OX8P9rv"},{"type":"code","lang":"","value":"","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"UxAUOYDGtL"}],"label":"demo-evd-eigen-python","identifier":"demo-evd-eigen-python","html_id":"demo-evd-eigen-python","key":"w7pJ7BpXcu"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Eigenvalue conditioning","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"lYqchx5Z9p"}],"key":"glLNP360AL"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"We first define a hermitian matrix. Note that we add the ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"QUTkdSjlgD"},{"type":"emphasis","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"conjugate","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ulVXD4QI4j"}],"key":"v3SYTeHRpw"},{"type":"text","value":" transpose of a matrix to itself.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"C10JxvT9pA"}],"key":"oOsOxmtB1h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = 7\nA = random.randn(n, n) + 1j * random.randn(n, n)\nA = (A + conj(A.T)) / 2","key":"qC0JiV1ATF"},{"type":"output","id":"8RlbLYBe9ZgXNYV8shfPC","data":[],"key":"zozyMgPfFy"}],"data":{},"key":"DrjFdOt09Y"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"We confirm that the matrix ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"h9BRPZ7CCT"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"ta4vO25OCS"},{"type":"text","value":" is normal by checking that ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"g98pkyUeSw"},{"type":"inlineMath","value":"\\kappa(\\mathbf{V}) = 1","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\kappa(\\mathbf{V}) = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"FWl33EqW2n"},{"type":"text","value":" (to within roundoff).","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"fxFPIMc8Fp"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"cond","kind":"entry"},"emphasis":false}],"label":"index-b0Y1c0oDSL","identifier":"index-b0y1c0odsl","html_id":"index-b0y1c0odsl","key":"PgcQ8kC2Js"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import eig\nd, V = eig(A)\nprint(f\"eigenvector matrix has condition number {cond(V):.5f}\")","key":"Tm6U3CHyFz"},{"type":"output","id":"NKHfuSTUsVxHFvoA2FR92","data":[{"output_type":"stream","name":"stdout","text":"eigenvector matrix has condition number 1.00000\n"}],"key":"VWFAp69lmw"}],"data":{},"key":"Enq76HRL47"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Now we perturb ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"uLX1POcLNv"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"gjUj02H0O9"},{"type":"text","value":" and measure the effect on the eigenvalues. Note that the Bauer–Fike theorem uses absolute differences, not relative ones. Since the ordering of eigenvalues can change, we look at all pairwise differences and take the minima.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"YYlGzzf4qv"}],"key":"ZVYKvV3eUZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"E = random.randn(n, n) + 1j * random.randn(n, n)\nE = 1e-8 * E / norm(E, 2)\ndd, _ = eig(A + E)\ndist = array([min([abs(x - y) for x in dd]) for y in d])\nprint(dist)","key":"E8Md3BGgRa"},{"type":"output","id":"9JSyihbLW5pU44f4ilaan","data":[{"output_type":"stream","name":"stdout","text":"[4.04147319e-09 7.25702260e-10 1.74699522e-09 2.58204885e-09\n 1.92163472e-09 1.91824780e-10 2.85577937e-09]\n"}],"key":"haD0vMvnjT"}],"data":{},"key":"bz5BtnNGya"},{"type":"paragraph","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"As promised, the perturbations in the eigenvalues do not exceed the normwise perturbation to the original matrix.","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"IEvmH9qgF5"}],"key":"n5W5DNry4M"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"Now we see what happens for a triangular matrix.","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"YYn4Y3pMRS"}],"key":"yOJpnARkZI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n = 20\nx = arange(n) + 1\nA = triu(outer(x, ones(n)))\nprint(A[:5, :5])","key":"erQvycQzwf"},{"type":"output","id":"Rb5anbsI34_GIbol2oCox","data":[{"output_type":"stream","name":"stdout","text":"[[1. 1. 1. 1. 1.]\n [0. 2. 2. 2. 2.]\n [0. 0. 3. 3. 3.]\n [0. 0. 0. 4. 4.]\n [0. 0. 0. 0. 5.]]\n"}],"key":"zlRoZkqWFz"}],"data":{},"key":"uRCwGfYdec"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"This matrix is not at all close to normal.","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"VnnzGtmL1e"}],"key":"v8fWeweUK9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"d, V = eig(A)\nprint(f\"eigenvector matrix has condition number {cond(V):.2e}\")","key":"oCu7ESIkDc"},{"type":"output","id":"hN_rK2ftiLYOCICRSnvXR","data":[{"output_type":"stream","name":"stdout","text":"eigenvector matrix has condition number 6.15e+09\n"}],"key":"QSjZzEt8QS"}],"data":{},"key":"ySdUL1j6BX"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"As a result, the eigenvalues can change by a good deal more.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"diH845Wm7H"}],"key":"G424cNXVJv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"E = random.randn(n, n) + 1j * random.randn(n, n)\nE = 1e-8 * E / norm(E, 2)\ndd, _ = eig(A + E)\ndist = array([min([abs(x - y) for x in dd]) for y in d])\nprint(f\"Maximum eigenvalue change is {max(dist):.2e}\")\nprint(f\"The Bauer-Fike upper bound is {cond(V) * norm(E, 2):.2e}\")","key":"ZA7vmZZU7l"},{"type":"output","id":"YXxAqd-XH8BkyLpXUNWkZ","data":[{"output_type":"stream","name":"stdout","text":"Maximum eigenvalue change is 7.44e-01\nThe Bauer-Fike upper bound is 6.15e+01\n"}],"key":"v4fP1bjokS"}],"data":{},"key":"zW3QFqYjcV"},{"type":"paragraph","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"If we plot the eigenvalues of many perturbations, we get a cloud of points that roughly represents all the possible eigenvalues when representing this matrix with single-precision accuracy.","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"wW6Hv9pcMi"}],"key":"QWdUVCdLNG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"clf\nscatter(d, zeros(n), 18)\naxis(\"equal\") \nfor _ in range(100):\n    E = random.randn(n, n) + 1j * random.randn(n, n)\n    E = finfo(np.float32).eps * E / norm(E, 2)\n    dd, _ = eig(A + E)\n    scatter(real(dd), imag(dd), 2, 'k')","key":"vqfdO1uAyt"},{"type":"output","id":"D5o6jmgXkIiivMHcaapQi","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ecdd7c616f1f96467f8f70477810dccd","path":"/fnc/build/ecdd7c616f1f96467f8f70477810dccd.png"}}}],"key":"OleXicqPZs"}],"data":{},"key":"wUNeO1120t"},{"type":"paragraph","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"text","value":"The plot shows that some eigenvalues are much more affected than others. This situation is not unusual, but it is not explained by the Bauer–Fike theorem.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"acChQRggHP"}],"key":"rvN5TQlDB9"}],"label":"demo-evd-bauerfike-python","identifier":"demo-evd-bauerfike-python","html_id":"demo-evd-bauerfike-python","key":"JgeTGTUJBT"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Francis ","key":"NafLKzDUch"},{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"cK8HCSPy7f"}],"key":"op4SOaLfqd"},{"type":"text","value":" iteration","key":"r9NwrEtxBi"}],"key":"sOlWvGkuKD"},{"type":"paragraph","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"text","value":"Let’s start with a known set of eigenvalues and an orthogonal eigenvector basis.","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"asS4QzWhvD"}],"key":"vgfYGvJDev"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import qr\nD = diag([-6, -1, 2, 4, 5])\nV, R = qr(random.randn(5, 5))\nA = V @ D @ V.T    # note that V.T = inv(V) here","key":"ULv3Maa0Q9"},{"type":"output","id":"SXX97JQeYmYMaYDyW61BM","data":[],"key":"dpdaeVLfTs"}],"data":{},"key":"B2Yi77kbtP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(sort(eig(A)[0]))","key":"iUDzKJdzqh"},{"type":"output","id":"jobh9u1rNiV52g6Qx0wxG","data":[{"output_type":"stream","name":"stdout","text":"[-6. -1.  2.  4.  5.]\n"}],"key":"GddPFii8Vg"}],"data":{},"key":"xltJBAmRNu"},{"type":"paragraph","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"Now we will take the ","key":"wcJ3F3qhvx"},{"type":"abbreviation","title":"orthogonal times upper triangular","children":[{"type":"text","value":"QR","key":"sgpJZ31eVu"}],"key":"nibhBdiHg9"},{"type":"text","value":" factorization and just reverse the factors.","key":"IsxzXNwJvm"}],"key":"oZxAFZAv6d"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Q, R = qr(A)\nA = R @ Q;","key":"NN1dX375i9"},{"type":"output","id":"xjmcfxza1F0QAqM15awFk","data":[],"key":"lwZDEMYaT3"}],"data":{},"key":"vIcGJYiasc"},{"type":"paragraph","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"It turns out that this is a similarity transformation, so the eigenvalues are unchanged.","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"UrCxQPcije"}],"key":"Lh8AVbhguo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(sort(eig(A)[0]))","key":"cP5F0BEq81"},{"type":"output","id":"PRgLJkgVyDTeifyNslhyL","data":[{"output_type":"stream","name":"stdout","text":"[-6. -1.  2.  4.  5.]\n"}],"key":"BOYx8ma9p7"}],"data":{},"key":"oCW7DhOC6p"},{"type":"paragraph","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"children":[{"type":"text","value":"What’s remarkable, and not elementary, is that if we repeat this transformation many times, the resulting matrix converges to ","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"g80jHIoqMX"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"Zag0ZZ71s2"},{"type":"text","value":".","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":1}},"key":"BMh2DRWZwZ"}],"key":"WN9jtMyhmk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for k in range(40):\n    Q, R = qr(A)\n    A = R @ Q\nset_printoptions(precision=4)\nprint(A)","key":"jF3rH7ImcI"},{"type":"output","id":"jGRfM4JyIElvSxxz2-aDV","data":[{"output_type":"stream","name":"stdout","text":"[[-6.0000e+00 -2.3078e-03  4.5788e-08 -8.9415e-16  1.3596e-16]\n [-2.3078e-03  5.0000e+00 -1.0904e-04 -5.2759e-16 -6.7661e-16]\n [ 4.5788e-08 -1.0904e-04  4.0000e+00 -3.6167e-14  2.2797e-16]\n [ 6.5070e-20 -8.2612e-17 -3.6456e-14  2.0000e+00  1.9052e-12]\n [ 2.7718e-32  4.7796e-29 -1.2662e-24  1.9051e-12 -1.0000e+00]]\n"}],"key":"ptlqp2zLGa"}],"data":{},"key":"BLP25D3e0j"}],"label":"demo-evd-francisqr-python","identifier":"demo-evd-francisqr-python","html_id":"demo-evd-francisqr-python","key":"P4FV5oLmwB"},{"type":"heading","depth":3,"position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"children":[{"type":"text","value":"Section 7.3","position":{"start":{"line":293,"column":1},"end":{"line":293,"column":1}},"key":"aWKxKaDeSy"}],"identifier":"section-7-3","label":"Section 7.3","html_id":"section-7-3","implicit":true,"key":"nFGjnzuYAb"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"SVD properties","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"iK0hMZoO0Z"}],"key":"WKc2RLgCFp"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"We verify some of the fundamental SVD properties using standard Julia functions from ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"HYXqZIB81b"},{"type":"inlineCode","value":"LinearAlgebra","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"tapmltuwDW"},{"type":"text","value":".","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"bn3o8Qdaw4"}],"key":"NK3k6G2b9z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = array([[(i + 1.0) ** j for j in range(4)] for i in range(5)])\nset_printoptions(precision=4)\nprint(A)","key":"ORqt0wnpRC"},{"type":"output","id":"J_NNQL3v_NfKFamL_0Lme","data":[{"output_type":"stream","name":"stdout","text":"[[  1.   1.   1.   1.]\n [  1.   2.   4.   8.]\n [  1.   3.   9.  27.]\n [  1.   4.  16.  64.]\n [  1.   5.  25. 125.]]\n"}],"key":"YQ2ADA4EtD"}],"data":{},"key":"c8boTVMNbp"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"The factorization is obtained using ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"A3UJCNNUFt"},{"type":"inlineCode","value":"svd","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"btDGVNX588"},{"type":"text","value":" from ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"qqKPxRyTHe"},{"type":"inlineCode","value":"numpy.linalg","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"ErimbEjx9K"},{"type":"text","value":".","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"rnlT2vSx50"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"svd","kind":"entry"},"emphasis":true}],"label":"index-zSr2ANFOxt","identifier":"index-zsr2anfoxt","html_id":"index-zsr2anfoxt","key":"fIYZWmmA1H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import svd\nU, sigma, Vh = svd(A)\nprint(\"singular values:\")\nprint(sigma)","key":"oCPusdOIbN"},{"type":"output","id":"3GsOUszl44IZO2RZM8fWO","data":[{"output_type":"stream","name":"stdout","text":"singular values:\n[1.4670e+02 5.7386e+00 9.9985e-01 1.1928e-01]\n"}],"key":"jz45DeRSDS"}],"data":{},"key":"DnPTtc4sl6"},{"type":"paragraph","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"children":[{"type":"text","value":"By default, the full factorization type is returned. This can be a memory hog if one of the dimensions of ","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"zv61uprb0A"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"tQAMA0Q65P"},{"type":"text","value":" is very large.","position":{"start":{"line":317,"column":1},"end":{"line":317,"column":1}},"key":"jl5C4OBvmc"}],"key":"TNR7OyBY52"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"size of U:\", U.shape)\nprint(\"size of V:\", Vh.T.shape)","key":"GgcWZtkjwc"},{"type":"output","id":"iv8A_IdekwYZA1u4CWpMn","data":[{"output_type":"stream","name":"stdout","text":"size of U: (5, 5)\nsize of V: (4, 4)\n"}],"key":"PJ2FuBc45P"}],"data":{},"key":"LL0SgpRdE0"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"Both ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"LA2TaZpNLQ"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"BOD14eil6E"},{"type":"text","value":" and ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"RjIVIuLpwP"},{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"G1dcEuoZnM"},{"type":"text","value":" are orthogonal (in the complex case, unitary). Note that it’s ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"Aq60yWlwGG"},{"type":"inlineMath","value":"\\mathbf{V}^*","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">V</mi><mo>∗</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}^*</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6887em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6887em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mbin mtight\">∗</span></span></span></span></span></span></span></span></span></span></span>","key":"YvSig89Ity"},{"type":"text","value":" that is returned, not ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"ZoBp4ahMjc"},{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"dIl8a0ACIs"},{"type":"text","value":".","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"mbqOppVeLp"}],"key":"QOBSH7o2Sn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"should be near zero: {norm(U.T @ U - eye(5), 2):.2e}\")\nprint(f\"should be near zero: {norm(Vh @ Vh.T - eye(4), 2):.2e}\")","key":"S5IQgjoyv5"},{"type":"output","id":"mQNkslw8HP546tG1GcEj2","data":[{"output_type":"stream","name":"stdout","text":"should be near zero: 5.61e-16\nshould be near zero: 1.07e-15\n"}],"key":"LTYAszB9ht"}],"data":{},"key":"kPmqPpQQzc"},{"type":"paragraph","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"children":[{"type":"text","value":"Next we test that we have the factorization promised by the SVD, using ","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"DLGw7Ax6WB"},{"type":"inlineCode","value":"diagsvd","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"hrszX1q81p"},{"type":"text","value":" to construct a rectangular diagonal matrix.","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"ZRRgj7Z0a2"}],"key":"ocefraW5qv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.linalg import diagsvd\nS = diagsvd(sigma, 5, 4)\nprint(f\"should be near zero: {norm(A - U @ S @ Vh, 2):.2e}\")","key":"UD6vhRxjmX"},{"type":"output","id":"rdgCq8PTfGfQgi_8wXSj8","data":[{"output_type":"stream","name":"stdout","text":"should be near zero: 8.56e-14\n"}],"key":"Ztp3PYa42G"}],"data":{},"key":"Gv2pZoUXcz"},{"type":"paragraph","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"children":[{"type":"text","value":"Here is verification of the connections between the singular values, norm, and condition number.","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"QqjmyZBCzM"}],"key":"ViLsVpX4el"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import cond\nprint(\"largest singular value:\", sigma[0])\nprint(\"2-norm of the matrix:  \", norm(A, 2))\nprint(\"singular value ratio:\", sigma[0] / sigma[-1])\nprint(\"2-norm condition no.:\", cond(A, 2))","key":"bHrHgC0UgN"},{"type":"output","id":"vgwdNr4alid2MypOjnUpo","data":[{"output_type":"stream","name":"stdout","text":"largest singular value: 146.69715365883005\n2-norm of the matrix:   146.69715365883005\nsingular value ratio: 1229.8468876337527\n2-norm condition no.: 1229.8468876337529\n"}],"key":"TA0h5dtza8"}],"data":{},"key":"wM8DcpTqEN"},{"type":"paragraph","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"children":[{"type":"text","value":"For matrices that are much taller than they are wide, the thin SVD form is more memory-efficient, because ","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"Pbi1QBP5hF"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"fUgRmguASJ"},{"type":"text","value":" takes the same shape.","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"Down2Dqvvl"}],"key":"WnwYUVeSNF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"A = random.randn(1000, 10)\nU, sigma, Vh = svd(A, full_matrices=False)\nprint(\"size of U:\", U.shape)\nprint(\"size of V:\", Vh.shape)","key":"tWAZUk3UaW"},{"type":"output","id":"eM8PvtL3mWwKnuDYXivzH","data":[{"output_type":"stream","name":"stdout","text":"size of U: (1000, 10)\nsize of V: (10, 10)\n"}],"key":"QtpwP0ZQxG"}],"data":{},"key":"eLgmfEppJz"}],"label":"demo-svd-props-python","identifier":"demo-svd-props-python","html_id":"demo-svd-props-python","key":"lr0KyuewEJ"},{"type":"heading","depth":3,"position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"Section 7.4","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"lbEy14sLTD"}],"identifier":"section-7-4","label":"Section 7.4","html_id":"section-7-4","implicit":true,"key":"GeOHfxT4Ei"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Rayleigh quotient","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"l8gZ4zRd4M"}],"key":"qSTAtntRSQ"},{"type":"paragraph","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"text","value":"We will use a symmetric matrix with a known EVD and eigenvalues equal to the integers from 1 to 20.","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"key":"thIVRDkn3V"}],"key":"hmBIxi4NkX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import qr\nn = 20\nd = arange(n) + 1\nD = diag(d)\nV, _ = qr(random.randn(n, n))    # get a random orthogonal V\nA = V @ D @ V.T","key":"uK1v06a2gp"},{"type":"output","id":"gWlwMLwp-VkRtT-wEswKp","data":[],"key":"igJnnUmGCt"}],"data":{},"key":"IuRXpV6vuj"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"The Rayleigh quotient is a scalar-valued function of a vector.","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"PKfQiVKp1U"}],"key":"zXAANZH6Ta"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"R = lambda x: dot(x, A @ x) / dot(x, x)","key":"nwvWDIat8c"},{"type":"output","id":"Hm_hZHtLmyaZ0ed0r3n1S","data":[],"key":"GGWQTNi9Lv"}],"data":{},"key":"tZOuIV73RM"},{"type":"paragraph","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"The Rayleigh quotient evaluated at an eigenvector gives the corresponding eigenvalue.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"LUSFRd9v3E"}],"key":"jF7OBmngJb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(R(V[:, 6]))","key":"MJWiw4XLkg"},{"type":"output","id":"sRqJPQqTxwlvPs6CkNyOk","data":[{"output_type":"stream","name":"stdout","text":"7.0\n"}],"key":"bqCWNAnv2j"}],"data":{},"key":"bDJPV3N5F6"},{"type":"paragraph","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"If the input to he Rayleigh quotient is within a small ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"aIglWyt9kj"},{"type":"text","value":"δ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"VXiYLU07Lk"},{"type":"text","value":" of an eigenvector, its output is within ","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"f09wY7nE43"},{"type":"inlineMath","value":"O(\\delta^2)","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>δ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\delta^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"OulVm4nDZg"},{"type":"text","value":" of the corresponding eigenvalue. In this experiment, we observe that each additional digit of accuracy in an approximate eigenvector gives two more digits to the eigenvalue estimate coming from the Rayleigh quotient.","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"evjTf4Lic5"}],"key":"Napx30ajk3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"results = PrettyTable([\"perturbation size\", \"R.Q. - λ\"])\nfor delta in 1 / 10 ** arange(1, 6):\n    e = random.randn(n)\n    e = delta * e / norm(e)\n    x = V[:, 5] + e\n    quotient = R(x)\n    results.add_row([delta, quotient - d[5]])\n\nprint(results)","key":"p5iBWB6qmC"},{"type":"output","id":"YKetJgayftEBszaPvro-d","data":[{"output_type":"stream","name":"stdout","text":"+-------------------+------------------------+\n| perturbation size |        R.Q. - λ        |\n+-------------------+------------------------+\n|        0.1        |  0.042227602379944607  |\n|        0.01       | 0.0004517348610564298  |\n|       0.001       | 1.1863305919845857e-06 |\n|       0.0001      | 8.038392174114506e-08  |\n|       1e-05       | 4.2661518762088235e-10 |\n+-------------------+------------------------+\n"}],"key":"seuImYp36k"}],"data":{},"key":"MibbeLQX8n"}],"label":"demo-symm-eig-rayleigh-python","identifier":"demo-symm-eig-rayleigh-python","html_id":"demo-symm-eig-rayleigh-python","key":"czYHbWLFoi"},{"type":"heading","depth":3,"position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"Section 7.5","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"HbN5aJh2HD"}],"identifier":"section-7-5","label":"Section 7.5","html_id":"section-7-5","implicit":true,"key":"YmFBSyXa0n"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Image compression","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"mzvEsylYlu"}],"key":"CUIxQiayo7"},{"type":"paragraph","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"We make an image from some text, then reload it as a matrix.","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"nzatQHoZ0B"}],"key":"CX0q1JlqY1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"text(\n    0.5,\n    0.5,\n    \"Hello world\",\n    dict(fontsize=44),\n    horizontalalignment=\"center\",\n    verticalalignment=\"center\",\n)\naxis(\"off\")\nsavefig(\"hello.png\")","key":"WlMJA74vqC"},{"type":"output","id":"2U8CNnZLghmz_C0cl4aAF","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"26683514453c4da0853df5e456f1efd4","path":"/fnc/build/26683514453c4da0853df5e456f1efd4.png"}}}],"key":"BKUPGfXHiz"}],"data":{},"key":"OFs8l94adm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"img = imread(\"hello.png\")[:, :, :3]\nA = rgb2gray(img)\nprint(f\"image of size {A.shape}\")","key":"HfVtSITXyf"},{"type":"output","id":"2vYECp-tZ_OfyJHj2ZM2K","data":[{"output_type":"stream","name":"stdout","text":"image of size (400, 700)\n"}],"key":"KcGlH9tFkS"}],"data":{},"key":"sT0dScpe6w"},{"type":"paragraph","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"Next we show that the singular values decrease until they reach zero (more precisely, until they are about ","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"bF4FcrxNJ8"},{"type":"inlineMath","value":"\\epsilon_\\text{mach}","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ILwRduY1Ut"},{"type":"text","value":" times the norm of the matrix) at around index ","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"el45mPBjX2"},{"type":"text","value":"38","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"ILnamSNYQQ"},{"type":"text","value":".","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"qlntIYjq3j"}],"key":"Rnov2mRVQc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import svd\nU, sigma, Vt = svd(A)\nsemilogy(sigma, \"o\")\ntitle(\"Singular values\")\nxlabel(\"$i$\"), ylabel(\"$\\\\sigma_i$\");","key":"BdaOXXZeaj"},{"type":"output","id":"AgZLRTJ_7lpZtzBWPy_VK","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"bbbbd9401cd6b702fe6e442474f09035","path":"/fnc/build/bbbbd9401cd6b702fe6e442474f09035.png"}}}],"key":"dCyNWw2NeG"}],"data":{},"key":"nT0p72SuxJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"significant = sigma / sigma[0] > 10 * 2**-52\nprint(f\"last significant singular value at index {max(where(significant)[0])}\")","key":"bX0Oe0oVzQ"},{"type":"output","id":"Aa2n2TQU2jVYlwiudxt9b","data":[{"output_type":"stream","name":"stdout","text":"last significant singular value at index 38\n"}],"key":"sZSN952aq0"}],"data":{},"key":"mIliIWAhsp"},{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"The rapid decrease suggests that we can get fairly good low-rank approximations.","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"HRoPoM42kI"}],"key":"yxDkp6jm4R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for k in range(4):\n    r = 2 + 2 * k\n    Ak = U[:, :r] @ diag(sigma[:r]) @ Vt[:r, :]\n    subplot(2, 2, k + 1)\n    imshow(Ak, cmap=\"gray\", clim=(0.0, 1.0))\n    title(f\"rank = {r}\")\n    xticks([]), yticks([])","key":"uvtDXjLNOu"},{"type":"output","id":"nhd2q97ChKjDn--pq9SbI","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 4 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"489e11379a8c15a007d58770ca92bb2f","path":"/fnc/build/489e11379a8c15a007d58770ca92bb2f.png"}}}],"key":"AcPmPXL9uH"}],"data":{},"key":"wDDAsCo2iB"},{"type":"paragraph","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"children":[{"type":"text","value":"Consider how little data is needed to reconstruct these images. For rank-8, for instance, we have 8 left and right singular vectors plus 8 singular values.","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"A2Ra1n2rb2"}],"key":"eSQ33x8Xbq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m, n = A.shape\nfull_size = m * n\ncompressed_size = 8 * (m + n + 1)\nprint(f\"compression ratio: {full_size / compressed_size:.1f}\")","key":"Lr53uPVlkX"},{"type":"output","id":"3TtZPDy9g_Lps3ZKC6bBr","data":[{"output_type":"stream","name":"stdout","text":"compression ratio: 31.8\n"}],"key":"tw0DZPrPgi"}],"data":{},"key":"QAtGvGUJRb"}],"label":"demo-dimreduce-hello-python","identifier":"demo-dimreduce-hello-python","html_id":"demo-dimreduce-hello-python","key":"OIh6pU967G"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Dimension reduction in voting records","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":1}},"key":"OfPadofTZZ"}],"key":"D4ATkr3Kml"},{"type":"paragraph","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"children":[{"type":"text","value":"This matrix describes the votes on bills in the 111th session of the United States Senate. (The data set was obtained from [","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"key":"OOMtSeEkFy"},{"type":"link","url":"https://voteview.com","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"children":[{"type":"text","value":"https://​voteview​.com","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"key":"Szagmscwya"}],"urlSource":"https://voteview.com","key":"fmINNCHUCf"},{"type":"text","value":"].) Each row is one senator, and each column is a vote item.","position":{"start":{"line":466,"column":1},"end":{"line":466,"column":1}},"key":"HXgdYQCcgA"}],"key":"n8hQxyEK6A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.io import loadmat\nvars = loadmat(\"voting.mat\")\nA = vars[\"A\"]\nm, n = A.shape\nprint(\"size:\", (m, n))","key":"kVIjYgjm1Z"},{"type":"output","id":"EDILzNRgkPxO3A4gTEcmq","data":[{"output_type":"stream","name":"stdout","text":"size: (112, 696)\n"}],"key":"uO2s3slJUt"}],"data":{},"key":"MCdBApnZsJ"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"If we visualize the votes (yellow is “yea,” blue is “nay”), we can see great similarity between many rows, reflecting party unity.","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"WBKiimhJXx"}],"key":"hlD0YRidkf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"imshow(A, cmap=\"viridis\")\nxlabel(\"bill\")\nylabel(\"senator\")\ntitle(\"Votes in 111th U.S. Senate\");","key":"pr7UTUrG8M"},{"type":"output","id":"t6-EWVKxmBJDwdSJD3X6p","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"21cbcfbf266d4e5b95f4bb635b11a7e5","path":"/fnc/build/21cbcfbf266d4e5b95f4bb635b11a7e5.png"}}}],"key":"aROMz871Ks"}],"data":{},"key":"ztJa3bKGv0"},{"type":"paragraph","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"n4UphvgBrL"},{"type":"crossReference","kind":"equation","identifier":"sing-val-decay","label":"sing-val-decay","children":[{"type":"text","value":"(","key":"tCW8mwKR8E"},{"type":"text","value":"7.5.4","key":"i8VGjAPoyv"},{"type":"text","value":")","key":"NU2zqhzfua"}],"template":"(%s)","enumerator":"7.5.4","resolved":true,"html_id":"sing-val-decay","remote":true,"url":"/dimreduce","dataUrl":"/dimreduce.json","key":"X0l10ujB9l"},{"type":"text","value":" to quantify the decay rate of the values.","position":{"start":{"line":485,"column":1},"end":{"line":485,"column":1}},"key":"BWBqUEuiun"}],"key":"FrMbhKtYRx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"U, sigma, Vt = svd(A)\ntau = cumsum(sigma**2) / sum(sigma**2)\nplot(range(1, 17), tau[:16], \"o\")\nxlabel(\"$k$\")\nylabel(\"$\\tau_k$\")\ntitle(\"Fraction of singular value energy\");","key":"S4W5KBqN4U"},{"type":"output","id":"EfOKWGne2bwwNap_e0ExA","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"73741733f2e02f178b0fca6e67fde074","path":"/fnc/build/73741733f2e02f178b0fca6e67fde074.png"}}}],"key":"O9izvhrODH"}],"data":{},"key":"xhUi0Dhpw8"},{"type":"paragraph","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"children":[{"type":"text","value":"The first and second singular triples contain about 58% and 17%, respectively, of the energy of the matrix. All others have far less effect, suggesting that the information is primarily two-dimensional. The first left and right singular vectors also contain interesting structure.","position":{"start":{"line":496,"column":1},"end":{"line":496,"column":1}},"key":"gL8PTcLZf9"}],"key":"TOoSpn0uFy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"subplot(1, 2, 1)\nplot(U[:, 0], \"o\")\nxlabel(\"senator\"),title(\"left singular vector\")\nsubplot(1, 2, 2)\nplot(Vt[0, :], \"o\")\nxlabel(\"bill\"), title(\"right singular vector\");","key":"MuMUzw7xAB"},{"type":"output","id":"IbIPCJ9yVgbKeE5x_Ba46","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"3dc9201974a80ab1b6b86d94de92a4a8","path":"/fnc/build/3dc9201974a80ab1b6b86d94de92a4a8.png"}}}],"key":"MmXZAOP2Pr"}],"data":{},"key":"aHTfmkLAPp"},{"type":"paragraph","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"Both vectors have values greatly clustered near ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"WTGbMsPP1Z"},{"type":"inlineMath","value":"\\pm C","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>±</mo><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">\\pm C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"irMtsKmg1U"},{"type":"text","value":" for a constant ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"S4ieCjk7z9"},{"type":"inlineMath","value":"C","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"xxjPd9voJt"},{"type":"text","value":". These can be roughly interpreted as how partisan a particular senator or bill was, and for which political party. Projecting the senators’ vectors into the first two ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"bAyREwFArU"},{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"tqJul9ZfCC"},{"type":"text","value":"-coordinates gives a particularly nice way to reduce them to two dimensions. Political scientists label these dimensions ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"fHh8FNIWsi"},{"type":"emphasis","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"partisanship","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"ZoYO45ScPq"}],"key":"cAXKTaHLvk"},{"type":"text","value":" and ","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"JFE3OpibLh"},{"type":"emphasis","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"bipartisanship","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"UiuaVFhZqt"}],"key":"UM3W8LVd4e"},{"type":"text","value":". Here we color them by actual party affiliation (also given in the data file): red for Republican, blue for Democrat, and yellow for independent.","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"VAZHUWwoHn"}],"key":"ea0QlM5XA8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = sigma[0] * U[:, 0]\nx2 = sigma[1] * U[:, 1]\n\nRep = vars[\"Rep\"] - 1\nDem = vars[\"Dem\"] - 1\nInd = vars[\"Ind\"] - 1\n\nscatter(x1[Dem], x2[Dem], color=\"blue\", label=\"D\")\nscatter(x1[Rep], x2[Rep], color=\"red\", label=\"R\")\nscatter(x1[Ind], x2[Ind], color=\"darkorange\", label=\"I\")\n\nxlabel(\"partisanship\")\nylabel(\"bipartisanship\")\nlegend()\ntitle(\"111th US Senate in 2D\");","key":"uFIJ87751v"},{"type":"output","id":"dGRmuOUE6MJo8a-PM5t1B","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"56893fd0912b0b81744322decdf57206","path":"/fnc/build/56893fd0912b0b81744322decdf57206.png"}}}],"key":"mV5z18rxCw"}],"data":{},"key":"qI9nkrQha4"}],"label":"demo-dimreduce-voting-python","identifier":"demo-dimreduce-voting-python","html_id":"demo-dimreduce-voting-python","key":"eE7hD5THq7"}],"key":"FnKahKSn3L"}],"key":"tDiEJrLaCn"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 6","url":"/chapter6-2","group":"Python codes"},"next":{"title":"Chapter 8","url":"/chapter8-1","group":"Python codes"}}},"domain":"http://localhost:3000"}