{"kind":"Notebook","sha256":"4db8d55c446168a3ec7636fcfb61ab32cf89265adf6624f9671cbbd914b05165","slug":"roots-5","location":"/chapter1/section4/python/roots.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"roots.ipynb","url":"/build/roots-2610b0a07ebcee1cb3b397689e018588.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"qdCFNzPMzP"},{"type":"text","value":"1.4.3","key":"c9FUgoiCx4"}],"key":"UJxHJ1ijL0"}],"identifier":"demo-stability-roots","label":"demo-stability-roots","kind":"proof:example","template":"Example %s","enumerator":"1.4.3","resolved":true,"html_id":"demo-stability-roots","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"vhcwE55RfH"}],"key":"hbF1vUEzZA"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Our first step is to construct a polynomial with six known roots.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rwSa83F5xw"}],"key":"OURT6yzkzC"}],"key":"SgpSAgq2HP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T20:16:35.616481Z","iopub.status.busy":"2025-01-14T20:16:35.608678Z","iopub.execute_input":"2025-01-14T20:16:35.609002Z","shell.execute_reply":"2025-01-14T20:16:35.612628Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"r = [-2, -1, 1, 1, 3, 6]\np = poly(r)\nprint(p)","key":"LQCKmZxBUG"},{"type":"output","id":"I-566mLTHG9s414uAvrtc","data":[{"name":"stdout","output_type":"stream","text":"[  1.  -8.   6.  44. -43. -36.  36.]\n"}],"key":"ElZwGBjkrr"}],"key":"VNYuiPdYey"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use a standard numerical method for finding those roots, pretending that we don’t know them already. This corresponds to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hKGX42NvyD"},{"type":"inlineMath","value":"\\tilde{y}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8623em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">~</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"PVPLyau3yY"},{"type":"text","value":" in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OLBQmCgqBM"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"LvClMbOd9P"},{"type":"text","value":"1.4.1","key":"lzmoho7MGM"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"AqeczgiveM"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PwgDtzq4fq"}],"key":"sNzEwBI3kn"}],"key":"mV2ydCXtJS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T20:16:35.624189Z","iopub.status.busy":"2025-01-14T20:16:35.618825Z","iopub.execute_input":"2025-01-14T20:16:35.619095Z","shell.execute_reply":"2025-01-14T20:16:35.623688Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"r_computed = sort(roots(p))\nprint(r_computed)","key":"Eg8NZ49ftB"},{"type":"output","id":"tyPLU_APY9KSObEtrreNW","data":[{"name":"stdout","output_type":"stream","text":"[-2.+0.00000000e+00j -1.+0.00000000e+00j  1.-1.31638218e-08j\n  1.+1.31638218e-08j  3.+0.00000000e+00j  6.+0.00000000e+00j]\n"}],"key":"hDyP0iK5O5"}],"key":"rQOPGR32Vu"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here are the relative errors in each of the computed roots.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YWzfAr9BPf"}],"key":"k02j7yCCb5"}],"key":"KZ9xC5r0E8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T20:16:35.634078Z","iopub.status.busy":"2025-01-14T20:16:35.626593Z","iopub.execute_input":"2025-01-14T20:16:35.626836Z","shell.execute_reply":"2025-01-14T20:16:35.633456Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(abs(r - r_computed) / r)","key":"qD1M2GGGvh"},{"type":"output","id":"wWt1IEL8Tyg26-l4FeLms","data":[{"name":"stdout","output_type":"stream","text":"[-5.55111512e-16 -2.22044605e-16  1.31638218e-08  1.31638218e-08\n  4.44089210e-16  1.33226763e-15]\n"}],"key":"syXJBUlrj4"}],"key":"ZseQvNd6nM"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It seems that the forward error is acceptably close to machine epsilon for double precision in all cases except the double root at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xjnkeL0AOh"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"cw3Mx6PMNx"},{"type":"text","value":". This is not a surprise, though, given the poor conditioning at such roots.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BVH3QwkV5R"}],"key":"J38ONhwAxg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s consider the backward error. The data in the rootfinding problem is the polynomial coefficients. We can apply poly to find the coefficients of the polynomial (that is, the data) whose roots were actually computed by the numerical algorithm. This corresponds to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FP7cnr5Dkg"},{"type":"inlineMath","value":"\\tilde{x}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>~</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\tilde{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6679em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6679em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3.35em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">~</span></span></span></span></span></span></span></span></span></span>","key":"X0LAhxx2xM"},{"type":"text","value":" in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wDT9phAlKb"},{"type":"crossReference","kind":"proof:definition","identifier":"definition-stability-backward","label":"definition-stability-backward","children":[{"type":"text","value":"Definition ","key":"P6M0EphcHU"},{"type":"text","value":"1.4.1","key":"fCQsdMRWj0"}],"template":"Definition %s","enumerator":"1.4.1","resolved":true,"html_id":"definition-stability-backward","remote":true,"url":"/stability","dataUrl":"/stability.json","key":"Mp8CqmsdSF"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nZT23SoQoE"}],"key":"stgMsvc5zV"}],"key":"noeQTN4icd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T20:16:35.640818Z","iopub.status.busy":"2025-01-14T20:16:35.636656Z","iopub.execute_input":"2025-01-14T20:16:35.636929Z","shell.execute_reply":"2025-01-14T20:16:35.640229Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"p_computed = poly(r_computed)\nprint(p_computed)","key":"COqlU5Wgk7"},{"type":"output","id":"UBAGjIqg8NB8RIsfELEjY","data":[{"name":"stdout","output_type":"stream","text":"[  1.  -8.   6.  44. -43. -36.  36.]\n"}],"key":"rNYzMyiJgY"}],"key":"Zx1FtV5jIJ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We find that in a relative sense, these coefficients are very close to those of the original, exact polynomial:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S8c5Ue0P6B"}],"key":"nxMmXLsBp4"}],"key":"LikqtHdVK3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T20:16:35.649749Z","iopub.status.busy":"2025-01-14T20:16:35.643637Z","iopub.execute_input":"2025-01-14T20:16:35.643912Z","shell.execute_reply":"2025-01-14T20:16:35.649205Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(abs(p - p_computed) / p)","key":"dqt1YYTsUK"},{"type":"output","id":"4nKijOPe33Liwf20ur2mf","data":[{"name":"stdout","output_type":"stream","text":"[ 0.00000000e+00 -1.11022302e-15  2.96059473e-15  1.45338287e-15\n -3.63533493e-15 -1.38161088e-15  3.75008666e-15]\n"}],"key":"WBcOEdX1QH"}],"key":"xST9p7Jyga"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In summary, even though there are some computed roots relatively far from their correct values, they are nevertheless the roots of a polynomial that is very close to the original.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MbG4i0InEB"}],"key":"nuPvpClpd5"}],"key":"Zl6US3DOEb"}],"key":"GBeAA7uuaw"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Quadgood","url":"/quadgood-2","group":"Chapter 1"},"next":{"title":"Vander","url":"/vander-2","group":"Chapter 2"}}},"domain":"http://localhost:3000"}