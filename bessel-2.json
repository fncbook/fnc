{"kind":"Notebook","sha256":"7660139f4748f2a6829483fd54647a19227f875cc2439251a39ceb9baa284716","slug":"bessel-2","location":"/chapter4/section1/python/bessel.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"bessel.ipynb","url":"/fnc/build/bessel-81e33715bef8752413ec25777e76f0d2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:27.490306Z","iopub.status.busy":"2025-01-11T17:18:27.489930Z","iopub.status.idle":"2025-01-11T17:18:27.892221Z","shell.execute_reply":"2025-01-11T17:18:27.891950Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"NKGt3QURwK"},{"type":"output","id":"jhdV16OdCgXA12D9AowC4","data":[],"visibility":"show","key":"JdGKNz4m1e"}],"visibility":"remove","key":"r5qGD5Kmv8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"jHXL9CQ7ln"},{"type":"text","value":"4.1.1","key":"QrkWQOb7SI"}],"key":"nhfymvEecR"}],"identifier":"demo-rootproblem-bessel","label":"demo-rootproblem-bessel","kind":"proof:example","template":"Example %s","enumerator":"4.1.1","resolved":true,"html_id":"demo-rootproblem-bessel","remote":true,"url":"/rootproblem","dataUrl":"/rootproblem.json","key":"LSyti413DV"}],"key":"glQDMxqnUq"}],"key":"Zp9eO2x1x9"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:27.893732Z","iopub.status.busy":"2025-01-11T17:18:27.893597Z","iopub.status.idle":"2025-01-11T17:18:28.031486Z","shell.execute_reply":"2025-01-11T17:18:28.031193Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.special as special\ndef J3(x):\n    return special.jv(3.0, x)\n\nxx = linspace(0, 20, 500)\nfig, ax = subplots()\nax.plot(xx, J3(xx))\nax.grid()\nxlabel(\"$x$\"), ylabel(\"$J_3(x)$\")\ntitle(\"Bessel function\");","key":"zMr9kixm0Y"},{"type":"output","id":"F9bTn-aHOL82vFXwLkRIe","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4ff3d46e327f486e510cfc943018f94e","path":"/fnc/build/4ff3d46e327f486e510cfc943018f94e.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"IxpfLmEDfC"}],"key":"XzWBTG3k4f"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the graph we see roots near 6, 10, 13, 16, and 19. We use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LqNUo8KfjT"},{"type":"inlineCode","value":"root_scalar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JhlMQx9X5U"},{"type":"text","value":" from the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UwOAI5Pcig"},{"type":"inlineCode","value":"scipy.optimize","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y3hdfU9Lf1"},{"type":"text","value":" package to find these roots accurately.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GboeS3RjFS"}],"key":"Aa8sXxghWP"}],"key":"l2dmaS4PJd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:28.032902Z","iopub.status.busy":"2025-01-11T17:18:28.032778Z","iopub.status.idle":"2025-01-11T17:18:28.035586Z","shell.execute_reply":"2025-01-11T17:18:28.035334Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.optimize import root_scalar\n\nomega = []\nfor guess in [6.0, 10.0, 13.0, 16.0, 19.0]:\n    s = root_scalar(J3, bracket=[guess - 0.5, guess + 0.5]).root\n    omega.append(s)\n\nresults = PrettyTable()\nresults.add_column(\"root estimate\", omega)\nresults.add_column(\"function value\", [J3(ω) for ω in omega])\nprint(results)","key":"fl0pWPPPp3"},{"type":"output","id":"1INdK5jS_lDw-IKh_6lSK","data":[{"name":"stdout","output_type":"stream","text":"+--------------------+-------------------------+\n|   root estimate    |      function value     |\n+--------------------+-------------------------+\n| 6.380161895923983  |  2.5877058405892666e-16 |\n| 9.761023129981195  | -1.1824718824668837e-13 |\n| 13.015200721698434 |  -1.135864957485476e-16 |\n| 16.223466160318758 |  -1.898385896228919e-15 |\n| 19.40941522643501  |  7.862906169587308e-16  |\n+--------------------+-------------------------+\n"}],"key":"G6wHtZnlmU"}],"key":"QlY0vm7U1v"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:28.036827Z","iopub.status.busy":"2025-01-11T17:18:28.036723Z","iopub.status.idle":"2025-01-11T17:18:28.089538Z","shell.execute_reply":"2025-01-11T17:18:28.089242Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ax.scatter(omega, J3(omega))\nax.set_title(\"Bessel function roots\")\nfig","key":"N7HRYef4JY"},{"type":"output","id":"LCps7vYRtKYxXGOUo3kq7","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7e983db265dbf1877ba45142cc9d04c1","path":"/fnc/build/7e983db265dbf1877ba45142cc9d04c1.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"prThsgV2rC"}],"key":"O2phlPG9wg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If instead we seek values at which ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"toqm8NoRI4"},{"type":"inlineMath","value":"J_3(x)=0.2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)=0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"cdz4MBs1uf"},{"type":"text","value":", then we must find roots of the function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VA1sxkdfLh"},{"type":"inlineMath","value":"J_3(x)-0.2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)-0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"qTeNqiF0JK"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yN8U9X4jXT"}],"key":"auq8wsxovj"}],"key":"IJmC2gF3iZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T17:18:28.090892Z","iopub.status.busy":"2025-01-11T17:18:28.090801Z","iopub.status.idle":"2025-01-11T17:18:28.164370Z","shell.execute_reply":"2025-01-11T17:18:28.164078Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"omega = []\nfor guess in [3., 6., 10., 13.]:\n    f = lambda x: J3(x) - 0.2\n    s = root_scalar(f, x0=guess).root\n    omega.append(s)\n\nax.scatter(omega, J3(omega))\nfig","key":"bCVALqOFyd"},{"type":"output","id":"YshZehm7Ec4i8QArrOdO9","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"471c4cdc235c3f4e2c835c2a410a8a52","path":"/fnc/build/471c4cdc235c3f4e2c835c2a410a8a52.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"Wxt7QD4fHC"}],"key":"OcPug9buqr"}],"key":"aYVALCs7IB"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Qr","url":"/qr-3","group":"Chapter 3"},"next":{"title":"Cond","url":"/cond-6","group":"Chapter 4"}}},"domain":"http://localhost:3000"}