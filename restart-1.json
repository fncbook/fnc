{"kind":"Notebook","sha256":"8db2b9d00b6513052e16f99dc3e83749fc9d61180ff155191f321865c2ee0af9","slug":"restart-1","location":"/chapter8/section5/matlab/restart.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"restart.ipynb","url":"/build/restart-87c05a05c4b8790b33c4dc718e329db1.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ctXG9ZdJZB"},{"type":"text","value":"8.5.2","key":"ZcfPfeudau"}],"key":"PdZ2498u9R"}],"identifier":"demo-gmres-restart","label":"demo-gmres-restart","kind":"proof:example","template":"Example %s","enumerator":"8.5.2","resolved":true,"html_id":"demo-gmres-restart","remote":true,"url":"/gmres","dataUrl":"/gmres.json","key":"iC4WtpVi8x"}],"key":"I1ynXSYUpy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following experiments are based on a matrix resulting from discretization of a partial differential equation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VJQ9inFBiK"}],"key":"scDhjoNhRQ"}],"key":"OmlFdRUXZ3"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"d = 50;\nA = d^2 * gallery('poisson', d);\nn = size(A, 1)\nb = ones(n, 1);\nclf,  spy(A)","key":"ZNISu199LE"},{"type":"output","id":"-11yHFb3nPOzfWVfRuJNK","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"n = 2500","content_type":"text/plain"},"text/html":{"content":"<html><body><pre>n = 2500</pre></body></html>","content_type":"text/html"}}},{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0349497de122e91aa4e45c634f232555","path":"/build/0349497de122e91aa4e45c634f232555.png"}}}],"key":"O3WeFbYL81"}],"key":"tqWYoLAR9T"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We compare unrestarted GMRES with three different thresholds for restarting. Here we are using the built-in ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QwgenqgjUy"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VwSiqcq9AX"},{"type":"text","value":", since our simple implementation does not offer restarting.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BP7qaFgmw6"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"gmres","kind":"entry"},"emphasis":true}],"label":"index-Z8b0b5KAZq","identifier":"index-z8b0b5kazq","html_id":"index-z8b0b5kazq","key":"ScRuMNznJn"}],"key":"TVhcz51Euq"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nrestart = [120, 20, 40, 60];\nfor j = 1:4\n    [~,~,~,~,rv] = gmres(A, b, restart(j), 1e-9,120 / restart(j));\n    semilogy(0:length(rv) - 1, rv),  hold on\nend\ntitle('Convergence of restarted GMRES')\nxlabel('m'),  ylabel('residual norm')\nlegend('no restart','every 20','every 40','every 60','location','southwest');","key":"btxTqRzhig"},{"type":"output","id":"deAOmZS_NY2ekc3r1ArcW","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2c3f62121db0a9953df4941fee25a01a","path":"/build/2c3f62121db0a9953df4941fee25a01a.png"}}}],"key":"OqdwSrqagY"}],"key":"jZgO8gXDo6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The “pure” GMRES curve is the lowest one. All of the other curves agree with it until the first restart. Decreasing the restart value makes the convergence per iteration generally worse, but the time required per iteration smaller as well.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UVGlc4G5jO"}],"key":"U0KXSqZwly"}],"key":"JMf9v6h9ME"}],"key":"FM6qfZZuZG"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Intro","url":"/intro-1","group":"Chapter 8"},"next":{"title":"Indefinite","url":"/indefinite-1","group":"Chapter 8"}}},"domain":"http://localhost:3000"}