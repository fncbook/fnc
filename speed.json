{"kind":"Notebook","sha256":"a983d266a2f37aee712fbafd1fa3107751a3455e9aa19f85cd9d46c37c0217db","slug":"speed","location":"/chapter12/section4/julia/speed.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1.11.2","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"speed.ipynb","url":"/build/speed-f0d3f6e2885671747b7a841336c87891.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"EW7MiLyiN2"},{"type":"text","value":"12.4.2","key":"HxLpRNjR5F"}],"key":"Geo7zzuuP3"}],"identifier":"demo-wave-speed","label":"demo-wave-speed","kind":"proof:example","template":"Example %s","enumerator":"12.4.2","resolved":true,"html_id":"demo-wave-speed","remote":true,"url":"/wave","dataUrl":"/wave.json","key":"nchD2OmGvB"}],"key":"Iuk7qZIuJM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","key":"qC7Y6DEcm0"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"vBnOrncBdq"}],"key":"jzheabDkzR"},{"type":"text","value":" implementation has to change slightly.","key":"Jr6vavIBm9"}],"key":"SiyKE0PTOl"}],"key":"FmMMuViTWI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:20:44.527000Z","iopub.status.busy":"2025-01-14T15:20:38.010000Z","iopub.execute_input":"2025-01-14T15:20:39.230000Z","shell.execute_reply":"2025-01-14T15:20:44.524000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m = 200\nx, Dₓ = FNC.diffcheb(m, [-1, 1]);\n\nextend = v -> [0; v; 0]\nchop = u -> u[2:m];\n\nu_init = @. exp( -100*(x + 0.5)^2 )\nz_init = -u_init\nw_init = [ chop(u_init); z_init ]\n\node = function(w,c,t)\n    u = extend(w[1:m-1])\n    z = w[m:2m]\n    du_dt = Dₓ*z\n    dz_dt = c.^2 .* (Dₓ*u)\n    return [ chop(du_dt); dz_dt ]\nend;","key":"p39OZuOHM1"},{"type":"output","id":"rj_McfJIrV0LxvHcz1w-H","data":[],"key":"uYPh2BHFmS"}],"key":"b7LRsDoNNB"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The variable wave speed is passed as an extra parameter through the ","key":"snRJ1AlW2K"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"YSJgG7PLY6"}],"key":"R7cxewu7tS"},{"type":"text","value":" solver.","key":"GYNyuiy92I"}],"key":"e0YvaXrsf0"}],"key":"ihp9XMbNg8"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:21:21.649000Z","iopub.status.busy":"2025-01-14T15:20:44.546000Z","iopub.execute_input":"2025-01-14T15:20:44.547000Z","shell.execute_reply":"2025-01-14T15:21:21.648000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nc = @. 1 + (sign(x)+1)/2\nIVP = ODEProblem(ode, w_init, (0., 5.), c)\nw = solve(IVP, RK4());","key":"BMdiJte8T4"},{"type":"output","id":"cB6wsMvTP6z4bFWLuO7SP","data":[],"key":"qpBBEUqydR"}],"key":"oD18QuSWGN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:21:36.583000Z","iopub.status.busy":"2025-01-14T15:21:21.660000Z","iopub.execute_input":"2025-01-14T15:21:21.660000Z","shell.execute_reply":"2025-01-14T15:21:36.582000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"t = range(0, 5, 80)\nU = [extend(w(t)[1:m-1]) for t in t]\ncontour(x, t, hcat(U...)';\n    color=:redsblues,  clims=(-1,1),\n    levels=24,\n    xlabel=L\"x\",  ylabel=L\"t\",\n    title=\"Wave equation\",\n    right_margin=3Plots.mm\n    )","key":"HVgY6mL9Al"},{"type":"output","id":"CmmkSbful3RQUev7aZPJD","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a598559cd3c7d950cda10aff7ae1171b","path":"/build/a598559cd3c7d950cda10aff7ae1171b.png"},"text/html":{"content_type":"text/html","hash":"3eb4a0c230e366b2d7ba6217aeef8143","path":"/build/3eb4a0c230e366b2d7ba6217aeef8143.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ac1001521a6ea29c04c34414e1792286","path":"/build/ac1001521a6ea29c04c34414e1792286.svg"}}}],"key":"FwRD2TdchD"}],"key":"F10a6u11au"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:21:56.335000Z","iopub.status.busy":"2025-01-14T15:21:36.609000Z","iopub.execute_input":"2025-01-14T15:21:36.610000Z","shell.execute_reply":"2025-01-14T15:21:56.334000Z"},"tags":[]},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0,5,181)\n    plot(Shape([-1, 0, 0, -1], [-1, -1, 1, 1]), color=RGB(.8, .8, .8), l=0, label=\"\")\n    plot!(x, extend(w(t, idxs=1:m-1));\n        label=@sprintf(\"t=%.2f\", t), \n        xaxis=(L\"x\"),  yaxis=([-1, 1], L\"u(x,t)\"),\n        dpi=150,  title=\"Wave equation, variable speed\")\nend\nmp4(anim, \"wave-speed.mp4\")","visibility":"hide","key":"MLSDK25F05"},{"type":"output","id":"75ACiu_VqwVinV9mH7k66","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section4/julia/wave-speed.mp4\n"},{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"Plots.AnimatedGif(\"/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter12/section4/julia/wave-speed.mp4\")","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"82b4de29af1675350c9503e441b8f79f","path":"/build/82b4de29af1675350c9503e441b8f79f.html"}}}],"visibility":"show","key":"n2SReviJjy"}],"visibility":"show","key":"ClmUIbSNIO"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Each pass through the interface at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"duoYtlWzDD"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">x=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"SVDOONdk6f"},{"type":"text","value":" generates a reflected and transmitted wave. By conservation of energy, these are both smaller in amplitude than the incoming bump.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KLzAI4vlGp"}],"key":"CBGt82wgVm"}],"key":"PBgyMWegVG"}],"key":"N8RcxezOpO"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Boundaries","url":"/boundaries-1","group":"Chapter 12"},"next":{"title":"Gridfun","url":"/gridfun","group":"Chapter 13"}}},"domain":"http://localhost:3000"}