{"kind":"Notebook","sha256":"57fddc6ce39903017457a239507237bf084dff14d64760a27a8817b38de14e37","slug":"chapter6-1","location":"/matlab/chapter6.md","dependencies":[],"frontmatter":{"title":"Chapter 6","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter6.md","url":"/fnc/build/chapter6-388077afa1368de68cf1eae5e98c4f78.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"pDobiBQhfG"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"f0wsSKv7Vt"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Euler’s method for an initial-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"DHchpC1u8H"}],"key":"o7XuNnfoPb"},{"type":"include","file":"../matlab/fnc/eulerivp.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [t, u] = eulerivp(ivp, a, b, n)\r\n% EULERIVP   Euler's method for a scalar initial-value problem.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;\r\nt = a + (0:n) * h;\r\n\r\n% Initialize solution array.\r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0;\r\n\r\n% Time stepping.\r\nfor i = 1:n\r\n  u(:, i+1) = u(:, i) + h * du_dt(t(i), u(i), p);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"eulerivp.m","key":"C7DqsmkmNj"}],"key":"sNshybijXr"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"I2cCmhkZ6g"}],"key":"wwdNmjIiso"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"xcIIXZFsIs"},{"type":"inlineCode","value":"ivp","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"LQX3v3mQhs"},{"type":"text","value":" input argument is the same structure that is used with the built-in ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"weywyjChdY"},{"type":"inlineCode","value":"solve","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"BarxYL99KX"},{"type":"text","value":" solvers. The outputs ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"oKwL9RsJ4a"},{"type":"inlineCode","value":"t","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"P2BgqDkkfR"},{"type":"text","value":" and ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"clNwdmgO4N"},{"type":"inlineCode","value":"u","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"qJAst1uga1"},{"type":"text","value":" are row vectors of the same length, like the fields in a solution object output by ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"FKKosZi0Mz"},{"type":"inlineCode","value":"solve","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"o0IoNnQqAM"},{"type":"text","value":". While the entries of ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"eFF9HAqFxL"},{"type":"inlineCode","value":"u","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"jZYnIHG0TB"},{"type":"text","value":" could be simplified to ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"AA2sUyekRV"},{"type":"inlineCode","value":"u(1)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"QF2XcCaKj6"},{"type":"text","value":", ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"ZZ5slK2au2"},{"type":"inlineCode","value":"u(i)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"oe2AAe3qyQ"},{"type":"text","value":", etc., we chose a column-access syntax like ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"sHoHEpMV3n"},{"type":"inlineCode","value":"u(:, i)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"xUQ5EZMPJo"},{"type":"text","value":" that will prove useful for what’s coming next in the chapter.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"odL9ckCBTR"}],"key":"fw5dXlat3w"}],"class":"dropdown","key":"dD7ZzhnMug"}],"label":"function-euler-matlab","identifier":"function-euler-matlab","html_id":"function-euler-matlab","key":"Bqi0svk0vt"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Improved Euler method for an IVP","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Ah7HrEb7L7"}],"key":"eASdvcSWEB"},{"type":"include","file":"../matlab/fnc/ie2.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [t, u] = ie2(ivp, a, b, n)\r\n% IE2    Improved Euler method for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\n% Initialize solution array. \r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0(:);\r\n\r\n% Time stepping. \r\nfor i = 1:n \r\n    uhalf = u(:, i) + h/2 * du_dt(t(i), u(:, i), p);\r\n    u(:, i+1) = u(:, i) + h * du_dt(t(i) + h/2, uhalf, p);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"ie2.m","key":"DRgs6P64dx"}],"key":"Julz0qnGMd"}],"label":"function-ie2-matlab","identifier":"function-ie2-matlab","html_id":"function-ie2-matlab","key":"cJGcBT3cQJ"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Fourth-order Runge-Kutta for an IVP","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"AEY1tjdaKv"}],"key":"YY7KM3O0mB"},{"type":"include","file":"../matlab/fnc/rk4.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [t, u] = rk4(ivp, a, b, n)\r\n% RK4    Fourth-order Runge-Kutta for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\n% Initialize solution array. \r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0(:);\r\n\r\n% Time stepping.\r\nfor i = 1:n\r\n  k1 = h * du_dt( t(i),       u(:, i)       , p);\r\n  k2 = h * du_dt( t(i) + h/2, u(:, i) + k1/2, p );\r\n  k3 = h * du_dt( t(i) + h/2, u(:, i) + k2/2, p );\r\n  k4 = h * du_dt( t(i) + h,   u(:, i) + k3  , p);\r\n  u(:, i+1) = u(:, i) + (k1 + 2*(k2 + k3) + k4) / 6;\r\nend","lang":"matlab","showLineNumbers":true,"filename":"rk4.m","key":"xXsucerWoj"}],"key":"qT7JCfZZv4"}],"label":"function-rk4-matlab","identifier":"function-rk4-matlab","html_id":"function-rk4-matlab","key":"k3fSOPVJfF"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Adaptive IVP solver based on embedded RK formulas","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"yOrm5nMWdc"}],"key":"skTmjq7k2g"},{"type":"include","file":"../matlab/fnc/rk23.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [t, u] = rk23(ivp, a, b, tol)\r\n% RK23   Adaptive IVP solver based on embedded RK formulas.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   tol     global error target (positive scalar)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Initialize for the first time step.\r\nt = a;\r\nu(:, 1) = u0(:);  i = 1;\r\nh = 0.5 * tol^(1/3);\r\ns1 = du_dt(t(1), u(:, 1));\r\n\r\n% Time stepping.\r\nwhile t(i) < b\r\n    % Detect underflow of the step size.\r\n    if t(i) + h == t(i)\r\n        warning('Stepsize too small near t=%.6g.',t(i))\r\n        break  % quit time stepping loop\r\n    end\r\n    \r\n    % New RK stages.\r\n    s2 = du_dt(t(i) + h/2,   u(:, i) + (h/2)   * s1, p);\r\n    s3 = du_dt(t(i) + 3*h/4, u(:, i) + (3*h/4) * s2, p);\r\n    unew2 = u(:, i) + h * (2*s1 + 3*s2 + 4*s3) / 9;    % 2rd order solution\r\n    s4 = du_dt(t(i) + h, unew2, p );\r\n    err = h * (-5*s1/72 + s2/12 + s3/9 - s4/8);        % 2nd/3rd order difference\r\n    E = norm(err, Inf);                                % error estimate\r\n    maxerr = tol * (1 + norm(u(:, i), Inf));           % relative/absolute blend\r\n    \r\n    % Accept the proposed step? \r\n    if E < maxerr     % yes \r\n        t(i+1) = t(i) + h;\r\n        u(:, i+1) = unew2;\r\n        i = i+1;\r\n        s1 = s4;      % use FSAL property\r\n    end\r\n    \r\n    % Adjust step size. \r\n    q = 0.8 * (maxerr/E)^(1/3);       % conservative optimal step factor\r\n    q = min(q, 4);                    % limit stepsize growth\r\n    h = min(q*h, b - t(i));           % don't step past the end\r\nend","lang":"matlab","showLineNumbers":true,"filename":"rk23.m","key":"ymlFr4Thu1"}],"key":"awHdfzDW9G"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"PfLk9AzCS0"}],"key":"dQULyuOjH3"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"QCcnb7DYg7"},{"type":"inlineCode","value":"t(i) + h == t(i)","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"Wa74VBZu0w"},{"type":"text","value":"on line 24 is to detect when ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"dMkvu2o47k"},{"type":"inlineMath","value":"h","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"W9WpX9RZIu"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"hbwWpK0bn0"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"r2kXVvJzmt"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"AqcJQBw0kZ"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"TIxcrCYIDQ"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"imCvh0x7ue"},{"type":"inlineCode","value":"break","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"rCyN0ebgZ0"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"hAhYbpEbwt"}],"key":"tBPwWaZZU9"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"On line 36, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"vJYGzG0Odb"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"R3YwRkdzOd"},{"type":"text","value":"5.7.6","key":"y7yyBgY9NE"},{"type":"text","value":")","key":"kmp9tvyNyv"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"zhdrneSA4M"},{"type":"text","value":". In lines 47--49 we underestimate the step factor ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"V7e0wCfVYf"},{"type":"inlineMath","value":"q","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"YokRAZaouM"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"G9kaGpEqEM"}],"key":"rFutVkqa70"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Finally, line 43 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"UzspLFV6nU"},{"type":"emphasis","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ubPTEhSHO4"}],"key":"ccH81UQv8i"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"C4msZlwDRE"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"ROMj8N7SwH"},{"type":"text","value":"6.5.5","key":"CtzEvwiTS4"},{"type":"text","value":")","key":"oHbxj2AqFi"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"VHVX85F5Gi"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"TJ751nuGk0"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"vim3SecdwQ"},{"type":"text","value":" to ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"nDjJYxDWUs"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ajW2pYUrsK"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"jkNdcrSwC6"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gGBh5IoWmI"},{"type":"text","value":" to ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"VauPzXLGTu"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rzeKsVOB4b"},{"type":"text","value":". By repurposing ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"YGK4mmSz2d"},{"type":"inlineCode","value":"s4","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"eJw8tbgEXT"},{"type":"text","value":" as ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"ij9jdH3TNn"},{"type":"inlineCode","value":"s1","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Xj79eCyDBf"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"bktYNO1P5k"},{"type":"inlineMath","value":"f","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"ziRSDPm0uR"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"FEH4plWzJW"}],"key":"pneN1t1CuG"}],"class":"dropdown","key":"KY1s3T4j4G"}],"label":"function-rk23-matlab","identifier":"function-rk23-matlab","html_id":"function-rk23-matlab","key":"GrXyvb36QB"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"4th-order Adams–Bashforth formula for an IVP","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"UpGmYYhHHN"}],"key":"K2I3XA1CL3"},{"type":"include","file":"../matlab/fnc/ab4.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [t, u] = ab4(ivp, a, b, n)\r\n%AB4     4th-order Adams-Bashforth formula for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\n% Constants in the AB4 method.\r\nk = 4;  \r\nsigma = [55; -59; 37; -9] / 24;  \r\n\r\n% Find starting values by RK4.\r\n[ts, us] = rk4(ivp, a, a + (k-1)*h, k-1);\r\nu = zeros(length(u0), n+1);\r\nu(:, 1:k) = us(:, 1:k);\r\n\r\n% Compute history of u' values, from oldest to newest.\r\nf = zeros(length(u0), k);\r\nfor i = 1:k-1\r\n  f(:, k-i) = du_dt(t(i), u(:, i), p);\r\nend\r\n\r\n% Time stepping.\r\nfor i = k:n\r\n  f = [du_dt(t(i), u(:, i), p), f(:, 1:k-1)];   % new value of du/dt\r\n  u(:, i+1) = u(:, i) + h * (f * sigma);        % advance one step\r\nend","lang":"matlab","showLineNumbers":true,"filename":"ab4.m","key":"oGhOHzMmeS"}],"key":"UsDOQgMdPB"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"owSwWzflRE"}],"key":"omeUUjKkCH"},{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Line 21 sets ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"qCvTFHgPFJ"},{"type":"inlineCode","value":"sigma","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"rhVwvRpfN3"},{"type":"text","value":" to be the coefficients of the generating polynomial ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"dBkOhzLhTA"},{"type":"inlineMath","value":"\\sigma(z)","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"TypOoZPvbD"},{"type":"text","value":" of AB4. Lines 24--26 set up the IVP over the time interval ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"RQVxxNMQIy"},{"type":"inlineMath","value":"a \\le t \\le a+3 h","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">a \\le t \\le a+3 h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"UWoHuTYXY9"},{"type":"text","value":", call ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"AUYO92w5Bb"},{"type":"inlineCode","value":"rk4","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"vum2DfqiXE"},{"type":"text","value":" to solve it using the step size ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"exa8hZs7an"},{"type":"inlineMath","value":"h","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"PhN1v1E35K"},{"type":"text","value":", and use the result to fill the first four values of the solution. Then lines 29--32 compute the vector ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"E2brcN9sN1"},{"type":"inlineMath","value":"[f_2,f_1,f_0]","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[f_2,f_1,f_0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"yrItFdpNqN"},{"type":"text","value":".","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"FcLHpuYwRu"}],"key":"EevgnB0cgk"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"Line 36 computes ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"FDDNLaEfC1"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tXMkCpFZlb"},{"type":"text","value":", based on the most recent solution value and time. That goes into the first column of ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"pSZeoKdcbC"},{"type":"inlineCode","value":"f","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"h6jeeWGnsB"},{"type":"text","value":", followed by the three values that were previously most recent. These are the four values that appear in ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"GHH7xq5nqa"},{"type":"crossReference","kind":"equation","identifier":"ab4","label":"ab4","children":[{"type":"text","value":"(","key":"SXfdCbG3s3"},{"type":"text","value":"6.7.1","key":"PiPZ3Dzb37"},{"type":"text","value":")","key":"Nh7UukN0Fg"}],"template":"(%s)","enumerator":"6.7.1","resolved":true,"html_id":"ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"HFUmeb9Xwx"},{"type":"text","value":". Each particular ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"gD82IY67mJ"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YwXS5lrSJk"},{"type":"text","value":" value starts at the front of ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"vUlegX9sjy"},{"type":"inlineCode","value":"f","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"mL0H101qTy"},{"type":"text","value":", moves through each position in the vector over three iterations, and then is forgotten.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"t69PvytfZs"}],"key":"NbPbUfAUlO"}],"class":"dropdown","key":"y8IwGZzUrp"}],"label":"function-ab4-matlab","identifier":"function-ab4-matlab","html_id":"function-ab4-matlab","key":"ijXkhIfAUx"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"2nd-order Adams–Moulton (trapezoid) formula for an IVP","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"VBWtkhPyQf"}],"key":"sFkryUm07k"},{"type":"include","file":"../matlab/fnc/am2.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [t, u] = am2(ivp, a, b, n)\r\n% AM2    2nd-order Adams-Moulton (trapezoid) formula for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0(:);\r\n\r\n% Time stepping.\r\nfor i = 1:n\r\n  % Data that does not depend on the new value.\r\n  known = u(:,i) + h/2 * du_dt(t(i), u(:, i), p);\r\n  % Find a root for the new value. \r\n  unew = levenberg(@trapzero, known);\r\n  u(:, i+1) = unew(:, end);\r\nend\r\n\r\n% This function defines the rootfinding problem at each step.\r\nfunction F = trapzero(z)\r\n    F = z - h/2 * du_dt(t(i+1), z, p) - known;\r\nend\r\n\r\nend  % main function","lang":"matlab","showLineNumbers":true,"filename":"am2.m","key":"VGFP7hgE1h"}],"key":"bh6B3dAj1Z"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"ou30uKIlTt"}],"key":"zu087lrSwM"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"Lines 32--34 define the function ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"XbIu6UBpMt"},{"type":"inlineMath","value":"\\mathbf{g}","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span></span></span></span>","key":"od8XCBZId5"},{"type":"text","value":". This is sent to ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"pGHE5Nxn1u"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"GylcuxX4ZN"},{"type":"text","value":" in line~27 to find the new solution value, using an Euler half-step as its starting value. A robust code would have to intercept the case where ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"ERyWedMk5m"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"gnwZCs7eFN"},{"type":"text","value":" fails to converge, but we have ignored this issue for the sake of brevity.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"u0SRNIg9gM"}],"key":"jh43C3rVtk"}],"class":"dropdown","key":"uUuew9p73x"}],"label":"function-am2-matlab","identifier":"function-am2-matlab","html_id":"function-am2-matlab","key":"NLsUuByqrg"},{"type":"heading","depth":2,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"zZQ31pfqOA"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"oWLLhXKqBp"}],"key":"kfuSAEW6Ye"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"addpath /Users/driscoll/Documents/GitHub/fnc/matlab/fnc\naddpath /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init","visibility":"show","key":"rd63cpepPA"},{"type":"output","id":"S8UMzcExmWFB8C91ADXLz","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n  Figure (1) with properties:\n\n      Number: 1\n        Name: ''\n       Color: [1 1 1]\n    Position: [1224 1070 560 420]\n       Units: 'pixels'\n\n  Use GET to show all properties\n","content_type":"text/plain"}}}],"visibility":"show","key":"unxdY9R803"}],"data":{"tags":[]},"visibility":"remove","key":"IJlEru022O"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"text","value":"Section 6.1","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"T76JAvBqHE"}],"identifier":"section-6-1","label":"Section 6.1","html_id":"section-6-1","implicit":true,"key":"se8mwQBhiO"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Solving an IVP","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"RLROWyADks"}],"key":"x6NBFDJbiP"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"Let’s use it to define and solve an initial-value problem for ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"I2s73gCMcJ"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"VPhbpXuKsy"},{"type":"text","value":" over ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"xdp72fCC5W"},{"type":"inlineMath","value":"t \\in [0,4]","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">t \\in [0,4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span>","key":"sGAJnjUkKX"},{"type":"text","value":", such that ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"vSbCuo86Oi"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"s2L7vvPiNt"},{"type":"text","value":". To create an initial-value problem for ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"YtNkdg2yGU"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"pRftGJhI0H"},{"type":"text","value":", you must create an ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"IvRAPJrcYM"},{"type":"inlineCode","value":"ode","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"TMtaZmovol"},{"type":"text","value":" with a function that computes ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"h5H6hdxztg"},{"type":"inlineMath","value":"u'","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"hvy1Nek1iF"},{"type":"text","value":" and an initial condition for ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"Ij0antvCd5"},{"type":"inlineMath","value":"u","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"J8BWER5yZM"},{"type":"text","value":". Then you create a solution by calling ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"xYQu3ehpWj"},{"type":"inlineCode","value":"solve","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"eVO8atJwTj"},{"type":"text","value":" with a time interval.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"KdRrNSfAOI"}],"key":"TqXwTEvEer"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Most real ODE problems contain parameters that are constant during the solution but that can change from one problem instance to the next. Accordingly, we define the ODE function below to accept a third argument, ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"V5ip1TFHGX"},{"type":"inlineCode","value":"p","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"B88J6KLQkH"},{"type":"text","value":", which is a vector of parameters. We always include this argument for consistency, even when there are no parameters.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"nh8WcVl0IQ"}],"key":"MEZWCbm6IA"}],"key":"W8l5HrnHNL"}],"key":"pGemBVSJQ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialTime = 0;\nivp.InitialValue = -1;\nsol = solve(ivp, 0, 4);","key":"deuWMzazgh"},{"type":"output","id":"_p3MG6QbktvE0N6relxkp","data":[],"key":"mFHA5yfJSk"}],"data":{},"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"ode","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"solve","kind":"entry"},"emphasis":true}],"label":"index-sD27i3EGd3","identifier":"index-sd27i3egd3","html_id":"index-sd27i3egd3","key":"ZQ8D7aissv"},{"type":"paragraph","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"children":[{"type":"text","value":"The resulting solution object has fields ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"pEaOku1a9r"},{"type":"inlineCode","value":"Time","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"l8AVvmVJWQ"},{"type":"text","value":" and ","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"pes6gFHHEt"},{"type":"inlineCode","value":"Solution","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"fs1F1nKJz5"},{"type":"text","value":" that contain the approximate values of the solution at automatically chosen times in the interval you provided.","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"Qy4cPBYVUX"}],"key":"DQEWyIllq1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(sol.Time, sol.Solution, '-o')\nxlabel(\"t\")\nylabel(\"u(t)\")\ntitle(\"Solution of an IVP\")","key":"zZ6z36rdNi"},{"type":"output","id":"4Ig0rMX1Ikp62IlFvF_44","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7a9fe53502885d83b85c1cfc1b2fa23d","path":"/fnc/build/7a9fe53502885d83b85c1cfc1b2fa23d.png"}}}],"key":"cAYeZums5J"}],"data":{},"key":"TxQKbKWm77"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"You might want to know the solution at particular times other than the ones selected by the solver. That requires an interpolation, which is done by ","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"aRlw1llm54"},{"type":"inlineCode","value":"solutionFcn","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"bkpmdYZQO1"},{"type":"text","value":".","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"WcPpNCjdQY"}],"key":"MRv1wjkQ2S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = solutionFcn(ivp, 0, 10);\nu(0:5)","key":"izbVx04LYa"},{"type":"output","id":"JqE-5n-yO3e5Ub2u79fN_","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×6 double\n   -1.0000   -0.7989   -0.2856   -0.9272   -1.8814   -2.8645\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×6 double\n   -1.0000   -0.7989   -0.2856   -0.9272   -1.8814   -2.8645\n","content_type":"text/plain"}}}],"key":"BdcE4hmrNg"}],"data":{},"key":"npM7u8DWya"}],"label":"demo-basics-first-matlab","identifier":"demo-basics-first-matlab","html_id":"demo-basics-first-matlab","key":"iLQEiAyt07"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Finite-time singularity","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"BchwwouiMu"}],"key":"en3JHTteh1"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"The equation ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"n7zdyKxiOc"},{"type":"inlineMath","value":"u'=(u+t)^2","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=(u+t)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"uluSFiyJ6x"},{"type":"text","value":" gives us some trouble.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"gLerfETEDE"}],"key":"bCUGZGyAS6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) (t + u)^2;\nivp.InitialTime = 0;\nivp.InitialValue = 1;\nsol = solve(ivp, 0, 1);","key":"ObExmlqW48"},{"type":"output","id":"0zd87gTrsq0NEBX8lO9kB","data":[{"output_type":"stream","name":"stderr","text":"Warning: Failure at t=7.853789e-01.  Unable to meet integration tolerances without reducing the step size below the smallest value allowed (1.776357e-15) at time t."}],"key":"o7WZFSGUIN"}],"data":{},"key":"gWt8Duewe5"},{"type":"paragraph","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"The warning message we received can mean that there is a bug in the formulation of the problem. But if everything has been done correctly, it suggests that the solution may not exist past the indicated time. This is a possibility in nonlinear ODEs.","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"I0GJX9GSrx"}],"key":"PQ5ydwavsv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nsemilogy(sol.Time, sol.Solution)\nxlabel(\"t\")\nylabel(\"u(t)\")\ntitle(\"Finite-time blowup\")","key":"OCPzbEyU9z"},{"type":"output","id":"Otg5HfrR88YLw84o8wcgG","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"48d4c93a9fe540eb6df31da0e2b5d95b","path":"/fnc/build/48d4c93a9fe540eb6df31da0e2b5d95b.png"}}}],"key":"oIf8sWC4sV"}],"data":{},"key":"RQGQ7GD165"}],"label":"demo-basics-sing-matlab","identifier":"demo-basics-sing-matlab","html_id":"demo-basics-sing-matlab","key":"cPSGRAHifq"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Conditioning of an IVP","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"w0TkYwxeye"}],"key":"UaY0P86Yin"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Consider the ODEs ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"zBWIMf6wz3"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"hjGOzd72jR"},{"type":"text","value":" and ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"AloGMUO7lP"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"MdHUXRajtM"},{"type":"text","value":". In each case we compute ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"w0XILzruLX"},{"type":"inlineMath","value":"\\partial f/\\partial u = \\pm 1","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∂</mi><mi>u</mi><mo>=</mo><mo>±</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\partial f/\\partial u = \\pm 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\">/</span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord\">1</span></span></span></span>","key":"c3F57lOYs0"},{"type":"text","value":", so the condition number bound from ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"kuuAY0SiaU"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-depic","label":"theorem-depIC","children":[{"type":"text","value":"Theorem ","key":"faf6vNdWIK"},{"type":"text","value":"6.1.2","key":"cqS6abKFC2"}],"template":"Theorem %s","enumerator":"6.1.2","resolved":true,"html_id":"theorem-depic","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"pPGJvyD2oB"},{"type":"text","value":" is ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"XxI7chIah1"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"UJV0aIGYAc"},{"type":"text","value":" in both problems. However, they behave quite differently. In the case of exponential growth, ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"IrUQwHmkIj"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"akmsbhnwjb"},{"type":"text","value":", the bound is the actual condition number.","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"QBxEt2BsZ1"}],"key":"atKNskSNAj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor u0 = [0.7, 1, 1.3]    % initial values\n    fplot(@(t) exp(t) * u0, [0, 3]), hold on\nend\nxlabel('t')\nylabel('u(t)')   % ignore this line\ntitle('Exponential divergence of solutions')   % ignore this line","visibility":"hide","key":"t2TLvDKr2A"},{"type":"output","id":"S2Duy0O2gZdXvhO8U3c00","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"51509341e6b5c56c96e578ce64e18453","path":"/fnc/build/51509341e6b5c56c96e578ce64e18453.png"}}}],"visibility":"show","key":"MQZyK4Uanh"}],"data":{"tags":[]},"visibility":"show","key":"CCcImk8F3Y"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"But with ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"bfJyM4pDQj"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"noWNM00HGG"},{"type":"text","value":", solutions actually get closer together with time.","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"lGAs5ZUAkF"}],"key":"nSKrDTdAhJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor u0 = [0.7, 1, 1.3]    % initial values\n    fplot(@(t) exp(-t) * u0, [0, 3]), hold on\nend\nxlabel('t')\nylabel('u(t)')   % ignore this line\ntitle('Exponential convergence of solutions')   % ignore this line","visibility":"hide","key":"A3tTCBG3FR"},{"type":"output","id":"3feS7q3lxTbMFihRFtFtO","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02e4571c9a0c0069a21e0f9d98057a5a","path":"/fnc/build/02e4571c9a0c0069a21e0f9d98057a5a.png"}}}],"visibility":"show","key":"hRYd7pCbSn"}],"data":{"tags":[]},"visibility":"show","key":"CYl0uNezS5"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"In this case the actual condition number is one, because the initial difference between solutions is the largest over all time. Hence the exponentially growing bound ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"hj7wkPUMB0"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"ImILYaDV5I"},{"type":"text","value":" is a gross overestimate.","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"tz2CJeaKfV"}],"key":"JnxMOst578"}],"label":"demo-basics-cond-matlab","identifier":"demo-basics-cond-matlab","html_id":"demo-basics-cond-matlab","key":"HcGJkjrTC6"},{"type":"heading","depth":3,"position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Section 6.2","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"tlr0OGRDiP"}],"identifier":"section-6-2","label":"Section 6.2","html_id":"section-6-2","implicit":true,"key":"JgEWettca5"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Euler’s method","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"JCY1dyn7Ew"}],"key":"iAeIZjNmvP"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"We consider the IVP ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"TCHOQ1izyt"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"HSamzVbVMv"},{"type":"text","value":" over ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"HillXFoINk"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"igEOrlCp5W"},{"type":"text","value":", with ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"aAyoItNqrP"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"o4SjwxXygw"},{"type":"text","value":". We need to define the function for the right-hand side of the ODE, the interval for the independent variable, and the initial value.","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"sJFmRdgdfS"}],"key":"wmuHexUGb8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialValue = -1;\na = 0;  b = 4;","key":"vN5bzXMPsa"},{"type":"output","id":"c2zP5wLkZyZipE27chGCX","data":[],"key":"ulAgudN73k"}],"data":{},"key":"MSxqNa95fH"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"Here is the call to ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"dZIh9v08PF"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"XPabZ8cox1"},{"type":"text","value":"6.2.2","key":"c7JiuilX7v"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"g8SUABJaBv"},{"type":"text","value":".","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"uBKBSXE3cZ"}],"key":"sEQb0YLa6E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, u] = eulerivp(ivp, a, b, 20);\nclf, plot(t, u, '.-')\nxlabel('t')\nylabel('u(t)')\ntitle('Solution by Euler''s method')  % ignore this line","key":"xTorAP3QLJ"},{"type":"output","id":"15YwfFnLjjMLqYyN_dAoy","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e225f40d300a28dce180fc92d46985f2","path":"/fnc/build/e225f40d300a28dce180fc92d46985f2.png"}}}],"key":"DA4x0ytNIq"}],"data":{},"key":"nPPwCCdpa5"},{"type":"paragraph","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"We could define a different interpolant to get a smoother picture above, but the derivation of Euler’s method assumed a piecewise linear interpolant. We can instead request more steps to make the interpolant look smoother.","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"qzXPSm2GGi"}],"key":"ACgF8Y9v86"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, u] = eulerivp(ivp, a, b, 50);\nhold on, plot(t, u, '.-')\nlegend('20 steps', '50 steps')","key":"A0tn1QXIo9"},{"type":"output","id":"EvttUU4XXSRmU8ewB7cT9","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a12655510bc8cfdba9e977e258a4ef66","path":"/fnc/build/a12655510bc8cfdba9e977e258a4ef66.png"}}}],"key":"SHGE86kDuj"}],"data":{},"key":"VRuWnnjxW1"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"Increasing ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"FkH3QwbllF"},{"type":"inlineMath","value":"n","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"ei3DE2pOyv"},{"type":"text","value":" changed the solution noticeably. Since we know that interpolants and finite differences become more accurate as ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"Q0Aoa9vE3R"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"LVASJtVK5C"},{"type":"text","value":", we should anticipate the same behavior from Euler’s method. We don’t have an exact solution to compare to, so we will use a built-in solver to construct an accurate reference solution.","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"CWJL1btGwM"}],"key":"klYW6lNMK8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp.AbsoluteTolerance = 1e-13;\nivp.RelativeTolerance = 1e-13;\nu_exact = solutionFcn(ivp, a, b);","key":"cXJuV0Kwuk"},{"type":"output","id":"zKyDikAkBm74gVa6K9nhR","data":[],"key":"UkUjV13BVe"}],"data":{},"key":"KJWdBsPR8j"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"Now we can perform a convergence study.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"vKyxI5I7Cj"}],"key":"hUXCxPX0SG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round(5 * 10.^(0:0.5:3));\nerr = [];\nfor k = 1:length(n)\n    [t, u] = eulerivp(ivp, a, b, n(k));\n    err(k) = norm(u_exact(t) - u, Inf);\nend\ntable(n', err', VariableNames=[\"n\", \"inf-norm error\"])","key":"NWszMRjsC9"},{"type":"output","id":"WLUDwi_vYfppyd_EJIc8e","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>7x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>5</td><td>2.7342</td></tr><tr><td>16</td><td>0.1076</td></tr><tr><td>50</td><td>0.0300</td></tr><tr><td>158</td><td>0.0089</td></tr><tr><td>500</td><td>0.0027</td></tr><tr><td>1581</td><td>8.5965e-04</td></tr><tr><td>5000</td><td>2.7124e-04</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>7x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>5</td><td>2.7342</td></tr><tr><td>16</td><td>0.1076</td></tr><tr><td>50</td><td>0.0300</td></tr><tr><td>158</td><td>0.0089</td></tr><tr><td>500</td><td>0.0027</td></tr><tr><td>1581</td><td>8.5965e-04</td></tr><tr><td>5000</td><td>2.7124e-04</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"VXZtG3du5w"}],"data":{},"key":"lQrCBXX4dN"},{"type":"paragraph","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"children":[{"type":"text","value":"The error is approximately cut by a factor of 10 for each increase in ","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"aAFYUbtcFg"},{"type":"inlineMath","value":"n","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"BlLi2Q81JW"},{"type":"text","value":" by the same factor. A log-log plot also confirms first-order convergence. Keep in mind that since ","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"W9mfLRNDFx"},{"type":"inlineMath","value":"h=(b-a)/n","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">h=(b-a)/n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"nvBvA3pkkr"},{"type":"text","value":", it follows that ","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"WpZFXzZ4XU"},{"type":"inlineMath","value":"O(h)=O(n^{-1})","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h)=O(n^{-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"gBCFfJXrYO"},{"type":"text","value":".","position":{"start":{"line":239,"column":1},"end":{"line":239,"column":1}},"key":"JFIoLk0Exy"}],"key":"nxy7n3OEVW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n, err, 'o-')\nhold on, loglog(n, 0.5 * err(end) * (n / n(end)).^(-1), '--')\nxlabel('n')\nylabel('inf-norm error')  % ignore this line\ntitle('Convergence of Euler''s method')  % ignore this line\nlegend('error', 'O(n^{-1})', 'location', 'southwest')  % ignore this line","key":"pF23tnRMIA"},{"type":"output","id":"opfOrc5CNNtkbv9Ia9fwl","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"222677a230036435db32677afa45fc9c","path":"/fnc/build/222677a230036435db32677afa45fc9c.png"}}}],"key":"IyxyzlZaWq"}],"data":{},"key":"HZDToIOivl"}],"label":"demo-euler-converge-matlab","identifier":"demo-euler-converge-matlab","html_id":"demo-euler-converge-matlab","key":"D6Zk7qa9qQ"},{"type":"heading","depth":3,"position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"Section 6.3","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"IVhF4jBreA"}],"identifier":"section-6-3","label":"Section 6.3","html_id":"section-6-3","implicit":true,"key":"z6a3uDNp7c"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Predator-prey model","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"sNYbf50zSe"}],"key":"vUD4wqqU3h"},{"type":"paragraph","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"We encode the predator–prey equations via a function, defined here externally.","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"CbdjNlJ5w2"}],"key":"QTLE8G34rq"},{"type":"include","file":"f63_predprey.m","literal":true,"filter":{},"children":[{"type":"code","value":"function du_dt = predprey(t, u, p)\n    alpha = p(1);  beta = p(2);\n    y = u(1);      z = u(2);\n    s = (y * z) / (1 + beta * y);  % appears in both equations\n    du_dt = [ y * (1 - alpha * y) - s;  -z + s ];\nend\n","lang":"matlab","filename":"f63_predprey.m","key":"sOkZNjvkIq"}],"key":"opvwbs66mj"},{"type":"paragraph","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"The values of ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"jsvEWpPxvQ"},{"type":"inlineCode","value":"alpha","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"Y1QlHldMZM"},{"type":"text","value":" and ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"maYooM9NdW"},{"type":"inlineCode","value":"beta","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"tq8zlN5HOw"},{"type":"text","value":" are parameters that influence the solution of the IVP. We use the ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"EXIFw6NoZa"},{"type":"inlineCode","value":"Parameters","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"Ogof2UUYOd"},{"type":"text","value":" field of the IVP object to define them for the solver, which in turn passes them as the third argument into our ODE function.","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"yrCxQUbX4z"}],"key":"U1RX0mjzsw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u0 = [1; 0.01];    % column vector\np = [0.1, 0.25];\nivp = ode;\nivp.ODEFcn = @f63_predprey;\nivp.InitialValue = u0;\nivp.Parameters = p;\nsol = solve(ivp, 0, 60);\nsize(sol.Solution)","key":"ZG6FcIxQh6"},{"type":"output","id":"1I5z7jZJyUPZpbozD1LOa","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n     2   341\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     2   341\n","content_type":"text/plain"}}}],"key":"sI4tu3qWUI"}],"data":{},"key":"FDyZm0g4dE"},{"type":"paragraph","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"Each column of the ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"lKIVtS28xH"},{"type":"inlineCode","value":"Solution","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"l0vM4yIQd6"},{"type":"text","value":" field is the solution vector ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"HPGvs4lPVC"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"wAF5fqX4Gi"},{"type":"text","value":" at a particular time; each row is a component of ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"EPe1pNguia"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"epEjMorJ92"},{"type":"text","value":" over all time.","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"DmdAZ2Cqfz"}],"key":"bfVshOHetF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(sol.Time, sol.Solution)\nxlabel(\"t\")\nylabel(\"u(t)\")\ntitle('Predator-prey solution')  % ignore this line\nlegend('prey', 'predator')  % ignore this line","key":"ACgCiDAsMC"},{"type":"output","id":"pjeSh8FxIq5FVKpnmHScU","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"67234df9a5a12e826624a3162e3a7ace","path":"/fnc/build/67234df9a5a12e826624a3162e3a7ace.png"}}}],"key":"YMJf7B7e2r"}],"data":{},"key":"iwLSSaVqne"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"We can also use ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"rbX3rjoarW"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"Npdlmn3yE5"},{"type":"text","value":"6.2.2","key":"xCXxzu6S6Z"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"Llfhs29F0C"},{"type":"text","value":" to find the solution.","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"L70mgJ6tvC"}],"key":"Uxg6E7xHpu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, u] = eulerivp(ivp, 0, 60, 1200);","key":"ucwf6hK6u7"},{"type":"output","id":"kF_zgidLg4QvW3OxGGzQF","data":[{"output_type":"stream","name":"stderr","text":"Index exceeds the number of array elements. Index must not exceed 1.\n\nError in f63_predprey (line 3)\n    y = u(1);      z = u(2);\n\nError in eulerivp (line 25)\n  u(:, i+1) = u(:, i) + h * du_dt(t(i), u(i), p);"}],"key":"OyjBMvKinj"}],"data":{},"key":"kJP37abPxu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nplot(t, u, '.')","key":"oqDHRdF92Z"},{"type":"output","id":"TLBmdVHSimgoVDhNjoJ4P","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"931581e69282b257182e809435c2a674","path":"/fnc/build/931581e69282b257182e809435c2a674.png"}}}],"key":"prGVPDVnNz"}],"data":{},"key":"pbicjCF0st"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"Notice above that the accuracy of the Euler solution deteriorates rapidly.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"vwRHmIpfBn"}],"key":"oFwViQYitj"},{"type":"paragraph","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"When there are just two components, it’s common to plot the solution in the ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"m5ABosWsCL"},{"type":"emphasis","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"phase plane","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"IPemMj8CMb"}],"key":"k8qsMOR3pw"},{"type":"text","value":", i.e., with ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"VSvMs3qkLx"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"DWMHI49PXj"},{"type":"text","value":" and ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"RK5p1jBBPA"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"U3XH2UsE6O"},{"type":"text","value":" along the axes and time as a parameterization of the curve.","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"LjztAr8hw3"}],"key":"PhP9frHLL7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(u(1, :), u(2, :))\ntitle(\"Predator-prey in the phase plane\")\nxlabel(\"y\")\nylabel(\"z\")","key":"QBFQHcdepd"},{"type":"output","id":"oCeBVchBesrVuOmj0csef","data":[{"output_type":"stream","name":"stderr","text":"Index in position 1 exceeds array bounds. Index must not exceed 1."}],"key":"PVsNTEwWbs"}],"data":{},"key":"u1p1bIpaQK"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"From this plot we can deduce that the solution approaches a periodic one, which in the phase plane is represented by a closed loop.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"mROr1AYiKK"}],"key":"Q5U5s9SbYO"}],"label":"demo-systems-predator-matlab","identifier":"demo-systems-predator-matlab","html_id":"demo-systems-predator-matlab","key":"g5lEsOO2sF"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Coupled pendulums","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"CdsU5GzdeJ"}],"key":"ICDxRFEULo"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"k19ODlQ9j9"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"uhxq1PhOk0"},{"type":"text","value":"6.3.4","key":"MDpiA1Htis"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"eiOauu0R2k"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"gM8KeWedve"}],"key":"MePdKqKKOL"},{"type":"include","file":"f63_pendulums.m","literal":true,"filter":{},"children":[{"type":"code","value":"function udot = pendulums(t, u, p)\n    gamma = p(1);  L = p(2);  k = p(3);\n    g = 9.8;\n    udot = zeros(4, 1);\n    udot(1:2) = u(3:4);\n    udot(3) = -gamma * u(3) - (g / L) * sin(u(1)) + k * (u(2) - u(1));\n    udot(4) = -gamma * u(4) - (g / L) * sin(u(2)) + k * (u(1) - u(2));\nend\n","lang":"matlab","filename":"f63_pendulums.m","key":"ybIeXFTu5R"}],"key":"juFJqRHD0D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u0 = [1.25; -0.5; 0; 0];\na = 0; b = 50;","key":"cqUOtfBKgp"},{"type":"output","id":"GiX2q8R6S8L97a9fjRkhp","data":[],"key":"lmUdsPZ35a"}],"data":{},"key":"E10Uric81z"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"LRM6wQzkbZ"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"jP4bIxX86k"},{"type":"text","value":".","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"kvzRQLG2uv"}],"key":"tIdeWMvJuj"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"yo9tg4JPoh"},{"type":"inlineCode","value":"OutputVariables","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"zkKak47tVL"},{"type":"text","value":" is used to restrict output to just ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"KmawmMhpUB"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MhGVcbajCS"},{"type":"text","value":" and ","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"GjbGQK6L0a"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sBpR1ARyOi"},{"type":"text","value":".","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"wd28ImaJrY"}],"key":"UdtmEgo6m7"}],"key":"ZXOBAK7g4U"}],"key":"omGcEcmf4y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"params =[0.01, 0.5, 0];    % gamma, L, k\nivp = ode(ODEFcn=@f63_pendulums, InitialValue=u0, Parameters=params);\ntheta = solutionFcn(ivp, a, b, OutputVariables = 1:2);\nt = linspace(a, b, 1001);\nclf, plot(t, theta(t))\nxlabel(\"t\");  ylabel(\"angle\")\ntitle(\"Uncoupled pendulums\")\nlegend(\"\\theta_1\", \"\\theta_2\")","key":"LmtzLbWGUk"},{"type":"output","id":"nAcmQhyItxDOsWEKPUK3c","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cdff49e46f1226782f9771de37b6a8b4","path":"/fnc/build/cdff49e46f1226782f9771de37b6a8b4.png"}}}],"key":"qyDKGoxCgw"}],"data":{},"key":"Alnn9zS7Kp"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently. Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"sFb81PI30b"}],"key":"XvTOlp3jZa"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"WETCDrFwJH"}],"key":"Z45ZsH9v46"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"params(3) = 1;\nivp = ode(ODEFcn=@f63_pendulums, InitialValue=u0, Parameters=params);\ntheta = solutionFcn(ivp, a, b, OutputVariables = 1:2);\nclf, plot(t, theta(t))\nxlabel(\"t\");  ylabel(\"angle\")\ntitle(\"Coupled pendulums\")\nlegend(\"\\theta_1\", \"\\theta_2\")","key":"fx23JaOwJM"},{"type":"output","id":"KKJH_oQXbOQ-2eP04ecfU","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7f96ad428f16b83ea5522e04d1849440","path":"/fnc/build/7f96ad428f16b83ea5522e04d1849440.png"}}}],"key":"KmNXAlHOaN"}],"data":{},"key":"ztnhZ9rdO0"},{"type":"paragraph","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth.","position":{"start":{"line":356,"column":1},"end":{"line":356,"column":1}},"key":"TwDiQRueyg"}],"key":"PbJ0UhMBfd"}],"label":"demo-systems-coupledpendula-matlab","identifier":"demo-systems-coupledpendula-matlab","html_id":"demo-systems-coupledpendula-matlab","key":"KXWBjnzC28"},{"type":"heading","depth":3,"position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"Section 6.4","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"rjBZ3PXhvH"}],"identifier":"section-6-4","label":"Section 6.4","html_id":"section-6-4","implicit":true,"key":"JeL6UYTWR9"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Runge–Kutta methods","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"Buq4PPewoI"}],"key":"GEGAKZBs1V"},{"type":"paragraph","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"children":[{"type":"text","value":"We solve the IVP ","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"key":"fd1BykgK2t"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"KPrGOEP9SQ"},{"type":"text","value":" over ","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"key":"aOA01aTa1o"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"SZPflDFyJG"},{"type":"text","value":", with ","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"key":"GYcVfHcCDm"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"B8Mlqr4CzF"},{"type":"text","value":".","position":{"start":{"line":363,"column":1},"end":{"line":363,"column":1}},"key":"LPe4ObKcKf"}],"key":"YYxR6AXtMU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialValue = -1;\na = 0;  b = 4;","key":"P7QLZohEf0"},{"type":"output","id":"alGn02zKOXvijUV068x8b","data":[],"key":"PN9l9zopGY"}],"data":{},"key":"a9hlp4tu1k"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"We use a built-in solver to construct an accurate approximation to the exact solution.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"jvYClCejKj"}],"key":"eJIgvFK708"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp.AbsoluteTolerance = 1e-13;\nivp.RelativeTolerance = 1e-13;\nu_ref = solutionFcn(ivp, a, b);","key":"HjMhWk7kQ3"},{"type":"output","id":"3l4qQCzplea8Ju0GxuZSE","data":[],"key":"NdmZ1RIpRx"}],"data":{},"key":"Q1uCLLT6fG"},{"type":"paragraph","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of our two Runge–Kutta implementations.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"Uu9JQHy6Uv"}],"key":"VdMDDdMYP9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round(2 * 10.^(0:0.5:3)');\nerr = zeros(length(n), 2);\nfor i = 1:length(n)\n    [t, u] = ie2(ivp, a, b, n(i));\n    err(i, 1) = norm(u_ref(t) - u, Inf);\n    [t, u] = rk4(ivp, a, b, n(i));\n    err(i, 2) = norm(u_ref(t) - u, Inf);\nend\n\ndisp(table(n, err(:, 1), err(:, 2), variableNames=[\"n\", \"IE2 error\", \"RK4 error\"]))","key":"MN1RnPPoTr"},{"type":"output","id":"5abuMQJKJYnPUcni1mveJ","data":[{"output_type":"stream","name":"stdout","text":"     n      IE2 error     RK4 error \n"},{"output_type":"stream","name":"stdout","text":"    ____    __________    __________\n\n"},{"output_type":"stream","name":"stdout","text":"       2         1.769       0.82065\n"},{"output_type":"stream","name":"stdout","text":"       6       0.51268       0.79192\n"},{"output_type":"stream","name":"stdout","text":"      20      0.024059    0.00081269\n"},{"output_type":"stream","name":"stdout","text":"      63     0.0022533    8.0622e-06\n"},{"output_type":"stream","name":"stdout","text":"     200    0.00022242    7.6066e-08\n"},{"output_type":"stream","name":"stdout","text":"     632    2.2253e-05     7.515e-10\n"},{"output_type":"stream","name":"stdout","text":"    2000    2.2218e-06    7.6541e-12\n"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"lujthKRzUw"}],"data":{},"key":"WDWIr3g2XC"},{"type":"paragraph","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"children":[{"type":"text","value":"The amount of computational work at each time step is assumed to be proportional to the number of stages. Let’s compare on an apples-to-apples basis by using the number of ","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"mooEjdHdAg"},{"type":"inlineMath","value":"f","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"tKaH7DA5xU"},{"type":"text","value":"-evaluations on the horizontal axis.","position":{"start":{"line":395,"column":1},"end":{"line":395,"column":1}},"key":"Y6w33lw4ns"}],"key":"wcHSEUHuC2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, loglog([2*n 4*n], err, '-o')\nhold on\nloglog(2*n, 1e-5 * (n / n(end)) .^ (-2), '--')\nloglog(4*n, 1e-10 * (n / n(end)) .^ (-4), '--')\nxlabel(\"f-evaluations\");  ylabel(\"inf-norm error\")\ntitle(\"Convergence of RK methods\")\nlegend(\"IE2\", \"RK4\", \"O(n^{-2})\", \"O(n^{-4})\", \"location\", \"southwest\")","key":"qnkkO0JfnA"},{"type":"output","id":"tbvS691G16IU5xxnP0lvJ","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"024922aa24bf10705e12652e59a14647","path":"/fnc/build/024922aa24bf10705e12652e59a14647.png"}}}],"key":"PZPeKKxZPP"}],"data":{},"key":"pNysgG2mu1"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"The fourth-order variant is more efficient in this problem over a wide range of accuracy.","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"rlO92kbfuI"}],"key":"AcU4IAMKYR"}],"label":"demo-rk-converge-matlab","identifier":"demo-rk-converge-matlab","html_id":"demo-rk-converge-matlab","key":"e58o1SStKz"},{"type":"heading","depth":3,"position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"children":[{"type":"text","value":"Section 6.5","position":{"start":{"line":410,"column":1},"end":{"line":410,"column":1}},"key":"hBENQwbNb8"}],"identifier":"section-6-5","label":"Section 6.5","html_id":"section-6-5","implicit":true,"key":"Nza94XlePS"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Adaptive step size","position":{"start":{"line":412,"column":1},"end":{"line":412,"column":1}},"key":"YZWIayFHYl"}],"key":"RwlEZ9nrmX"},{"type":"paragraph","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"fXjBCoQv0X"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"WUNNu3ClFj"},{"type":"text","value":".","position":{"start":{"line":413,"column":1},"end":{"line":413,"column":1}},"key":"LxnTdTjHa3"}],"key":"GH1Sc62e7I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) exp(t - u * sin(u));\nivp.InitialValue = 0;\na = 0;  b = 5;\n\n[t, u] = rk23(ivp, a, b, 1e-5);\nclf, plot(t, u)\nxlabel(\"t\");  ylabel(\"u(t)\")\ntitle(\"Adaptive IVP solution\")","key":"gZxzWtO5i5"},{"type":"output","id":"LDdFf0-iittxALxWxOXp2","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad3e012fd036df1ce13f3b1a1a135db4","path":"/fnc/build/ad3e012fd036df1ce13f3b1a1a135db4.png"}}}],"key":"rTC1oriJvY"}],"data":{},"key":"DzWUbawECi"},{"type":"paragraph","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"IBmpztOJQ7"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"SnCsja35c8"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"e3HPNDQCgK"}],"key":"fAEuExriPC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Delta_t = diff(t);\nsemilogy(t(1:end-1), Delta_t) \nxlabel(\"t\");  ylabel(\"step size\")\ntitle(\"Adaptive step sizes\")","key":"u1BZzPmkSy"},{"type":"output","id":"DMMcAJvEo0cpefhj47Of8","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a51df1bc85a9122b8fbae8a3333d23ef","path":"/fnc/build/a51df1bc85a9122b8fbae8a3333d23ef.png"}}}],"key":"DIowMq0ClY"}],"data":{},"key":"sN9tLCARGu"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"tCXmg6NoeR"}],"key":"sipLLwHzmf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"minimum step size = %.2e\", min(Delta_t))","key":"CKUqEsKUwc"},{"type":"output","id":"uYHnDffQ-QyPcT6A8Ix5t","data":[{"output_type":"stream","name":"stdout","text":"minimum step size = "},{"output_type":"stream","name":"stdout","text":"4.61e-05"}],"key":"Brl4P1JxlC"}],"data":{},"key":"LMBCDjbziJ"},{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"dg2hTEhrYi"}],"key":"bCFrNd2uul"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"average step size = %.2e\", mean(Delta_t))","key":"BUePXnQks2"},{"type":"output","id":"RZiDs5l3sjUaXaRNwE_sl","data":[{"output_type":"stream","name":"stdout","text":"average step size = "},{"output_type":"stream","name":"stdout","text":"3.21e-02"}],"key":"A4JTtjOhbj"}],"data":{},"key":"cfCGfGc7Dk"},{"type":"paragraph","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"qAmcowIEID"}],"key":"NewZLH3Ahw"}],"label":"demo-adapt-basic-matlab","identifier":"demo-adapt-basic-matlab","html_id":"demo-adapt-basic-matlab","key":"qoCuodsaCa"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Adaptive step size near a singularity","position":{"start":{"line":453,"column":1},"end":{"line":453,"column":1}},"key":"qzz4LcpDAq"}],"key":"KC93z0EQvo"},{"type":"paragraph","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"twcDirenm3"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-sing","label":"demo-basics-sing","children":[{"type":"text","value":"Demo ","key":"zWINJ3aktZ"},{"type":"text","value":"6.1.3","key":"ptjqaCyU1p"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"LBYngHzKT9"},{"type":"text","value":" we saw an IVP that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"RRxXRQkRb7"}],"key":"Mgd6uZV1hH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) (t + u)^2;\nivp.InitialValue = 1;\n[t, u] = rk23(ivp, 0, 1, 1e-5);","key":"rbaLhPD1ld"},{"type":"output","id":"YctZc3jIu_61NwgxkMFzC","data":[{"output_type":"stream","name":"stderr","text":"Warning: Stepsize too small near t=0.785409."}],"key":"oGgq0sSRxG"}],"data":{},"key":"NyZ3StH1oH"},{"type":"paragraph","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":463,"column":1},"end":{"line":463,"column":1}},"key":"L3oBKT9I7V"}],"key":"bXyM1b9Yln"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, semilogy(t, u)\nxlabel(\"t\");  ylabel(\"u(t)\")\ntitle(\"Adaptive solution near a singularity\")\n\ntf = t(end);\nxline(tf, \"linestyle\", \"--\")\ntext(tf, 1e5, sprintf(\" t = %.6f \", tf))","key":"J7tORYbExa"},{"type":"output","id":"2aPYynLWvnmbTstRjVJ6G","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a584c51f6a6b2014d527994c084021ae","path":"/fnc/build/a584c51f6a6b2014d527994c084021ae.png"}}}],"key":"quSqeauL5r"}],"data":{},"key":"x9sPRwPEBY"}],"label":"demo-adpat-sing-matlab","identifier":"demo-adpat-sing-matlab","html_id":"demo-adpat-sing-matlab","key":"fSYprAVPSM"},{"type":"heading","depth":3,"position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"children":[{"type":"text","value":"Section 6.6","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"fi2XTaKrXw"}],"identifier":"section-6-6","label":"Section 6.6","html_id":"section-6-6","implicit":true,"key":"Xu6VhjJyAp"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Adams–Bashforth","position":{"start":{"line":477,"column":1},"end":{"line":477,"column":1}},"key":"MmSYM8I9cX"}],"key":"lQsbnTfx43"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"We study the convergence of AB4 using the IVP ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"gjfpJjt6fu"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"r7janw4mHY"},{"type":"text","value":" over ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"VEewUriWNd"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"IzNa9s1voz"},{"type":"text","value":", with ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"a5olESmDdt"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"uG73YcXkbJ"},{"type":"text","value":". As usual, a built-in solver is called to give an accurate reference solution.","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"S9qM9Ud9CN"}],"key":"NeIIsGXXAS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialValue = -1;\na = 0;  b = 4;\nivp.AbsoluteTolerance = 1e-13;\nivp.RelativeTolerance = 1e-13;\nu_ref = solutionFcn(ivp, a, b);","key":"pKTdTaNBxH"},{"type":"output","id":"1HlFONjONYmICXs2OyQDL","data":[],"key":"rluqYf1mx4"}],"data":{},"key":"tVlq9yciSS"},{"type":"paragraph","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of the AB4 code.","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":1}},"key":"J2Fgu4SXd6"}],"key":"nWT5WYskYP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round(4 * 10.^(0:0.5:3)');\nerr = [];\nfor i = 1:length(n)\n    [t, u] = ab4(ivp, a, b, n(i));\n    err(i) = norm(u_ref(t) - u, Inf);\nend\n\ndisp(table(n, err, variableNames=[\"n\", \"inf-norm error\"]))","key":"jRTrhraWDX"},{"type":"output","id":"4izmnHvP3aHlB6UhigboW","data":[{"output_type":"stream","name":"stderr","text":"Error using table (line 56)\nAll table variables must have the same number of rows."}],"key":"W6skzJXpe8"}],"data":{},"key":"mKPZ7nQRp7"},{"type":"paragraph","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"children":[{"type":"text","value":"The method should converge as ","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"kqNZUalwTd"},{"type":"inlineMath","value":"O(h^4)","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>4</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h^4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"CwKwZRM7Et"},{"type":"text","value":", so a log-log scale is appropriate for the errors.","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"jIoQ2ohF7N"}],"key":"IhB4CGFssg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, loglog(n, err, '-o')\nhold on\nloglog(n, 0.5 * err(end) * (n / n(end)) .^ (-4), '--')\nxlabel(\"n\");  ylabel(\"inf-norm error\")\ntitle(\"Convergence of AB4\")\nlegend(\"AB4\", \"O(n^{-4})\", \"location\", \"southwest\")","key":"k3MPSjU5sS"},{"type":"output","id":"znejJtEEUvSNJlhPs5Pub","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f0683e702e8fd50c525a6c36735b0d1d","path":"/fnc/build/f0683e702e8fd50c525a6c36735b0d1d.png"}}}],"key":"t9JsmYFaIK"}],"data":{},"key":"VcxG59xZnP"}],"label":"demo-implicit-ab4-matlab","identifier":"demo-implicit-ab4-matlab","html_id":"demo-implicit-ab4-matlab","key":"fVKhDitlcC"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Stiffness","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"cfUbn9gGas"}],"key":"TSvtHkh5yA"},{"type":"paragraph","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"children":[{"type":"text","value":"The following simple ODE uncovers a surprise.","position":{"start":{"line":517,"column":1},"end":{"line":517,"column":1}},"key":"bZUp0o0h16"}],"key":"iuIqO208fh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) u^2 - u^3;\nivp.InitialValue = 0.005;","key":"dRiUlpoGsu"},{"type":"output","id":"xUuZ4wN-kdGRyq5NKkhfN","data":[],"key":"YBbrURdYFI"}],"data":{},"key":"f1y4bs2Iwr"},{"type":"paragraph","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"TaEbwvMtc6"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">n=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"UeejJEmYQg"},{"type":"text","value":" steps.","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"Jv4S7wDyqI"}],"key":"dsSbche2x4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[tI, uI] = am2(ivp, 0, 400, 200);\nclf\nplot(tI, uI)\nxlabel(\"t\");  ylabel(\"u(t)\")","key":"k4EUYrZCSo"},{"type":"output","id":"aQf_nuo6JSIS96Aj3mxxd","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b86d302141c6ae36d44edfef60c325e0","path":"/fnc/build/b86d302141c6ae36d44edfef60c325e0.png"}}}],"key":"U9sLZP6cjD"}],"data":{},"key":"wy6FFPMSiN"},{"type":"paragraph","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"children":[{"type":"text","value":"Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"A3pT9Tlo7o"}],"key":"WxmAjB9FA3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[tE, uE] = ab4(ivp, 0, 400, 200);\nhold on\nplot(tE, uE, '.', 'markersize', 8)\nylim([-5, 3])\nlegend(\"AM2\", \"AB4\")","key":"O2WYhmXAkT"},{"type":"output","id":"rhIOZdmUZbJercb3U6bNt","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"910ab393d4b997e9998d1db7a96b0151","path":"/fnc/build/910ab393d4b997e9998d1db7a96b0151.png"}}}],"key":"hPI95AvENY"}],"data":{},"key":"spX9V5bM9h"},{"type":"paragraph","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":1}},"key":"RKFrvQhimh"}],"key":"Rq6uMWK00U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nuE(105:111)","key":"GEzCYZ1Tew"},{"type":"output","id":"WFpf7nsSJLC0wNWCU31Zi","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×7 double\n1.0e+00 *\n\n   7.5539e-01   1.4373e+00  -3.2890e+00   2.1418e+02  -4.4821e+07   4.1269e+23  -3.2214e+71\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×7 double\n1.0e+00 *\n\n   7.5539e-01   1.4373e+00  -3.2890e+00   2.1418e+02  -4.4821e+07   4.1269e+23  -3.2214e+71\n","content_type":"text/plain"}}}],"key":"sjc2x8S2Me"}],"data":{},"key":"kERtDxfGBo"},{"type":"paragraph","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"l3DUUcGAkF"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"Sh6vVP1lMb"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":551,"column":1},"end":{"line":551,"column":1}},"key":"O6lUw0MFmD"}],"key":"sOJPv3FWb5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  plot(tI, uI, '.', 'markersize', 10)\nhold on\n[tE, uE] = ab4(ivp, 0, 400, 1000);\nplot(tE, uE)\n[tE, uE] = ab4(ivp, 0, 400, 1600);\nplot(tE, uE)\nlegend(\"AM2, n=200\", \"AB4, n=1000\", \"AB4, n=1600\")","key":"aE8OmVpyZE"},{"type":"output","id":"rDD6IKDn6f5oESQmvVHGf","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1514a48be56e25701f03c31fa9b5b9b0","path":"/fnc/build/1514a48be56e25701f03c31fa9b5b9b0.png"}}}],"key":"xRQHFbBuPW"}],"data":{},"key":"Uh8PUmHiCp"},{"type":"paragraph","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"HSJqqGjptr"},{"type":"emphasis","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"fb0qO945Tf"}],"key":"UCP6zJOr37"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"vKX8DGz3LB"}],"key":"TkYZaaVHwN"}],"label":"demo-implicit-stiff-matlab","identifier":"demo-implicit-stiff-matlab","html_id":"demo-implicit-stiff-matlab","key":"APFqkclZGh"},{"type":"heading","depth":3,"position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"children":[{"type":"text","value":"Section 6.7","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"FBVMUFzeMX"}],"identifier":"section-6-7","label":"Section 6.7","html_id":"section-6-7","implicit":true,"key":"lwyEDO5YeA"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Instability","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"aE57as6fX0"}],"key":"MoMRntOSeb"},{"type":"paragraph","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"children":[{"type":"text","value":"We’ll measure the error at the time ","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"V1p6h5Y9c8"},{"type":"inlineMath","value":"t=1","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"NtgOvofue1"},{"type":"text","value":".","position":{"start":{"line":569,"column":1},"end":{"line":569,"column":1}},"key":"wa4nXCsKXT"}],"key":"XPgmSJfXDG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"du_dt = @(t, u) u;\nu_exact = @exp;\na = 0;  b = 1;\nn = [5, 10, 20, 40, 60]';\nerr = zeros(size(n));\nfor j = 1:length(n)\n    h = (b - a) / n(j);\n    t = a + h *(0:n(j));\n    u = [1, u_exact(h), zeros(1, n(j) - 1)];\n    f = [du_dt(t(1), u(1)), zeros(1, n(j) - 2)];\n    for i = 2:n(j)\n        f(i) = du_dt(t(i), u(i));\n        u(i+1) = -4*u(i) + 5*u(i-1) + h * (4*f(i) + 2*f(i-1));\n    end\n    err(j) = abs(u_exact(b) - u(end));\nend\n\nh = (b-a) ./ n;\ndisp(table(n, h, err))","key":"SXVi5r5lPG"},{"type":"output","id":"5db2rdKVsNFYGqzivyiwp","data":[{"output_type":"stream","name":"stdout","text":"        n             h            err    \n"},{"output_type":"stream","name":"stdout","text":"    __________    __________    __________\n\n"},{"output_type":"stream","name":"stdout","text":"    5.0000e+00    2.0000e-01    1.6045e-02\n"},{"output_type":"stream","name":"stdout","text":"    1.0000e+01    1.0000e-01    2.8455e+00\n"},{"output_type":"stream","name":"stdout","text":"    2.0000e+01    5.0000e-02    1.6225e+06\n"},{"output_type":"stream","name":"stdout","text":"    4.0000e+01    2.5000e-02    9.3442e+18\n"},{"output_type":"stream","name":"stdout","text":"    6.0000e+01    1.6667e-02    1.7401e+32\n"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"GeKjBn76qj"}],"data":{},"key":"Owq5ZT88ji"},{"type":"paragraph","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"children":[{"type":"text","value":"The error starts out promisingly, but things explode from there. A graph of the last numerical attempt yields a clue.","position":{"start":{"line":593,"column":1},"end":{"line":593,"column":1}},"key":"SbEL7UyMYz"}],"key":"Riv1wJrjsL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nsemilogy(t, abs(u))\nxlabel(\"t\");  ylabel(\"|u(t)|\")\ntitle(\"LIAF solution\")","key":"RZchxdVrO9"},{"type":"output","id":"7BPthAG8z3ptSGbUKERjd","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8f617fb6e3db2383cbf05166bfcc5e63","path":"/fnc/build/8f617fb6e3db2383cbf05166bfcc5e63.png"}}}],"key":"OsrKnTp2wb"}],"data":{},"key":"D6qTo8OfGU"},{"type":"paragraph","position":{"start":{"line":602,"column":1},"end":{"line":602,"column":1}},"children":[{"type":"text","value":"It’s clear that the solution is growing exponentially in time.","position":{"start":{"line":602,"column":1},"end":{"line":602,"column":1}},"key":"VsCZBY9NUN"}],"key":"qipy0Eixpr"}],"label":"demo-zs-LIAF-matlab","identifier":"demo-zs-liaf-matlab","html_id":"demo-zs-liaf-matlab","key":"GvdCjcI0rC"}],"key":"FxKklg8CkF"}],"key":"ur7JHmKqWW"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 5","url":"/chapter5-1","group":"MATLAB codes"},"next":{"title":"Chapter 1","url":"/chapter1-2","group":"Python codes"}}},"domain":"http://localhost:3000"}