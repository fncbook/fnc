{"version":2,"kind":"Notebook","sha256":"aee39d469f05b60f9a52719417990d0ad239929d7dbead1bcd42512fadbad5eb","slug":"chapter6-1","location":"/matlab/chapter6.md","dependencies":[],"frontmatter":{"title":"Chapter 6","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter6.md","exports":[{"format":"md","filename":"chapter6.md","url":"/build/chapter6-f270907f8b6efedfd950675471cf18ff.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"i7vlaa063F"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"COk0CiFu72"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Euler’s method for an initial-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"n2PQJ8MPaw"}],"key":"ACTZtHoynY"},{"type":"include","file":"FNC-matlab/eulerivp.m","literal":true,"children":[{"type":"code","value":"function [t, u] = eulerivp(ivp, a, b, n)\r\n% EULERIVP   Euler's method for a scalar initial-value problem.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;\r\nt = a + (0:n) * h;\r\n\r\n% Initialize solution array.\r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0;\r\n\r\n% Time stepping.\r\nfor i = 1:n\r\n  u(:, i+1) = u(:, i) + h * du_dt(t(i), u(:, i), p);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"eulerivp.m","key":"Zq2kwce9DC"}],"key":"fidbAPDV4R"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"djTXBE5P09"}],"key":"T0F2fJtyFY"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"lsGiC3G5du"},{"type":"inlineCode","value":"ivp","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"iXx5H4vMie"},{"type":"text","value":" input argument is the same structure that is used with the built-in ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"QBPobcB9OD"},{"type":"inlineCode","value":"solve","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"X0t4IwdaZN"},{"type":"text","value":" solvers. The outputs ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"QpoGBqgoL5"},{"type":"inlineCode","value":"t","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"IGRGylOFVI"},{"type":"text","value":" and ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"r7eeJSl7xM"},{"type":"inlineCode","value":"u","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"hxmk33bvTx"},{"type":"text","value":" are row vectors of the same length, like the fields in a solution object output by ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"GkwUyUD3LF"},{"type":"inlineCode","value":"solve","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"oTnoCmaAuG"},{"type":"text","value":". While the entries of ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"dtYpws91Hd"},{"type":"inlineCode","value":"u","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"r9koqw0rjN"},{"type":"text","value":" could be simplified to ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"rn7gyhBv3X"},{"type":"inlineCode","value":"u(1)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"J8u3ml5h6W"},{"type":"text","value":", ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"HN97qWDSbI"},{"type":"inlineCode","value":"u(i)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"PujnyCPRye"},{"type":"text","value":", etc., we chose a column-access syntax like ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ISTXrGJo2n"},{"type":"inlineCode","value":"u(:, i)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"BbGeuGeFXN"},{"type":"text","value":" that will prove useful for what’s coming next in the chapter.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"e6MCIcgSvV"}],"key":"zbUUXrj4Tm"}],"class":"dropdown","key":"CaGsbUmIob"}],"label":"function-euler-matlab","identifier":"function-euler-matlab","html_id":"function-euler-matlab","key":"Z8jRhucPtm"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Improved Euler method for an ","key":"xcbe279vZ3"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"PHbgBPibDI"}],"key":"zTZmZPKaHt"}],"key":"wdRa3ULdBP"},{"type":"include","file":"FNC-matlab/ie2.m","literal":true,"children":[{"type":"code","value":"function [t, u] = ie2(ivp, a, b, n)\r\n% IE2    Improved Euler method for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\n% Initialize solution array. \r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0(:);\r\n\r\n% Time stepping. \r\nfor i = 1:n \r\n    uhalf = u(:, i) + h/2 * du_dt(t(i), u(:, i), p);\r\n    u(:, i+1) = u(:, i) + h * du_dt(t(i) + h/2, uhalf, p);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"ie2.m","key":"ARtI9F1Fdc"}],"key":"cOmS3fyl7D"}],"label":"function-ie2-matlab","identifier":"function-ie2-matlab","html_id":"function-ie2-matlab","key":"VANboOfr5N"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Fourth-order Runge-Kutta for an ","key":"b1qiW65ZSu"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"TJTL32rEX3"}],"key":"Cco64HV8wP"}],"key":"PVzGYsCiv2"},{"type":"include","file":"FNC-matlab/rk4.m","literal":true,"children":[{"type":"code","value":"function [t, u] = rk4(ivp, a, b, n)\r\n% RK4    Fourth-order Runge-Kutta for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\n% Initialize solution array. \r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0(:);\r\n\r\n% Time stepping.\r\nfor i = 1:n\r\n  k1 = h * du_dt( t(i),       u(:, i)       , p);\r\n  k2 = h * du_dt( t(i) + h/2, u(:, i) + k1/2, p );\r\n  k3 = h * du_dt( t(i) + h/2, u(:, i) + k2/2, p );\r\n  k4 = h * du_dt( t(i) + h,   u(:, i) + k3  , p);\r\n  u(:, i+1) = u(:, i) + (k1 + 2*(k2 + k3) + k4) / 6;\r\nend","lang":"matlab","showLineNumbers":true,"filename":"rk4.m","key":"bdqaOWfk0L"}],"key":"bHREVGg6de"}],"label":"function-rk4-matlab","identifier":"function-rk4-matlab","html_id":"function-rk4-matlab","key":"VyQ88Xm4pm"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Adaptive ","key":"aTE0yg6OjU"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"k1JfLUohWD"}],"key":"C9szqwumB9"},{"type":"text","value":" solver based on embedded RK formulas","key":"ayWSoYvcZj"}],"key":"bzRDW4ZKnb"},{"type":"include","file":"FNC-matlab/rk23.m","literal":true,"children":[{"type":"code","value":"function [t, u] = rk23(ivp, a, b, tol)\r\n% RK23   Adaptive IVP solver based on embedded RK formulas.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   tol     global error target (positive scalar)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Initialize for the first time step.\r\nt = a;\r\nu(:, 1) = u0(:);  i = 1;\r\nh = 0.5 * tol^(1/3);\r\ns1 = du_dt(t(1), u(:, 1) ,p);\r\n\r\n% Time stepping.\r\nwhile t(i) < b\r\n    % Detect underflow of the step size.\r\n    if t(i) + h == t(i)\r\n        warning('Stepsize too small near t=%.6g.',t(i))\r\n        break  % quit time stepping loop\r\n    end\r\n    \r\n    % New RK stages.\r\n    s2 = du_dt(t(i) + h/2,   u(:, i) + (h/2)   * s1, p);\r\n    s3 = du_dt(t(i) + 3*h/4, u(:, i) + (3*h/4) * s2, p);\r\n    unew2 = u(:, i) + h * (2*s1 + 3*s2 + 4*s3) / 9;    % 2rd order solution\r\n    s4 = du_dt(t(i) + h, unew2, p );\r\n    err = h * (-5*s1/72 + s2/12 + s3/9 - s4/8);        % 2nd/3rd order difference\r\n    E = norm(err, Inf);                                % error estimate\r\n    maxerr = tol * (1 + norm(u(:, i), Inf));           % relative/absolute blend\r\n    \r\n    % Accept the proposed step? \r\n    if E < maxerr     % yes \r\n        t(i+1) = t(i) + h;\r\n        u(:, i+1) = unew2;\r\n        i = i+1;\r\n        s1 = s4;      % use FSAL property\r\n    end\r\n    \r\n    % Adjust step size. \r\n    q = 0.8 * (maxerr/E)^(1/3);       % conservative optimal step factor\r\n    q = min(q, 4);                    % limit stepsize growth\r\n    h = min(q*h, b - t(i));           % don't step past the end\r\nend","lang":"matlab","showLineNumbers":true,"filename":"rk23.m","key":"nMvdVx48AC"}],"key":"aNDg5NpX4W"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"MHOvBAE4TK"}],"key":"pvZaRyrecW"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"The check ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Q90VfJp4TY"},{"type":"inlineCode","value":"t(i) + h == t(i)","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"dugtyNGAyt"},{"type":"text","value":"on line 24 is to detect when ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"KRLlyCX8fb"},{"type":"inlineMath","value":"h","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"qHCp5oduN1"},{"type":"text","value":" has become so small that it no longer changes the floating-point value of ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"Cu95neFxFZ"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SNzBlpNRRc"},{"type":"text","value":". This may be a sign that the underlying exact solution has a singularity near ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"lugLRZxVil"},{"type":"inlineMath","value":"t=t_i","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t=t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BCrA0R79cQ"},{"type":"text","value":", but in any case, the solver must halt by using a ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"naug6RudXw"},{"type":"inlineCode","value":"break","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"LUazPGT29b"},{"type":"text","value":" statement to exit the loop.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"hO1MsShMLG"}],"key":"Wr20Q4cxLj"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"On line 36, we use a combination of absolute and relative tolerances to judge the acceptability of a solution value, as in ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"wgqEoL2J2D"},{"type":"crossReference","kind":"equation","identifier":"absreltolerance","label":"absreltolerance","children":[{"type":"text","value":"(","key":"jl26RCKLoQ"},{"type":"text","value":"5.7.6","key":"QFelHAfbFc"},{"type":"text","value":")","key":"HrYK92SuXE"}],"template":"(%s)","enumerator":"5.7.6","resolved":true,"html_id":"absreltolerance","remote":true,"url":"/adaptive","dataUrl":"/adaptive.json","key":"jL8khfcnGZ"},{"type":"text","value":". In lines 47--49 we underestimate the step factor ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"CDb56UQsAq"},{"type":"inlineMath","value":"q","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"znNIxHYIc9"},{"type":"text","value":" a bit and prevent a huge increase in the step size, since a rejected step is expensive, and then we make sure that our final step doesn’t take us past the end of the domain.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"xKKUMlOC4B"}],"key":"Yuo11CpoUz"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"Finally, line 43 exploits a subtle property of the BS23 formula called ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"by05EL7Z0j"},{"type":"emphasis","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"first same as last","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"GQvNbEsTx6"}],"key":"kYKiYYOwyr"},{"type":"text","value":" (FSAL).\nWhile ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"ianzhOGWak"},{"type":"crossReference","kind":"equation","identifier":"bs23","label":"bs23","children":[{"type":"text","value":"(","key":"Hl8nREcRVz"},{"type":"text","value":"6.5.5","key":"UYFe7tMuP3"},{"type":"text","value":")","key":"v1cARtBIUn"}],"template":"(%s)","enumerator":"6.5.5","resolved":true,"html_id":"bs23","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"y9kIymZOK3"},{"type":"text","value":" calls for four stages to find the paired second- and third-order estimates, the final stage computed in stepping from ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"NEdi5TUhRK"},{"type":"inlineMath","value":"t_i","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">t_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7651em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XPoplBDTL6"},{"type":"text","value":" to ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"PicxvcbpeC"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"AIvu0WQk10"},{"type":"text","value":" is identical to the first stage needed to step from ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"oTznSKT30Q"},{"type":"inlineMath","value":"t_{i+1}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GvBpC9PaAx"},{"type":"text","value":" to ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"o5kkiwsBpg"},{"type":"inlineMath","value":"t_{i+2}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>i</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">t_{i+2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8234em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rwhPgUNpTX"},{"type":"text","value":". By repurposing ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"xyI3LBQw8v"},{"type":"inlineCode","value":"s4","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"V7UgDgT7Dj"},{"type":"text","value":" as ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"eEHvgVvEJz"},{"type":"inlineCode","value":"s1","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"BaSdj67Y4R"},{"type":"text","value":" for the next pass, one of the stage evaluations comes for free, and only three evaluations of ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"VeAoJRXIKp"},{"type":"inlineMath","value":"f","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"c0DbczJhaw"},{"type":"text","value":" are needed per successful step.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"UN1tbY9aAx"}],"key":"ycBz0aVDDg"}],"class":"dropdown","key":"QpS0VCfw0X"}],"label":"function-rk23-matlab","identifier":"function-rk23-matlab","html_id":"function-rk23-matlab","key":"EgI5pHm6oh"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"4th-order Adams–Bashforth formula for an ","key":"AhZ0bIuoXL"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"WLWN7XxGsL"}],"key":"He5NlkxArz"}],"key":"Q0x8yN6k5z"},{"type":"include","file":"FNC-matlab/ab4.m","literal":true,"children":[{"type":"code","value":"function [t, u] = ab4(ivp, a, b, n)\r\n%AB4     4th-order Adams-Bashforth formula for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\n% Constants in the AB4 method.\r\nk = 4;  \r\nsigma = [55; -59; 37; -9] / 24;  \r\n\r\n% Find starting values by RK4.\r\n[ts, us] = rk4(ivp, a, a + (k-1)*h, k-1);\r\nu = zeros(length(u0), n+1);\r\nu(:, 1:k) = us(:, 1:k);\r\n\r\n% Compute history of u' values, from oldest to newest.\r\nf = zeros(length(u0), k);\r\nfor i = 1:k-1\r\n  f(:, k-i) = du_dt(t(i), u(:, i), p);\r\nend\r\n\r\n% Time stepping.\r\nfor i = k:n\r\n  f = [du_dt(t(i), u(:, i), p), f(:, 1:k-1)];   % new value of du/dt\r\n  u(:, i+1) = u(:, i) + h * (f * sigma);        % advance one step\r\nend","lang":"matlab","showLineNumbers":true,"filename":"ab4.m","key":"wxKhGARU2S"}],"key":"voK58O9INH"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"wrD237SeAH"}],"key":"S4IMFBizPr"},{"type":"paragraph","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"Line 21 sets ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"HstqgphVwU"},{"type":"inlineCode","value":"sigma","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"lCV6LtfCew"},{"type":"text","value":" to be the coefficients of the generating polynomial ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"UzCqmNozET"},{"type":"inlineMath","value":"\\sigma(z)","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"d4LsKC5mmg"},{"type":"text","value":" of AB4. Lines 24--26 set up the ","key":"xymHDytcuV"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"WanCSCuJe4"}],"key":"Nzgm9tZzy8"},{"type":"text","value":" over the time interval ","key":"KfIGKWUnHL"},{"type":"inlineMath","value":"a \\le t \\le a+3 h","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>≤</mo><mi>t</mi><mo>≤</mo><mi>a</mi><mo>+</mo><mn>3</mn><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">a \\le t \\le a+3 h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">3</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"EYqgEzBRTH"},{"type":"text","value":", call ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"V04hZoTlFc"},{"type":"inlineCode","value":"rk4","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"jl8jM4SQn3"},{"type":"text","value":" to solve it using the step size ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"ZhEC22GdKc"},{"type":"inlineMath","value":"h","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">h</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"uepIbuUJZJ"},{"type":"text","value":", and use the result to fill the first four values of the solution. Then lines 29--32 compute the vector ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"EeeJMbOlRr"},{"type":"inlineMath","value":"[f_2,f_1,f_0]","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>f</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>f</mi><mn>0</mn></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[f_2,f_1,f_0]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"xCUr6WM9dv"},{"type":"text","value":".","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"yg70txLlAj"}],"key":"tk2ODmIocu"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Line 36 computes ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"RwYFf4Zk3y"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QOiFfC6FdK"},{"type":"text","value":", based on the most recent solution value and time. That goes into the first column of ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"Ijg2s5yy8o"},{"type":"inlineCode","value":"f","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"ihD95Svs1O"},{"type":"text","value":", followed by the three values that were previously most recent. These are the four values that appear in ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"bRabA4zsJl"},{"type":"crossReference","kind":"equation","identifier":"ab4","label":"ab4","children":[{"type":"text","value":"(","key":"eY1j0qylbN"},{"type":"text","value":"6.7.1","key":"w4xmC6jALo"},{"type":"text","value":")","key":"LNFkp6PXqo"}],"template":"(%s)","enumerator":"6.7.1","resolved":true,"html_id":"ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"qdJ7SoIhUa"},{"type":"text","value":". Each particular ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"cM0G4Fkf4J"},{"type":"inlineMath","value":"f_i","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">f_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ovm6nNCSM6"},{"type":"text","value":" value starts at the front of ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"RwN6Qj35PR"},{"type":"inlineCode","value":"f","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"DzeBEANQKJ"},{"type":"text","value":", moves through each position in the vector over three iterations, and then is forgotten.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"B9SwK6ifgy"}],"key":"nZZKPyDOh8"}],"class":"dropdown","key":"BdQCmFgsyQ"}],"label":"function-ab4-matlab","identifier":"function-ab4-matlab","html_id":"function-ab4-matlab","key":"K3veCiQp7C"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"2nd-order Adams–Moulton (trapezoid) formula for an ","key":"vZcYt5M42w"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"mGQm1fC6Ip"}],"key":"MHJRgDfG0Y"}],"key":"hSQblOCgXm"},{"type":"include","file":"FNC-matlab/am2.m","literal":true,"children":[{"type":"code","value":"function [t, u] = am2(ivp, a, b, n)\r\n% AM2    2nd-order Adams-Moulton (trapezoid) formula for an IVP.\r\n% Input:\r\n%   ivp     structure defining the IVP\r\n%   a, b    endpoints of time interval (scalars)\r\n%   n       number of time steps (integer)\r\n% Output:\r\n%   t       selected nodes (vector, length n+1)\r\n%   u       solution values (array, m by (n+1))\r\n\r\ndu_dt = ivp.ODEFcn;\r\nu0 = ivp.InitialValue;\r\np = ivp.Parameters;\r\n\r\n% Define time discretization.\r\nh = (b - a) / n;   \r\nt = a + h * (0:n)';\r\n\r\nu = zeros(length(u0), n+1);\r\nu(:, 1) = u0(:);\r\n\r\n% Time stepping.\r\nfor i = 1:n\r\n  % Data that does not depend on the new value.\r\n  known = u(:,i) + h/2 * du_dt(t(i), u(:, i), p);\r\n  % Find a root for the new value. \r\n  unew = levenberg(@trapzero, known);\r\n  u(:, i+1) = unew(:, end);\r\nend\r\n\r\n% This function defines the rootfinding problem at each step.\r\nfunction F = trapzero(z)\r\n    F = z - h/2 * du_dt(t(i+1), z, p) - known;\r\nend\r\n\r\nend  % main function","lang":"matlab","showLineNumbers":true,"filename":"am2.m","key":"darZ0LUdvK"}],"key":"om5DQO5Vvy"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"x1WQ9MBQbZ"}],"key":"r6Bku6At41"},{"type":"paragraph","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Lines 32--34 define the function ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"gbl6Hz8Hx9"},{"type":"inlineMath","value":"\\mathbf{g}","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span></span></span></span>","key":"fL0Oec0SA5"},{"type":"text","value":". This is sent to ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"GKVjeOevVg"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"NLnGloZi84"},{"type":"text","value":" in line~27 to find the new solution value, using an Euler half-step as its starting value. A robust code would have to intercept the case where ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"nWSmoqX6zM"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"IS3f0KiXyC"},{"type":"text","value":" fails to converge, but we have ignored this issue for the sake of brevity.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"khUr4k6boP"}],"key":"L2s9c4lRQi"}],"class":"dropdown","key":"G4ZbxtCJYt"}],"label":"function-am2-matlab","identifier":"function-am2-matlab","html_id":"function-am2-matlab","key":"Ud0vpQMH4O"},{"type":"heading","depth":2,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"sb84rd1qhO"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"U3dzEGZW6y"}],"key":"K1DBcRwDvL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init\npwd","visibility":"show","key":"euSZQILbxs"},{"type":"output","id":"BPN1tAw2iWQkSd8Gy-7Xi","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."},{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = '/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/matlab'</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = '/Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc/matlab'","content_type":"text/plain"}}}],"visibility":"show","key":"SnQ5lXYmSP"}],"data":{"tags":[]},"visibility":"remove","key":"bQtl5cUwbp"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"6.1 ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"VEll2gcag0"},{"type":"link","identifier":"section-ivp-basics","label":"section-ivp-basics","kind":"narrative","position":{"start":{"line":99,"column":5},"end":{"line":99,"column":24}},"url":"/basics","internal":true,"dataUrl":"/basics.json","children":[{"type":"text","value":"Basics of IVPs","key":"nlv1XuHi1q"}],"key":"wIYDfDP9XI"}],"identifier":"id-6-1","label":"6.1 ","html_id":"id-6-1","implicit":true,"key":"FzX7oFf36R"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-first","label":"demo-basics-first","kind":"proof:example","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":19}},"children":[{"type":"text","value":"Example ","key":"NooqnZnzj1"},{"type":"text","value":"6.1.2","key":"YNEoOgmzND"}],"template":"Example %s","enumerator":"6.1.2","resolved":true,"html_id":"demo-basics-first","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"u8Dxlri1KA"}],"key":"hTxlW5o3Pp"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"Let’s use it to define and solve an initial-value problem for ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"mhkhgE81x5"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"HxyG1GBK7K"},{"type":"text","value":" over ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"mVqh26TzAz"},{"type":"inlineMath","value":"t \\in [0,4]","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">t \\in [0,4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6542em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span>","key":"ex5nlb1vfj"},{"type":"text","value":", such that ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"laVsggb9Su"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"ywWEcbGHS8"},{"type":"text","value":". To create an initial-value problem for ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"MJio2VQfLA"},{"type":"inlineMath","value":"u(t)","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"a3sQ7C7Zx4"},{"type":"text","value":", you must create an ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"EWb7wOAfjd"},{"type":"inlineCode","value":"ode","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"pfUMAvEKrj"},{"type":"text","value":" with a function that computes ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"gbQyBHNWqa"},{"type":"inlineMath","value":"u'","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"UzVLmsAaBJ"},{"type":"text","value":" and an initial condition for ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"ieVgmG5X4p"},{"type":"inlineMath","value":"u","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"wi6m9CR9vQ"},{"type":"text","value":". Then you create a solution by calling ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"HYFoKEnRTQ"},{"type":"inlineCode","value":"solve","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"IsqA0PPS77"},{"type":"text","value":" with a time interval.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"hCiFNv7RWx"}],"key":"DvA76VyQl3"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"sNxXIQm2CT"}],"key":"JGax1Y5Bdj"},{"type":"paragraph","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"text","value":"Most real ","key":"gKRmPjDJ9M"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"SgQ0KRVaa7"}],"key":"Qcg720aLJ1"},{"type":"text","value":" problems contain parameters that are constant during the solution but that can change from one problem instance to the next. Accordingly, we define the ","key":"BOzVD5fF9f"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"K56rhIIdYj"}],"key":"Avg5irF51Z"},{"type":"text","value":" function below to accept a third argument, ","key":"h3dPsWBgfr"},{"type":"inlineCode","value":"p","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"MDW66aQUvW"},{"type":"text","value":", which is a vector of parameters. We always include this argument for consistency, even when there are no parameters.","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"baDKqjyvG5"}],"key":"qGNQboTaoU"}],"class":"dropdown","key":"pxoFV7cVbK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialTime = 0;\nivp.InitialValue = -1;\nsol = solve(ivp, 0, 4);","key":"uWzBNdunGS"},{"type":"output","id":"zLaXBzmJryjdSqX9kgQOP","data":[],"key":"DMKv4gd1zx"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"ode","kind":"entry"},"emphasis":true},{"entry":"MATLAB","subEntry":{"value":"solve","kind":"entry"},"emphasis":true}],"label":"index-syb1WNu35y","identifier":"index-syb1wnu35y","html_id":"index-syb1wnu35y","key":"h1zel8mXds"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"The resulting solution object has fields ","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"oUDAxbeJw3"},{"type":"inlineCode","value":"Time","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"YtDmuxBZKo"},{"type":"text","value":" and ","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"mPg2KyCeLu"},{"type":"inlineCode","value":"Solution","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"sjEepRlIEI"},{"type":"text","value":" that contain the approximate values of the solution at automatically chosen times in the interval you provided.","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"dWTsGW2AJP"}],"key":"rEDxfJZWoK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(sol.Time, sol.Solution, '-o')\nxlabel(\"t\")\nylabel(\"u(t)\")\ntitle((\"Solution of an IVP\"));","key":"Lo8lVtAe3D"},{"type":"output","id":"3V0_yvOSjS47ghzggrApV","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0a27ec442a0e0955464b5afb95572ad0","path":"/build/0a27ec442a0e0955464b5afb95572ad0.png"}}}],"key":"i0smCsJxOA"}],"key":"uJaIPWW0hC"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"You might want to know the solution at particular times other than the ones selected by the solver. That requires an interpolation, which is done by ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"nQBxA7G2Xf"},{"type":"inlineCode","value":"solutionFcn","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"Hw5jZkWOBa"},{"type":"text","value":".","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"z1CLHDciHs"}],"key":"q47O8B5Vav"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u = solutionFcn(ivp, 0, 10);\nu(0:5)","key":"hSE1xKAs8y"},{"type":"output","id":"9XUAbzs9Ozjhpm-Bp-_ev","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.\n\nError in LiveEditorEvaluationHelperE61d9d5cb-2d7e-4377-866a-63569db68026>@(t,u,c)-c*(Dx*u) (line 2)\nivp.InitialValue = u_init;\n\nError in odearguments (line 93)\nf0 = ode(t0,y0,args{:});\n\nError in ode45 (line 104)\n    odearguments(odeIsFuncHandle,odeTreatAsMFile, solver_name, ode, tspan, y0, options, varargin);\n\nError in matlab.ode.internal.LegacySolver/extend (line 56)\n                obj.sol = obj.SolverFcn(args{:});\n\nError in matlab.ode.internal.SolverPair/extend (line 162)\n                [obj.rSolver,tmax] = obj.rSolver.extend(t2);\n\nError in ode/solutionFcn (line 382)\n            [ODESOL,L,R] = ODESOL.extend(L,R);"}],"key":"g4dekPPCwg"}],"key":"f1RjGiAFP5"}],"label":"demo-basics-first-matlab","identifier":"demo-basics-first-matlab","html_id":"demo-basics-first-matlab","key":"Xs1lmoFVbG"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-sing","label":"demo-basics-sing","kind":"proof:example","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":18}},"children":[{"type":"text","value":"Example ","key":"Vg6WqpIUfN"},{"type":"text","value":"6.1.3","key":"NZWuZcyn8p"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"FaPSsP0Uur"}],"key":"u7D1ErGvsW"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"The equation ","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"Mer3iJHLlv"},{"type":"inlineMath","value":"u'=(u+t)^2","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=(u+t)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"OotGWO4PIB"},{"type":"text","value":" gives us some trouble.","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"R2p1q9rLzk"}],"key":"YEgiSRnLoE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) (t + u)^2;\nivp.InitialTime = 0;\nivp.InitialValue = 1;\nsol = solve(ivp, 0, 1);","key":"ibNKRXOOxo"},{"type":"output","id":"AsYui6GCpQzuq7SEKwV1Z","data":[{"output_type":"stream","name":"stderr","text":"Warning: Failure at t=7.853789e-01.  Unable to meet integration tolerances without reducing the step size below the smallest value allowed (1.776357e-15) at time t."}],"key":"E66Xo6yHrU"}],"key":"jdAE7rFBCT"},{"type":"paragraph","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"text","value":"The warning message we received can mean that there is a bug in the formulation of the problem. But if everything has been done correctly, it suggests that the solution may not exist past the indicated time. This is a possibility in nonlinear ","key":"JDhCQTSahN"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"b4sNfIJZv0"}],"key":"V25BXPINH0"},{"type":"text","value":"s.","key":"xfFnzunrGo"}],"key":"PeKYbyqRuy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nsemilogy(sol.Time, sol.Solution)\nxlabel(\"t\")\nylabel(\"u(t)\")\ntitle((\"Finite-time blowup\"));","key":"M7xxq5Lnpc"},{"type":"output","id":"lYBzJPLLfze6zH07pBsGC","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized field name \"Time\"."}],"key":"f8oT7ccBNu"}],"key":"pfDmCywt5q"}],"label":"demo-basics-sing-matlab","identifier":"demo-basics-sing-matlab","html_id":"demo-basics-sing-matlab","key":"MnwymHflDw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-basics-cond","label":"demo-basics-cond","kind":"proof:example","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":18}},"children":[{"type":"text","value":"Example ","key":"goNIeoW8OO"},{"type":"text","value":"6.1.5","key":"wOcm6Vk8Uc"}],"template":"Example %s","enumerator":"6.1.5","resolved":true,"html_id":"demo-basics-cond","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"JrJ1I2AO1i"}],"key":"qDJcr0K5cD"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"text","value":"Consider the ","key":"IE9kPZVpsI"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"znLe8GD55m"}],"key":"vYiUlNgKzA"},{"type":"text","value":"s ","key":"tS96zm9r23"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"CIgvPxcaWQ"},{"type":"text","value":" and ","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"aj9ocC81L3"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"OGZZOfnIjX"},{"type":"text","value":". In each case we compute ","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"Qfo5p0cWXX"},{"type":"inlineMath","value":"\\partial f/\\partial u = \\pm 1","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">∂</mi><mi>u</mi><mo>=</mo><mo>±</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\partial f/\\partial u = \\pm 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\">/</span><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord\">1</span></span></span></span>","key":"tViLHECAPp"},{"type":"text","value":", so the condition number bound from ","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"zGNLnAinrl"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-depic","label":"theorem-depIC","children":[{"type":"text","value":"Theorem ","key":"Jro8dpmyFF"},{"type":"text","value":"6.1.2","key":"dpfPUxEUZD"}],"template":"Theorem %s","enumerator":"6.1.2","resolved":true,"html_id":"theorem-depic","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"A0EiZrwPA1"},{"type":"text","value":" is ","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"gMTc2bDuo2"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"MqzSMMQQIh"},{"type":"text","value":" in both problems. However, they behave quite differently. In the case of exponential growth, ","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"dHtAo1IoVp"},{"type":"inlineMath","value":"u'=u","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"yXHmZXaoRI"},{"type":"text","value":", the bound is the actual condition number.","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"JBLgu7QAXO"}],"key":"dOkOEdqzke"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor u0 = [0.7, 1, 1.3]    % initial values\n    fplot(@(t) exp(t) * u0, [0, 3]), hold on\nend\nxlabel('t')\nylabel('u(t)')\ntitle(('Exponential divergence of solutions'));","visibility":"hide","key":"xjGTUv2Lyp"},{"type":"output","id":"UmyFXV8ipJ0f7Szy9kiql","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"356909c73a6337a12cbb7cc759c183a7","path":"/build/356909c73a6337a12cbb7cc759c183a7.png"}}}],"visibility":"show","key":"hbC0OQMAxs"}],"data":{"tags":[]},"visibility":"show","key":"ciqLpTwFNQ"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"But with ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ksUKJjg207"},{"type":"inlineMath","value":"u'=-u","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo>−</mo><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u&#x27;=-u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"CBqoCVe75K"},{"type":"text","value":", solutions actually get closer together with time.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"ow7xiVZZYC"}],"key":"o9Cpo3ZaP5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nfor u0 = [0.7, 1, 1.3]    % initial values\n    fplot(@(t) exp(-t) * u0, [0, 3]), hold on\nend\nxlabel('t')\nylabel('u(t)')\ntitle(('Exponential convergence of solutions'));","visibility":"hide","key":"SoteUk1L8L"},{"type":"output","id":"5tYmqJMnyAukwjLZ3Qk8s","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"621f537c786cadc310d2086b90f6bca7","path":"/build/621f537c786cadc310d2086b90f6bca7.png"}}}],"visibility":"show","key":"uACMJI6Rzf"}],"data":{"tags":[]},"visibility":"show","key":"pIkLpiW0jn"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"In this case the actual condition number is one, because the initial difference between solutions is the largest over all time. Hence the exponentially growing bound ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"WlMPvl0HmO"},{"type":"inlineMath","value":"e^{b-a}","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>e</mi><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">e^{b-a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span></span></span></span></span></span></span></span>","key":"de1Ciyj6fh"},{"type":"text","value":" is a gross overestimate.","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"FRHcaEmbWh"}],"key":"tb83ShMc0q"}],"label":"demo-basics-cond-matlab","identifier":"demo-basics-cond-matlab","html_id":"demo-basics-cond-matlab","key":"ZwHWRHvKgs"},{"type":"heading","depth":3,"position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"6.2 ","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"N9fbkQt3mM"},{"type":"link","identifier":"section-ivp-euler","label":"section-ivp-euler","kind":"narrative","position":{"start":{"line":197,"column":5},"end":{"line":197,"column":23}},"url":"/euler","internal":true,"dataUrl":"/euler.json","children":[{"type":"text","value":"Euler’s method","key":"vUBL0Uc9rN"}],"key":"dSuFpHmwhR"}],"identifier":"id-6-2","label":"6.2 ","html_id":"id-6-2","implicit":true,"key":"g0qYDvc1dD"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-euler-converge","label":"demo-euler-converge","kind":"proof:example","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":21}},"children":[{"type":"text","value":"Example ","key":"qTIBErGKYV"},{"type":"text","value":"6.2.1","key":"kKawprzqQp"}],"template":"Example %s","enumerator":"6.2.1","resolved":true,"html_id":"demo-euler-converge","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"xhLATFq4Vy"}],"key":"CZz8v1XDx5"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"We consider the ","key":"GgwO4o8TkQ"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"xKvt2HDEmy"}],"key":"kr1x9TKuI3"},{"type":"text","value":" ","key":"xsKvYvt0yN"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"u14OZQt92h"},{"type":"text","value":" over ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"k5zgRG7IDK"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"tDMrpj9lZb"},{"type":"text","value":", with ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"N2lELHqqnM"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"A2jOJaiQIT"},{"type":"text","value":". We need to define the function for the right-hand side of the ","key":"V1yANNZ392"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"qYEyCkeiTH"}],"key":"N0qIC9ej9D"},{"type":"text","value":", the interval for the independent variable, and the initial value.","key":"OlrfiUO6Lv"}],"key":"r8qUxTRtiy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialValue = -1;\na = 0;  b = 4;","key":"D7gkFVxZg4"},{"type":"output","id":"-zvCz_RnXDTNC8PcG_AiK","data":[],"key":"X0VZ4Zyh5z"}],"key":"jVPUzUkjMg"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Here is the call to ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"HR0CXHQS9O"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"awsNMyEiSE"},{"type":"text","value":"6.2.2","key":"JKwbIlIpR7"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"YtMeORi62e"},{"type":"text","value":".","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"Omcs0W9hL3"}],"key":"q44yKmFpyj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, u] = eulerivp(ivp, a, b, 20);\nclf, plot(t, u, '.-')\nxlabel('t')\nylabel('u(t)')\ntitle(('Solution by Euler''s method'));","key":"uYp7ks84LC"},{"type":"output","id":"A1tK5oxvH-T6rqXX-G32W","data":[{"output_type":"stream","name":"stderr","text":"Error using ^ (line 52)\nIncorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To operate on each element of the matrix individually, use POWER (.^) for elementwise power.\n\nError in Notebook>@(t,u,p)sin((t+u)^2) (line 2)\nclf, plot(t, u, '.-')\n\nError in eulerivp (line 25)\n  u(:, i+1) = u(:, i) + h * du_dt(t(i), u(:, i), p);"}],"key":"OYGtoERT0y"}],"key":"vH1sq1KD1j"},{"type":"paragraph","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"children":[{"type":"text","value":"We could define a different interpolant to get a smoother picture above, but the derivation of Euler’s method assumed a piecewise linear interpolant. We can instead request more steps to make the interpolant look smoother.","position":{"start":{"line":220,"column":1},"end":{"line":220,"column":1}},"key":"w6ijKA0aHV"}],"key":"RityaqpoVC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, u] = eulerivp(ivp, a, b, 50);\nhold on, plot(t, u, '.-')\nlegend('20 steps', '50 steps');","key":"wowFnqJjHI"},{"type":"output","id":"DI-_guGkYIvhd3RJcTNWH","data":[{"output_type":"stream","name":"stderr","text":"Error using ^ (line 52)\nIncorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To operate on each element of the matrix individually, use POWER (.^) for elementwise power.\n\nError in Notebook>@(t,u,p)sin((t+u)^2) (line 2)\nhold on, plot(t, u, '.-')\n\nError in eulerivp (line 25)\n  u(:, i+1) = u(:, i) + h * du_dt(t(i), u(:, i), p);"}],"key":"DtXFrnJakZ"}],"key":"rBrHdYBGmh"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"Increasing ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"nf6GFYVuuw"},{"type":"inlineMath","value":"n","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"Qnr69HGJyN"},{"type":"text","value":" changed the solution noticeably. Since we know that interpolants and finite differences become more accurate as ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"puDhbhCGrz"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"byGMTStyWU"},{"type":"text","value":", we should anticipate the same behavior from Euler’s method. We don’t have an exact solution to compare to, so we will use a built-in solver to construct an accurate reference solution.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"Jcbf0OhSwi"}],"key":"ywRhac77ca"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp.AbsoluteTolerance = 1e-13;\nivp.RelativeTolerance = 1e-13;\nu_exact = solutionFcn(ivp, a, b);","key":"KEGadYofWa"},{"type":"output","id":"HkClwSl2gRVdIh4WMV-h-","data":[{"output_type":"stream","name":"stderr","text":"Error using ode/solutionFcn (line 348)\nInvalid argument at position 2. Value must be a scalar."}],"key":"GJYsNoKz2e"}],"key":"diw2gbqCq8"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"Now we can perform a convergence study.","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"IfVwgeCZ3C"}],"key":"Z93rclrXPM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round(5 * 10.^(0:0.5:3));\nerr = [];\nfor k = 1:length(n)\n    [t, u] = eulerivp(ivp, a, b, n(k));\n    err(k) = norm(u_exact(t) - u, Inf);\nend\ntable(n', err', VariableNames=[\"n\", \"inf-norm error\"])","key":"DbwOkMStsO"},{"type":"output","id":"S09tuZ27Fft44VLWFdKtL","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.\n\nError in eulerivp (line 17)\nt = a + (0:n) * h;"}],"key":"fINWNicyes"}],"key":"zNyOimJIXv"},{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"The error is approximately cut by a factor of 10 for each increase in ","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"Y8Ha5FxPMK"},{"type":"inlineMath","value":"n","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"aWpBVcgn9d"},{"type":"text","value":" by the same factor. A log-log plot also confirms first-order convergence. Keep in mind that since ","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"DZSNfJibh0"},{"type":"inlineMath","value":"h=(b-a)/n","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>=</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">h=(b-a)/n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"VzpgNJNEyg"},{"type":"text","value":", it follows that ","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"F8iV3TfQET"},{"type":"inlineMath","value":"O(h)=O(n^{-1})","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h)=O(n^{-1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">h</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"CuqXfVZHKW"},{"type":"text","value":".","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"lZ21q2j1Ar"}],"key":"wckgDCEbio"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nloglog(n, err, 'o-')\nhold on, loglog(n, 0.5 * err(end) * (n / n(end)).^(-1), '--')\nxlabel('n')\nylabel('inf-norm error')\ntitle('Convergence of Euler''s method')\nlegend('error', 'O(n^{-1})', 'location', 'southwest');","key":"yvPKgiTwh5"},{"type":"output","id":"-Awq-sRzOnG4BXph0AyAP","data":[{"output_type":"stream","name":"stderr","text":"Error using loglog\nSpecify the coordinates as vectors or matrices of the same size, or as a vector and a matrix that share the same length in at least one dimension."}],"key":"kvMTmiXQkc"}],"key":"DlThyhUXpJ"}],"label":"demo-euler-converge-matlab","identifier":"demo-euler-converge-matlab","html_id":"demo-euler-converge-matlab","key":"bdeaXh9kPg"},{"type":"heading","depth":3,"position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"children":[{"type":"text","value":"6.3 ","position":{"start":{"line":261,"column":1},"end":{"line":261,"column":1}},"key":"nGUyyz2GwZ"},{"type":"link","identifier":"section-ivp-systems","label":"section-ivp-systems","kind":"narrative","position":{"start":{"line":261,"column":5},"end":{"line":261,"column":25}},"url":"/systems","internal":true,"dataUrl":"/systems.json","children":[{"type":"text","value":"IVP systems","key":"aKqzxR95rq"}],"key":"fc9Uk5imzf"}],"identifier":"id-6-3","label":"6.3 ","html_id":"id-6-3","implicit":true,"key":"aufFZh85Ce"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-predator","label":"demo-systems-predator","kind":"proof:example","position":{"start":{"line":263,"column":1},"end":{"line":263,"column":23}},"children":[{"type":"text","value":"Example ","key":"pZEgNKIG7X"},{"type":"text","value":"6.3.2","key":"II1bTQsH3D"}],"template":"Example %s","enumerator":"6.3.2","resolved":true,"html_id":"demo-systems-predator","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"CktiaDKVKc"}],"key":"UTzVnwYI9u"},{"type":"paragraph","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"We encode the predator–prey equations via a function, defined here externally.","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"WrxIlavGZp"}],"key":"v2jT2nu1hT"},{"type":"include","file":"f63_predprey.m","literal":true,"children":[{"type":"code","value":"function du_dt = predprey(t, u, p)\n    alpha = p(1);  beta = p(2);\n    y = u(1);      z = u(2);\n    s = (y * z) / (1 + beta * y);  % appears in both equations\n    du_dt = [ y * (1 - alpha * y) - s;  -z + s ];\nend\n","lang":"matlab","filename":"f63_predprey.m","key":"YDGDhjQFPI"}],"key":"YzTAHM6MkW"},{"type":"paragraph","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"text","value":"The values of ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"KliHoQfukX"},{"type":"inlineCode","value":"alpha","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"VqO8p33oyG"},{"type":"text","value":" and ","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"tbbFk8Zbol"},{"type":"inlineCode","value":"beta","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"xr0ZHeAHXP"},{"type":"text","value":" are parameters that influence the solution of the ","key":"scuHd5ET0q"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"GKwrM0VfHX"}],"key":"E1fMWOHUtd"},{"type":"text","value":". We use the ","key":"QPqCwMNrh5"},{"type":"inlineCode","value":"Parameters","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"KptJwEbhg2"},{"type":"text","value":" field of the ","key":"eTSvuBSqMS"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"GkvGoxlN1x"}],"key":"soLgXTSoWb"},{"type":"text","value":" object to define them for the solver, which in turn passes them as the third argument into our ","key":"vsAtTxV47f"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"uTRHR7Kr1w"}],"key":"gdxk6lWCNx"},{"type":"text","value":" function.","key":"k6jm7qCXgA"}],"key":"c78oVLaKyR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u0 = [1; 0.01];    % column vector\np = [0.1, 0.25];\nivp = ode;\nivp.ODEFcn = @f63_predprey;\nivp.InitialValue = u0;\nivp.Parameters = p;\nsol = solve(ivp, 0, 60);\nsize(sol.Solution)","key":"iXIHvC4zpM"},{"type":"output","id":"NkkLP1MUzqZWIuGL4z352","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×2 double\n     2   341\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×2 double\n     2   341\n","content_type":"text/plain"}}}],"key":"VRhODmpV8s"}],"key":"nyWajwI3TR"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"Each column of the ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"Qse9ZhXV2f"},{"type":"inlineCode","value":"Solution","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"G8se4C0Cme"},{"type":"text","value":" field is the solution vector ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"BQy6iBZfRc"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"xeoz3AOe72"},{"type":"text","value":" at a particular time; each row is a component of ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"bFHfUvMVe1"},{"type":"inlineMath","value":"\\mathbf{u}","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span></span></span></span>","key":"RV0DwrXg5u"},{"type":"text","value":" over all time.","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"MXVHq8klOu"}],"key":"kP0q3zeDjZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(sol.Time, sol.Solution)\nxlabel(\"t\")\nylabel(\"u(t)\")\ntitle('Predator-prey solution')\nlegend('prey', 'predator');","key":"z2ZfoPbPhW"},{"type":"output","id":"hmKl2ADHA8ehlTIrwsz5a","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7d7b32aec5c4a71f277a48d2fb3c7462","path":"/build/7d7b32aec5c4a71f277a48d2fb3c7462.png"}}}],"key":"oGZBCmBzAJ"}],"key":"TyAN9Q7yDz"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"We can also use ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"qIhjBdwC4W"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-euler","label":"function-euler","children":[{"type":"text","value":"Function ","key":"ASWtyCZSjC"},{"type":"text","value":"6.2.2","key":"bJKNtrOoUm"}],"template":"Algorithm %s","enumerator":"6.2.2","resolved":true,"html_id":"function-euler","remote":true,"url":"/euler","dataUrl":"/euler.json","key":"yjnqL8h52d"},{"type":"text","value":" to find the solution.","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"SGKLIL7uyn"}],"key":"U2mCarNFnq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[t, u] = eulerivp(ivp, 0, 60, 1200);","key":"OR5acvWo08"},{"type":"output","id":"P5R0p3SgP08k81iLxkTIM","data":[],"key":"eQGk5LBKDB"}],"key":"buJsipJ1JL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nplot(t, u, '.')","key":"UzvyI3SYI7"},{"type":"output","id":"Xys_p8n0BiVw6_nletLga","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3918aeedce5812f0aff14a1c1a9ef554","path":"/build/3918aeedce5812f0aff14a1c1a9ef554.png"}}},{"output_type":"stream","name":"stderr","text":"Error using plot\nInvalid data argument."}],"key":"Lk9IOhgkXg"}],"key":"Tt1NsDjSeN"},{"type":"paragraph","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"Notice above that the accuracy of the Euler solution deteriorates rapidly.","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"p3KHn5ksBQ"}],"key":"AVNvQLbxoA"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"When there are just two components, it’s common to plot the solution in the ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"oTfsPAwM7o"},{"type":"emphasis","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"phase plane","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"U1Cxh0QFEC"}],"key":"WrcQaG8qGu"},{"type":"text","value":", i.e., with ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"XcDqcd9dhr"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"F4CUxzOR5Q"},{"type":"text","value":" and ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"uprce9VrRt"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"QkTR9UaHpZ"},{"type":"text","value":" along the axes and time as a parameterization of the curve.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"uXlVvicud8"}],"key":"LpMcbVr27a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nplot(u(1, :), u(2, :))\ntitle(\"Predator-prey in the phase plane\")\nxlabel(\"y\")\nylabel((\"z\"));","key":"dQnWhmoHzV"},{"type":"output","id":"zkINKItbUDTaz764GOGG4","data":[{"output_type":"stream","name":"stderr","text":"Input arguments to function include colon operator. To input the colon character, use ':' instead."}],"key":"SEq2BmUVpO"}],"key":"ZCpPA3Xiel"},{"type":"paragraph","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"text","value":"From this plot we can deduce that the solution approaches a periodic one, which in the phase plane is represented by a closed loop.","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"TMYBitoSQn"}],"key":"osY8u1PaO4"}],"label":"demo-systems-predator-matlab","identifier":"demo-systems-predator-matlab","html_id":"demo-systems-predator-matlab","key":"YorHH9wr1P"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-systems-coupledpendula","label":"demo-systems-coupledpendula","kind":"proof:example","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":29}},"children":[{"type":"text","value":"Example ","key":"LLxjQ2it7i"},{"type":"text","value":"6.3.5","key":"VgyFN09ebg"}],"template":"Example %s","enumerator":"6.3.5","resolved":true,"html_id":"demo-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"s7q9sLZnAm"}],"key":"eXSB3EiJlt"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"Let’s implement the coupled pendulums from ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"icJBp4fjWF"},{"type":"crossReference","kind":"proof:example","identifier":"example-systems-coupledpendula","label":"example-systems-coupledpendula","children":[{"type":"text","value":"Example ","key":"Dssnq1z33o"},{"type":"text","value":"6.3.4","key":"J8QdpfOP4b"}],"template":"Example %s","enumerator":"6.3.4","resolved":true,"html_id":"example-systems-coupledpendula","remote":true,"url":"/systems","dataUrl":"/systems.json","key":"BhHe1fsahx"},{"type":"text","value":". The pendulums will be pulled in opposite directions and then released together from rest.","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"yBeHebXVdq"}],"key":"Au1YgU2gjM"},{"type":"include","file":"f63_pendulums.m","literal":true,"children":[{"type":"code","value":"function udot = pendulums(t, u, p)\n    gamma = p(1);  L = p(2);  k = p(3);\n    g = 9.8;\n    udot = zeros(4, 1);\n    udot(1:2) = u(3:4);\n    udot(3) = -gamma * u(3) - (g / L) * sin(u(1)) + k * (u(2) - u(1));\n    udot(4) = -gamma * u(4) - (g / L) * sin(u(2)) + k * (u(1) - u(2));\nend\n","lang":"matlab","filename":"f63_pendulums.m","key":"hOIWrzEDjI"}],"key":"q44IdrEJTf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"u0 = [1.25; -0.5; 0; 0];\na = 0; b = 50;","key":"FoLXablddU"},{"type":"output","id":"M-_nJZQar3XV9pnDy_oco","data":[],"key":"lhBuXT7ef5"}],"key":"fbpWvWfvws"},{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"First we check the behavior of the system when the pendulums are uncoupled, i.e., when ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"ZDqZ5V64wQ"},{"type":"inlineMath","value":"k=0","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">k=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"cdQvKDK0MT"},{"type":"text","value":".","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"Cf66er5Tq7"}],"key":"fCNuufMolz"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"UfE4q0f5WW"}],"key":"aYdPkZSs0l"},{"type":"paragraph","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"XW6pMOKxXZ"},{"type":"inlineCode","value":"OutputVariables","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"xAPMu1kK6x"},{"type":"text","value":" is used to restrict output to just ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"v5JFsse7Nk"},{"type":"inlineMath","value":"u_1","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lMR8QYyRAH"},{"type":"text","value":" and ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"Na8Idq39RK"},{"type":"inlineMath","value":"u_2","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">u_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"XBYg3FPPb0"},{"type":"text","value":".","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"iErJ6kEDKa"}],"key":"Q6Og3TwJcz"}],"class":"dropdown","key":"eB9jlKqaGn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"params =[0.01, 0.5, 0];    % gamma, L, k\nivp = ode(ODEFcn=@f63_pendulums, InitialValue=u0, Parameters=params);\ntheta = solutionFcn(ivp, a, b, OutputVariables = 1:2);\nt = linspace(a, b, 1001);\nclf, plot(t, theta(t))\nxlabel(\"t\");  ylabel(\"angle\")\ntitle(\"Uncoupled pendulums\")\nlegend(\"\\theta_1\", \"\\theta_2\");","key":"XDU57Ab4jo"},{"type":"output","id":"XKy6tnoJJXFb8DhpE5mhN","data":[{"output_type":"stream","name":"stderr","text":"Error using ode/solutionFcn (line 371)\nThe end point arguments to the solutionFcn method are in the wrong order. Try reversing them."}],"key":"JDxs5QrzKC"}],"key":"WPmwgajT5O"},{"type":"paragraph","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"You can see that the pendulums swing independently. Because the model is nonlinear and the initial angles are not small, they have slightly different periods of oscillation, and they go in and out of phase.","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"xYX3NYssC5"}],"key":"KoagDYhUXd"},{"type":"paragraph","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"With coupling activated, a different behavior is seen.","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"Q5neoqnfXK"}],"key":"HM5DXR2qw1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"params(3) = 1;\nivp = ode(ODEFcn=@f63_pendulums, InitialValue=u0, Parameters=params);\ntheta = solutionFcn(ivp, a, b, OutputVariables = 1:2);\nclf, plot(t, theta(t))\nxlabel(\"t\");  ylabel(\"angle\")\ntitle(\"Coupled pendulums\")\nlegend(\"\\theta_1\", \"\\theta_2\");","key":"vt51aY71zf"},{"type":"output","id":"uaTkC07fG74hHE9nc29rK","data":[{"output_type":"stream","name":"stderr","text":"Error using ode/solutionFcn (line 371)\nThe end point arguments to the solutionFcn method are in the wrong order. Try reversing them."}],"key":"PQMfiP3MWn"}],"key":"zSGRasTsJG"},{"type":"paragraph","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"The coupling makes the pendulums swap energy back and forth.","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"yiNq8bZvrN"}],"key":"YP7aHpIo3L"}],"label":"demo-systems-coupledpendula-matlab","identifier":"demo-systems-coupledpendula-matlab","html_id":"demo-systems-coupledpendula-matlab","key":"b2NNVHuCHP"},{"type":"heading","depth":3,"position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"6.4 ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"B7ZD4pc2hb"},{"type":"link","identifier":"section-ivp-rk","label":"section-ivp-rk","kind":"narrative","position":{"start":{"line":369,"column":5},"end":{"line":369,"column":20}},"url":"/rk","internal":true,"dataUrl":"/rk.json","children":[{"type":"text","value":"Runge–Kutta methods","key":"EMyWuKn5AI"}],"key":"thzaFZR39z"}],"identifier":"id-6-4","label":"6.4 ","html_id":"id-6-4","implicit":true,"key":"qS8eSUsklo"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-rk-converge","label":"demo-rk-converge","kind":"proof:example","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":18}},"children":[{"type":"text","value":"Example ","key":"NHbLOvAexo"},{"type":"text","value":"6.4.1","key":"w47QrJ6UNO"}],"template":"Example %s","enumerator":"6.4.1","resolved":true,"html_id":"demo-rk-converge","remote":true,"url":"/rk","dataUrl":"/rk.json","key":"hAVAmkfXcI"}],"key":"xoTutv1s8I"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"ldXfKyES6V"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"wdj1E9sEtG"}],"key":"CmroVJDeJn"},{"type":"text","value":" ","key":"oSKJ5IBICB"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"U5mC2mzynR"},{"type":"text","value":" over ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"oIwKAyFmew"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"Nqi7SMPmTQ"},{"type":"text","value":", with ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"SoSWQxOXyB"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"oGt8KKSmJ8"},{"type":"text","value":".","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"YkIEzjzOjy"}],"key":"TVATa1w11Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialValue = -1;\na = 0;  b = 4;","key":"klwubLkTGI"},{"type":"output","id":"hniYpXGUM-KtneCERMT1k","data":[],"key":"V8h46NPwja"}],"key":"CElYxYC7GB"},{"type":"paragraph","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"children":[{"type":"text","value":"We use a built-in solver to construct an accurate approximation to the exact solution.","position":{"start":{"line":383,"column":1},"end":{"line":383,"column":1}},"key":"nq3YP6berI"}],"key":"rqQfEtZOtb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp.AbsoluteTolerance = 1e-13;\nivp.RelativeTolerance = 1e-13;\nu_ref = solutionFcn(ivp, a, b);","key":"s7tq062KUh"},{"type":"output","id":"oxJVILfUXt5Z7CsGsXuUe","data":[],"key":"i3WIzkufmv"}],"key":"F4e0NJHShr"},{"type":"paragraph","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of our two Runge–Kutta implementations.","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"key":"s1dDx9P6Ym"}],"key":"uMIRzuoyLv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round(2 * 10.^(0:0.5:3)');\nerr = zeros(length(n), 2);\nfor i = 1:length(n)\n    [t, u] = ie2(ivp, a, b, n(i));\n    err(i, 1) = norm(u_ref(t) - u, Inf);\n    [t, u] = rk4(ivp, a, b, n(i));\n    err(i, 2) = norm(u_ref(t) - u, Inf);\nend\n\ntable(n, err(:, 1), err(:, 2), variableNames=[\"n\", \"IE2 error\", \"RK4 error\"])","key":"FyUO6IvdoN"},{"type":"output","id":"OUNzmQOe_F7ExoqtVbEbW","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>7x3 table</span></div><table><thead><tr><th>n</th><th>IE2 error</th><th>RK4 error</th></tr></thead><tbody><tr><td>2</td><td>1.7690</td><td>0.8207</td></tr><tr><td>6</td><td>0.5127</td><td>0.7919</td></tr><tr><td>20</td><td>0.0241</td><td>8.1269e-04</td></tr><tr><td>63</td><td>0.0023</td><td>8.0622e-06</td></tr><tr><td>200</td><td>2.2242e-04</td><td>7.6066e-08</td></tr><tr><td>632</td><td>2.2253e-05</td><td>7.5150e-10</td></tr><tr><td>2000</td><td>2.2218e-06</td><td>7.6541e-12</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>7x3 table</span></div><table><thead><tr><th>n</th><th>IE2 error</th><th>RK4 error</th></tr></thead><tbody><tr><td>2</td><td>1.7690</td><td>0.8207</td></tr><tr><td>6</td><td>0.5127</td><td>0.7919</td></tr><tr><td>20</td><td>0.0241</td><td>8.1269e-04</td></tr><tr><td>63</td><td>0.0023</td><td>8.0622e-06</td></tr><tr><td>200</td><td>2.2242e-04</td><td>7.6066e-08</td></tr><tr><td>632</td><td>2.2253e-05</td><td>7.5150e-10</td></tr><tr><td>2000</td><td>2.2218e-06</td><td>7.6541e-12</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"MXXQO1FAOi"}],"key":"EIqhVxjWPH"},{"type":"paragraph","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"text","value":"The amount of computational work at each time step is assumed to be proportional to the number of stages. Let’s compare on an apples-to-apples basis by using the number of ","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"vfQ9ooDmCT"},{"type":"inlineMath","value":"f","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"DN6Xp7BgR5"},{"type":"text","value":"-evaluations on the horizontal axis.","position":{"start":{"line":406,"column":1},"end":{"line":406,"column":1}},"key":"wCLW7CDD6h"}],"key":"uO2srs5z9u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, loglog([2*n 4*n], err, '-o')\nhold on\nloglog(2*n, 1e-5 * (n / n(end)) .^ (-2), '--')\nloglog(4*n, 1e-10 * (n / n(end)) .^ (-4), '--')\nxlabel(\"f-evaluations\");  ylabel(\"inf-norm error\")\ntitle(\"Convergence of RK methods\")\nlegend(\"IE2\", \"RK4\", \"O(n^{-2})\", \"O(n^{-4})\", \"location\", \"southwest\");","key":"rkgCrY4hWi"},{"type":"output","id":"pZ5zE6QBgmZ34OX12heT2","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"02e474cd1b742926dba35f5dd34a5326","path":"/build/02e474cd1b742926dba35f5dd34a5326.png"}}}],"key":"tQ41wvj2Lf"}],"key":"SNGmBT0v18"},{"type":"paragraph","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"children":[{"type":"text","value":"The fourth-order variant is more efficient in this problem over a wide range of accuracy.","position":{"start":{"line":418,"column":1},"end":{"line":418,"column":1}},"key":"MLyrdaHBLj"}],"key":"TgRlSXk8bV"}],"label":"demo-rk-converge-matlab","identifier":"demo-rk-converge-matlab","html_id":"demo-rk-converge-matlab","key":"LpSZpmYvLh"},{"type":"heading","depth":3,"position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"children":[{"type":"text","value":"6.5 ","position":{"start":{"line":421,"column":1},"end":{"line":421,"column":1}},"key":"BQaP1lOmVX"},{"type":"link","identifier":"section-ivp-adaptive","label":"section-ivp-adaptive","kind":"narrative","position":{"start":{"line":421,"column":5},"end":{"line":421,"column":26}},"url":"/adaptive-rk","internal":true,"dataUrl":"/adaptive-rk.json","children":[{"type":"text","value":"Adaptive Runge–Kutta","key":"rzlbzoqIDf"}],"key":"CtLkPzSMEf"}],"identifier":"id-6-5","label":"6.5 ","html_id":"id-6-5","implicit":true,"key":"iPLIkNGwfk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-basic","label":"demo-adapt-basic","kind":"proof:example","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":18}},"children":[{"type":"text","value":"Example ","key":"q7uqsJIZy2"},{"type":"text","value":"6.5.1","key":"hWv98kXOuH"}],"template":"Example %s","enumerator":"6.5.1","resolved":true,"html_id":"demo-adapt-basic","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"YrxdHB2pUA"}],"key":"Ion6iWboRw"},{"type":"paragraph","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"text","value":"Let’s run adaptive RK on  ","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"kopc01nTAw"},{"type":"inlineMath","value":"u'=e^{t-u\\sin u}","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><msup><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>u</mi><mi>sin</mi><mo>⁡</mo><mi>u</mi></mrow></msup></mrow><annotation encoding=\"application/x-tex\">u&#x27;=e^{t-u\\sin u}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8305em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8305em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mop mtight\"><span class=\"mtight\">s</span><span class=\"mtight\">i</span><span class=\"mtight\">n</span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mathnormal mtight\">u</span></span></span></span></span></span></span></span></span></span></span></span>","key":"fd2wp73Ro6"},{"type":"text","value":".","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"IqYxOqIPje"}],"key":"C6RCGCJ1tw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) exp(t - u * sin(u));\nivp.InitialValue = 0;\na = 0;  b = 5;\n\n[t, u] = rk23(ivp, a, b, 1e-5);\nclf, plot(t, u)\nxlabel(\"t\");  ylabel(\"u(t)\")\ntitle((\"Adaptive IVP solution\"));","key":"wRn6zkuArK"},{"type":"output","id":"2w-xGjJnS8ZW-ypJxUq1Y","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b7655b9dbc10554bdcd78220c8aedd64","path":"/build/b7655b9dbc10554bdcd78220c8aedd64.png"}}}],"key":"VjyaxcSYB5"}],"key":"g05dkSPJ6Y"},{"type":"paragraph","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"children":[{"type":"text","value":"The solution makes a very abrupt change near ","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"key":"aRgQ4gBWZE"},{"type":"inlineMath","value":"t=2.4","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2.4</mn></mrow><annotation encoding=\"application/x-tex\">t=2.4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.4</span></span></span></span>","key":"E2PBEgNqJ4"},{"type":"text","value":". The resulting time steps vary over three orders of magnitude.","position":{"start":{"line":439,"column":1},"end":{"line":439,"column":1}},"key":"zvqcwusI1z"}],"key":"eIv6uXSQEm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Delta_t = diff(t);\nsemilogy(t(1:end-1), Delta_t) \nxlabel(\"t\");  ylabel(\"step size\")\ntitle((\"Adaptive step sizes\"));","key":"iWh9etsltc"},{"type":"output","id":"s0ukkKxiu84u2wGGeXUY3","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d5c7b9332417b8169630c0d4f16506a9","path":"/build/d5c7b9332417b8169630c0d4f16506a9.png"}}}],"key":"PkdETkMpLC"}],"key":"oFH2dt6iFR"},{"type":"paragraph","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"children":[{"type":"text","value":"If we had to run with a uniform step size to get this accuracy, it would be","position":{"start":{"line":448,"column":1},"end":{"line":448,"column":1}},"key":"lVkDbSP6zH"}],"key":"sUIdXg3DNf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"minimum step size = %.2e\", min(Delta_t))","key":"dieXMUQzam"},{"type":"output","id":"7PUPGPyE1upmXYffnn21P","data":[{"output_type":"stream","name":"stdout","text":"minimum step size = "}],"key":"kQLPzCYjP4"}],"key":"ITzNdrguzK"},{"type":"paragraph","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"children":[{"type":"text","value":"On the other hand, the average step size that was actually taken was","position":{"start":{"line":454,"column":1},"end":{"line":454,"column":1}},"key":"SdJLDzTjYn"}],"key":"tUSXLUTpVc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"fprintf(\"average step size = %.2e\", mean(Delta_t))","key":"kcWus1BgyG"},{"type":"output","id":"y9zWahr2qe2vN0BxHS1e4","data":[{"output_type":"stream","name":"stdout","text":"average step size = "},{"output_type":"stream","name":"stdout","text":"NaN"}],"key":"Y9IpqeLn1j"}],"key":"rzjLQCja57"},{"type":"paragraph","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"children":[{"type":"text","value":"We took fewer steps by a factor of almost 1000! Even accounting for the extra stage per step and the occasional rejected step, the savings are clear.","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":1}},"key":"atddd2BYu5"}],"key":"mmACMdynX5"}],"label":"demo-adapt-basic-matlab","identifier":"demo-adapt-basic-matlab","html_id":"demo-adapt-basic-matlab","key":"mj5HD4Fdoo"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-adapt-sing","label":"demo-adapt-sing","kind":"proof:example","position":{"start":{"line":465,"column":1},"end":{"line":465,"column":17}},"children":[{"type":"text","value":"Example ","key":"jB5uNkw8RH"},{"type":"text","value":"6.5.2","key":"aNSunVwP3E"}],"template":"Example %s","enumerator":"6.5.2","resolved":true,"html_id":"demo-adapt-sing","remote":true,"url":"/adaptive-rk","dataUrl":"/adaptive-rk.json","key":"bgiKBh6jDL"}],"key":"UvrUbAQbSv"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"G9tSjMrf4c"},{"type":"crossReference","kind":"proof:example","identifier":"demo-basics-sing","label":"demo-basics-sing","children":[{"type":"text","value":"Demo ","key":"rQKd8daWkf"},{"type":"text","value":"6.1.3","key":"NYZYFObFh3"}],"template":"Example %s","enumerator":"6.1.3","resolved":true,"html_id":"demo-basics-sing","remote":true,"url":"/basics","dataUrl":"/basics.json","key":"iiYLTgmEl1"},{"type":"text","value":" we saw an ","key":"bUJRTGUiXQ"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"BjwyQIw8U6"}],"key":"sQGRAhfWu6"},{"type":"text","value":" that appears to blow up in a finite amount of time. Because the solution increases so rapidly as it approaches the blowup, adaptive stepping is required even to get close.","key":"zMDWQFIjnx"}],"key":"O1jCuovswU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) (t + u)^2;\nivp.InitialValue = 1;\n[t, u] = rk23(ivp, 0, 1, 1e-5);","key":"vqUmOkbR2m"},{"type":"output","id":"LXysPdu8gRr3Zr5mqK9ez","data":[],"key":"z3qgKqBgKx"}],"key":"qaBeyE662I"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"In fact, the failure of the adaptivity gives a decent idea of when the singularity occurs.","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"KHB07AI2Sf"}],"key":"GkN3TwAUO5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, semilogy(t, u)\nxlabel(\"t\");  ylabel(\"u(t)\")\ntitle(\"Adaptive solution near a singularity\")\n\ntf = t(end);\nxline(tf, \"linestyle\", \"--\")\ntext(tf, 1e5, sprintf(\" t = %.6f \", tf))","key":"XnzV28u6B1"},{"type":"output","id":"GMEjoDn-m_TEOwr246sKa","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ad6d29b9b980b17b71877a37063f3990","path":"/build/ad6d29b9b980b17b71877a37063f3990.png"}}}],"key":"LABBQmwyy2"}],"key":"cYiM1lRFU6"}],"label":"demo-adapt-sing-matlab","identifier":"demo-adapt-sing-matlab","html_id":"demo-adapt-sing-matlab","key":"bjh20uxXiF"},{"type":"heading","depth":3,"position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"children":[{"type":"text","value":"6.6 ","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"Vv0NgPHzxr"},{"type":"link","identifier":"section-ivp-multistep","label":"section-ivp-multistep","kind":"narrative","position":{"start":{"line":488,"column":5},"end":{"line":488,"column":27}},"url":"/multistep","internal":true,"dataUrl":"/multistep.json","children":[{"type":"text","value":"Multistep methods","key":"zrzAuHijDE"}],"key":"qyh8CZL4b7"}],"identifier":"id-6-6","label":"6.6 ","html_id":"id-6-6","implicit":true,"key":"XPOIvS2hib"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-ab4","label":"demo-implicit-ab4","kind":"proof:example","position":{"start":{"line":490,"column":1},"end":{"line":490,"column":19}},"children":[{"type":"text","value":"Example ","key":"YeJZmEFJ5U"},{"type":"text","value":"6.7.1","key":"f3FBMofkEG"}],"template":"Example %s","enumerator":"6.7.1","resolved":true,"html_id":"demo-implicit-ab4","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"CXo2O051pQ"}],"key":"Sy8e2Gw5YS"},{"type":"paragraph","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"children":[{"type":"text","value":"We study the convergence of AB4 using the ","key":"HK8R8JZbWT"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"avY35I2Owu"}],"key":"PvyGZjQ0BB"},{"type":"text","value":" ","key":"IhPmuOoDV1"},{"type":"inlineMath","value":"u'=\\sin[(u+t)^2]","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>u</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><mi>u</mi><mo>+</mo><mi>t</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">u&#x27;=\\sin[(u+t)^2]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">[(</span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"Uc0SvIzMks"},{"type":"text","value":" over ","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"fHQf6Ip1VV"},{"type":"inlineMath","value":"0\\le t \\le 4","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"WbX3RzU9LU"},{"type":"text","value":", with ","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"ogw9Fil8xT"},{"type":"inlineMath","value":"u(0)=-1","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">u(0)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"v56UuiKtzo"},{"type":"text","value":". As usual, a built-in solver is called to give an accurate reference solution.","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"C5ggqb7aTk"}],"key":"a4DkcjZnjw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) sin((t + u)^2);\nivp.InitialValue = -1;\na = 0;  b = 4;\nivp.AbsoluteTolerance = 1e-13;\nivp.RelativeTolerance = 1e-13;\nu_ref = solutionFcn(ivp, a, b);","key":"fK87hil30d"},{"type":"output","id":"48MZle3hjXUPf-O1nDg65","data":[],"key":"MnFYB8uMY9"}],"key":"LaWvtP8geT"},{"type":"paragraph","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"children":[{"type":"text","value":"Now we perform a convergence study of the AB4 code.","position":{"start":{"line":504,"column":1},"end":{"line":504,"column":1}},"key":"KE8JAcuhyy"}],"key":"TAgwfrUt5F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = round(4 * 10.^(0:0.5:3)');\nerr = zeros(size(n));\nfor i = 1:length(n)\n    [t, u] = ab4(ivp, a, b, n(i));\n    err(i) = norm(u_ref(t) - u, Inf);\nend\ntable(n, err, variableNames=[\"n\", \"inf-norm error\"])","key":"L9DT4oU6Io"},{"type":"output","id":"sODWBebWUn3Q7DZIvGF1L","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>7x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>4</td><td>0.500440170451885</td></tr><tr><td>13</td><td>1.391294717583058</td></tr><tr><td>40</td><td>0.006278094753107</td></tr><tr><td>126</td><td>9.949415404897355e-05</td></tr><tr><td>400</td><td>1.095975864839893e-06</td></tr><tr><td>1265</td><td>1.127615778528934e-08</td></tr><tr><td>4000</td><td>1.133054761126573e-10</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>7x2 table</span></div><table><thead><tr><th>n</th><th>inf-norm error</th></tr></thead><tbody><tr><td>4</td><td>0.500440170451885</td></tr><tr><td>13</td><td>1.391294717583058</td></tr><tr><td>40</td><td>0.006278094753107</td></tr><tr><td>126</td><td>9.949415404897355e-05</td></tr><tr><td>400</td><td>1.095975864839893e-06</td></tr><tr><td>1265</td><td>1.127615778528934e-08</td></tr><tr><td>4000</td><td>1.133054761126573e-10</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"UhBxfUBTyU"}],"key":"ISvRIgmseZ"},{"type":"paragraph","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"text","value":"The method should converge as ","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"xsrAssJnpF"},{"type":"inlineMath","value":"O(h^4)","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>4</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(h^4)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"PyTNHg0lto"},{"type":"text","value":", so a log-log scale is appropriate for the errors.","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"OtwfH402X0"}],"key":"XSuSGqr8Gm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, loglog(n, err, '-o')\nhold on\nloglog(n, 0.5 * err(end) * (n / n(end)) .^ (-4), '--')\nxlabel(\"n\");  ylabel(\"inf-norm error\")\ntitle(\"Convergence of AB4\")\nlegend(\"AB4\", \"O(n^{-4})\", location=\"southwest\");","key":"vME7ZlUtho"},{"type":"output","id":"6lJV54H3HRdlHpnjCw8p4","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"287ed9a5f37e3310ac68e8f8dd4f57a4","path":"/build/287ed9a5f37e3310ac68e8f8dd4f57a4.png"}}}],"key":"uKfZXDzVur"}],"key":"eRrhA3fjIM"}],"label":"demo-implicit-ab4-matlab","identifier":"demo-implicit-ab4-matlab","html_id":"demo-implicit-ab4-matlab","key":"rDNLynse8p"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-implicit-stiff","label":"demo-implicit-stiff","kind":"proof:example","position":{"start":{"line":529,"column":1},"end":{"line":529,"column":21}},"children":[{"type":"text","value":"Example ","key":"ohTewBDfAH"},{"type":"text","value":"6.7.2","key":"CJsRz4V3ZR"}],"template":"Example %s","enumerator":"6.7.2","resolved":true,"html_id":"demo-implicit-stiff","remote":true,"url":"/implicit","dataUrl":"/implicit.json","key":"CVBQF93feL"}],"key":"hZjzXzixju"},{"type":"paragraph","position":{"start":{"line":531,"column":1},"end":{"line":531,"column":1}},"children":[{"type":"text","value":"The following simple ","key":"p2NDCknuuM"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"PhvHso6MD0"}],"key":"rFL08niT0Z"},{"type":"text","value":" uncovers a surprise.","key":"ayse3e7ht2"}],"key":"DnGmvL3wpZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode;\nivp.ODEFcn = @(t, u, p) u^2 - u^3;\nivp.InitialValue = 0.005;","key":"h0XbojnDSp"},{"type":"output","id":"8OC9WAAHInX4GBWdhZ9Sy","data":[],"key":"nh5erUUdFX"}],"key":"PanfSBFhOc"},{"type":"paragraph","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"children":[{"type":"text","value":"We will solve the problem first with the implicit AM2 method using ","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"S7RnfdGDjR"},{"type":"inlineMath","value":"n=200","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding=\"application/x-tex\">n=200</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">200</span></span></span></span>","key":"GIJX26gLQl"},{"type":"text","value":" steps.","position":{"start":{"line":539,"column":1},"end":{"line":539,"column":1}},"key":"KVuN45rYAo"}],"key":"LDVBAmAMdQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[tI, uI] = am2(ivp, 0, 400, 200);\nclf\nplot(tI, uI)\nxlabel(\"t\");  ylabel((\"u(t)\"));","key":"zo5UWqAQPi"},{"type":"output","id":"UyEBthPjdBf7Ii790xawZ","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fbcd298154fca102f4e1f22086d95bd0","path":"/build/fbcd298154fca102f4e1f22086d95bd0.png"}}}],"key":"GZTySoUa3f"}],"key":"aEaocnQ5G1"},{"type":"paragraph","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"children":[{"type":"text","value":"Now we repeat the process using the explicit AB4 method.","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":1}},"key":"duwk8m9sma"}],"key":"U9PA09Bnsg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[tE, uE] = ab4(ivp, 0, 400, 200);\nhold on\nplot(tE, uE, '.', 'markersize', 8)\nylim([-5, 3])\nlegend(\"AM2\", \"AB4\");","key":"tkKjSDJYn5"},{"type":"output","id":"UEFvWIBJgmIuot5bFcDJ0","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4a7de3e7ec62d267616a0febea182c89","path":"/build/4a7de3e7ec62d267616a0febea182c89.png"}}}],"key":"wAlHfOTQRo"}],"key":"Xeot7HH7Nh"},{"type":"paragraph","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"children":[{"type":"text","value":"Once the solution starts to take off, the AB4 result goes catastrophically wrong.","position":{"start":{"line":558,"column":1},"end":{"line":558,"column":1}},"key":"cuoksxemsq"}],"key":"z4aj6yJuAn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format short e\nuE(105:111)","key":"hS3tE9Cp5V"},{"type":"output","id":"pvbJswzSgOG9xHRS4HEsg","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×7 double\n1.0e+00 *\n\n   7.5539e-01   1.4373e+00  -3.2890e+00   2.1418e+02  -4.4821e+07   4.1269e+23  -3.2214e+71\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×7 double\n1.0e+00 *\n\n   7.5539e-01   1.4373e+00  -3.2890e+00   2.1418e+02  -4.4821e+07   4.1269e+23  -3.2214e+71\n","content_type":"text/plain"}}}],"key":"NSFUQRB2RM"}],"key":"uQwV4X2lh9"},{"type":"paragraph","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"children":[{"type":"text","value":"We hope that AB4 will converge in the limit ","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"pz31RWOtpP"},{"type":"inlineMath","value":"h\\to 0","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h\\to 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"bqtGc5riJ5"},{"type":"text","value":", so let’s try using more steps.","position":{"start":{"line":565,"column":1},"end":{"line":565,"column":1}},"key":"bCi8IjJcAU"}],"key":"ZkGPSxLzYh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf,  plot(tI, uI, '.', 'markersize', 10)\nhold on\n[tE, uE] = ab4(ivp, 0, 400, 1000);\nplot(tE, uE)\n[tE, uE] = ab4(ivp, 0, 400, 1600);\nplot(tE, uE)\nlegend(\"AM2, n=200\", \"AB4, n=1000\", \"AB4, n=1600\", location=\"northwest\");","key":"RbUQCl0Ltm"},{"type":"output","id":"ii55YISkOAqF0-t2TufOH","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"54ec48db73ebfcc4d7ac4dcd0b18383f","path":"/build/54ec48db73ebfcc4d7ac4dcd0b18383f.png"}}},{"output_type":"stream","name":"stderr","text":"Error using ^ (line 52)\nIncorrect dimensions for raising a matrix to a power. Check that the matrix is square and the power is a scalar. To operate on each element of the matrix individually, use POWER (.^) for elementwise power.\n\nError in Notebook>@(t,u,p)u^2-u^3 (line 2)\nhold on\n\nError in rk4 (line 25)\n  k1 = h * du_dt( t(i),       u(:, i)       , p);\n\nError in ab4 (line 24)\n[ts, us] = rk4(ivp, a, a + (k-1)*h, k-1);"}],"key":"rkWUa8VuyW"}],"key":"f4fuVJjWBt"},{"type":"paragraph","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"So AB4, which is supposed to be ","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"QGg5Q4VSBp"},{"type":"emphasis","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"more","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"OUhBPTtjya"}],"key":"mqzah8BNMd"},{"type":"text","value":" accurate than AM2, actually needs something like 8 times as many steps to get a reasonable-looking answer!","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"w4HGKJttEs"}],"key":"xEX70KkPlV"}],"label":"demo-implicit-stiff-matlab","identifier":"demo-implicit-stiff-matlab","html_id":"demo-implicit-stiff-matlab","key":"tCMqamp4nB"},{"type":"heading","depth":3,"position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"children":[{"type":"text","value":"6.7 ","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"key":"g34RboM5f4"},{"type":"link","identifier":"section-ivp-implicit","label":"section-ivp-implicit","kind":"narrative","position":{"start":{"line":580,"column":5},"end":{"line":580,"column":26}},"url":"/implicit","internal":true,"dataUrl":"/implicit.json","children":[{"type":"text","value":"Implementation of multistep methods","key":"XkCIOoHIuZ"}],"key":"XvhrdWo1ej"}],"identifier":"id-6-7","label":"6.7 ","html_id":"id-6-7","implicit":true,"key":"LNjZ6NeNnC"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-zs-liaf","label":"demo-zs-LIAF","kind":"proof:example","position":{"start":{"line":582,"column":1},"end":{"line":582,"column":14}},"children":[{"type":"text","value":"Example ","key":"zvbfrIeQZw"},{"type":"text","value":"6.8.1","key":"cuiaWK8PW7"}],"template":"Example %s","enumerator":"6.8.1","resolved":true,"html_id":"demo-zs-liaf","remote":true,"url":"/zerostability","dataUrl":"/zerostability.json","key":"WJw7uCLVHB"}],"key":"Hb6Zyh07PB"},{"type":"paragraph","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"children":[{"type":"text","value":"We’ll measure the error at the time ","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"Fv9o2fPvol"},{"type":"inlineMath","value":"t=1","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">t=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"hzKhI2QaZx"},{"type":"text","value":".","position":{"start":{"line":584,"column":1},"end":{"line":584,"column":1}},"key":"rVhp4YkGKu"}],"key":"So2qAPgewY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"du_dt = @(t, u) u;\nu_exact = @exp;\na = 0;  b = 1;\nn = [5, 10, 20, 40, 60]';\nerr = zeros(size(n));\nfor j = 1:length(n)\n    h = (b - a) / n(j);\n    t = a + h *(0:n(j));\n    u = [1, u_exact(h), zeros(1, n(j) - 1)];\n    f = [du_dt(t(1), u(1)), zeros(1, n(j) - 2)];\n    for i = 2:n(j)\n        f(i) = du_dt(t(i), u(i));\n        u(i+1) = -4*u(i) + 5*u(i-1) + h * (4*f(i) + 2*f(i-1));\n    end\n    err(j) = abs(u_exact(b) - u(end));\nend\n\nh = (b-a) ./ n;\ntable(n, h, err)","key":"aTm82gfG30"},{"type":"output","id":"hF2wAGQjH0yG2EkPh6ntI","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x3 table</span></div><table><thead><tr><th>n</th><th>h</th><th>err</th></tr></thead><tbody><tr><td>5</td><td>0.200000000000000</td><td>0.016045199221587</td></tr><tr><td>10</td><td>0.100000000000000</td><td>2.845479238377764</td></tr><tr><td>20</td><td>0.050000000000000</td><td>1.622496146221866e+06</td></tr><tr><td>40</td><td>0.025000000000000</td><td>9.344202752462701e+18</td></tr><tr><td>60</td><td>0.016666666666667</td><td>1.740134731635269e+32</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x3 table</span></div><table><thead><tr><th>n</th><th>h</th><th>err</th></tr></thead><tbody><tr><td>5</td><td>0.200000000000000</td><td>0.016045199221587</td></tr><tr><td>10</td><td>0.100000000000000</td><td>2.845479238377764</td></tr><tr><td>20</td><td>0.050000000000000</td><td>1.622496146221866e+06</td></tr><tr><td>40</td><td>0.025000000000000</td><td>9.344202752462701e+18</td></tr><tr><td>60</td><td>0.016666666666667</td><td>1.740134731635269e+32</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"sO9VUO1gFH"}],"key":"u45SB4rXpD"},{"type":"paragraph","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"children":[{"type":"text","value":"The error starts out promisingly, but things explode from there. A graph of the last numerical attempt yields a clue.","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"key":"vsTfgsTVdf"}],"key":"l2wUbZ5kOp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nsemilogy(t, abs(u))\nxlabel(\"t\");  ylabel(\"|u(t)|\")\ntitle((\"LIAF solution\"));","key":"buH6YrK2f0"},{"type":"output","id":"FvfnrYMwGqr55Qa9W_FlF","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b0de964d49336878a36e519fc520f3da","path":"/build/b0de964d49336878a36e519fc520f3da.png"}}}],"key":"bKnzveMqOO"}],"key":"ztpafrUnHi"},{"type":"paragraph","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"children":[{"type":"text","value":"It’s clear that the solution is growing exponentially in time.","position":{"start":{"line":617,"column":1},"end":{"line":617,"column":1}},"key":"wFXDMyundn"}],"key":"XUEa0FguV8"}],"label":"demo-zs-LIAF-matlab","identifier":"demo-zs-liaf-matlab","html_id":"demo-zs-liaf-matlab","key":"C5Q9oGwwGx"}],"key":"PJF2zfYHHF"}],"key":"WvGA7suK8E"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 5","url":"/chapter5-1","group":"MATLAB codes"},"next":{"title":"Chapter 7","url":"/chapter7-1","group":"MATLAB codes"}}},"domain":"http://localhost:3002"}