{"kind":"Notebook","sha256":"05efe9ec525ce32f965a32dd5f050730838fdead96f39a39554dddcf029f84ae","slug":"converge-2","location":"/chapter4/section4/julia/converge.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"converge.ipynb","url":"/fnc/build/converge-35561b8543fc0db990815a7c56356b3b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"J2GYFFRvZP"},{"type":"text","value":"4.4.2","key":"Ep43K9FXZO"}],"key":"RwO3khHvZW"}],"identifier":"demo-secant-converge","label":"demo-secant-converge","kind":"proof:example","template":"Example %s","enumerator":"4.4.2","resolved":true,"html_id":"demo-secant-converge","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"T216kXYuJs"}],"key":"caK11IRPra"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We check the convergence of the secant method from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lWYLJisKzC"},{"type":"crossReference","kind":"proof:example","identifier":"demo-secant-line","label":"demo-secant-line","children":[{"type":"text","value":"Demo ","key":"PdpGc2tYok"},{"type":"text","value":"4.4.1","key":"R9P4Jy2ZSS"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"nekFz1J4lG"},{"type":"text","value":". Again we will use extended precision to get a longer sequence than double precision allows.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"earlQbBGjq"}],"key":"SGPWyJE0en"}],"key":"kN8vAl7mjn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:28:31.550000Z","iopub.status.busy":"2025-01-14T15:28:28.846000Z","iopub.execute_input":"2025-01-14T15:28:30.434000Z","shell.execute_reply":"2025-01-14T15:28:31.548000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"f(x) = x * exp(x) - 2\nx = FNC.secant(f, BigFloat(1), BigFloat(0.5), xtol=1e-80, ftol=1e-80);","key":"hL9lBxiui9"},{"type":"output","id":"_1LL_aScyPDSpyucFxxz9","data":[],"key":"o8daCyJDMe"}],"key":"KpgJGznaqe"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use the last value as a proxy.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UZPWTrgFMH"}],"key":"f48rD9qk7j"}],"key":"lQ9jSVuviN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:28:34.931000Z","iopub.status.busy":"2025-01-14T15:28:31.563000Z","iopub.execute_input":"2025-01-14T15:28:31.564000Z","shell.execute_reply":"2025-01-14T15:28:34.930000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"r = x[end]","key":"qf8waij1rv"},{"type":"output","id":"LMbe9Kb-tSFmxsXxLp8mf","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"0.8526055020137254913464724146953174668984533001514035087721073946525150656742605","content_type":"text/plain"}}}],"key":"wBlcnXXPSz"}],"key":"P2ZtaXXifx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UE03f33dDa"}],"key":"a19f5iCcjo"}],"key":"pVmzf8EYaf"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:28:50.918000Z","iopub.status.busy":"2025-01-14T15:28:34.970000Z","iopub.execute_input":"2025-01-14T15:28:34.971000Z","shell.execute_reply":"2025-01-14T15:28:50.907000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = @. Float64(r - x[1:end-2])","key":"QleFborv0l"},{"type":"output","id":"O91TiB1EWQ6SquqnnAxK8","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"11-element Vector{Float64}:\n -0.14739449798627452\n  0.3526055020137255\n  0.04223372706144885\n -0.013026425327222755\n  0.00042747994131549927\n  4.269915586133851e-6\n -1.4054770126368277e-9\n  4.620323656624992e-15\n  4.999480931132388e-24\n -1.7783862252641536e-38\n  6.845099610444838e-62","content_type":"text/plain"}}}],"key":"dooATTAb0I"}],"key":"KU0wQHSHAa"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It’s not easy to see the convergence rate by staring at these numbers. We can use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JJNhxgdxxe"},{"type":"crossReference","kind":"equation","identifier":"superlinear-rate","label":"superlinear-rate","children":[{"type":"text","value":"(","key":"Zkey04vdp3"},{"type":"text","value":"4.4.8","key":"kw7e6fj3nk"},{"type":"text","value":")","key":"rRy0MDEcWM"}],"template":"(%s)","enumerator":"4.4.8","resolved":true,"html_id":"superlinear-rate","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"RECAHEjxYR"},{"type":"text","value":" to try to expose the superlinear convergence rate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s8TGn0BgzN"}],"key":"NHG5E93oCV"}],"key":"uFA3iwugVE"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:29:03.547000Z","iopub.status.busy":"2025-01-14T15:28:50.997000Z","iopub.execute_input":"2025-01-14T15:28:50.998000Z","shell.execute_reply":"2025-01-14T15:29:03.478000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"logerr = @. log10(abs(ϵ))\nratios = [NaN; [logerr[i+1] / logerr[i] for i in 1:length(logerr)-1]]\n@pt :header=[\"iteration\", \"error\", \"log error\", \"ratio\"] [eachindex(ϵ) ϵ logerr ratios]","key":"Y0cMnkN4Ox"},{"type":"output","id":"E3lN1iRlZKw5ngWhchkAT","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">iteration</th>\n      <th style = \"text-align: right;\">error</th>\n      <th style = \"text-align: right;\">log error</th>\n      <th style = \"text-align: right;\">ratio</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">1.0</td>\n      <td style = \"text-align: right;\">-0.147394</td>\n      <td style = \"text-align: right;\">-0.831519</td>\n      <td style = \"text-align: right;\">NaN</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">2.0</td>\n      <td style = \"text-align: right;\">0.352606</td>\n      <td style = \"text-align: right;\">-0.452711</td>\n      <td style = \"text-align: right;\">0.544439</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">3.0</td>\n      <td style = \"text-align: right;\">0.0422337</td>\n      <td style = \"text-align: right;\">-1.37434</td>\n      <td style = \"text-align: right;\">3.0358</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">4.0</td>\n      <td style = \"text-align: right;\">-0.0130264</td>\n      <td style = \"text-align: right;\">-1.88517</td>\n      <td style = \"text-align: right;\">1.37169</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">5.0</td>\n      <td style = \"text-align: right;\">0.00042748</td>\n      <td style = \"text-align: right;\">-3.36908</td>\n      <td style = \"text-align: right;\">1.78715</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">6.0</td>\n      <td style = \"text-align: right;\">4.26992e-6</td>\n      <td style = \"text-align: right;\">-5.36958</td>\n      <td style = \"text-align: right;\">1.59378</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">7.0</td>\n      <td style = \"text-align: right;\">-1.40548e-9</td>\n      <td style = \"text-align: right;\">-8.85218</td>\n      <td style = \"text-align: right;\">1.64858</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">8.0</td>\n      <td style = \"text-align: right;\">4.62032e-15</td>\n      <td style = \"text-align: right;\">-14.3353</td>\n      <td style = \"text-align: right;\">1.61941</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">9.0</td>\n      <td style = \"text-align: right;\">4.99948e-24</td>\n      <td style = \"text-align: right;\">-23.3011</td>\n      <td style = \"text-align: right;\">1.62543</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">10.0</td>\n      <td style = \"text-align: right;\">-1.77839e-38</td>\n      <td style = \"text-align: right;\">-37.75</td>\n      <td style = \"text-align: right;\">1.6201</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">11.0</td>\n      <td style = \"text-align: right;\">6.8451e-62</td>\n      <td style = \"text-align: right;\">-61.1646</td>\n      <td style = \"text-align: right;\">1.62026</td>\n    </tr>\n  </tbody>\n</table>\n","content_type":"text/html"}}}],"key":"pG8J2ZK4fv"}],"key":"ZiDcVhmyAx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As expected, this settles in at around 1.618.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vqjkq6TPuJ"}],"key":"MghAjmRYM6"}],"key":"ckBsG9CSsE"}],"key":"GbMw4Gm6Xc"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Line","url":"/line-1","group":"Chapter 4"},"next":{"title":"Iqi","url":"/iqi","group":"Chapter 4"}}},"domain":"http://localhost:3000"}