{"version":2,"kind":"Notebook","sha256":"f710c01819b7625877d6cc78a4e7cfc088bf889db9be24826934f9eeed71d97a","slug":"chapter7-1","location":"/matlab/chapter7.md","dependencies":[],"frontmatter":{"title":"Chapter 7","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter7.md","exports":[{"format":"md","filename":"chapter7.md","url":"/build/chapter7-f6ef067edcd784ea5cdd6628b40c1498.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nt4Mlq2j7j"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"hvMyCcvm9w"}],"key":"xXhDGXjDVi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;\npwd;","visibility":"show","key":"rvYsneCSPC"},{"type":"output","id":"45Y_RpTX2boeT2qgZXBTV","data":[{"output_type":"stream","name":"stdout","text":"Executing ..."}],"visibility":"show","key":"guYKmQv9ok"}],"data":{"tags":[]},"visibility":"remove","key":"IrJ3yUSv3Y"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"7.1 ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"AtFOckuRd7"},{"type":"link","identifier":"section-matrixanaly-insight","label":"section-matrixanaly-insight","kind":"narrative","position":{"start":{"line":20,"column":5},"end":{"line":20,"column":33}},"url":"/insight","internal":true,"dataUrl":"/insight.json","children":[{"type":"text","value":"From matrix to insight","key":"hVaofkWaPV"}],"key":"sSejmsH5Dy"}],"identifier":"id-7-1","label":"7.1 ","html_id":"id-7-1","implicit":true,"key":"pEIRqgFXvz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-insight-graph","label":"demo-insight-graph","kind":"proof:example","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":20}},"children":[{"type":"text","value":"Example ","key":"r6jqjPL4Fq"},{"type":"text","value":"7.1.4","key":"M4jRKVPwNt"}],"template":"Example %s","enumerator":"7.1.4","resolved":true,"html_id":"demo-insight-graph","remote":true,"url":"/insight","dataUrl":"/insight.json","key":"uivG5IuhjB"}],"key":"IxwS4l88FO"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Here we create an adjacency matrix for a graph on four nodes.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"SvgdQ37Igp"}],"key":"elUuFrfXse"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [0 1 0 0; 1 0 0 0; 1 1 0 1; 0 1 1 0]","key":"tcySo67cMn"},{"type":"output","id":"wZJq4qACOB6KEG7VXUr7-","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 4×4 double\n     0     1     0     0\n     1     0     0     0\n     1     1     0     1\n     0     1     1     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 4×4 double\n     0     1     0     0\n     1     0     0     0\n     1     1     0     1\n     0     1     1     0\n","content_type":"text/plain"}}}],"key":"ZARu7wkK9P"}],"key":"nc3OcJnQQf"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Since this adjacency matrix is not symmetric, the edges are all directed. We use ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"avMl3TG6oB"},{"type":"inlineCode","value":"digraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"M23RgdY1UQ"},{"type":"text","value":" to create a directed graph.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"FiL1MVuWzu"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"graph (network)","kind":"entry"},"emphasis":true}],"label":"index-eks0oVrIzV","identifier":"index-eks0ovrizv","html_id":"index-eks0ovrizv","key":"W37TNlSFpm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"G = digraph(A);\nplot(G)","key":"scHhRKB9CC"},{"type":"output","id":"peWEsu9k3Mw-7hHkLRw5c","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6182df601526c66299bca5b7457e7908","path":"/build/6182df601526c66299bca5b7457e7908.png"}}}],"key":"osog5BrOlg"}],"key":"TLbhdJpy9C"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Here are the counts of all walks of length 3 in the graph:","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"ezF9VtSziY"}],"key":"aJhM7CTbPQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A^3","key":"RcUeiQYkbY"},{"type":"output","id":"LjFreUXbP5Zytx_n3tvcD","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 4×4 double\n     0     1     0     0\n     1     0     0     0\n     3     2     0     1\n     1     3     1     0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 4×4 double\n     0     1     0     0\n     1     0     0     0\n     3     2     0     1\n     1     3     1     0\n","content_type":"text/plain"}}}],"key":"Dl4COw7jC0"}],"key":"C834xhCsMb"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"If the adjacency matrix is symmetric, the result is an undirected graph: all edges connect in both directions.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"amKIEzIYsJ"}],"key":"p9wViMhYCC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [0 1 1 0; 1 0 0 1; 1 0 0 0; 0 1 0 0];\nplot(graph(A))","key":"CPA2BnNVdd"},{"type":"output","id":"1OY97NRRsSO4dd1wuh0ER","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3986b648f7e514b9302983fc3c39fb58","path":"/build/3986b648f7e514b9302983fc3c39fb58.png"}}}],"key":"xXWM9FBct8"}],"key":"jpiCbZeIdm"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"A “buckyball” is an allotrope of carbon atoms with the same connection structure as a soccer ball.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"oMJgscW090"}],"key":"wNqhNz4BKu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"plot(graph(bucky))","key":"EQ9MK7W2RA"},{"type":"output","id":"j1qo3Oar-RQLLARL_hlrZ","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a148a5a0a662fb4df3482108a083ce6f","path":"/build/a148a5a0a662fb4df3482108a083ce6f.png"}}}],"key":"dm8ugSaFD7"}],"key":"SEJCZAhgYB"}],"label":"demo-insight-graph-matlab","identifier":"demo-insight-graph-matlab","html_id":"demo-insight-graph-matlab","key":"qvs2fN542v"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-insight-image","label":"demo-insight-image","kind":"proof:example","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":20}},"children":[{"type":"text","value":"Example ","key":"slhFg2eiOA"},{"type":"text","value":"7.1.5","key":"sjrLNJlsLy"}],"template":"Example %s","enumerator":"7.1.5","resolved":true,"html_id":"demo-insight-image","remote":true,"url":"/insight","dataUrl":"/insight.json","key":"AprJKpCIHZ"}],"key":"wobsCiuS7h"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"MATLAB ships with a few test images to play with.","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"hMzwwlzSh1"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"Images","kind":"entry"},"emphasis":true}],"label":"index-kCvtoNCH5h","identifier":"index-kcvtonch5h","html_id":"index-kcvtonch5h","key":"uhd0jsuaKA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = imread('peppers.png');\ncolor_size = size(A)","key":"yloQPXWeS7"},{"type":"output","id":"s0HQe2a7MPv2XfWY4QJlK","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>color_size = 1×3 double\n   384   512     3\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"color_size = 1×3 double\n   384   512     3\n","content_type":"text/plain"}}}],"key":"uShJLnXf1L"}],"key":"SYVt4m44kW"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"hOSG2xDQlF"},{"type":"inlineCode","value":"imshow","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"IOFRgHdKZ5"},{"type":"text","value":" to display the image.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"kMZW1uXmjU"}],"key":"GJPf6kB6OU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"imshow(A)","key":"pB9r62qRWk"},{"type":"output","id":"mNszectfBgu4d_NYBkJyR","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"32b44d45ebc0669ae3d5e7df5b24032e","path":"/build/32b44d45ebc0669ae3d5e7df5b24032e.png"}}}],"key":"wQQDkiFsz3"}],"key":"zC8m1MP60i"},{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"The image has three layers or channels for red, green, and blue. We can deal with each layer as a matrix, or (as below) convert it to a single matrix indicating shades of gray from black (0) to white (255). Either way, we have to explicitly convert the entries to floating-point values rather than integers.","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"dAhqq76ePy"}],"key":"QVAE9Znw6O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = im2gray(A);   % collapse from 3 dimensions to 2\ngray_size = size(A)\nimshow(A)","key":"BVZ6lUO2Di"},{"type":"output","id":"hCjTmxewzNnupMAtjrDoQ","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>gray_size = 1×2 double\n   384   512\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"gray_size = 1×2 double\n   384   512\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6d26720ffa8d70c7f3fd7fb490ea4eab","path":"/build/6d26720ffa8d70c7f3fd7fb490ea4eab.png"}}}],"key":"qKhyS0QxX0"}],"key":"nKpZDInptv"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Before we can do any numerical computation, we need to convert the image to a matrix of floating-point numbers.","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"lfIkigwqhT"}],"key":"kUnYo9k1eE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = double(A);","key":"K7hjlIdr38"},{"type":"output","id":"OCvQUpFcDZTSabF0emElQ","data":[],"key":"ZZPRJAA0kb"}],"key":"ePsdvSvy0b"}],"label":"demo-insight-image-matlab","identifier":"demo-insight-image-matlab","html_id":"demo-insight-image-matlab","key":"FEpuLgOzX1"},{"type":"heading","depth":3,"position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"text","value":"7.2 ","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"ro14JZI4L8"},{"type":"link","identifier":"section-matrixanaly-evd","label":"section-matrixanaly-evd","kind":"narrative","position":{"start":{"line":95,"column":5},"end":{"line":95,"column":29}},"url":"/evd","internal":true,"dataUrl":"/evd.json","children":[{"type":"text","value":"Eigenvalue decomposition","key":"ErVBKFRch7"}],"key":"ZNCJwjuwjh"}],"identifier":"id-7-2","label":"7.2 ","html_id":"id-7-2","implicit":true,"key":"CyaV3m2XPa"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-evd-eigen","label":"demo-evd-eigen","kind":"proof:example","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":16}},"children":[{"type":"text","value":"Example ","key":"WasgNuwFjw"},{"type":"text","value":"7.2.2","key":"TsRjefDKLE"}],"template":"Example %s","enumerator":"7.2.2","resolved":true,"html_id":"demo-evd-eigen","remote":true,"url":"/evd","dataUrl":"/evd.json","key":"DzmAVZ9VzL"}],"key":"uinrN7vPhm"},{"type":"paragraph","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"vROmdClr1f"},{"type":"inlineCode","value":"eig","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"AW6lIaeYLc"},{"type":"text","value":" function with one output argument returns a vector of the eigenvalues of a matrix.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"UhlEtwpRrT"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"eig","kind":"entry"},"emphasis":true}],"label":"index-CCjs8FqSqR","identifier":"index-ccjs8fqsqr","html_id":"index-ccjs8fqsqr","key":"YW9vDmY5lT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = pi * ones(2, 2);\nlambda = eig(A)","key":"Soap2nDPrD"},{"type":"output","id":"bQMkS-t8DHLb1tVXPKhwa","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>lambda = 2×1 double\n         0\n    6.2832\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"lambda = 2×1 double\n         0\n    6.2832\n","content_type":"text/plain"}}}],"key":"MVEh6UPWEd"}],"key":"Lvwmar21Pj"},{"type":"paragraph","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"text","value":"With two output arguments given, ","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"nSsD5Ub7sc"},{"type":"inlineCode","value":"eig","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"VKzWBgIOYS"},{"type":"text","value":" returns a matrix eigenvectors and a diagonal matrix with the eigenvalues.","position":{"start":{"line":111,"column":1},"end":{"line":111,"column":1}},"key":"EqHvyC6MEG"}],"key":"dYTm2yM7Db"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eig(A)","key":"GjaSpv2TvS"},{"type":"output","id":"AODcUq6jmV-stnYoNqIuV","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>V = 2×2 double\n   -0.7071    0.7071\n    0.7071    0.7071\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"V = 2×2 double\n   -0.7071    0.7071\n    0.7071    0.7071\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>D = 2×2 double\n         0         0\n         0    6.2832\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"D = 2×2 double\n         0         0\n         0    6.2832\n","content_type":"text/plain"}}}],"key":"vVoQh2Qhrf"}],"key":"GpuzM0KbX9"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"We can check the fact that this is an ","key":"edQfaUO0qF"},{"type":"abbreviation","title":"eigenvalue decomposition","children":[{"type":"text","value":"EVD","key":"iAIWAIkeER"}],"key":"CUfWMxbfhC"},{"type":"text","value":".","key":"VzQTi56EAS"}],"key":"vL0VWRvoX2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm( A - V*D/V )   % / V is like * inv(V)","key":"WxAhpGzOlb"},{"type":"output","id":"KLTOZ1pqaI2oC9DYU53fB","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 8.8818e-16</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 8.8818e-16","content_type":"text/plain"}}}],"key":"i2YtEk5Ne8"}],"key":"BrSyES6hpf"},{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"If the matrix is not diagonalizable, no message is given, but ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"N8JYVz35FN"},{"type":"inlineCode","value":"V","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"POQVsiH1nx"},{"type":"text","value":" will be singular. The robust way to detect that circumstance is via ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"Rryw3LOBE3"},{"type":"inlineMath","value":"\\kappa(\\mathbf{V})","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\kappa(\\mathbf{V})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mclose\">)</span></span></span></span>","key":"HfM4AnqjsR"},{"type":"text","value":".","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"wDS34MRVxz"}],"key":"odeJhRO483"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = [-1 1; 0 -1];\n[V, D] = eig(A)","key":"ZXS65gJJoj"},{"type":"output","id":"SVH2a2uyG5RnbLR6PumLb","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>V = 2×2 double\n    1.0000   -1.0000\n         0    0.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"V = 2×2 double\n    1.0000   -1.0000\n         0    0.0000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>D = 2×2 double\n    -1     0\n     0    -1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"D = 2×2 double\n    -1     0\n     0    -1\n","content_type":"text/plain"}}}],"key":"MFOshRlpNn"}],"indexEntries":[{"entry":"condition number","subEntry":{"value":"of a matrix","kind":"entry"},"emphasis":false}],"label":"index-evo9dT2vPK","identifier":"index-evo9dt2vpk","html_id":"index-evo9dt2vpk","key":"tPmy8LLxip"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cond(V)","key":"cPf7XgrNuc"},{"type":"output","id":"DRJVDmEf9cpaUPcfYGmHA","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 9.0072e+15</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 9.0072e+15","content_type":"text/plain"}}}],"key":"fYg10YJE4t"}],"key":"HH1MTBdBiY"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Even in the nondiagonalizable case, ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"EmQ4P4a1C0"},{"type":"inlineMath","value":"\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">V</mi><mo>=</mo><mi mathvariant=\"bold\">V</mi><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}\\mathbf{V} = \\mathbf{V}\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">AV</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">VD</span></span></span></span>","key":"HZpXJUSF1Q"},{"type":"text","value":" holds.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"fh7jPPi2IF"}],"key":"ieiilQ6sat"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm(A * V - V * D)","key":"HeGCmvgv71"},{"type":"output","id":"4NJmxvWxid0UHjLz56q9a","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2.2204e-16</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2.2204e-16","content_type":"text/plain"}}}],"key":"Bmq3S44iYc"}],"key":"eBM9Oa19BB"}],"label":"demo-evd-eigen-matlab","identifier":"demo-evd-eigen-matlab","html_id":"demo-evd-eigen-matlab","key":"M6DY3EoAJf"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-evd-bauerfike","label":"demo-evd-bauerfike","kind":"proof:example","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":20}},"children":[{"type":"text","value":"Example ","key":"a2Ae8qSXm2"},{"type":"text","value":"7.2.3","key":"jJfXWoByKo"}],"template":"Example %s","enumerator":"7.2.3","resolved":true,"html_id":"demo-evd-bauerfike","remote":true,"url":"/evd","dataUrl":"/evd.json","key":"uA6EackdEc"}],"key":"RcXIZzbKcj"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"We first define a hermitian matrix. Note that the ","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"nAAFPx3Sry"},{"type":"inlineCode","value":"'","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"KzxsXMmYVJ"},{"type":"text","value":" operation is the adjoint and includes complex conjugation.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"TOPFbkejAI"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"adjoint","kind":"entry"},"emphasis":false},{"entry":"MATLAB","subEntry":{"value":"\\'","kind":"entry"},"emphasis":false}],"label":"index-eDomGp8Udn","identifier":"index-edomgp8udn","html_id":"index-edomgp8udn","key":"S0WmY1uR3u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 7;\nA = randn(n, n) + 1i * randn(n, n);\nA = (A + A') / 2;","key":"GM0kdZ2lQD"},{"type":"output","id":"q_D0nZaifmUUzME27OZp-","data":[],"key":"vnb5dleWO0"}],"key":"aMau3U9cBQ"},{"type":"paragraph","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"children":[{"type":"text","value":"We confirm that the matrix ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"CFO2z6dN12"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"kg8ab6MdsQ"},{"type":"text","value":" is normal by checking that ","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"RE3nw8wrvm"},{"type":"inlineMath","value":"\\kappa(\\mathbf{V}) = 1","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>κ</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\kappa(\\mathbf{V}) = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">κ</span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"EkpOVKEr7o"},{"type":"text","value":" (to within roundoff).","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"yHXV93ugWd"}],"key":"iGZs6t5cLY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eig(A);\nlambda = diag(D);\ncond(V)","key":"c9lOboRyfF"},{"type":"output","id":"VxbS77Fw6mo50Epz0mt1m","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1.0000</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1.0000","content_type":"text/plain"}}}],"key":"wQxCnuOZiE"}],"key":"SdYO9is3z4"},{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"Now we perturb ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"qCftSuSdNv"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"bq3G0AOkh8"},{"type":"text","value":" and measure the effect on the eigenvalues. The Bauer–Fike theorem uses absolute differences, not relative ones. Note: since the ordering of eigenvalues can change, we look at all pairwise differences and take the minima.","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"HfiB03NTdv"}],"key":"zKtqtlypy2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"E = randn(n, n) + 1i * randn(n, n);\nE = 1e-8 * E / norm(E);\ndd = eig(A + E);\ndist = [];\nfor j = 1:n\n    dist = [dist; min(abs(dd - lambda(j)))];\nend\ndist","key":"flhYhpyTVN"},{"type":"output","id":"Ir-xhn4qSiOa8cBpyKo2q","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>dist = 7×1 double\n1.0e-08 *\n\n    0.3224\n    0.3705\n    0.0562\n    0.2904\n    0.3161\n    0.4601\n    0.1961\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"dist = 7×1 double\n1.0e-08 *\n\n    0.3224\n    0.3705\n    0.0562\n    0.2904\n    0.3161\n    0.4601\n    0.1961\n","content_type":"text/plain"}}}],"key":"sWTKKNREED"}],"key":"Uj8k3qIFJK"},{"type":"paragraph","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"As promised, the perturbations in the eigenvalues do not exceed the normwise perturbation to the original matrix.","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"LK7HLomrYF"}],"key":"x0pRk85Oux"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"Now we see what happens for a triangular matrix.","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"zc23NpBuL6"}],"key":"nNNrgAAJmi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 20;\nx = (1:n)';\nA = triu(x * ones(1, n));\nA(1:5, 1:5)","key":"wuQkJ5RQvk"},{"type":"output","id":"qOHDsi2eQ1EBSkihKSBSq","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 5×5 double\n     1     1     1     1     1\n     0     2     2     2     2\n     0     0     3     3     3\n     0     0     0     4     4\n     0     0     0     0     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 5×5 double\n     1     1     1     1     1\n     0     2     2     2     2\n     0     0     3     3     3\n     0     0     0     4     4\n     0     0     0     0     5\n","content_type":"text/plain"}}}],"key":"Hr1feccMFD"}],"key":"SDnGBkavmx"},{"type":"paragraph","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"children":[{"type":"text","value":"This matrix is not at all close to normal.","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"jaxjDQcFIL"}],"key":"wDs0l886qH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eig(A);\nlambda = diag(D);\ncond(V)","key":"uqgYGGPRoJ"},{"type":"output","id":"SimMsAjvJi-o1CJtItwwN","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2.1342e+14</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2.1342e+14","content_type":"text/plain"}}}],"key":"hcuDuHnKzr"}],"key":"Y7tkdNdF89"},{"type":"paragraph","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"As a result, the eigenvalues can change by a good deal more.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"CDCd07aVNW"}],"key":"pXtnPEIsom"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"E = randn(n, n) + 1i * randn(n, n);\nE = 1e-8 * E / norm(E);\ndd = eig(A + E);\ndist = -Inf;\nfor j = 1:n\n    dist = max(dist, min(abs(dd - lambda(j))));\nend\nfprintf(\"max change in eigenvalues: %.2e\", dist)\nfprintf(\"Bauer-Fike upper bound: %.2e\", cond(V) * norm(E))","key":"JM9AGucj1Z"},{"type":"output","id":"0RPfZ6DrfuElgcNQphwt4","data":[{"output_type":"stream","name":"stderr","text":"Error using +\nArrays have incompatible sizes for this operation."}],"key":"xYN2i3ishe"}],"key":"KXrFcbAWK1"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"If we plot the eigenvalues of many perturbations, we get a cloud of points that roughly represents all the possible eigenvalues when representing this matrix with single-precision accuracy.","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"IxASHjkI6E"}],"key":"iPq6DlY3ae"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nscatter(lambda, 0*lambda)\naxis equal; hold on\nfor k = 1:60\n    E = randn(n, n) + 1i * randn(n, n);\n    E = eps(single(1)) * E / norm(E);\n    dd = eig(A + E);\n    plot(real(dd), imag(dd), 'k.', markersize=2)\nend","key":"umlVoQRXyk"},{"type":"output","id":"GzuOeBU_rxnyUxA7LPZKg","data":[{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"148582a13d35713b0c042aa597b3b16d","path":"/build/148582a13d35713b0c042aa597b3b16d.png"}}},{"output_type":"stream","name":"stderr","text":"Warning: Using only the real component of complex data."},{"output_type":"stream","name":"stderr","text":"Error using +\nArrays have incompatible sizes for this operation."}],"key":"jRxcLXTCCg"}],"key":"n75ldxQ2E4"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"The plot shows that some eigenvalues are much more affected than others. This situation is not unusual, but it is not explained by the Bauer–Fike theorem.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"IJc2Rh1blu"}],"key":"emk0Yf57RA"}],"label":"demo-evd-bauerfike-matlab","identifier":"demo-evd-bauerfike-matlab","html_id":"demo-evd-bauerfike-matlab","key":"VEHl1jXR8H"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-evd-francisqr","label":"demo-evd-francisqr","kind":"proof:example","position":{"start":{"line":231,"column":1},"end":{"line":231,"column":20}},"children":[{"type":"text","value":"Example ","key":"FNphQPGqbC"},{"type":"text","value":"7.2.4","key":"eh8HxkgXox"}],"template":"Example %s","enumerator":"7.2.4","resolved":true,"html_id":"demo-evd-francisqr","remote":true,"url":"/evd","dataUrl":"/evd.json","key":"KXRYwoAVvY"}],"key":"OxJfuDf9VL"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"Let’s start with a known set of eigenvalues and an orthogonal eigenvector basis.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"rK4RQT0whY"}],"key":"pLzKNpr8WE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"D = diag([-6, -1, 2, 4, 5]);\n[V, R]= qr(randn(5, 5));    % V is unitary\nA = V * D * V';","key":"m4XZK2WHFQ"},{"type":"output","id":"8KncO_uNcLEGAKTH3KTHs","data":[],"key":"wFmyfMGEdn"}],"key":"rjLwQI929P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sort(eig(A))","key":"HBSs89Sms9"},{"type":"output","id":"aaav-TFsMQJJMePbClXO1","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 5×1 double\n   -6.0000\n   -1.0000\n    2.0000\n    4.0000\n    5.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 5×1 double\n   -6.0000\n   -1.0000\n    2.0000\n    4.0000\n    5.0000\n","content_type":"text/plain"}}}],"key":"ZBbPVUrdHP"}],"key":"E7Qi8F90n1"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"Now we will take the QR factorization and just reverse the factors.","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"iXD2vdNQ5N"}],"key":"Z3izDFOorN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q, R] = qr(A);\nA = R * Q;","key":"gdupMJJKjA"},{"type":"output","id":"MCbra-xMpV1Hk10ISlNH6","data":[],"key":"MSK7szbNMN"}],"key":"QXfG1Rwoe1"},{"type":"paragraph","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"text","value":"It turns out that this is a similarity transformation, so the eigenvalues are unchanged.","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"qnGAXBuDP7"}],"key":"tWci7HJavm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sort(eig(A))","key":"QVAxF1ijy5"},{"type":"output","id":"k0GFBQMjsgrYvcpzNlaEc","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 5×1 double\n   -6.0000\n   -1.0000\n    2.0000\n    4.0000\n    5.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 5×1 double\n   -6.0000\n   -1.0000\n    2.0000\n    4.0000\n    5.0000\n","content_type":"text/plain"}}}],"key":"QBdGWfC0dj"}],"key":"kFxSoZZnnH"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"What’s remarkable, and not elementary, is that if we repeat this transformation many times, the resulting matrix converges to ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"tno4dmNz0V"},{"type":"inlineMath","value":"\\mathbf{D}","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">D</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">D</span></span></span></span>","key":"y7vatxmxuE"},{"type":"text","value":".","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"f969LzW1tC"}],"key":"JswNXjZgXF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for k = 1:40\n    [Q, R] = qr(A);\n    A = R * Q;\nend\nformat short e\nA","key":"twmm0yI1ku"},{"type":"output","id":"eNSSHLHlTHIn4RfxIwrKj","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 5×5 double\n  -6.0000e+00   1.7572e-02  -1.6826e-06  -1.2510e-16  -6.4543e-16\n   1.7572e-02   5.0000e+00  -1.2873e-04   1.2300e-16   7.8797e-16\n  -1.6826e-06  -1.2873e-04   4.0000e+00   3.2459e-13   4.2815e-16\n   3.1886e-19   6.1719e-18   3.2453e-13   2.0000e+00   2.9171e-13\n   2.7774e-31   2.0908e-28   8.6527e-25   2.9130e-13  -1.0000e+00\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 5×5 double\n  -6.0000e+00   1.7572e-02  -1.6826e-06  -1.2510e-16  -6.4543e-16\n   1.7572e-02   5.0000e+00  -1.2873e-04   1.2300e-16   7.8797e-16\n  -1.6826e-06  -1.2873e-04   4.0000e+00   3.2459e-13   4.2815e-16\n   3.1886e-19   6.1719e-18   3.2453e-13   2.0000e+00   2.9171e-13\n   2.7774e-31   2.0908e-28   8.6527e-25   2.9130e-13  -1.0000e+00\n","content_type":"text/plain"}}}],"key":"MSNXFIAni8"}],"key":"HtQPgzt6p6"}],"label":"demo-evd-francisqr-matlab","identifier":"demo-evd-francisqr-matlab","html_id":"demo-evd-francisqr-matlab","key":"AOH4ENyU9a"},{"type":"heading","depth":3,"position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"7.3 ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"riXVgEo1M4"},{"type":"link","identifier":"section-matrixanaly-svd","label":"section-matrixanaly-svd","kind":"narrative","position":{"start":{"line":270,"column":5},"end":{"line":270,"column":29}},"url":"/svd","internal":true,"dataUrl":"/svd.json","children":[{"type":"text","value":"Singular value decomposition","key":"NXyaz4dOeb"}],"key":"P6btWuboWF"}],"identifier":"id-7-3","label":"7.3 ","html_id":"id-7-3","implicit":true,"key":"jyPzTqICJw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-svd-props","label":"demo-svd-props","kind":"proof:example","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":16}},"children":[{"type":"text","value":"Example ","key":"TuBO9vAZWu"},{"type":"text","value":"7.3.4","key":"Cu2cat4kRZ"}],"template":"Example %s","enumerator":"7.3.4","resolved":true,"html_id":"demo-svd-props","remote":true,"url":"/svd","dataUrl":"/svd.json","key":"eK1TeDvNIp"}],"key":"iLaECM9Rrz"},{"type":"paragraph","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"We verify some of the fundamental ","key":"TVd2Pdkldq"},{"type":"abbreviation","title":"singular value decomposition","children":[{"type":"text","value":"SVD","key":"sk4OeTG42o"}],"key":"pnYJKgf0uc"},{"type":"text","value":" properties using the built-in ","key":"uSdW3wwtlT"},{"type":"inlineCode","value":"svd","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"Rg1VPCcMer"},{"type":"text","value":" function.","position":{"start":{"line":275,"column":1},"end":{"line":275,"column":1}},"key":"S01illQfrP"}],"key":"NUuUj2iHSB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = vander(1:5);\nA = A(:, 1:4)","key":"oD0MXQSCd8"},{"type":"output","id":"2xfX2Gb0cWGuj-noR19kM","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>A = 5×4 double\n     1     1     1     1\n    16     8     4     2\n    81    27     9     3\n   256    64    16     4\n   625   125    25     5\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"A = 5×4 double\n     1     1     1     1\n    16     8     4     2\n    81    27     9     3\n   256    64    16     4\n   625   125    25     5\n","content_type":"text/plain"}}}],"key":"MXoAwYDl7i"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"svd","kind":"entry"},"emphasis":true}],"label":"index-nU5y6haPhF","identifier":"index-nu5y6haphf","html_id":"index-nu5y6haphf","key":"kSktHeElfw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[U, S, V] = svd(A);\ndisp(sprintf(\"U is %d by %d. S is %d by %d. V is %d by %d.\\n\", size(U), size(S), size(V)))","key":"kcl6cbehTz"},{"type":"output","id":"yqJB0y_OK2l6oHHLXojPj","data":[{"output_type":"stream","name":"stdout","text":"U is 5 by 5. S is 5 by 4. V is 4 by 4.\n"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"CbvsXyI2Ho"}],"key":"O7FViEnG6u"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"We verify the orthogonality of the singular vectors as follows:","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"JWH1zE4rLR"}],"key":"c3163LlvIj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm(U' * U - eye(5))\nnorm(V' * V - eye(4))","key":"V3ggWCi7ID"},{"type":"output","id":"d7FULWPoLhVJqzAv6SwjS","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.8553e-15\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.8553e-15\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   1.1849e-15\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   1.1849e-15\n","content_type":"text/plain"}}}],"key":"aBXMLn4uPg"}],"key":"NdKB0wOnQ6"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"Here is verification of the connections between the singular values, norm, and condition number.","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"jZjtTbJrji"}],"key":"N5sniCU1SL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"s = diag(S);\nnorm_A = norm(A)\nsigma_max = s(1)","key":"MG3nFjoUye"},{"type":"output","id":"cBpkL9wKE9y6t6zst3Y7J","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>norm_A = \n   6.9584e+02\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"norm_A = \n   6.9584e+02\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sigma_max = \n   6.9584e+02\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sigma_max = \n   6.9584e+02\n","content_type":"text/plain"}}}],"key":"bv0NGCVJKn"}],"key":"NSN2lpVCe7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cond_A = cond(A)\nsigma_ratio = s(1) / s(end)","key":"rkUZGJ7YQy"},{"type":"output","id":"oQLKJmHp9phq22HUU2a0x","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>cond_A = \n   3.2820e+03\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"cond_A = \n   3.2820e+03\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>sigma_ratio = \n   3.2820e+03\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"sigma_ratio = \n   3.2820e+03\n","content_type":"text/plain"}}}],"key":"ZhwjlNybtq"}],"key":"E8f9f2jNNI"}],"label":"demo-svd-props-matlab","identifier":"demo-svd-props-matlab","html_id":"demo-svd-props-matlab","key":"nURGCa7t4K"},{"type":"heading","depth":3,"position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"7.4 ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"WwdXyo9OWs"},{"type":"link","identifier":"section-matrixanaly-symm-eig","label":"section-matrixanaly-symm-eig","kind":"narrative","position":{"start":{"line":311,"column":5},"end":{"line":311,"column":34}},"url":"/symm-eig","internal":true,"dataUrl":"/symm-eig.json","children":[{"type":"text","value":"Symmetry and definiteness","key":"zVEJaqWf20"}],"key":"E12nXUpAEx"}],"identifier":"id-7-4","label":"7.4 ","html_id":"id-7-4","implicit":true,"key":"b8aRRbDaiB"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-symm-eig-rayleigh","label":"demo-symm-eig-rayleigh","kind":"proof:example","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":24}},"children":[{"type":"text","value":"Example ","key":"Nkj8s54qzO"},{"type":"text","value":"7.4.1","key":"E6sseLuuBb"}],"template":"Example %s","enumerator":"7.4.1","resolved":true,"html_id":"demo-symm-eig-rayleigh","remote":true,"url":"/symm-eig","dataUrl":"/symm-eig.json","key":"SLamFkmXs2"}],"key":"JXtx078yg7"},{"type":"paragraph","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"We will use a symmetric matrix with a known ","key":"XuuVNxDHJo"},{"type":"abbreviation","title":"eigenvalue decomposition","children":[{"type":"text","value":"EVD","key":"yiQIW4McsP"}],"key":"QBrwY3iDqL"},{"type":"text","value":" and eigenvalues equal to the integers from 1 to 20.","key":"yjVgfhvfJ9"}],"key":"NbvtOuTrTh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 20;\nlambda = 1:n;\nD = diag(lambda);\n[V, ~] = qr(randn(n, n));    % get a random orthogonal V\nA = V * D * V';","key":"M0wD5AwCKg"},{"type":"output","id":"ynbNoQqmbD2qtGpg2-cGx","data":[],"key":"H0kV6IiIoX"}],"key":"vI4MxmGtiS"},{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"The Rayleigh quotient is a scalar-valued function of a vector.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"lQQ7tIHWk8"}],"key":"wLz4EaM1UY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"R = @(x) (x' * A * x) / (x' * x);","key":"M7xEex4h8g"},{"type":"output","id":"Gr_BIIh8DBz7gksSuC6Xv","data":[],"key":"PwBnXwEl0I"}],"key":"nZUm0tNa4P"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"The Rayleigh quotient evaluated at an eigenvector gives the corresponding eigenvalue.","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"yB1bpzh5Pm"}],"key":"BqkDP4AvMt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long\nR(V(:, 7))","key":"apdY0slzgd"},{"type":"output","id":"6wlJYYAx5aKpcyPj6orsM","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = \n   7.000000000000003\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = \n   7.000000000000003\n","content_type":"text/plain"}}}],"key":"WBZtPkG2WV"}],"key":"aS3sCk6NJc"},{"type":"paragraph","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"children":[{"type":"text","value":"If the input to he Rayleigh quotient is within a small ","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"pSwEPFbqRw"},{"type":"inlineMath","value":"\\delta","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>δ</mi></mrow><annotation encoding=\"application/x-tex\">\\delta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span></span></span></span>","key":"hDKTQA8XHf"},{"type":"text","value":" of an eigenvector, its output is within ","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"M02k3amE4c"},{"type":"inlineMath","value":"O(\\delta^2)","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>δ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\delta^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"fGarC6tI34"},{"type":"text","value":" of the corresponding eigenvalue. In this experiment, we observe that each additional digit of accuracy in an approximate eigenvector gives two more digits to the eigenvalue estimate coming from the Rayleigh quotient.","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"Xip44MLprY"}],"key":"d86MEGqGVv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"delta = 1 ./ 10 .^ (1:5)';\ndif = zeros(size(delta));\nfor k = 1:length(delta)\n    e = randn(n, 1);\n    e = delta(k) * e / norm(e);\n    x = V(:, 6) + e;\n    dif(k) = R(x) - lambda(6);\nend\ntable(delta, dif, variablenames=[\"perturbation size\", \"R(x) - lambda\"])","key":"g9WdmEwlZd"},{"type":"output","id":"EfnAhTTBfZBymTNsRL2z5","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>perturbation size</th><th>R(x) - lambda</th></tr></thead><tbody><tr><td>0.100000000000000</td><td>0.050532234614056</td></tr><tr><td>0.010000000000000</td><td>9.615175568811196e-05</td></tr><tr><td>1.000000000000000e-03</td><td>4.302230357744463e-06</td></tr><tr><td>1.000000000000000e-04</td><td>6.823066200922767e-08</td></tr><tr><td>1.000000000000000e-05</td><td>5.596643148919611e-10</td></tr></tbody></table></div></body></html>","content_type":"text/html"},"text/plain":{"content":"<html><head><style>.mwBasicVariableOutputWrapper .mwBasicVariableOutputHeader {font-style: italic;}</style></head><body><div class='mwBasicVariableOutputWrapper'><div>ans = <span class='mwBasicVariableOutputHeader'>5x2 table</span></div><table><thead><tr><th>perturbation size</th><th>R(x) - lambda</th></tr></thead><tbody><tr><td>0.100000000000000</td><td>0.050532234614056</td></tr><tr><td>0.010000000000000</td><td>9.615175568811196e-05</td></tr><tr><td>1.000000000000000e-03</td><td>4.302230357744463e-06</td></tr><tr><td>1.000000000000000e-04</td><td>6.823066200922767e-08</td></tr><tr><td>1.000000000000000e-05</td><td>5.596643148919611e-10</td></tr></tbody></table></div></body></html>","content_type":"text/plain"}}}],"key":"a0dtMMhQfU"}],"key":"ci8dk0RONi"}],"label":"demo-symm-eig-rayleigh-matlab","identifier":"demo-symm-eig-rayleigh-matlab","html_id":"demo-symm-eig-rayleigh-matlab","key":"iZBFINy9iX"},{"type":"heading","depth":3,"position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"children":[{"type":"text","value":"7.5 ","position":{"start":{"line":354,"column":1},"end":{"line":354,"column":1}},"key":"Jsl5uLP2FG"},{"type":"link","identifier":"section-matrixanaly-dimreduce","label":"section-matrixanaly-dimreduce","kind":"narrative","position":{"start":{"line":354,"column":5},"end":{"line":354,"column":35}},"url":"/dimreduce","internal":true,"dataUrl":"/dimreduce.json","children":[{"type":"text","value":"Dimension reduction","key":"MSW1AQKMK5"}],"key":"SpGDza9jH7"}],"identifier":"id-7-5","label":"7.5 ","html_id":"id-7-5","implicit":true,"key":"QzU0DsBs5d"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-dimreduce-hello","label":"demo-dimreduce-hello","kind":"proof:example","position":{"start":{"line":357,"column":1},"end":{"line":357,"column":22}},"children":[{"type":"text","value":"Example ","key":"X1E2sTYHfK"},{"type":"text","value":"7.5.1","key":"CizalqGbYI"}],"template":"Example %s","enumerator":"7.5.1","resolved":true,"html_id":"demo-dimreduce-hello","remote":true,"url":"/dimreduce","dataUrl":"/dimreduce.json","key":"lZmw9P5gPO"}],"key":"gP9Dm2QKc2"},{"type":"paragraph","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"children":[{"type":"text","value":"We make an image from some text, then reload it as a matrix.","position":{"start":{"line":359,"column":1},"end":{"line":359,"column":1}},"key":"blW1RGygRz"}],"key":"pmGBGlgsKz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\ntobj = text(0, 0,'Hello world','fontsize',44);\nex = get(tobj, 'extent');\naxis([ex(1) ex(1) + ex(3) ex(2) ex(2) + ex(4)]), axis off\nexportgraphics(gca, 'hello.png', resolution=300)\nA = imread('hello.png');\nA = double(im2gray(A));\nsize_A = size(A)","visibility":"hide","key":"shKyYElwP0"},{"type":"output","id":"aCEsC9L2AgVFmPA6qFGtF","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c3cbec4c095b634c3d086a2595db749","path":"/build/0c3cbec4c095b634c3d086a2595db749.png"}}},{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>size_A = 1×2 double\n   137   901\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"size_A = 1×2 double\n   137   901\n","content_type":"text/plain"}}}],"visibility":"show","key":"RsrIR48GVp"}],"data":{"tags":[]},"visibility":"show","key":"EqEeDCMNaU"},{"type":"paragraph","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"children":[{"type":"text","value":"Next we show that the singular values decrease until they reach zero (more precisely, until they are about ","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"RW5JLB54gp"},{"type":"inlineMath","value":"\\epsilon_\\text{mach}","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mtext>mach</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_\\text{mach}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">mach</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"JOOaPgf3cF"},{"type":"text","value":" times the norm of the matrix) at around ","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"R7tVixJz7g"},{"type":"inlineMath","value":"k=100","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding=\"application/x-tex\">k=100</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">100</span></span></span></span>","key":"q0aeI6p3M5"},{"type":"text","value":".","position":{"start":{"line":373,"column":1},"end":{"line":373,"column":1}},"key":"YZ3ttsUNen"}],"key":"JxEkoM3yht"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[U, S, V] = svd(A);\nsigma = diag(S);\nsemilogy(sigma, '.')\ntitle('singular values'), axis tight \nxlabel('i'), ylabel('\\sigma_i') \nr = find(sigma / sigma(1) > 10*eps, 1, 'last')","key":"dAmLJyzU0d"},{"type":"output","id":"zax4e1iwAjOIctbWrnSun","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e963932c70909807c427b1bf528cd46b","path":"/build/e963932c70909807c427b1bf528cd46b.png"}}},{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>r = \n   102\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"r = \n   102\n","content_type":"text/plain"}}}],"key":"chfORuIaFW"}],"key":"BQWh5bhU5m"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"The rapid decrease suggests that we can get fairly good low-rank approximations.","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"jL4LmFQCtX"}],"key":"p6rEtM48MJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for i = 1:4\n    subplot(2, 2, i)\n    k = 2*i;\n    Ak = U(:, 1:k) * S(1:k, 1:k) * V(:, 1:k)';\n    imshow(Ak, [0, 255])\n    title(sprintf('rank = %d', k))\nend","key":"HwkTpbSoXD"},{"type":"output","id":"fzTFijnk13qL8MXTY7i6o","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3878f958abd146091493e844003bf8f9","path":"/build/3878f958abd146091493e844003bf8f9.png"}}}],"key":"QNf5hOxmBL"}],"key":"JgsSb2IDRb"},{"type":"paragraph","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"text","value":"Consider how little data is needed to reconstruct these images. For rank-9, for instance, we have 9 left and right singular vectors plus 9 singular values, for a compression ratio of better than 12:1.","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"vLYj78OsqR"}],"key":"CKAuhtg63P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[m, n] = size(A);\nfull_size = m * n;\ncompressed_size = 8 * (m + n + 1);\nfprintf(\"compression ratio: %.1f\", full_size / compressed_size)","key":"A44FmOMWXK"},{"type":"output","id":"MmQH1TI6BuP5FpSMLyb-V","data":[{"output_type":"stream","name":"stdout","text":"compression ratio: "},{"output_type":"stream","name":"stdout","text":"14.9"}],"key":"eqzlknkxoj"}],"key":"iYCL57TI1J"}],"label":"demo-dimreduce-hello-matlab","identifier":"demo-dimreduce-hello-matlab","html_id":"demo-dimreduce-hello-matlab","key":"cCx78BBnOO"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-dimreduce-voting","label":"demo-dimreduce-voting","kind":"proof:example","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":23}},"children":[{"type":"text","value":"Example ","key":"MMO6SVLVwF"},{"type":"text","value":"7.5.2","key":"wCUm8Sk7OV"}],"template":"Example %s","enumerator":"7.5.2","resolved":true,"html_id":"demo-dimreduce-voting","remote":true,"url":"/dimreduce","dataUrl":"/dimreduce.json","key":"emA7Q7FoE3"}],"key":"Nbt6LdyCJO"},{"type":"paragraph","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"The matrix in ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"r0pK1xhcSl"},{"type":"link","url":"https://raw.github.com/fncbook/fnc/master/matlab/voting.mat","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"this data file","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"X1CfSLdXfz"}],"urlSource":"https://raw.github.com/fncbook/fnc/master/matlab/voting.mat","key":"G6On8bNIY7"},{"type":"text","value":" describes the votes on bills in the 111th session of the United States Senate. (The data set was obtained from ","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"ns5Pf7uluq"},{"type":"link","url":"https://voteview.com","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"children":[{"type":"text","value":"voteview.com","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"QJy2NIqh7H"}],"urlSource":"https://voteview.com","key":"WqMiVzlPb9"},{"type":"text","value":".) Each row is one senator, and each column is a vote item.","position":{"start":{"line":409,"column":1},"end":{"line":409,"column":1}},"key":"pnkCSfbepl"}],"key":"I49ZJKg7Bw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"load voting","key":"PS2Msw4BCW"},{"type":"output","id":"ATBK3b1w4l-tOyEvqnu45","data":[],"key":"CTnl29S5eN"}],"key":"xSpYW9HODm"},{"type":"paragraph","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"children":[{"type":"text","value":"If we visualize the votes (yellow is “yea,” blue is “nay”), we can see great similarity between many rows, reflecting party unity.","position":{"start":{"line":415,"column":1},"end":{"line":415,"column":1}},"key":"YoS4KX4JKs"}],"key":"u7ux1G6RZb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nimagesc(A)\ncolormap parula\ntitle('Votes in 111th U.S. Senate')\nylabel(('senator'),  xlabel('bill'));","key":"BwRWVDdbRj"},{"type":"output","id":"5fsbJmOnC1t4x36EGoV8m","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"05f9d423669d069c61048393a79a9cce","path":"/build/05f9d423669d069c61048393a79a9cce.png"}}},{"output_type":"stream","name":"stderr","text":"Error using xyzlabel (line 4)\nIncorrect number of inputs for property-value pairs.\n\nError in ylabel (line 7)\n    xyzlabel(\"YLabel\", varargin);"}],"key":"UtR0h3qHgW"}],"key":"oLEJZJAWWH"},{"type":"paragraph","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"s1nva3uY43"},{"type":"crossReference","kind":"equation","identifier":"sing-val-decay","label":"sing-val-decay","children":[{"type":"text","value":"(","key":"azVXVQF8Xg"},{"type":"text","value":"7.5.4","key":"o79cEfRuZc"},{"type":"text","value":")","key":"GZXA4Ei0is"}],"template":"(%s)","enumerator":"7.5.4","resolved":true,"html_id":"sing-val-decay","remote":true,"url":"/dimreduce","dataUrl":"/dimreduce.json","key":"vKP8opp1O6"},{"type":"text","value":" to quantify the decay rate of the values.","position":{"start":{"line":425,"column":1},"end":{"line":425,"column":1}},"key":"tGmua90huq"}],"key":"iXuaP3A3vj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[U, S, V] = svd(A);\nsigma = diag(S);\ntau = cumsum(sigma.^2) / sum(sigma.^2);\nplot(tau(1:16), 'o')\nxlabel('k'),  ylabel('\\tau_k')\ntitle(('Fraction of singular value energy'));","key":"mQNzBmumfQ"},{"type":"output","id":"g2C3NEA7xZBm1C0XHikdC","data":[{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f79a248c700fe969221c8cdee21ff74e","path":"/build/f79a248c700fe969221c8cdee21ff74e.png"}}}],"key":"CtVLhy95dl"}],"key":"M6B48i1Tkg"},{"type":"paragraph","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"children":[{"type":"text","value":"The first and second singular triples contain about 58% and 17%, respectively, of the energy of the matrix. All others have far less effect, suggesting that the information is primarily two-dimensional. The first left and right singular vectors also contain interesting structure.","position":{"start":{"line":436,"column":1},"end":{"line":436,"column":1}},"key":"Ym2zt5s4Hr"}],"key":"rwCB236Z7j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"subplot(211), plot(U(:, 1), '.')\nxlabel('senator number'), title('left singular vector')\nsubplot(212), plot(V(:, 1), '.')\nxlabel('bill number'), title(('right singular vector'));","key":"X0RPjvOsqG"},{"type":"output","id":"BXWIbXEVNefrB3GbC8ZSN","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6b9e96e043219564c489e516403e61c5","path":"/build/6b9e96e043219564c489e516403e61c5.png"}}}],"key":"uNo8V0iZwD"}],"key":"Vt3ukSZq1T"},{"type":"paragraph","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"Both vectors have values greatly clustered near ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"THdnsu0QCx"},{"type":"inlineMath","value":"\\pm C","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>±</mo><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">\\pm C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">±</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"ajr69r5dMX"},{"type":"text","value":" for a constant ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"ome5b3G1My"},{"type":"inlineMath","value":"C","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span>","key":"vHCeAHJMYG"},{"type":"text","value":". These can be roughly interpreted as how partisan a particular senator or bill was, and for which political party. Projecting the senators’ vectors into the first two ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"sE3Ul19rGV"},{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"pakYYcldwZ"},{"type":"text","value":"-coordinates gives a particularly nice way to reduce them to two dimensions. Political scientists label these dimensions ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"GJk01RkmgZ"},{"type":"emphasis","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"partisanship","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"UZHFehLCvs"}],"key":"RZ97NtIqG4"},{"type":"text","value":" and ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"JEN2W3KGJY"},{"type":"emphasis","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"bipartisanship","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"uL3LIm4iRy"}],"key":"OJYND0HYpw"},{"type":"text","value":". Here we color them by actual party affiliation (also given in the data file): red for Republican, blue for Democrat, and yellow for independent.","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"qhcebIUkQL"}],"key":"kQVRBqfKh7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nx1 = V(:, 1)'*A';   x2 = V(:, 2)'*A'; \nscatter(x1(Dem), x2(Dem), 20, 'b'),  hold on\nscatter(x1(Rep), x2(Rep), 20, 'r')\nscatter(x1(Ind), x2(Ind), 20, 'm')\nxlabel('partisanship'),  ylabel('bipartisanship')\nlegend('Democrat', 'Republican', 'Independent')\ntitle(('111th US Senate in 2D'));","key":"n8nFluaPNa"},{"type":"output","id":"ihacH0GRXthJ5FAJcFUgd","data":[{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb013cde3d22ad0b5fa9fa9ef6d464b2","path":"/build/eb013cde3d22ad0b5fa9fa9ef6d464b2.png"}}}],"key":"F7B6wspZLY"}],"key":"UscMf4vJFL"}],"label":"demo-dimreduce-voting-matlab","identifier":"demo-dimreduce-voting-matlab","html_id":"demo-dimreduce-voting-matlab","key":"NmKM4sqfNY"}],"key":"AflGCoAirx"}],"key":"PX4cm0zSaJ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 6","url":"/chapter6-1","group":"MATLAB codes"},"next":{"title":"Chapter 8","url":"/chapter8-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}