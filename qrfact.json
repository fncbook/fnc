{"kind":"Notebook","sha256":"ef3eaf1f6110e77d6a5b5dff5f75a001a5d3860c5e0cbb0e4d82d4a755cfd1a4","slug":"qrfact","location":"/chapter3/section3/julia/qrfact.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"qrfact.ipynb","url":"/fnc/build/qrfact-7ad2d95e2864589b8b4ca6358d93e56a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"ti68aGFnwL"},{"type":"text","value":"3.3.1","key":"WxarNP02Rm"}],"key":"J8qVlUvFbZ"}],"identifier":"demo-qr-qrfact","label":"demo-qr-qrfact","kind":"proof:example","template":"Example %s","enumerator":"3.3.1","resolved":true,"html_id":"demo-qr-qrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"H9EUmvdcfg"}],"key":"CVu1O8fg3b"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Julia provides access to both the thin and full forms of the QR factorization.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zwqFyAnFa4"}],"key":"Q7rLuYBYt5"}],"key":"GL0pAVOrWT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:08.087000Z","iopub.status.busy":"2025-01-14T15:23:52.370000Z","iopub.execute_input":"2025-01-14T15:23:55.529000Z","shell.execute_reply":"2025-01-14T15:24:08.085000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.:9., 6, 4)\n@show m,n = size(A);","key":"y63EAO8FGV"},{"type":"output","id":"WO25Cw_EDOgrrYhad3X0F","data":[{"name":"stdout","output_type":"stream","text":"(m, n) = size(A) = (6, 4)"},{"name":"stdout","output_type":"stream","text":"\n"}],"key":"IquQN6peIQ"}],"key":"x1zwCRZMd8"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is a standard call:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KsSoeJSz5W"}],"key":"kDx2XDeMmN"}],"key":"VqAcuOQs4p"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:12.534000Z","iopub.status.busy":"2025-01-14T15:24:08.099000Z","iopub.execute_input":"2025-01-14T15:24:08.100000Z","shell.execute_reply":"2025-01-14T15:24:12.479000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"Q,R = qr(A);\nQ","key":"zltxRXvpj3"},{"type":"output","id":"kj2AdS7GwRx_r01pnbiSy","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"6×6 LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}","content_type":"text/plain"}}}],"key":"RtSb10uw0i"}],"key":"hEn82kRYpA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:26.552000Z","iopub.status.busy":"2025-01-14T15:24:12.545000Z","iopub.execute_input":"2025-01-14T15:24:12.546000Z","shell.execute_reply":"2025-01-14T15:24:26.551000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"R","key":"TzFQ7e1ThX"},{"type":"output","id":"gk8RwRx5_DORQgk-N3ihe","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -14.6629  -9.88892  -11.3211   -14.7993\n   0.0      5.4963     2.73757   -0.609289\n   0.0      0.0        4.72634    2.77674\n   0.0      0.0        0.0       -4.78538","content_type":"text/plain"}}}],"key":"TitVf9uCZO"}],"key":"mkojvlzQlE"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you look carefully, you see that we seemingly got a full ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k8lNCPfUpo"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"muaUqPypsv"},{"type":"text","value":" but a thin ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"STFv6PZhoB"},{"type":"inlineMath","value":"\\mathbf{R}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">R</span></span></span></span>","key":"XO1pdnPFzB"},{"type":"text","value":". However, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xfqsY8L3rH"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"gHJY9EPigZ"},{"type":"text","value":" above is not a standard matrix type. If you convert it to a true matrix, then it reverts to the thin form.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rSPamO2ARo"}],"key":"XZoZuc6GnP"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"z5z2hIZsL3"}],"key":"XBqoaqoWaF"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To enter the accented character ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cyR3VSyJma"},{"type":"inlineCode","value":"Q̂","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vsmAsJWUqn"},{"type":"text","value":", type ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"tLOpSvIk8e"},{"type":"inlineCode","value":"Q\\hat","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dfvfk5ZZ92"},{"type":"text","value":" followed by ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kzsAnGGhWb"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"LVLQw3RTvk"}],"key":"fu1ASVdJ10"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ebJ0OOQAk1"}],"key":"AwwussKLTk"}],"class":"dropdown","key":"EKE5klAReb"}],"key":"a5TPiDdCg6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:26.996000Z","iopub.status.busy":"2025-01-14T15:24:26.572000Z","iopub.execute_input":"2025-01-14T15:24:26.573000Z","shell.execute_reply":"2025-01-14T15:24:26.996000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂ = Matrix(Q)","key":"OecC230ma1"},{"type":"output","id":"vb2hWb9MKSjEpCZKJLmbz","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n -0.204598   0.35965      0.782668   0.414186\n -0.613795  -0.194634    -0.2996     0.077402\n -0.409197   0.173478    -0.234318   0.271551\n -0.204598  -0.00423118   0.358693  -0.830345\n -0.545595  -0.435811     0.215033  -0.0131558\n -0.272798   0.782768    -0.260509  -0.24305","content_type":"text/plain"}}}],"key":"qVqvC3sPjd"}],"key":"uyXzK1T6iD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can test that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lj6motH7i8"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"DW8KEFjhq2"},{"type":"text","value":" is an orthogonal matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X5YpB0f8Q8"}],"key":"TSQyCaoLKl"}],"key":"p8ZM2nhxhB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:28.678000Z","iopub.status.busy":"2025-01-14T15:24:26.999000Z","iopub.execute_input":"2025-01-14T15:24:26.999000Z","shell.execute_reply":"2025-01-14T15:24:28.676000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(Q' * Q - I)","key":"IPwZwGVa9O"},{"type":"output","id":"Jf9K4Vb0B6k0Nn5ik36pn","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"7.342801647515658e-16","content_type":"text/plain"}}}],"key":"kFncALbbRL"}],"key":"w0uoPiBGZg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The thin ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eS5LV0Wzdq"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"RlNZRJK8UA"},{"type":"text","value":" cannot be an orthogonal matrix, because it is not square, but it is still ","key":"b31bChF1az"},{"type":"abbreviation","title":"matrix with orthonormal columns","children":[{"type":"text","value":"ONC","key":"axkZbuI41J"}],"key":"Is9GoxNin8"},{"type":"text","value":":","key":"TZtIxEZnvY"}],"key":"zchPUUrVFw"}],"key":"zO0YA55JtI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:28.780000Z","iopub.status.busy":"2025-01-14T15:24:28.680000Z","iopub.execute_input":"2025-01-14T15:24:28.680000Z","shell.execute_reply":"2025-01-14T15:24:28.742000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂' * Q̂ - I","key":"lHeCVDPLHG"},{"type":"output","id":"mbptWqS5AMlDmVQ1xrLx2","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  4.44089e-16   2.60887e-17  -2.69778e-16  -1.23647e-16\n  2.60887e-17   0.0          -3.49859e-17   2.38519e-17\n -2.69778e-16  -3.49859e-17   2.22045e-16   9.57486e-17\n -1.23647e-16   2.38519e-17   9.57486e-17   2.22045e-16","content_type":"text/plain"}}}],"key":"lGziDj3zjp"}],"key":"ofp82zr6m3"}],"key":"Jes5EBWFAm"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Instab","url":"/instab","group":"Chapter 3"},"next":{"title":"Stable","url":"/stable-1","group":"Chapter 3"}}},"domain":"http://localhost:3000"}