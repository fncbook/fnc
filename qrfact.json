{"kind":"Notebook","sha256":"ef3eaf1f6110e77d6a5b5dff5f75a001a5d3860c5e0cbb0e4d82d4a755cfd1a4","slug":"qrfact","location":"/chapter3/section3/julia/qrfact.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"qrfact.ipynb","url":"/build/qrfact-7ad2d95e2864589b8b4ca6358d93e56a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"L9yCWuJBQq"},{"type":"text","value":"3.3.1","key":"Rq30TWydFS"}],"key":"EP5bVOdF26"}],"identifier":"demo-qr-qrfact","label":"demo-qr-qrfact","kind":"proof:example","template":"Example %s","enumerator":"3.3.1","resolved":true,"html_id":"demo-qr-qrfact","remote":true,"url":"/qr","dataUrl":"/qr.json","key":"nfPuaXRa29"}],"key":"WiG4ZuGpJF"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Julia provides access to both the thin and full forms of the QR factorization.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"x15O32zPu0"}],"key":"VburO2FvXF"}],"key":"i8LhCIp8vd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:08.087000Z","iopub.status.busy":"2025-01-14T15:23:52.370000Z","iopub.execute_input":"2025-01-14T15:23:55.529000Z","shell.execute_reply":"2025-01-14T15:24:08.085000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"A = rand(1.:9., 6, 4)\n@show m,n = size(A);","key":"QBnCiiNUX0"},{"type":"output","id":"laTqShpcuFdi4lFYezgQZ","data":[{"name":"stdout","output_type":"stream","text":"(m, n) = size(A) = (6, 4)"},{"name":"stdout","output_type":"stream","text":"\n"}],"key":"NEMeS4v3ep"}],"key":"lth3RkDWpU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is a standard call:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u4XujC94zL"}],"key":"xJ1ektQJTh"}],"key":"kfhV6wkQo2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:12.534000Z","iopub.status.busy":"2025-01-14T15:24:08.099000Z","iopub.execute_input":"2025-01-14T15:24:08.100000Z","shell.execute_reply":"2025-01-14T15:24:12.479000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"Q,R = qr(A);\nQ","key":"qTAVN3JjTf"},{"type":"output","id":"9NRUtjD_Vsf_ZXHcBmbD5","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"6×6 LinearAlgebra.QRCompactWYQ{Float64, Matrix{Float64}, Matrix{Float64}}","content_type":"text/plain"}}}],"key":"WvJ8YPN47K"}],"key":"D5tnSGvoTM"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:26.552000Z","iopub.status.busy":"2025-01-14T15:24:12.545000Z","iopub.execute_input":"2025-01-14T15:24:12.546000Z","shell.execute_reply":"2025-01-14T15:24:26.551000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"R","key":"ky0q7KbDJf"},{"type":"output","id":"V8W-RuzxwPLeREgOPrcaF","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -14.6629  -9.88892  -11.3211   -14.7993\n   0.0      5.4963     2.73757   -0.609289\n   0.0      0.0        4.72634    2.77674\n   0.0      0.0        0.0       -4.78538","content_type":"text/plain"}}}],"key":"nmzQIV3spl"}],"key":"oPCqItKiiZ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you look carefully, you see that we seemingly got a full ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DL178Kg08J"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"ea7VVtwJRg"},{"type":"text","value":" but a thin ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VgViYxTLkn"},{"type":"inlineMath","value":"\\mathbf{R}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">R</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{R}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">R</span></span></span></span>","key":"l9Q857CXDl"},{"type":"text","value":". However, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PbZLYlBK8i"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"GLVlAG0qmo"},{"type":"text","value":" above is not a standard matrix type. If you convert it to a true matrix, then it reverts to the thin form.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x9EJZeXS2s"}],"key":"oTZhmhG3LC"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"TEM6X0gJmO"}],"key":"xfr4YzreBP"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To enter the accented character ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LCmzGj8oQI"},{"type":"inlineCode","value":"Q̂","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CSqf0a18tN"},{"type":"text","value":", type ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CCUdezafQ9"},{"type":"inlineCode","value":"Q\\hat","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"NqJrL1jbkd"},{"type":"text","value":" followed by ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"vyiwoIcZYN"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"pEVKPAEqJU"}],"key":"uP9VqsrBaL"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZCxvGJNo1g"}],"key":"nLdNaokZD7"}],"class":"dropdown","key":"SDk4v9KgqB"}],"key":"avd3j1ndfq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:26.996000Z","iopub.status.busy":"2025-01-14T15:24:26.572000Z","iopub.execute_input":"2025-01-14T15:24:26.573000Z","shell.execute_reply":"2025-01-14T15:24:26.996000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂ = Matrix(Q)","key":"alNa3oNzyY"},{"type":"output","id":"IZy_FDbshk0gqRPWIc1Di","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"6×4 Matrix{Float64}:\n -0.204598   0.35965      0.782668   0.414186\n -0.613795  -0.194634    -0.2996     0.077402\n -0.409197   0.173478    -0.234318   0.271551\n -0.204598  -0.00423118   0.358693  -0.830345\n -0.545595  -0.435811     0.215033  -0.0131558\n -0.272798   0.782768    -0.260509  -0.24305","content_type":"text/plain"}}}],"key":"aDKG4rdCuY"}],"key":"XBRHdnanBq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can test that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J5HBd4oTUa"},{"type":"inlineMath","value":"\\mathbf{Q}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Q</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Q}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8805em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">Q</span></span></span></span>","key":"emqDTitKOV"},{"type":"text","value":" is an orthogonal matrix:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EbwtqwBG0w"}],"key":"j7oKy0UzoG"}],"key":"HJHzflpau2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:28.678000Z","iopub.status.busy":"2025-01-14T15:24:26.999000Z","iopub.execute_input":"2025-01-14T15:24:26.999000Z","shell.execute_reply":"2025-01-14T15:24:28.676000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"opnorm(Q' * Q - I)","key":"c7uHZiAQZY"},{"type":"output","id":"NR3GIFw3qNrj-25aEPBoS","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"7.342801647515658e-16","content_type":"text/plain"}}}],"key":"FKYrROaqI1"}],"key":"FJ330vKri6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The thin ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nr8KpswO5B"},{"type":"inlineMath","value":"\\hat{\\mathbf{Q}}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi mathvariant=\"bold\">Q</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{\\mathbf{Q}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.144em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9495em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathbf\">Q</span></span><span style=\"top:-3.2551em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"DMou184vPx"},{"type":"text","value":" cannot be an orthogonal matrix, because it is not square, but it is still ","key":"Dm7UTxyBJ6"},{"type":"abbreviation","title":"matrix with orthonormal columns","children":[{"type":"text","value":"ONC","key":"nGNiWv1Sn3"}],"key":"usPOQCX9lc"},{"type":"text","value":":","key":"vDKbeXTj5F"}],"key":"UOJ3IRcvjc"}],"key":"WWyQDtN729"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:24:28.780000Z","iopub.status.busy":"2025-01-14T15:24:28.680000Z","iopub.execute_input":"2025-01-14T15:24:28.680000Z","shell.execute_reply":"2025-01-14T15:24:28.742000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"Q̂' * Q̂ - I","key":"K8CkQfqnSO"},{"type":"output","id":"gUSdGSSR-BlPrUSWmVLM2","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n  4.44089e-16   2.60887e-17  -2.69778e-16  -1.23647e-16\n  2.60887e-17   0.0          -3.49859e-17   2.38519e-17\n -2.69778e-16  -3.49859e-17   2.22045e-16   9.57486e-17\n -1.23647e-16   2.38519e-17   9.57486e-17   2.22045e-16","content_type":"text/plain"}}}],"key":"qI6DP5ZGDb"}],"key":"xxUWrzstzB"}],"key":"wKK9HO4kWX"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Instab","url":"/instab","group":"Chapter 3"},"next":{"title":"Stable","url":"/stable-1","group":"Chapter 3"}}},"domain":"http://localhost:3000"}