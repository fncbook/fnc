{"kind":"Notebook","sha256":"ed3c9852c5d14b272b64ccdeef2f703769feda2e7fbc8cad1ecc0e4a0e620213","slug":"conv","location":"/chapter8/section3/julia/conv.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"conv.ipynb","url":"/build/conv-8c26817415d98f5acaefbd3aa04b6746.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"htGJlqTqin"},{"type":"text","value":"8.3.1","key":"QxtPsTYG2t"}],"key":"u9PbyNWpra"}],"identifier":"demo-inviter-conv","label":"demo-inviter-conv","kind":"proof:example","template":"Example %s","enumerator":"8.3.1","resolved":true,"html_id":"demo-inviter-conv","remote":true,"url":"/inviter","dataUrl":"/inviter.json","key":"U4LCPClmw0"}],"key":"uitwnw7MXG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We set up a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"F9HYvUawDT"},{"type":"inlineMath","value":"5\\times 5","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">5\\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"DpLtLmwMMT"},{"type":"text","value":" triangular matrix with prescribed eigenvalues on its diagonal.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"m5SveNT1Y1"}],"key":"LX7lyL9mbr"}],"key":"fIelEusxY0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:16.987000Z","iopub.status.busy":"2025-01-14T16:39:11.392000Z","iopub.execute_input":"2025-01-14T16:39:11.748000Z","shell.execute_reply":"2025-01-14T16:39:16.986000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"λ = [1, -0.75, 0.6, -0.4, 0]\n# Make a triangular matrix with eigenvalues on the diagonal.\nA = triu(ones(5, 5), 1) + diagm(λ)","key":"EMVNI2yw7W"},{"type":"output","id":"aTFH47DdRiuiKmYbFCV2G","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"5×5 Matrix{Float64}:\n 1.0   1.0   1.0   1.0  1.0\n 0.0  -0.75  1.0   1.0  1.0\n 0.0   0.0   0.6   1.0  1.0\n 0.0   0.0   0.0  -0.4  1.0\n 0.0   0.0   0.0   0.0  0.0","content_type":"text/plain"}}}],"key":"GB8FiT80qC"}],"key":"vZJlMjsdgh"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We run inverse iteration with the shift ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iTxjdgLXko"},{"type":"inlineMath","value":"s=0.7","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding=\"application/x-tex\">s=0.7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.7</span></span></span></span>","key":"RijRkkLtr3"},{"type":"text","value":" and take the final estimate as our “exact” answer to observe the convergence.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nnyk9oCLOw"}],"key":"VrjoofxUG9"}],"key":"EzGfa06ewT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:17.680000Z","iopub.status.busy":"2025-01-14T16:39:16.998000Z","iopub.execute_input":"2025-01-14T16:39:16.999000Z","shell.execute_reply":"2025-01-14T16:39:17.680000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"s = 0.7\nβ, x = FNC.inviter(A, s, 30)\neigval = β[end]","key":"I88eVOAUga"},{"type":"output","id":"UWRImkRZbpYBkFp6zQU3G","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"0.5999999999999995","content_type":"text/plain"}}}],"key":"N856Pou5BW"}],"key":"pPWykGfo0O"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As expected, the eigenvalue that was found is the one closest to 0.7. The convergence is again linear.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TcoaaqaoRS"}],"key":"EAqaQjo3Rf"}],"key":"vMJAghz09d"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:27.984000Z","iopub.status.busy":"2025-01-14T16:39:17.685000Z","iopub.execute_input":"2025-01-14T16:39:17.685000Z","shell.execute_reply":"2025-01-14T16:39:27.983000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"err = @. abs(eigval - β)\nplot(0:28, err[1:end-1];\n    m=:o,  xlabel=L\"k\", \n    yaxis=(L\"|\\lambda_3-\\beta_k|\", :log10, [1e-16, 1]),\n    title=\"Convergence of inverse iteration\")","key":"vwGGJFUI2J"},{"type":"output","id":"fP0aFUgwBOJEc7ffsW8un","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a76496fe4a9494545f239e2202a1364d","path":"/build/a76496fe4a9494545f239e2202a1364d.png"},"text/html":{"content_type":"text/html","hash":"f6d25c86ac742bf7c5bba22d75ad96a2","path":"/build/f6d25c86ac742bf7c5bba22d75ad96a2.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"5179fecf0a16f448a0a06fecacc9f726","path":"/build/5179fecf0a16f448a0a06fecacc9f726.svg"}}}],"key":"Lmnloom79J"}],"key":"R9FvHUGmm5"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The observed linear convergence rate is found from the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kXKsDwH3RV"}],"key":"p0OisfImnK"}],"key":"HEXUvktBPR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:29.236000Z","iopub.status.busy":"2025-01-14T16:39:27.991000Z","iopub.execute_input":"2025-01-14T16:39:27.992000Z","shell.execute_reply":"2025-01-14T16:39:29.235000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show observed_rate = err[22] / err[21];","key":"lZ3p5j29g8"},{"type":"output","id":"IYJ_4sC8x_AzcDfnEsBuW","data":[{"name":"stdout","output_type":"stream","text":"observed_rate = err[22] / err[21] = 0.33326927642065046"},{"name":"stdout","output_type":"stream","text":"\n"}],"key":"kZx5xVEQyg"}],"key":"HVps0Zm3XP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We reorder the eigenvalues to enforce ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wrXPqbkWaE"},{"type":"crossReference","kind":"equation","identifier":"shiftorder","label":"shiftorder","children":[{"type":"text","value":"(","key":"zR9bkQZIgq"},{"type":"text","value":"8.3.3","key":"xzbrnNZC28"},{"type":"text","value":")","key":"nNbNnQSKG7"}],"template":"(%s)","enumerator":"8.3.3","resolved":true,"html_id":"shiftorder","remote":true,"url":"/inviter","dataUrl":"/inviter.json","key":"dX4Fn9NCDy"},{"type":"text","value":".","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VURfXwk0HJ"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"sortperm","kind":"entry"},"emphasis":true}],"label":"index-ZnLmsGQUFz","identifier":"index-znlmsgqufz","html_id":"index-znlmsgqufz","key":"v5ooG2AKPs"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"R7A2MCAxdR"}],"key":"o20jU2TMhC"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cglVibuVBS"},{"type":"inlineCode","value":"sortperm","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Bczy3IHIda"},{"type":"text","value":" function returns the index permutation needed to sort the given vector, rather than the sorted vector itself.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"V946HInwF4"}],"key":"fZ6K8xQwxO"}],"class":"dropdown","key":"Fsoe4SLF1D"}],"key":"AZF2lDbtwD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:29.605000Z","iopub.status.busy":"2025-01-14T16:39:29.239000Z","iopub.execute_input":"2025-01-14T16:39:29.239000Z","shell.execute_reply":"2025-01-14T16:39:29.604000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"λ = λ[sortperm(abs.(λ .- s))]","key":"pJaoBpFQ8p"},{"type":"output","id":"txGihhRYNz9WDpv48B4I4","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"5-element Vector{Float64}:\n  0.6\n  1.0\n  0.0\n -0.4\n -0.75","content_type":"text/plain"}}}],"key":"xi0v4gcnpm"}],"key":"rySNC0dOci"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Hence the theoretical convergence rate is","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H44HYr9sVi"}],"key":"W6c3SIjQPR"}],"key":"G94zrjO1Fd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T16:39:29.611000Z","iopub.status.busy":"2025-01-14T16:39:29.608000Z","iopub.execute_input":"2025-01-14T16:39:29.608000Z","shell.execute_reply":"2025-01-14T16:39:29.611000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"@show theoretical_rate = (λ[1] - s) / (λ[2] - s);","key":"Io0HA5HAki"},{"type":"output","id":"ds5ZV16862UV6ITfNHI5I","data":[{"name":"stdout","output_type":"stream","text":"theoretical_rate = (λ[1] - s) / (λ[2] - s) = -0.3333333333333332\n"}],"key":"YxdC2xsQF6"}],"key":"tN93NRlrSz"}],"key":"EULX0ZvonW"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Iter","url":"/iter","group":"Chapter 8"},"next":{"title":"Accel","url":"/accel","group":"Chapter 8"}}},"domain":"http://localhost:3000"}