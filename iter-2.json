{"kind":"Notebook","sha256":"31681e4211b525bfd51a3dcec8745e689e627440b4ca3de780d2cf913fe8da96","slug":"iter-2","location":"/chapter8/section2/python/iter.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"iter.ipynb","url":"/build/iter-2d618f703fb80e219fb32d95d11397db.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:22:14.919814Z","iopub.status.busy":"2025-01-11T16:22:14.919576Z","iopub.status.idle":"2025-01-11T16:22:15.322965Z","shell.execute_reply":"2025-01-11T16:22:15.322704Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"IMsaZdX81I"},{"type":"output","id":"INKS2UQxWOKKrF5lKoSbO","data":[],"visibility":"show","key":"rR9clN1hw2"}],"visibility":"remove","key":"b3EM3cI4vx"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"SG6gRrfWd6"},{"type":"text","value":"8.2.2","key":"Pna7O9zdig"}],"key":"tbmn1JA7IB"}],"identifier":"demo-power-iter","label":"demo-power-iter","kind":"proof:example","template":"Example %s","enumerator":"8.2.2","resolved":true,"html_id":"demo-power-iter","remote":true,"url":"/power","dataUrl":"/power.json","key":"WoSWztYYXV"}],"key":"RlynTZjtcB"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will experiment with the power iteration on a 5×5 matrix with prescribed eigenvalues and dominant eigenvalue at 1.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d11kcnZtXr"}],"key":"g2cuFWux7h"}],"key":"hdQSqe2piX"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:22:15.324501Z","iopub.status.busy":"2025-01-11T16:22:15.324359Z","iopub.status.idle":"2025-01-11T16:22:15.326295Z","shell.execute_reply":"2025-01-11T16:22:15.326046Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ev = [1, -0.75, 0.6, -0.4, 0]\nA = triu(ones([5, 5]), 1) + diag(ev)    # triangular matrix, eigs on diagonal","key":"xpp6kpoBc7"},{"type":"output","id":"Twpj0Tzmr30kFIM5MEmyz","data":[],"key":"KGYDNo4i7N"}],"key":"oxouTfl8gV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We run the power iteration 60 times. The first output should be a sequence of estimates converging to the dominant eigenvalue—which, in this case, we set up to be 1.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VpK4BIMPkN"}],"key":"fvCWRaEBt3"}],"key":"rQ6fMcYIk0"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:22:15.327416Z","iopub.status.busy":"2025-01-11T16:22:15.327323Z","iopub.status.idle":"2025-01-11T16:22:15.329598Z","shell.execute_reply":"2025-01-11T16:22:15.329382Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"beta, x = FNC.poweriter(A, 60)\nprint(beta)","key":"zaalCerkg5"},{"type":"output","id":"w6jyBg7mCQ8zZxlVWO81y","data":[{"name":"stdout","output_type":"stream","text":"[-13.85479499 -13.30497011   1.71067197   1.22051051   1.1260693\n   1.05540639   1.03986036   1.01696853   1.01445896   1.00526348\n   1.00559482   1.0015085    1.00227396   1.00033595   1.00097024\n   1.00000558   1.00043535   0.99993724   1.00020525   0.99994098\n   1.0001012    0.99995826   1.0000518    0.99997345   1.00002729\n   0.99998396   1.00001469   0.99999058   1.00000802   0.99999456\n   1.00000443   0.99999689   1.00000246   0.99999823   1.00000137\n   0.999999     1.00000077   0.99999943   1.00000043   0.99999968\n   1.00000024   0.99999982   1.00000014   0.9999999    1.00000008\n   0.99999994   1.00000004   0.99999997   1.00000002   0.99999998\n   1.00000001   0.99999999   1.00000001   0.99999999   1.\n   1.           1.           1.           1.           1.        ]\n"}],"key":"Y2hwzMLK9X"}],"key":"d1BuWzekKN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We check for linear convergence using a log-linear plot of the error.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aV4ctZlvqj"}],"key":"UddKXW0t6w"}],"key":"SGFsvaS6VK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:22:15.330708Z","iopub.status.busy":"2025-01-11T16:22:15.330623Z","iopub.status.idle":"2025-01-11T16:22:15.533558Z","shell.execute_reply":"2025-01-11T16:22:15.533233Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"err = 1 - beta\nsemilogy(arange(60), abs(err), \"-o\")\nylim(1e-10, 1)\nxlabel(\"$k$\")\nylabel(\"$|\\\\lambda_1 - \\\\beta_k|$\")\ntitle(\"Convergence of power iteration\");","key":"DBwKx538eL"},{"type":"output","id":"0a6T07bNoLu_gwxAWKdFn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a5ee5aab448948192bb24c87f1155866","path":"/build/a5ee5aab448948192bb24c87f1155866.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"v35pukDYOu"}],"key":"rBMZEvy0Ky"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The asymptotic trend seems to be a straight line, consistent with linear convergence. To estimate the convergence rate, we look at the ratio of two consecutive errors in the linear part of the convergence curve. The ratio of the first two eigenvalues should match the observed rate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dtyqEfQnNI"}],"key":"tjO6tnLJeT"}],"key":"kIU2gkyMdK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:22:15.535451Z","iopub.status.busy":"2025-01-11T16:22:15.535214Z","iopub.status.idle":"2025-01-11T16:22:15.538206Z","shell.execute_reply":"2025-01-11T16:22:15.537951Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(f\"theory: {ev[1] / ev[0]:.5f}\")\nprint(f\"observed: {err[40] / err[39]:.5f}\")","key":"vNbQ955M0D"},{"type":"output","id":"voaLxaJ02hVE1Fj42eZ76","data":[{"name":"stdout","output_type":"stream","text":"theory: -0.75000\nobserved: -0.75652\n"}],"key":"UUhCNrAg2I"}],"key":"wakWlm1Pdg"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that the error is supposed to change sign on each iteration. The effect of these alternating signs is that estimates oscillate around the exact value.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pqByeGveCs"}],"key":"gawKdM1nHT"}],"key":"FdFwuky7Lg"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:22:15.539613Z","iopub.status.busy":"2025-01-11T16:22:15.539513Z","iopub.status.idle":"2025-01-11T16:22:15.541360Z","shell.execute_reply":"2025-01-11T16:22:15.541149Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(beta[26:30])","key":"sM8pECxuHd"},{"type":"output","id":"bYa0wZg7Vj-SUnKSWPrxD","data":[{"name":"stdout","output_type":"stream","text":"[1.00001469 0.99999058 1.00000802 0.99999456]\n"}],"key":"wSYRICkVbW"}],"key":"jzqHTvwpU7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In practical situations, we don’t know the exact eigenvalue that the algorithm is supposed to find. In that case we would base errors on the final ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p4vspMkL7f"},{"type":"text","value":"β","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hb3bKVBItp"},{"type":"text","value":" that was found, as in the following plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bkBjPLbEx4"}],"key":"f28gHS0x1R"}],"key":"olesuvZrZF"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-11T16:22:15.542320Z","iopub.status.busy":"2025-01-11T16:22:15.542226Z","iopub.status.idle":"2025-01-11T16:22:15.622063Z","shell.execute_reply":"2025-01-11T16:22:15.621749Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"err = beta[-1] - beta\nsemilogy(arange(60), abs(err), \"-o\")\nylim(1e-10, 1), xlabel(\"$k$\")\nylabel(\"$|\\\\lambda_1 - \\\\beta_k|$\")\ntitle(\"Convergence of power iteration\");","key":"uZ5VKT0pOi"},{"type":"output","id":"t19KhaH5ZHZi6Qj__60ms","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa2b6ba6cf8c91dafa10feeaac173930","path":"/build/aa2b6ba6cf8c91dafa10feeaac173930.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"zPoVkn8BhC"}],"key":"aM1pH5u1qG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The results are very similar until the last few iterations, when the limited accuracy of the reference value begins to show. That is, while it is a good estimate of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MIaeY85H8A"},{"type":"inlineMath","value":"\\lambda_1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\lambda_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"SeyX9rqrgY"},{"type":"text","value":", it is less good as an estimate of the error in nearby estimates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jujYV9E3G6"}],"key":"xwr3HxzrG1"}],"key":"cjUe05GEgI"}],"key":"PjRBwaqXio"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"One","url":"/one-2","group":"Chapter 8"},"next":{"title":"Conv","url":"/conv-2","group":"Chapter 8"}}},"domain":"http://localhost:3000"}