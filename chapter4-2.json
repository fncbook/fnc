{"kind":"Notebook","sha256":"fcd6c114c0f912e5b60ec81bcfb108f217a5a9bb6ea53d3c9bc156bb7c800aee","slug":"chapter4-2","location":"/python/chapter4.md","dependencies":[],"frontmatter":{"title":"Chapter 4","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"LU":"lower triangular times upper triangular","QR":"orthogonal times upper triangular"},"exports":[{"format":"md","filename":"chapter4.md","url":"/fnc/build/chapter4-fbd86cd079f0072d77b82cc46aa899d0.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Python implementations","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"aDltTMhvVz"}],"key":"rTLd7GwUBA"},{"type":"heading","depth":2,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"kffJHPr0QL"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"UzJgSR7jA0"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"vAmgfD7EhR"}],"key":"P6JHD7saQw"},{"type":"include","file":"../python/pkg/FNC/FNC04.py","literal":true,"filter":{"lines":[[5,35]]},"children":[{"type":"code","value":"def newton(f, dfdx, x1):\n    \"\"\"\n    newton(f, dfdx, x1)\n\n    Use Newton's method to find a root of `f` starting from `x1`, where `dfdx` is the\n    derivative of `f`. Returns a vector of root estimates.\n    \"\"\"\n    # Operating parameters.\n    eps = np.finfo(float).eps\n    funtol = 100 * eps\n    xtol = 100 * eps\n    maxiter = 40\n\n    x = np.zeros(maxiter)\n    x[0] = x1\n    y = f(x1)\n    dx = np.inf  # for initial pass below\n    k = 0\n\n    while (abs(dx) > xtol) and (abs(y) > funtol) and (k < maxiter):\n        dydx = dfdx(x[k])\n        dx = -y / dydx  # Newton step\n        x[k + 1] = x[k] + dx  # new estimate\n\n        k = k + 1\n        y = f(x[k])\n\n    if k == maxiter:\n        warnings.warn(\"Maximum number of iterations reached.\")\n\n    return x[: k + 1]","lang":"python","showLineNumbers":true,"filename":"newton.py","key":"fbMtZIxmcB"}],"key":"DvMEUbzRnQ"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"IVLuukksZm"}],"key":"j1VDNKCyCZ"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-newton","label":"function-newton","children":[{"type":"text","value":"Function ","key":"bKZBToibP0"},{"type":"text","value":"4.3.2","key":"Eq30jHqwy7"}],"template":"Algorithm %s","enumerator":"4.3.2","resolved":true,"html_id":"function-newton","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"F3Wkh9VnaY"},{"type":"text","value":" accepts ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"vm95QRzX6S"},{"type":"emphasis","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"keyword arguments","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"rk8dgJuKWj"}],"key":"LJcpAzA4Fb"},{"type":"text","value":". In the function declaration, these follow the semicolon, and when the function is called, they may be supplied as ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Bf5xqG5klu"},{"type":"inlineCode","value":"keyword=value","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Swt9nzUFca"},{"type":"text","value":" in the argument list. Here, these arguments are also given default values by the assignments within the declaration. This arrangement is useful when there are multiple optional arguments, because the ordering of them doesn’t matter.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"sAZxEFSyQD"}],"key":"uo6w4XmEJb"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"Qz5DmRcEwG"},{"type":"inlineCode","value":"break","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"FoECaEIBW1"},{"type":"text","value":" statement, seen here in line 25, causes an immediate exit from the innermost loop in which it is called. It is often used as a safety valve to escape an iteration that may not be able to terminate otherwise.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"HyAkGfc7uq"}],"key":"lTEEstNblB"}],"class":"dropdown","key":"AhsbBUEkbS"}],"label":"function-newton-python","identifier":"function-newton-python","html_id":"function-newton-python","key":"koJjeI3MZe"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Secant method","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"eHbczJLeFI"}],"key":"siYBDDMdqw"},{"type":"include","file":"../python/pkg/FNC/FNC04.py","literal":true,"filter":{"lines":[[37,67]]},"children":[{"type":"code","value":"def secant(f, x1, x2):\n    \"\"\"\n    secant(f, x1, x2)\n\n    Use the secant method to find a root of `f` starting from `x1` and `x2`. Returns a\n    vector of root estimates.\n    \"\"\"\n    # Operating parameters.\n    eps = np.finfo(float).eps\n    funtol = 100 * eps\n    xtol = 100 * eps\n    maxiter = 40\n\n    x = np.zeros(maxiter)\n    x[:2] = [x1, x2]\n    y1 = f(x1)\n    y2 = 100\n    dx = np.inf  # for initial pass below\n    k = 1\n\n    while (abs(dx) > xtol) and (abs(y2) > funtol) and (k < maxiter):\n        y2 = f(x[k])\n        dx = -y2 * (x[k] - x[k - 1]) / (y2 - y1)  # secant step\n        x[k + 1] = x[k] + dx  # new estimate\n\n        k = k + 1\n        y1 = y2  # current f-value becomes the old one next time\n\n    if k == maxiter:\n        warnings.warn(\"Maximum number of iterations reached.\")\n    return x[:k+1]","lang":"python","showLineNumbers":true,"filename":"secant.py","key":"jXu4GIBHIN"}],"key":"BGGHyX72ho"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"UKxAm7spdN"}],"key":"pLKqTGM5si"},{"type":"paragraph","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"Because we want to observe the convergence of the method, ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"qzxTqoIVAo"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-secant","label":"function-secant","children":[{"type":"text","value":"Function ","key":"y06qOMyyhJ"},{"type":"text","value":"4.4.2","key":"La3EkO81K3"}],"template":"Algorithm %s","enumerator":"4.4.2","resolved":true,"html_id":"function-secant","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"rOp01e9qx6"},{"type":"text","value":" stores and returns the entire sequence of root estimates. However, only the most recent two are needed by the iterative formula. This is demonstrated by the use of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"G4QqlBFlUv"},{"type":"inlineCode","value":"y₁","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"nF6Evtif5p"},{"type":"text","value":" and ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"r31myUSqnh"},{"type":"inlineCode","value":"y₂","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"ZZPGoV4Mpq"},{"type":"text","value":" for the two most recent values of ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"pe9CsNbzNP"},{"type":"inlineMath","value":"f","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"vUZ6vjrMPC"},{"type":"text","value":".","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"s30mx2zJ8G"}],"key":"zhAbWQr1d0"}],"class":"dropdown","key":"vXpMjbWN7a"}],"label":"function-secant-python","identifier":"function-secant-python","html_id":"function-secant-python","key":"lXNo9uQFYd"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Newton’s method for systems","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"mTvO2Nf1qy"}],"key":"IoeLibUMg9"},{"type":"include","file":"../python/pkg/FNC/FNC04.py","literal":true,"filter":{"lines":[[69,97]]},"children":[{"type":"code","value":"def newtonsys(f, jac, x1):\n    \"\"\"\n        newtonsys(f, jac, x1)\n\n    Use Newton's method to find a root of a system of equations, starting from `x1`. The\n    function `f` should return the residual vector, and the function `jac` should return \n    the Jacobian matrix. Returns root estimates as a matrix, one estimate per column.\n    \"\"\"\n    # Operating parameters.\n    funtol = 1000 * np.finfo(float).eps\n    xtol = 1000 * np.finfo(float).eps\n    maxiter = 40\n\n    x = np.zeros((len(x1), maxiter))\n    x[:, 0] = x1\n    y, J = f(x1), jac(x1)\n    dx = 10.0  # for initial pass below\n    k = 0\n\n    while (norm(dx) > xtol) and (norm(y) > funtol) and (k < maxiter):\n        dx = -lstsq(J, y)[0]  # Newton step\n        x[:, k+1] = x[:, k] + dx\n\n        k = k + 1\n        y, J = f(x[:, k]), jac(x[:, k])\n\n    if k == maxiter:\n        warnings.warn(\"Maximum number of iterations reached.\")\n    return x[:, :k+1]","lang":"python","showLineNumbers":true,"filename":"newtonsys.py","key":"SHKVoGBOvT"}],"key":"yCneZqjuS4"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Cn5AcUA7jq"}],"key":"nazp7EtKra"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"text","value":"The output of ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"Z1478Tac0D"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-newtonsys","label":"function-newtonsys","children":[{"type":"text","value":"Function ","key":"M7kAXNkobA"},{"type":"text","value":"4.5.2","key":"K7JQXYNN02"}],"template":"Algorithm %s","enumerator":"4.5.2","resolved":true,"html_id":"function-newtonsys","remote":true,"url":"/newtonsys","dataUrl":"/newtonsys.json","key":"qHRpPb0Kt1"},{"type":"text","value":" is a vector of vectors representing the entire history of root estimates. Since these should be in floating point, the starting value is converted with ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"U3FVSzpjdk"},{"type":"inlineCode","value":"float","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"UwpA209D3J"},{"type":"text","value":" before the iteration starts.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"AwVUVf5PAO"}],"key":"R6IEc2QfVH"}],"class":"dropdown","key":"B2UVaaXvU3"}],"label":"function-newtonsys-python","identifier":"function-newtonsys-python","html_id":"function-newtonsys-python","key":"pYoEXn6O3a"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Finite differences for Jacobian","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"mDncfBXJYw"}],"key":"Gx6Xedhxhq"},{"type":"include","file":"../python/pkg/FNC/FNC04.py","literal":true,"filter":{"lines":[[99,113]]},"children":[{"type":"code","value":"def fdjac(f, x0, y0):\n    \"\"\"\n    fdjac(f,x0,y0)\n\n    Compute a finite-difference approximation of the Jacobian matrix for `f` at `x0`,\n    where `y0`=`f(x0)` is given.\n    \"\"\"\n\n    delta = np.sqrt(np.finfo(float).eps)  # FD step size\n    m, n = len(y0), len(x0)\n    J = np.zeros((m, n))\n    I = np.eye(n)\n    for j in range(n):\n        J[:, j] = (f(x0 + delta * I[:, j]) - y0) / delta\n    return J","lang":"python","showLineNumbers":true,"filename":"fdjac.py","key":"bWiglFoRVX"}],"key":"eECZawCVjf"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"Rr6ZAVko3i"}],"key":"k4y25xiXfD"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fdjac","label":"function-fdjac","children":[{"type":"text","value":"Function ","key":"QExJ81sDIq"},{"type":"text","value":"4.6.1","key":"HCdW6N38ze"}],"template":"Algorithm %s","enumerator":"4.6.1","resolved":true,"html_id":"function-fdjac","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"uond0oPuE0"},{"type":"text","value":" is written to accept the case where ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"onT4fmWw20"},{"type":"inlineMath","value":"\\mathbf{f}","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"N2KfhWvuif"},{"type":"text","value":" maps ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"D4Ec8VPQsQ"},{"type":"inlineMath","value":"n","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"dMQaBGO7jp"},{"type":"text","value":" variables to ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"MU75rPNUDG"},{"type":"inlineMath","value":"m","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"cweOfUeAdF"},{"type":"text","value":" values with ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"PrkOGTyryb"},{"type":"inlineMath","value":"m\\neq n","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo mathvariant=\"normal\">≠</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m\\neq n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"u3lQscRKOf"},{"type":"text","value":", in anticipation of ","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"IkfnWLxtl6"},{"type":"link","kind":"numref","identifier":"section-nonlineqn-nlsq","label":"section-nonlineqn-nlsq","url":"/nlsq","internal":true,"dataUrl":"/nlsq.json","children":[{"type":"text","value":"Nonlinear least squares","key":"lV0xoMhrCk"}],"key":"Yp3gQKebzi"},{"type":"text","value":".","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"iKDMSvuMXv"}],"key":"pyjWV8C2yn"},{"type":"paragraph","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"Note that a default value is given for the third argument ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"xo42Bbt7k4"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"HnnL006dkX"},{"type":"text","value":", and it refers to earlier arguments in the list. The reason is that in some contexts, the caller of ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"jrMLbyaJkZ"},{"type":"inlineCode","value":"fdjac","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"pMGMjgvX1w"},{"type":"text","value":" may have already computed ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"RIJk2MPTkM"},{"type":"inlineCode","value":"y₀","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"wzP9tbnwkU"},{"type":"text","value":" and can supply it without computational cost, while in other contexts, it must be computed fresh. The configuration here adapts to either situation.","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"IDtPNNtlew"}],"key":"kJsa3cRwFA"}],"class":"dropdown","key":"j28ItILL4o"}],"label":"function-fdjac-python","identifier":"function-fdjac-python","html_id":"function-fdjac-python","key":"PR2cnk9l8G"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Levenberg’s method","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"rK52CYmjBM"}],"key":"sNy5AVhje2"},{"type":"include","file":"../python/pkg/FNC/FNC04.py","literal":true,"filter":{"lines":[[115,169]]},"children":[{"type":"code","value":"def levenberg(f, x1, tol=1e-12):\n    \"\"\"\n    levenberg(f,x1,tol)\n\n    Use Levenberg's quasi-Newton iteration to find a root of the system `f`, starting from\n    `x1`, with `tol` as the stopping tolerance in both step size and residual norm. Returns\n    root estimates as a matrix, one estimate per column.\n    \"\"\"\n\n    # Operating parameters.\n    ftol = tol\n    xtol = tol\n    maxiter = 40\n\n    n = len(x1)\n    x = np.zeros((n, maxiter))\n    x[:, 0] = x1\n    fk = f(x1)\n    k = 0\n    s = 10.0\n    Ak = fdjac(f, x[:, 0], fk)  # start with FD Jacobian\n    jac_is_new = True\n\n    lam = 10\n    while (norm(s) > xtol) and (norm(fk) > ftol) and (k < maxiter):\n        # Compute the proposed step.\n        B = Ak.T @ Ak + lam * np.eye(n)\n        z = Ak.T @ fk\n        s = -lstsq(B, z)[0]\n\n        xnew = x[:, k] + s\n        fnew = f(xnew)\n\n        # Do we accept the result?\n        if norm(fnew) < norm(fk):  # accept\n            y = fnew - fk\n            x[:, k + 1] = xnew\n            fk = fnew\n            k = k + 1\n\n            lam = lam / 10  # get closer to Newton\n            # Broyden update of the Jacobian.\n            Ak = Ak + np.outer(y - Ak @ s, s / np.dot(s, s))\n            jac_is_new = False\n        else:  # don't accept\n            # Get closer to steepest descent.\n            lam = lam * 4\n            # Re-initialize the Jacobian if it's out of date.\n            if not jac_is_new:\n                Ak = fdjac(f, x[:, k], fk)\n                jac_is_new = True\n\n    if norm(fk) > 1e-3:\n        warnings.warn(\"Iteration did not find a root.\")\n    return x[:, :k+1]","lang":"python","showLineNumbers":true,"filename":"levenberg.py","key":"DyWbyySXoK"}],"key":"CAs9d1jZfd"}],"label":"function-levenberg-python","identifier":"function-levenberg-python","html_id":"function-levenberg-python","key":"SSHJd7sWxm"},{"type":"heading","depth":2,"position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"aZHPiddra6"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"qRyNQnfhIR"}],"key":"cYcZ5iTnPF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy import *\nfrom matplotlib.pyplot import *\nfrom numpy.linalg import solve, norm\nimport scipy.sparse as sparse\nfrom scipy.sparse.linalg import splu\nfrom timeit import default_timer as timer\nfrom prettytable import PrettyTable\nimport FNC","key":"XcukilnlF7"},{"type":"output","id":"vtEveYaHhftKADjkyTSu_","data":[],"key":"NFCzA0XlnK"}],"data":{},"key":"wCJbOuszLY"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"Section 4.1","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"SRyTvbBNTC"}],"identifier":"section-4-1","label":"Section 4.1","html_id":"section-4-1","implicit":true,"key":"QnZxYRVTML"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"The rootfinding problem for Bessel functions","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"EHYyFUmrLB"}],"key":"ZCr0rihSpk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.special as special\ndef J3(x):\n    return special.jv(3.0, x)\n\nxx = linspace(0, 20, 500)\nfig, ax = subplots()\nax.plot(xx, J3(xx))\nax.grid()\nxlabel(\"$x$\"), ylabel(\"$J_3(x)$\")\ntitle(\"Bessel function\")","key":"SAbhdQs4Id"},{"type":"output","id":"cUI_8CoKUod0lSsv9SbZs","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"9ca78df049460b2568c953401ec6575c","path":"/fnc/build/9ca78df049460b2568c953401ec6575c.png"}}}],"key":"dgz5y9QtBp"}],"data":{},"key":"OWp2LYpYZ9"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"From the graph we see roots near 6, 10, 13, 16, and 19. We use ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"E12qf84pGA"},{"type":"inlineCode","value":"root_scalar","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"q1JB0sJdQu"},{"type":"text","value":" from the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"vgTMQWKqyd"},{"type":"inlineCode","value":"scipy.optimize","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"eKlDizKxOV"},{"type":"text","value":" package to find these roots accurately.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"duRS3r79vX"}],"key":"oLQLDk5Tu6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.optimize import root_scalar\n\nomega = []\nfor guess in [6.0, 10.0, 13.0, 16.0, 19.0]:\n    s = root_scalar(J3, bracket=[guess - 0.5, guess + 0.5]).root\n    omega.append(s)\n\nresults = PrettyTable()\nresults.add_column(\"root estimate\", omega)\nresults.add_column(\"function value\", [J3(ω) for ω in omega])\nprint(results)","key":"JkDzAkgtsX"},{"type":"output","id":"_nnpOUQiRoKOerXsLWW_a","data":[{"output_type":"stream","name":"stdout","text":"+--------------------+-------------------------+\n|   root estimate    |      function value     |\n+--------------------+-------------------------+\n| 6.380161895923983  |  2.5877058405892666e-16 |\n| 9.761023129981195  | -1.1824718824668837e-13 |\n| 13.015200721698434 |  -1.135864957485476e-16 |\n| 16.223466160318758 |  -1.898385896228919e-15 |\n| 19.40941522643501  |  7.862906169587308e-16  |\n+--------------------+-------------------------+\n"}],"key":"xLJ8q5UJlf"}],"data":{},"key":"BC0jVCWbJ4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ax.scatter(omega, J3(omega))\nax.set_title(\"Bessel function roots\")\nfig","key":"mjefZjGJEo"},{"type":"output","id":"HSChTD0P7ZJWviDqlVlfp","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"14d29cf07d03502a0ada3cd70038ab20","path":"/fnc/build/14d29cf07d03502a0ada3cd70038ab20.png"}}}],"key":"Ia8KtTTnQY"}],"data":{},"key":"XzF50H7O19"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"If instead we seek values at which ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"MPJoiVUNQV"},{"type":"inlineMath","value":"J_3(x)=0.2","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)=0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"xPsbeKKVEc"},{"type":"text","value":", then we must find roots of the function ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"GHjoC8uKHO"},{"type":"inlineMath","value":"J_3(x)-0.2","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>J</mi><mn>3</mn></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mn>0.2</mn></mrow><annotation encoding=\"application/x-tex\">J_3(x)-0.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0962em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.2</span></span></span></span>","key":"RsVPFsqXPW"},{"type":"text","value":".","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"asZAblB1nn"}],"key":"Q2vjmzYu5S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"omega = []\nfor guess in [3., 6., 10., 13.]:\n    f = lambda x: J3(x) - 0.2\n    s = root_scalar(f, x0=guess).root\n    omega.append(s)\n\nax.scatter(omega, J3(omega))\nfig","key":"ljpGk2ur6D"},{"type":"output","id":"POiJCTJVpBhmO0kq3dn1Y","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"5e41af24d35840014e9a20a7d557f3e7","path":"/fnc/build/5e41af24d35840014e9a20a7d557f3e7.png"}}}],"key":"sV6zdY6Qvh"}],"data":{},"key":"yJYiwznoGa"}],"label":"demo-rootproblem-bessel-python","identifier":"demo-rootproblem-bessel-python","html_id":"demo-rootproblem-bessel-python","key":"nAgHr9HCZI"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Condition number of a rootfinding problem","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"vspXd7EPyL"}],"key":"MXOvgiR8Nt"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"Consider first the function","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"zlJ3DlE7Q3"}],"key":"MBjlzHfMd3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: (x - 1) * (x - 2)","key":"dSHOL0f0kI"},{"type":"output","id":"C7lvUQf3T2QiQQLc-NYXD","data":[],"key":"uj9V4wTUyM"}],"data":{},"key":"NVRgsHtkox"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"At the root ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"NHxt00EqnV"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">r=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"smVHBHnKQZ"},{"type":"text","value":", we have ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"bY5e67oBos"},{"type":"inlineMath","value":"f'(r)=-1","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(r)=-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span>","key":"Yq6yQzg7EO"},{"type":"text","value":". If the values of ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"XXSj5bYuyX"},{"type":"inlineMath","value":"f","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"Np0864jvgz"},{"type":"text","value":" were perturbed at every point by a small amount of noise, we can imagine finding the root of the function drawn with a thick ribbon, giving a range of potential roots.","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"dDf0Pfx9Po"}],"key":"UK7oO8Wuyh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xx = linspace(0.8, 1.2, 400)\nplot(xx, f(xx))\nplot(xx, f(xx) + 0.02, \"k\")\nplot(xx, f(xx) - 0.02, \"k\")\naxis(\"equal\"), grid(True)\nxlabel(\"x\"), ylabel(\"f(x)\")\ntitle(\"Well-conditioned root\")","key":"a2sWRqLhCL"},{"type":"output","id":"Ryd2eFUEqqBZum9N3fFTl","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"86d14aca73f6e56a27193b0d743846d1","path":"/fnc/build/86d14aca73f6e56a27193b0d743846d1.png"}}}],"key":"qnMWuOzOH7"}],"data":{},"key":"kFXuAVjnaP"},{"type":"paragraph","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"The possible values for a perturbed root all lie within the interval where the ribbon intersects the ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"WpqJ3ziJk6"},{"type":"inlineMath","value":"x","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"QQkBifbQv8"},{"type":"text","value":"-axis. The width of that zone is about the same as the vertical thickness of the ribbon.","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"d9H9h7Kt2j"}],"key":"jL5eYFUl2a"},{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"By contrast, consider the function","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"I5sCkPsvoB"}],"key":"p3o7WVqvMg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: (x - 1) * (x - 1.01)","key":"F5se7S7TlV"},{"type":"output","id":"jOQvvmUSKDz5qDDwKEQc9","data":[],"key":"yqvH5awX5u"}],"data":{},"key":"bDhPniPWSv"},{"type":"paragraph","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"LXWJn2KdcK"},{"type":"inlineMath","value":"f'(1)=-0.01","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>f</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mn>0.01</mn></mrow><annotation encoding=\"application/x-tex\">f&#x27;(1)=-0.01</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.01</span></span></span></span>","key":"MeL1QUV9Bu"},{"type":"text","value":", and the graph of ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"kelbUhLhq0"},{"type":"inlineMath","value":"f","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"g88w0BGKDC"},{"type":"text","value":" will be much shallower near ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"kYS7IvJjoa"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"IQolCEHwkT"},{"type":"text","value":". Look at the effect this has on our thick rendering:","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"QeaySsOpOQ"}],"key":"bXJpy0EZ2g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xx = linspace(0.8, 1.2, 400)\nplot(xx, f(xx))\nplot(xx, f(xx) + 0.02, \"k\")\nplot(xx, f(xx) - 0.02, \"k\")\naxis(\"equal\"), grid(True)\nxlabel(\"x\"), ylabel(\"f(x)\")\ntitle(\"Poorly-conditioned root\")","key":"EqRLyvQx8U"},{"type":"output","id":"DqNEx1t99_kkd5aygPNo8","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b3a5e5f0860bc9ab9924510954ccc434","path":"/fnc/build/b3a5e5f0860bc9ab9924510954ccc434.png"}}}],"key":"e18kKrLs59"}],"data":{},"key":"F9FCBrK3Mx"},{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"The vertical displacements in this picture are exactly the same as before. But the potential ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"jDWYs8wejp"},{"type":"emphasis","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"horizontal","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"fx8wuYEr6B"}],"key":"DSFEOCSLty"},{"type":"text","value":" displacement of the root is much wider. In fact, if we perturb the function entirely upward by the amount drawn here, the root disappears!","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"DwcjTb7jrm"}],"key":"QCl56aqt3e"}],"label":"demo-roots-cond-python","identifier":"demo-roots-cond-python","html_id":"demo-roots-cond-python","key":"eGMSAvZ6A8"},{"type":"heading","depth":3,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Section 4.2","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"WRFrcAOewC"}],"identifier":"section-4-2","label":"Section 4.2","html_id":"section-4-2","implicit":true,"key":"whe8w90SfW"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Fixed-point iteration","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"w5TbrFvwNt"}],"key":"NA667Tu9CK"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Let’s convert the roots of a quadratic polynomial ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"G1aXQFUGPU"},{"type":"inlineMath","value":"f(x)","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"EHKW0OI30V"},{"type":"text","value":" to a fixed point problem.","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"QHwUsRRa49"}],"key":"xOjilCniJv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = poly1d([1, -4, 3.5])\nr = f.roots\nprint(r)","key":"GJcJKJUElm"},{"type":"output","id":"5Osg0yuyNqfC8Lz81zDKR","data":[{"output_type":"stream","name":"stdout","text":"[2.70710678 1.29289322]\n"}],"key":"zGxVzPhJEt"}],"data":{},"key":"xAgXEPQVom"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"We define ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"Gp44Fgx28m"},{"type":"inlineMath","value":"g(x)=x - f(x)","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo>−</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x)=x - f(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"acKRnro2M3"},{"type":"text","value":".","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"hrw53BlYRB"}],"key":"jj7DIqGptk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"g = lambda x: x - f(x)","key":"BI3F5fO275"},{"type":"output","id":"7D09NTrLZcdYJ60MpFbJs","data":[],"key":"hrMA9cs6Zh"}],"data":{},"key":"rgPXyaK2Ra"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Intersections of ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"XjurK5C8Bf"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"IWLR2aeZnI"},{"type":"text","value":" with the line ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"tnlP7RNb3d"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"VqAb4REKnO"},{"type":"text","value":" are fixed points of ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"BH9xiuWk98"},{"type":"inlineMath","value":"g","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"VArIsATZvh"},{"type":"text","value":" and thus roots of ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"H2McvyRzgg"},{"type":"inlineMath","value":"f","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"W39bJL7Jep"},{"type":"text","value":". (Only one is shown in the chosen plot range.)","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"J86XmWncUB"}],"key":"loO1BPibzw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = subplots()\ng = lambda x: x - f(x)\nxx = linspace(2, 3, 400)\nax.plot(xx, g(xx), label=\"y=g(x)\")\nax.plot(xx, xx, label=\"y=x\")\naxis(\"equal\"), legend()\ntitle(\"Finding a fixed point\")","key":"CmP8unUko4"},{"type":"output","id":"zwGSG6smzGxDqUJwl5lVS","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"926588eedc59bfa478ef042a92c68c22","path":"/fnc/build/926588eedc59bfa478ef042a92c68c22.png"}}}],"key":"xwavT0ZVxP"}],"data":{},"key":"Hb1omUFdAy"},{"type":"paragraph","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"text","value":"If we evaluate ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"ielN9B6dzR"},{"type":"inlineMath","value":"g(2.1)","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mn>2.1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(2.1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">2.1</span><span class=\"mclose\">)</span></span></span></span>","key":"wG2rjCkI3F"},{"type":"text","value":", we get a value of almost 2.6, so this is not a fixed point.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"SzadUfQKXE"}],"key":"O9CrxI0xCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = 2.1\ny = g(x)\nprint(y)","key":"Cs8oVSmlg9"},{"type":"output","id":"57UmyL-TfLlYR7bf7h8io","data":[{"output_type":"stream","name":"stdout","text":"2.59\n"}],"key":"Od8QBZyHcb"}],"data":{},"key":"Nfs4lFnb7M"},{"type":"paragraph","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"children":[{"type":"text","value":"However, ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"nwXY9aOLCY"},{"type":"inlineMath","value":"y=g(x)","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=g(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"eMuYu2stn6"},{"type":"text","value":" is considerably closer to the fixed point at around 2.7 than ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"WaIvt3tZ8g"},{"type":"inlineMath","value":"x","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"jC5AAW0HgE"},{"type":"text","value":" is. Suppose then that we adopt ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"GikWcV1FQO"},{"type":"inlineMath","value":"y","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"n7KhR9aOwW"},{"type":"text","value":" as our new ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"yHDpgCAm17"},{"type":"inlineMath","value":"x","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"bcvkxuiBl2"},{"type":"text","value":" value. Changing the ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"JQYl9mWENp"},{"type":"inlineMath","value":"x","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"sfEYRrlrKc"},{"type":"text","value":" coordinate in this way is the same as following a horizontal line over to the graph of ","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"KqI77Rhure"},{"type":"inlineMath","value":"y=x","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">y=x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"NK5oCiGwt3"},{"type":"text","value":".","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"key":"EQ0dnAkb4E"}],"key":"zImiIcEwmD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ax.plot([x, y], [y, y], \"r:\", label=\"\")\nfig","key":"BgFNXLMYUC"},{"type":"output","id":"d7fb7wCZNtamFCuss_lyQ","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"36b1ed15b7b0204385df1164e3b6d2f1","path":"/fnc/build/36b1ed15b7b0204385df1164e3b6d2f1.png"}}}],"key":"D2BTjE07Ax"}],"data":{},"key":"HRxtQmMmZN"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"Now we can compute a new value for ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"s7DsCOXgXP"},{"type":"inlineMath","value":"y","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"piQdwfpdvG"},{"type":"text","value":". We leave ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"ZB4282ruEh"},{"type":"inlineMath","value":"x","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"wI7o2XoEtw"},{"type":"text","value":" alone here, so we travel along a vertical line to the graph of ","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"wiqhBI2f80"},{"type":"inlineMath","value":"g","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"pb8P0S48BD"},{"type":"text","value":".","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"wfihZcFSfw"}],"key":"OaHPFR5K2R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = y\ny = g(x)\nprint(\"y:\", y)\nax.plot([x, x], [x, y], \"k:\")\nfig","key":"AEBIkolKrF"},{"type":"output","id":"_ITpD_MV6_8N47owU5866","data":[{"output_type":"stream","name":"stdout","text":"y: 2.7419000000000002\n"},{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"7c4c80ce9ac26db8798dce26b9ae198b","path":"/fnc/build/7c4c80ce9ac26db8798dce26b9ae198b.png"}}}],"key":"z63zjPJHW5"}],"data":{},"key":"NJo4zTRqZH"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"You see that we are in a position to repeat these steps as often as we like. Let’s apply them a few times and see the result.","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"KNITIG7zuD"}],"key":"DZHxeHzBQy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for k in range(5):\n    ax.plot([x, y], [y, y], \"r:\")\n    x = y       # y --> new x\n    y = g(x)    # g(x) --> new y\n    ax.plot([x, x], [x, y], \"k:\")  \nfig","key":"v6ZmtlfWWh"},{"type":"output","id":"k6ovNJozvOd6DjVqIQcJi","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"021db07784a304d6f1ac5ccd094e5d43","path":"/fnc/build/021db07784a304d6f1ac5ccd094e5d43.png"}}}],"key":"SzOzrIYUSs"}],"data":{},"key":"nKcJ9f9S2M"},{"type":"paragraph","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"The process spirals in beautifully toward the fixed point we seek. Our last estimate has almost 4 accurate digits.","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"VlT3gWXkpb"}],"key":"gLaP7Y25qm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(abs(y - max(r)) / max(r))","key":"nADZzUjgU6"},{"type":"output","id":"BMuak135bWd5N9atXYvW7","data":[{"output_type":"stream","name":"stdout","text":"0.0001653094344995643\n"}],"key":"Z9Y423Bjo5"}],"data":{},"key":"NxbRqrPKNu"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"Now let’s try to find the other fixed point ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"OJJiPuKaVc"},{"type":"inlineMath","value":"\\approx 1.29","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.29</mn></mrow><annotation encoding=\"application/x-tex\">\\approx 1.29</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.29</span></span></span></span>","key":"MEQEsLyjcD"},{"type":"text","value":" in the same way. We’ll use 1.3 as a starting approximation.","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"ezx5OkwW74"}],"key":"mrvpdVi5Vm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xx = linspace(1, 2, 400)\nfig, ax = subplots()\nax.plot(xx, g(xx), label=\"y=g(x)\")\nax.plot(xx, xx, label=\"y=x\")\nax.set_aspect(1.0)\nax.legend()\n\nx = 1.3\ny = g(x)\nfor k in range(5):\n    ax.plot([x, y], [y, y], \"r:\")\n    x = y\n    y = g(x)\n    ax.plot([x, x], [x, y], \"k:\")\nylim(1, 2.5)\ntitle(\"No convergence\")","key":"EIGf8CzhSe"},{"type":"output","id":"B9BFW0wmZliURu99EVz30","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"254c5cc2fb64cf57dde014ffaa3a5056","path":"/fnc/build/254c5cc2fb64cf57dde014ffaa3a5056.png"}}}],"key":"xCKCU55R98"}],"data":{},"key":"kQjaCL8CNQ"},{"type":"paragraph","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"text","value":"This time, the iteration is pushing us ","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"key":"cfiGrWDoDs"},{"type":"emphasis","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"children":[{"type":"text","value":"away from","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"key":"Umhg8EXCgO"}],"key":"oqtD5FpmWI"},{"type":"text","value":" the correct answer.","position":{"start":{"line":291,"column":1},"end":{"line":291,"column":1}},"key":"tHEmvaj4jh"}],"key":"XLcqcuWv27"}],"label":"demo-fp-spiral-python","identifier":"demo-fp-spiral-python","html_id":"demo-fp-spiral-python","key":"IJgl3zF1rp"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of fixed-point iteration","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"rOikyEIkxO"}],"key":"dVp8gyuWeT"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"vYg5kS4j1O"},{"type":"crossReference","kind":"proof:example","identifier":"demo-fp-spiral","label":"demo-fp-spiral","children":[{"type":"text","value":"Demo ","key":"IVEysoRYif"},{"type":"text","value":"4.2.1","key":"UQXjWNfeb0"}],"template":"Example %s","enumerator":"4.2.1","resolved":true,"html_id":"demo-fp-spiral","remote":true,"url":"/fixed-point","dataUrl":"/fixed-point.json","key":"ocmCQmjtUc"},{"type":"text","value":" and investigate the observed convergence more closely. Recall that above we calculated ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"taqhAUWhyU"},{"type":"inlineMath","value":"g'(p)\\approx-0.42","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>g</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mo>−</mo><mn>0.42</mn></mrow><annotation encoding=\"application/x-tex\">g&#x27;(p)\\approx-0.42</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.42</span></span></span></span>","key":"D4NYGUHWPq"},{"type":"text","value":" at the convergent fixed point.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"IKCrRIGwTR"}],"key":"jLnB8dC2P6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = poly1d([1, -4, 3.5])\nr = f.roots\nprint(r)","key":"HY6vjx0T6Z"},{"type":"output","id":"th4Jyd35UavHwouNyAPsC","data":[{"output_type":"stream","name":"stdout","text":"[2.70710678 1.29289322]\n"}],"key":"OWrCUIP7uN"}],"data":{},"key":"fJRwpjUL3g"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"Here is the fixed point iteration. This time we keep track of the whole sequence of approximations.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"bNTEvWB5Om"}],"key":"LTvudrHXmo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"g = lambda x: x - f(x)\nx = zeros(12)\nx[0] = 2.1\nfor k in range(11):\n    x[k + 1] = g(x[k])\n\nprint(x)","key":"eleJT5szX2"},{"type":"output","id":"JrxQuzJMQxGovcj6Ta3vi","data":[{"output_type":"stream","name":"stdout","text":"[2.1        2.59       2.7419     2.69148439 2.71333373 2.70448872\n 2.70818436 2.70665927 2.70729195 2.70703005 2.70713856 2.70709362]\n"}],"key":"eIVctUIARt"}],"data":{},"key":"SBdLXNOxlm"},{"type":"paragraph","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"It’s illuminating to construct and plot the sequence of errors.","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"UhPe4IfZty"}],"key":"QGXl5rAzLd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"err = abs(x - max(r))\nsemilogy(err, \"-o\")\nxlabel(\"iteration number\"), ylabel(\"error\")\ntitle(\"Convergence of fixed point iteration\")","key":"cPYeqqcxGd"},{"type":"output","id":"uHImTv_qNwASeq6OCYMKY","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"8abc56f3a780ccc5b3792ea44432b820","path":"/fnc/build/8abc56f3a780ccc5b3792ea44432b820.png"}}}],"key":"eCsFui6HNB"}],"data":{},"key":"XcKiol3ZGR"},{"type":"paragraph","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"children":[{"type":"text","value":"It’s quite clear that the convergence quickly settles into a linear rate. We could estimate this rate by doing a least-squares fit to a straight line. Keep in mind that the values for small ","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"MyVBh1ff9g"},{"type":"inlineMath","value":"k","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"opNn8rKUal"},{"type":"text","value":" should be left out of the computation, as they don’t represent the linear trend.","position":{"start":{"line":325,"column":1},"end":{"line":325,"column":1}},"key":"cHlLUOR1Jj"}],"key":"MvXqDCKaIj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"p = polyfit(arange(5, 13), log(err[4:]), 1)\nprint(p)","key":"BTYcsaEyME"},{"type":"output","id":"UO8FAKJ0uR4Z9vo5q4bfl","data":[{"output_type":"stream","name":"stdout","text":"[-0.88071816 -0.66805739]\n"}],"key":"XbTfoYsdE7"}],"data":{},"key":"SZ9pXo3XDC"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"text","value":"We can exponentiate the slope to get the convergence constant ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"sRU585LAzC"},{"type":"text","value":"σ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"gI0DDGjC1R"},{"type":"text","value":".","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"QtgjWLgRFV"}],"key":"YTQyxKIhhV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"sigma:\", exp(p[0]))","key":"n1SzkRpfyR"},{"type":"output","id":"1lWVsxC9Nl78hdEQzj8nD","data":[{"output_type":"stream","name":"stdout","text":"sigma: 0.4144851385485472\n"}],"key":"Ts09CatFqQ"}],"data":{},"key":"OuV3GX6owC"},{"type":"paragraph","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"text","value":"The error should therefore decrease by a factor of ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"DVe4O4Y9Ns"},{"type":"text","value":"σ","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"mS4FBdHhxW"},{"type":"text","value":" at each iteration. We can check this easily from the observed data.","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"JbCab3T6v2"}],"key":"x36ETF53dz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"err[8:] / err[7:-1]","key":"lpuKIGfLtr"},{"type":"output","id":"4U9rfM5t_5KBhaSBCSAzi","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"array([0.41376605, 0.41439873, 0.41413683, 0.41424534])","content_type":"text/plain"}}}],"key":"MTvpSxOpws"}],"data":{},"key":"TGwIkOFmu5"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"The methods for finding ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"NjosovqmF1"},{"type":"text","value":"σ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"uP5yE98hiW"},{"type":"text","value":" agree well.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"gXaF94fg2o"}],"key":"CRckbSqlmh"}],"label":"demo-fp-converge-python","identifier":"demo-fp-converge-python","html_id":"demo-fp-converge-python","key":"BR3vcdo3hy"},{"type":"heading","depth":3,"position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"Section 4.3","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"t5A1GaaMXT"}],"identifier":"section-4-3","label":"Section 4.3","html_id":"section-4-3","implicit":true,"key":"Arx3P9nfhy"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Graphical interpretation of Newton’s method","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"Ong0FY3lVH"}],"key":"PNZntepNy4"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"Suppose we want to find a root of this function:","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"XYQ12TiPnR"}],"key":"M0maVKnB77"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x * exp(x) - 2\nxx = linspace(0, 1.5, 400)\n\nfig, ax = subplots()\nax.plot(xx, f(xx), label=\"function\")\nax.grid()\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$y$\")","key":"CnJ4e3KQ9X"},{"type":"output","id":"NPldVNHmBvcw3o_Hp5ZNx","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"0aaf9e5953d13f01859916c0716d3084","path":"/fnc/build/0aaf9e5953d13f01859916c0716d3084.png"}}}],"key":"lOuAY55Yma"}],"data":{},"key":"mGGqssbGtZ"},{"type":"paragraph","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"text","value":"From the graph, it is clear that there is a root near ","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"eCnCx3xW3K"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"kwAWj2xPQF"},{"type":"text","value":". So we call that our initial guess, ","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"wVSpA8EdmY"},{"type":"inlineMath","value":"x_1","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YbSydSBRCs"},{"type":"text","value":".","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"fR0URYUIAo"}],"key":"M4kwVFxIj3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = 1\ny1 = f(x1)\nax.plot(x1, y1, \"ko\", label=\"initial point\")\nax.legend()\nfig","key":"dzDp6FKjoe"},{"type":"output","id":"dRIqS6YjBapNtO014NlIy","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c67fcd8130998424d9046ce0ee398902","path":"/fnc/build/c67fcd8130998424d9046ce0ee398902.png"}}}],"key":"IhE0h6blnl"}],"data":{},"key":"KWmVkZHu8r"},{"type":"paragraph","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"children":[{"type":"text","value":"Next, we can compute the tangent line at the point ","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"gwQi9xVSeo"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"A7R4BY1FtL"},{"type":"text","value":", using the derivative.","position":{"start":{"line":374,"column":1},"end":{"line":374,"column":1}},"key":"itPH86H7ua"}],"key":"yeQOLrykLQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_dx = lambda x: exp(x) * (x + 1)\nslope1 = df_dx(x1)\ntangent1 = lambda x: y1 + slope1 * (x - x1)\n\nax.plot(xx, tangent1(xx), \"--\", label=\"tangent line\")\nax.set_ylim(-2, 4)\nax.legend()\nfig","key":"WIxp9x3SqW"},{"type":"output","id":"l12f43KJbeqqmZ-3Rj09X","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"2bcd7217421d75b1b8104b3e897abff8","path":"/fnc/build/2bcd7217421d75b1b8104b3e897abff8.png"}}}],"key":"rZn8O2zWo5"}],"data":{},"key":"dICbFexHUe"},{"type":"paragraph","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"children":[{"type":"text","value":"In lieu of finding the root of ","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"key":"Jla4pNheBS"},{"type":"inlineMath","value":"f","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"LzQ5jOZOUz"},{"type":"text","value":" itself, we settle for finding the root of the tangent line approximation, which is trivial. Call this ","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"key":"clZTSf3Zzo"},{"type":"inlineMath","value":"x_2","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Yd4w9AVRBI"},{"type":"text","value":", our next approximation to the root.","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"key":"vHpBDvDgx8"}],"key":"XJzFQAmANk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x2 = x1 - y1 / slope1\nax.plot(x2, 0, \"ko\", label=\"tangent root\")\nax.legend()\nfig","key":"nMYMVPrawg"},{"type":"output","id":"mVW_CGYRLYQL5TLHt2zNl","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d08389fbd0450219cbdc4b04d7f34f67","path":"/fnc/build/d08389fbd0450219cbdc4b04d7f34f67.png"}}}],"key":"ytiZG57XPq"}],"data":{},"key":"wmppPTeJRJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y2 = f(x2)\nprint(y2)","key":"L8kv87bZ2k"},{"type":"output","id":"N6nXp3i4CDEsauxP6yHq0","data":[{"output_type":"stream","name":"stdout","text":"0.06716266657572145\n"}],"key":"R4mkmge3CW"}],"data":{},"key":"JgR2D4EXCA"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"The residual (i.e., value of ","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"bqR67PHuQj"},{"type":"inlineMath","value":"f","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"BKRkt8V9OA"},{"type":"text","value":") is smaller than before, but not zero. So we repeat the process with a new tangent line based on the latest point on the curve.","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"b2Jmzoa5KN"}],"key":"uWMUnJLTTf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xx = linspace(0.83, 0.88, 200)\n\nplot(xx, f(xx))\nplot(x2, y2, \"ko\")\ngrid(), xlabel(\"$x$\"), ylabel(\"$y$\")\n\nslope2 = df_dx(x2)\ntangent2 = lambda x: y2 + slope2 * (x - x2)\nplot(xx, tangent2(xx), \"--\")\nx3 = x2 - y2 / slope2\nplot(x3, 0, \"ko\")\ntitle(\"Second iteration\")","key":"oaT4qPfO0k"},{"type":"output","id":"s3d2Zha5nBmgfI10qbXnf","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"73a9f0b5d0386e12cbdd4adfb702f6bf","path":"/fnc/build/73a9f0b5d0386e12cbdd4adfb702f6bf.png"}}}],"key":"N1nQqupyPN"}],"data":{},"key":"qGO31HID5m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y3 = f(x3)\nprint(y3)","key":"NVhN9vyx9v"},{"type":"output","id":"7ppd6prrbry8zh-oT_vyq","data":[{"output_type":"stream","name":"stdout","text":"0.0007730906446230534\n"}],"key":"QPlU6oMsp2"}],"data":{},"key":"swmW9pouQ1"},{"type":"paragraph","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"children":[{"type":"text","value":"Judging by the residual, we appear to be getting closer to the true root each time.","position":{"start":{"line":423,"column":1},"end":{"line":423,"column":1}},"key":"ueCBqrrVEy"}],"key":"jqLWrOYfcl"}],"label":"demo-newton-line-python","identifier":"demo-newton-line-python","html_id":"demo-newton-line-python","key":"IupaNmrciO"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Newton’s method","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"w70nnhI5EO"}],"key":"iLWWcb6Urv"},{"type":"paragraph","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"children":[{"type":"text","value":"We again look at finding a solution of ","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"kWj3TawgUB"},{"type":"inlineMath","value":"x e^x=2","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msup><mi>e</mi><mi>x</mi></msup><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">x e^x=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6644em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"yvT6YTpYeJ"},{"type":"text","value":" near ","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"euLm10jkg5"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"WpIcstYXxG"},{"type":"text","value":". To apply Newton’s method, we need to calculate values of both the residual function ","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"IMx1mF6SLb"},{"type":"inlineMath","value":"f","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"Gzy5ey7S7y"},{"type":"text","value":" and its derivative.","position":{"start":{"line":428,"column":1},"end":{"line":428,"column":1}},"key":"u4cWWtUvNe"}],"key":"FtWRofyxkl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x * exp(x) - 2\ndf_dx = lambda x: exp(x) * (x + 1)","key":"yHC9aEho8w"},{"type":"output","id":"385rDMyBBREv-nFHZ_x-l","data":[],"key":"SCivXqO23f"}],"data":{},"key":"pONhKpvgnt"},{"type":"paragraph","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"LnAoRELUga"},{"type":"inlineCode","value":"nlsolve","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"h16nlrxENt"},{"type":"text","value":" to determine a proxy for it.","position":{"start":{"line":435,"column":1},"end":{"line":435,"column":1}},"key":"FUxT0kyMU9"}],"key":"rHwle7qcig"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r = root_scalar(f, bracket=[0.8, 1.0]).root\nprint(r)","key":"r53G0CK29N"},{"type":"output","id":"iIvMQFUmuSv5T4Is9mPIZ","data":[{"output_type":"stream","name":"stdout","text":"0.8526055020137255\n"}],"key":"lEhOwow7cd"}],"data":{},"key":"YI6Ah3PngE"},{"type":"paragraph","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"children":[{"type":"text","value":"We use ","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"wTZFfJkFMv"},{"type":"inlineMath","value":"x_1=1","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x_1=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"kwKAuLJpl6"},{"type":"text","value":" as a starting guess and apply the iteration in a loop, storing the sequence of iterates in a vector.","position":{"start":{"line":442,"column":1},"end":{"line":442,"column":1}},"key":"BT6oJItsYI"}],"key":"KGsXszhvKo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = ones(5)\nfor k in range(4):\n    x[k + 1] = x[k] - f(x[k]) / df_dx(x[k])\n\nprint(x)","key":"xJ2Dg2DXCg"},{"type":"output","id":"Cc42kljINkDj021FHSyL9","data":[{"output_type":"stream","name":"stdout","text":"[1.         0.86787944 0.85278337 0.85260553 0.8526055 ]\n"}],"key":"AzBDecaUOl"}],"data":{},"key":"vT9gPL3HwO"},{"type":"paragraph","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":452,"column":1},"end":{"line":452,"column":1}},"key":"A5RuIZTSID"}],"key":"mF9zNQUS4o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"err = x - r\nprint(err)","key":"lKZr41D4co"},{"type":"output","id":"YuubulqXxDgeZY1MHGPDp","data":[{"output_type":"stream","name":"stdout","text":"[1.47394498e-01 1.52739392e-02 1.77871403e-04 2.43551965e-08\n 4.44089210e-16]\n"}],"key":"UdoNJJ3ee9"}],"data":{},"key":"ovUDR1diTk"},{"type":"paragraph","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"children":[{"type":"text","value":"The exponents in the scientific notation definitely suggest a squaring sequence. We can check the evolution of the ratio in ","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"VagcHPQdVF"},{"type":"crossReference","kind":"equation","identifier":"quadratictest","label":"quadratictest","children":[{"type":"text","value":"(","key":"OfDqNI1pxl"},{"type":"text","value":"4.3.9","key":"t7buRWGw4H"},{"type":"text","value":")","key":"bN7iC1ffkO"}],"template":"(%s)","enumerator":"4.3.9","resolved":true,"html_id":"quadratictest","remote":true,"url":"/newton","dataUrl":"/newton.json","key":"AO92fWKdmL"},{"type":"text","value":".","position":{"start":{"line":459,"column":1},"end":{"line":459,"column":1}},"key":"cBU98FDg4m"}],"key":"sIwfFsNBJy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logerr = log(abs(err))\nfor i in range(len(err) - 1):\n    print(logerr[i+1] / logerr[i])","key":"Ze4vzizVUk"},{"type":"output","id":"7hsLD0dHH_TibioUfn7CH","data":[{"output_type":"stream","name":"stdout","text":"2.1840144823399648\n2.064863881067786\n2.030299689916648\n2.01651205997716\n"}],"key":"E9zHSMTc6p"}],"data":{},"key":"NmVQXxisRt"},{"type":"paragraph","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"children":[{"type":"text","value":"The clear convergence to 2 above constitutes good evidence of quadratic convergence.","position":{"start":{"line":467,"column":1},"end":{"line":467,"column":1}},"key":"rx98V7pCxl"}],"key":"lprg9W3RGN"}],"label":"demo-newton-converge-python","identifier":"demo-newton-converge-python","html_id":"demo-newton-converge-python","key":"WWbkoD7xm1"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Using Newton’s method","position":{"start":{"line":471,"column":1},"end":{"line":471,"column":1}},"key":"RFiACJKJWp"}],"key":"rEZAf9gYQn"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"children":[{"type":"text","value":"Suppose we want to evaluate the inverse of the function ","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"E5CUauzM6J"},{"type":"inlineMath","value":"h(x)=e^x-x","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">h(x)=e^x-x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"yzvugOiOm9"},{"type":"text","value":". This means solving ","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"qGzjyUJHFT"},{"type":"inlineMath","value":"y=h(x)","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y=h(x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"GxF9Zp4Jeq"},{"type":"text","value":", or ","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"lgFIibi24C"},{"type":"inlineMath","value":"h(x)-y=0","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>h</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">h(x)-y=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">h</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"WLUXvd25Zr"},{"type":"text","value":", for ","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"X0Bk69GHdB"},{"type":"inlineMath","value":"x","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"lUO1hnXuDW"},{"type":"text","value":" when ","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"wNEm8xsDWr"},{"type":"inlineMath","value":"y","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"HHjUIP8G6c"},{"type":"text","value":" is given. That equation has no solution in terms of elementary functions. If a value of ","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"nkR6U3Lyk4"},{"type":"inlineMath","value":"y","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"pXjW9u6gjZ"},{"type":"text","value":" is given numerically, though, we simply have a rootfinding problem for ","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"a4WmUX2vuj"},{"type":"inlineMath","value":"f(x)=e^x-x-y","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><mi>x</mi><mo>−</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">f(x)=e^x-x-y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7477em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"xRCg1EHuDD"},{"type":"text","value":".","position":{"start":{"line":473,"column":1},"end":{"line":473,"column":1}},"key":"qXs37Anwng"}],"key":"WuCrDLvoI8"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"zBkIZAm0MN"},{"type":"inlineCode","value":"enumerate","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"sjeVQI7XTv"},{"type":"text","value":" function produces a pair of values for each iteration: a positional index and the corresponding contents.","position":{"start":{"line":475,"column":1},"end":{"line":475,"column":1}},"key":"agwtZLVl8P"}],"key":"celRqY1sN0"}],"key":"t2vXWDpEx9"}],"key":"QQKM9pkGPh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"h = lambda x: exp(x) - x\ndh_dx = lambda x: exp(x) - 1\ny_ = linspace(h(0), h(2), 200)\nx_ = zeros(y_.shape)\nfor (i, y) in enumerate(y_):\n    f = lambda x: h(x) - y\n    df_dx = lambda x: dh_dx(x)\n    x = FNC.newton(f, df_dx, y)\n    x_[i] = x[-1]\n\nplot(x_, y_, label=\"$y=h(x)$\")\nplot(y_, x_, label=\"$y=h^{-1}(x)$\")\nplot([0, max(y_)], [0, max(y_)], 'k--', label=\"\")\ntitle(\"Function and its inverse\")\nxlabel(\"x\"), ylabel(\"y\"), axis(\"equal\")\nax.grid(), legend()","key":"LgARyD2wbJ"},{"type":"output","id":"NeDy7_EtxyKvA2KydwUki","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c3af832f3a6db0fbfab12740fea37aa2","path":"/fnc/build/c3af832f3a6db0fbfab12740fea37aa2.png"}}}],"key":"maYtU5bjIy"}],"data":{},"indexEntries":[{"entry":"Python","subEntry":{"value":"enumerate","kind":"entry"},"emphasis":true}],"label":"index-zotSg5zQMz","identifier":"index-zotsg5zqmz","html_id":"index-zotsg5zqmz","key":"oWFTe3OgCo"}],"label":"demo-newton-usage-python","identifier":"demo-newton-usage-python","html_id":"demo-newton-usage-python","key":"wqcXUzjEux"},{"type":"heading","depth":3,"position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"children":[{"type":"text","value":"Section 4.4","position":{"start":{"line":501,"column":1},"end":{"line":501,"column":1}},"key":"fpeGnBXjXy"}],"identifier":"section-4-4","label":"Section 4.4","html_id":"section-4-4","implicit":true,"key":"A55jn30pqB"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Graphical interpretation of the secant method","position":{"start":{"line":503,"column":1},"end":{"line":503,"column":1}},"key":"TKNMkOgDY6"}],"key":"VzYIjdq1Of"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x * exp(x) - 2\nxx = linspace(0.25, 1.25, 400)\n\nfig, ax = subplots()\nax.plot(xx, f(xx), label=\"function\")\nax.set_xlabel(\"$x$\")\nax.set_ylabel(\"$f(x)$\")\nax.grid()","key":"NFQExMsgg7"},{"type":"output","id":"zMmvXo9qVqlF2SuhmOMSO","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"fc4409260aad92070341a1da15851e9e","path":"/fnc/build/fc4409260aad92070341a1da15851e9e.png"}}}],"key":"hYv0mcYkHL"}],"data":{},"key":"VemyFrsicz"},{"type":"paragraph","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"text","value":"From the graph, it’s clear that there is a root near ","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"JTaYrelavh"},{"type":"inlineMath","value":"x=1","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"J9bRzepsk3"},{"type":"text","value":". To be more precise, there is a root in the interval ","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"cBHKiN8LAT"},{"type":"inlineMath","value":"[0.5,1]","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0.5,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"fIh597ClUO"},{"type":"text","value":". So let us take the endpoints of that interval as ","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"OSOkf2VYYW"},{"type":"emphasis","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"children":[{"type":"text","value":"two","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"zunUKeYFqq"}],"key":"IuuniZzxE7"},{"type":"text","value":" initial approximations.","position":{"start":{"line":516,"column":1},"end":{"line":516,"column":1}},"key":"BCHfCONvFC"}],"key":"NjJdVJR0B6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = 1\ny1 = f(x1)\nx2 = 0.5\ny2 = f(x2)\nax.plot([x1, x2], [y1, y2], \"ko\", label=\"initial points\")\nax.legend()\nfig","key":"HQM7jWGDZA"},{"type":"output","id":"oKBvn1FHT6ynplXXlH7jh","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b9f05324a932c849cd9a71a0376d2db3","path":"/fnc/build/b9f05324a932c849cd9a71a0376d2db3.png"}}}],"key":"V4OTjQyYwA"}],"data":{},"key":"pt60aiR7MK"},{"type":"paragraph","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"Instead of constructing the tangent line by evaluating the derivative, we can construct a linear model function by drawing the line between the two points ","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"bf6OxTmuI2"},{"type":"inlineMath","value":"\\bigl(x_1,f(x_1)\\bigr)","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_1,f(x_1)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"l6t4MW4S4D"},{"type":"text","value":" and ","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"GoV8g0kuIp"},{"type":"inlineMath","value":"\\bigl(x_2,f(x_2)\\bigr)","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\bigl(x_2,f(x_2)\\bigr)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span></span></span></span>","key":"RcmH5Sm2rK"},{"type":"text","value":". This is called a ","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"kkwSh6V5kK"},{"type":"emphasis","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"children":[{"type":"text","value":"secant line","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"LAV0yACqH9"}],"key":"gWKP2WF7bU"},{"type":"text","value":".","position":{"start":{"line":528,"column":1},"end":{"line":528,"column":1}},"key":"hDkeraJQhe"}],"key":"Kx2VS3B451"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"slope2 = (y2 - y1) / (x2 - x1)\nsecant2 = lambda x: y2 + slope2 * (x - x2)\nax.plot(xx, secant2(xx), \"--\", label=\"secant line\")\nax.legend()\nfig","key":"C40vO774h1"},{"type":"output","id":"7YMn0_3mwRlojCbfBJLab","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"519d60b8a1292d5a6fb24e0960c4ead3","path":"/fnc/build/519d60b8a1292d5a6fb24e0960c4ead3.png"}}}],"key":"za56B2RwFK"}],"data":{},"key":"QvMyNNurYN"},{"type":"paragraph","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"children":[{"type":"text","value":"As before, the next root estimate in the iteration is the root of this linear model.","position":{"start":{"line":538,"column":1},"end":{"line":538,"column":1}},"key":"yAANwbCxLe"}],"key":"WIuAHZOq7h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x3 = x2 - y2 / slope2\nax.plot(x3, 0, \"o\", label=\"root of secant\")\ny3 = f(x3)\nprint(y3)\nax.legend()\nfig","key":"KVQiZOvKmJ"},{"type":"output","id":"uOkykxtsZYQQJbIvIjReh","data":[{"output_type":"stream","name":"stdout","text":"-0.17768144843679456\n"},{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f08c2197ff35406a4cef05d1a63d9d75","path":"/fnc/build/f08c2197ff35406a4cef05d1a63d9d75.png"}}}],"key":"E22Oejibkj"}],"data":{},"key":"xJ1J64IKCj"},{"type":"paragraph","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"children":[{"type":"text","value":"For the next linear model, we use the line through the two most recent points. The next iterate is the root of that secant line, and so on.","position":{"start":{"line":549,"column":1},"end":{"line":549,"column":1}},"key":"CXZVTW1SUB"}],"key":"MYSJUsrppV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"slope3 = (y3 - y2) / (x3 - x2)\nx4 = x3 - y3 / slope3\nprint(f(x4))","key":"vNPBEDFqLp"},{"type":"output","id":"fyIdQ38W26F6PDhqsrJ0e","data":[{"output_type":"stream","name":"stdout","text":"0.05718067370113333\n"}],"key":"uHOUo3m2Rt"}],"data":{},"key":"NxvCuKQbRn"}],"label":"demo-secant-line-python","identifier":"demo-secant-line-python","html_id":"demo-secant-line-python","key":"Z7Agky51Qg"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of the secant method","position":{"start":{"line":559,"column":1},"end":{"line":559,"column":1}},"key":"ykm63AFsKC"}],"key":"Uc4O5SLmVq"},{"type":"paragraph","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"children":[{"type":"text","value":"We check the convergence of the secant method from ","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"JetDtETTlQ"},{"type":"crossReference","kind":"proof:example","identifier":"demo-secant-line","label":"demo-secant-line","children":[{"type":"text","value":"Demo ","key":"l9CJiZOOFa"},{"type":"text","value":"4.4.1","key":"dooxUg8nlI"}],"template":"Example %s","enumerator":"4.4.1","resolved":true,"html_id":"demo-secant-line","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"Cx2D5z0sD5"},{"type":"text","value":".","position":{"start":{"line":560,"column":1},"end":{"line":560,"column":1}},"key":"qPweMiVV81"}],"key":"vvfM3DufwL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x * exp(x) - 2\nx = FNC.secant(f, 1, 0.5)\nprint(x)","key":"OjzflK3NxN"},{"type":"output","id":"KJeaH-3QVLInk0uSc_6iQ","data":[{"output_type":"stream","name":"stdout","text":"[1.         0.5        0.81037177 0.86563193 0.85217802 0.85260123\n 0.8526055  0.8526055  0.8526055 ]\n"}],"key":"WGnoTssJPP"}],"data":{},"key":"cDFm2HVYq6"},{"type":"paragraph","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"children":[{"type":"text","value":"We don’t know the exact root, so we use ","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"CiJNX1SPEe"},{"type":"inlineCode","value":"root_scalar","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"mcCNwS4vhe"},{"type":"text","value":" to get a substitute.","position":{"start":{"line":568,"column":1},"end":{"line":568,"column":1}},"key":"te5YPp8uPD"}],"key":"aImVwQpojU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.optimize import root_scalar\nr = root_scalar(f, bracket=[0.5, 1]).root\nprint(r)","key":"iObVYM6N6K"},{"type":"output","id":"Fz6uHchWKK9MpZyhfnrwg","data":[{"output_type":"stream","name":"stdout","text":"0.8526055020137254\n"}],"key":"LEiEvCjBJd"}],"data":{},"key":"jWNKh8LDGr"},{"type":"paragraph","position":{"start":{"line":576,"column":1},"end":{"line":576,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":576,"column":1},"end":{"line":576,"column":1}},"key":"MYOFpiJjL5"}],"key":"cMjif9pkkc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"err = r - x\nprint(err)","key":"pXVWS6RJak"},{"type":"output","id":"6HxSfnHB4gOMpWHouSfpw","data":[{"output_type":"stream","name":"stdout","text":"[-1.47394498e-01  3.52605502e-01  4.22337271e-02 -1.30264253e-02\n  4.27479941e-04  4.26991559e-06 -1.40547707e-09  4.55191440e-15\n  0.00000000e+00]\n"}],"key":"oGSzGmsnL6"}],"data":{},"key":"gX8pbdc6Vn"},{"type":"paragraph","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"children":[{"type":"text","value":"It’s not easy to see the convergence rate by staring at these numbers. We can use ","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"ZMv3cfdcWu"},{"type":"crossReference","kind":"equation","identifier":"superlinear-rate","label":"superlinear-rate","children":[{"type":"text","value":"(","key":"TaXsHmoJzE"},{"type":"text","value":"4.4.8","key":"CCDLicKO0J"},{"type":"text","value":")","key":"ljrgEGbjfx"}],"template":"(%s)","enumerator":"4.4.8","resolved":true,"html_id":"superlinear-rate","remote":true,"url":"/secant","dataUrl":"/secant.json","key":"IDo4Stfmfz"},{"type":"text","value":" to try to expose the superlinear convergence rate.","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":1}},"key":"goGThcvMMI"}],"key":"ZUSFDWJmhs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logerr = log(abs(err))\nfor i in range(len(err) - 2):\n    print(logerr[i+1] / logerr[i])","key":"Y89AIXbIEv"},{"type":"output","id":"G4HAB7LbKnISsdCAJrlaG","data":[{"output_type":"stream","name":"stdout","text":"0.5444386280277934\n3.0358017547194565\n1.3716940021941457\n1.7871469297607958\n1.593780475055435\n1.6485786717829443\n1.62014464365765\n"},{"output_type":"stream","name":"stderr","text":"/var/folders/gc/0752xrm56pnf0r0dsrn5370c0000gr/T/ipykernel_74319/1382054591.py:1: RuntimeWarning: divide by zero encountered in log\n  logerr = log(abs(err))\n"}],"key":"qtcCYtjN64"}],"data":{},"key":"P8uaArRhg5"},{"type":"paragraph","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"children":[{"type":"text","value":"As expected, this settles in at around 1.618.","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":1}},"key":"I678ja2Q1E"}],"key":"MVtijfUL57"}],"label":"demo-secant-converge-python","identifier":"demo-secant-converge-python","html_id":"demo-secant-converge-python","key":"pH0jzDvcmP"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Inverse quadratic interpolation","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"pE492OPw5W"}],"key":"B3kqAqdyB9"},{"type":"paragraph","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"children":[{"type":"text","value":"Here we look for a root of ","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"Sad4b3KtzT"},{"type":"inlineMath","value":"x+\\cos(10x)","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>10</mn><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x+\\cos(10x)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">10</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span></span></span></span>","key":"LToSl5FABG"},{"type":"text","value":" that is close to 1.","position":{"start":{"line":596,"column":1},"end":{"line":596,"column":1}},"key":"BEy3cPKMy1"}],"key":"cLIIL39HJK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f = lambda x: x + cos(10 * x)\nxx = linspace(0.5, 1.5, 400)\nfig, ax = subplots()\nax.plot(xx, f(xx), label=\"function\")\nax.grid()\nxlabel(\"$x$\"), ylabel(\"$y$\")\nfig","key":"egS81Io3gD"},{"type":"output","id":"PQjCV-G6Kl0bpK2JLNEmM","data":[{"output_type":"execute_result","execution_count":47,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b1277f5ee84e25afa1eddcbb1906b80a","path":"/fnc/build/b1277f5ee84e25afa1eddcbb1906b80a.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"b1277f5ee84e25afa1eddcbb1906b80a","path":"/fnc/build/b1277f5ee84e25afa1eddcbb1906b80a.png"}}}],"key":"f4ir9YnxMj"}],"data":{},"key":"Ol0yD5Pndq"},{"type":"paragraph","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"children":[{"type":"text","value":"We choose three values to get the iteration started.","position":{"start":{"line":608,"column":1},"end":{"line":608,"column":1}},"key":"F57egsRbmt"}],"key":"AwMp0zlUGc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = array([0.8, 1.2, 1])\ny = f(x)\nax.plot(x, y, \"ko\", label=\"initial points\")\nax.legend()\nfig","key":"D8L2dhLlyo"},{"type":"output","id":"cxBVcdkoFBNRBVUyamnFF","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"be8d21eb04172097bc20e753c4f0d936","path":"/fnc/build/be8d21eb04172097bc20e753c4f0d936.png"}}}],"key":"Jg8vjpvFFk"}],"data":{},"key":"yO78VTey3E"},{"type":"paragraph","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"children":[{"type":"text","value":"If we were using forward interpolation, we would ask for the polynomial interpolant of ","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"Al9s0dljlY"},{"type":"inlineMath","value":"y","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"FR3ue0vDzU"},{"type":"text","value":" as a function of ","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"qWcKg2u9Dr"},{"type":"inlineMath","value":"x","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"NQaQAz3ktw"},{"type":"text","value":". But that parabola has no real roots.","position":{"start":{"line":618,"column":1},"end":{"line":618,"column":1}},"key":"GEFlbFXVDF"}],"key":"ZCbPYiEqq5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"q = poly1d(polyfit(x, y, 2))  # interpolating polynomial\nax.plot(xx, q(xx), \"--\", label=\"interpolant\")\nax.set_ylim(-0.1, 3), ax.legend()\nfig","key":"OVjvAHSdF7"},{"type":"output","id":"UgU164S1mvEvJbaVemmpg","data":[{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"54bf1992030b47c9cf50fe234e76ef1d","path":"/fnc/build/54bf1992030b47c9cf50fe234e76ef1d.png"}}}],"key":"yX1S6SXOWe"}],"data":{},"key":"X1nNvbNIj6"},{"type":"paragraph","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"children":[{"type":"text","value":"To do inverse interpolation, we swap the roles of ","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"key":"O0YRhZVkwV"},{"type":"inlineMath","value":"x","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"aLXAdey0P9"},{"type":"text","value":" and ","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"key":"Rd8HE62k7A"},{"type":"inlineMath","value":"y","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"NrB07V6zFC"},{"type":"text","value":" in the interpolation.","position":{"start":{"line":627,"column":1},"end":{"line":627,"column":1}},"key":"fvMA61wFfL"}],"key":"AQfuW6KMx0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot(xx, f(xx), label=\"function\")\nplot(x, y, \"ko\", label=\"initial points\")\n\nq = poly1d(polyfit(y, x, 2))  # inverse interpolating polynomial\nyy = linspace(-0.1, 2.6, 400)\nplot(q(yy), yy, \"--\", label=\"inverse interpolant\")\n\ngrid(), xlabel(\"$x$\"), ylabel(\"$y$\")\nlegend()","key":"Narc1dPI95"},{"type":"output","id":"LUURe8aeXwLrTmqo544pS","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"74e3f9b1592dee7d38a946fd21d2543f","path":"/fnc/build/74e3f9b1592dee7d38a946fd21d2543f.png"}}}],"key":"NJ32Z4hEaZ"}],"data":{},"key":"BTlosCfmSR"},{"type":"paragraph","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"children":[{"type":"text","value":"We seek the value of ","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"wZsUYUt4nU"},{"type":"inlineMath","value":"x","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"MD3sjeKmeA"},{"type":"text","value":" that makes ","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"UFa8KPZnOx"},{"type":"inlineMath","value":"y","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"j50cWe7t3y"},{"type":"text","value":" zero. This means evaluating ","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"G5FtEdNY6G"},{"type":"inlineMath","value":"q","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span>","key":"N1OtwsjsMO"},{"type":"text","value":" at zero.","position":{"start":{"line":641,"column":1},"end":{"line":641,"column":1}},"key":"gk601QktPi"}],"key":"Eu9PgwghHP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = hstack([x, q(0)])\ny = hstack([y, f(x[-1])])\nprint(\"x:\", x, \"\\ny:\", y)","key":"RqsM0FdQN0"},{"type":"output","id":"_-IwJth57FeBA9hjyS9NR","data":[{"output_type":"stream","name":"stdout","text":"x: [0.8        1.2        1.         1.10398139] \ny: [0.65449997 2.04385396 0.16092847 1.14820652]\n"}],"key":"xuwoAsHIWS"}],"data":{},"key":"Kiuazy3Ptf"},{"type":"paragraph","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"children":[{"type":"text","value":"We repeat the process a few more times.","position":{"start":{"line":649,"column":1},"end":{"line":649,"column":1}},"key":"dckQK6UVC6"}],"key":"A14z4uY0yM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for k in range(6):\n    q = poly1d(polyfit(y[-3:], x[-3:], 2))\n    x = hstack([x, q(0)])\n    y = hstack([y, f(x[-1])])\nprint(f\"final residual is {y[-1]:.2e}\")","key":"p3vWUIPBpv"},{"type":"output","id":"qffAyWpHE8iHJrMtD9T8e","data":[{"output_type":"stream","name":"stdout","text":"final residual is 1.53e-14\n"}],"key":"MoN1By92tw"}],"data":{},"key":"WFmtA9sY1f"},{"type":"paragraph","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"children":[{"type":"text","value":"Here is the sequence of errors.","position":{"start":{"line":659,"column":1},"end":{"line":659,"column":1}},"key":"Mvkd2X8Cu3"}],"key":"zyaXRtXluk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.optimize import root_scalar\nr = root_scalar(f, bracket=[0.9, 1]).root\nerr = x - r\nprint(err)","key":"rGpGEdeBTO"},{"type":"output","id":"u7jOU-oAYolcEzsV2u2UW","data":[{"output_type":"stream","name":"stdout","text":"[-1.67888402e-01  2.32111598e-01  3.21115982e-02  1.36092984e-01\n  1.53473435e-02  3.26831473e-03  4.61743614e-04  6.29584770e-06\n  3.43903683e-09  6.39488462e-14]\n"}],"key":"CTEuF5VSJd"}],"data":{},"key":"j1UDreUdZN"},{"type":"paragraph","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"The error seems to be superlinear, but subquadratic:","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"iCFV2yKWpn"}],"key":"wsGfyVvKYV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logerr = log(abs(err))\nfor i in range(len(err) - 1):\n    print(logerr[i+1] / logerr[i])","key":"o6YeQgUN8j"},{"type":"output","id":"rtbnDOpl0asQkPWKpG8QG","data":[{"output_type":"stream","name":"stdout","text":"0.818477543986624\n2.354297090262193\n0.5800188694773638\n2.0942526256501797\n1.3702985897217315\n1.341928284536791\n1.5592238835564955\n1.6273123235711273\n1.5589376504302388\n"}],"key":"SxvzSmlYjQ"}],"data":{},"key":"wq3lUVerAn"}],"label":"demo-secant-iqi-python","identifier":"demo-secant-iqi-python","html_id":"demo-secant-iqi-python","key":"GytIBjpNF5"},{"type":"heading","depth":3,"position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"children":[{"type":"text","value":"Section 4.5","position":{"start":{"line":677,"column":1},"end":{"line":677,"column":1}},"key":"wDy2Pj5dZV"}],"identifier":"section-4-5","label":"Section 4.5","html_id":"section-4-5","implicit":true,"key":"Fg09r8GZvy"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of Newton’s method for systems","position":{"start":{"line":679,"column":1},"end":{"line":679,"column":1}},"key":"rqhjGecj1w"}],"key":"OXyUvRudSg"},{"type":"paragraph","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"children":[{"type":"text","value":"A system of nonlinear equations is defined by its residual and Jacobian.","position":{"start":{"line":680,"column":1},"end":{"line":680,"column":1}},"key":"QXcEQy5bQT"}],"key":"d1icDvFGzA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def func(x):\n    return array([\n        exp(x[1] - x[0]) - 2, \n        x[0] * x[1] + x[2], \n        x[1] * x[2] + x[0]**2 - x[1]\n    ])\n\ndef jac(x):\n    return array([\n            [-exp(x[1] - x[0]), exp(x[1] - x[0]), 0],\n            [x[1], x[0], 1],\n            [2 * x[0], x[2] - 1, x[1]],\n    ])","key":"DbD42XFqbx"},{"type":"output","id":"miug9fvAUqb2txv6gVuHO","data":[],"key":"WqsC45QH8o"}],"data":{},"key":"RyJXib08PL"},{"type":"paragraph","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"children":[{"type":"text","value":"Our initial guess at a root is the origin.","position":{"start":{"line":698,"column":1},"end":{"line":698,"column":1}},"key":"Gp0j2uzo8R"}],"key":"clQQQfVebv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = zeros(3)\nx = FNC.newtonsys(func, jac, x1)\nprint(x)","key":"NYAlV8x2CA"},{"type":"output","id":"AlqL-KK0pQbVSWThdksMA","data":[{"output_type":"stream","name":"stdout","text":"[[ 0.00000000e+00 -1.00000000e+00 -5.78586294e-01 -4.63138615e-01\n  -4.58026868e-01 -4.58033281e-01 -4.58033281e-01]\n [ 0.00000000e+00 -1.11022302e-16  1.57172588e-01  2.30903685e-01\n   2.35120714e-01  2.35113900e-01  2.35113900e-01]\n [ 0.00000000e+00  0.00000000e+00  1.57172588e-01  1.15452497e-01\n   1.07713160e-01  1.07689991e-01  1.07689991e-01]]\n"}],"key":"i95fLhuEDJ"}],"data":{},"key":"T4DKvzKMkk"},{"type":"paragraph","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"children":[{"type":"text","value":"The output has one column per iteration, so the last column contains the final Newton estimate. Let’s compute the residual of the last result.","position":{"start":{"line":706,"column":1},"end":{"line":706,"column":1}},"key":"sVnygFjwV0"}],"key":"lKIZZyDG7i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r = x[:, -1]\nf = func(r)\nprint(\"final residual:\", f)","key":"SGpKQXtaZp"},{"type":"output","id":"t2M8f51fc4Z3Y_mHmKLY5","data":[{"output_type":"stream","name":"stdout","text":"final residual: [ 0.00000000e+00 -1.38777878e-17  0.00000000e+00]\n"}],"key":"qzclTQPK9l"}],"data":{},"key":"aaDVHOgJsg"},{"type":"paragraph","position":{"start":{"line":714,"column":1},"end":{"line":714,"column":1}},"children":[{"type":"text","value":"Let’s check the convergence rate:","position":{"start":{"line":714,"column":1},"end":{"line":714,"column":1}},"key":"cFYtSf9edc"}],"key":"VbJsSCmHJ5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logerr = [log(norm(x[:, k] - r)) for k in range(x.shape[1] - 1)]\nfor k in range(len(logerr) - 1):\n    print(logerr[k+1] / logerr[k])","key":"BMPguHtq64"},{"type":"output","id":"XvByftmkvfu-aox8F5lvE","data":[{"output_type":"stream","name":"stdout","text":"0.7937993447128695\n3.6959808854483063\n2.432659788997719\n2.31109323743665\n2.132541136303707\n"}],"key":"N4dskHH2fC"}],"data":{},"key":"HvNSziznjW"},{"type":"paragraph","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"children":[{"type":"text","value":"The ratio is apparently converging toward 2, as expected for quadratic convergence.","position":{"start":{"line":722,"column":1},"end":{"line":722,"column":1}},"key":"SGwdf2yOTz"}],"key":"YATMkV4JPF"}],"label":"demo-newtonsys-converge-python","identifier":"demo-newtonsys-converge-python","html_id":"demo-newtonsys-converge-python","key":"z98O4VRNKA"},{"type":"heading","depth":3,"position":{"start":{"line":725,"column":1},"end":{"line":725,"column":1}},"children":[{"type":"text","value":"Section 4.6","position":{"start":{"line":725,"column":1},"end":{"line":725,"column":1}},"key":"G2EFUTgOMt"}],"identifier":"section-4-6","label":"Section 4.6","html_id":"section-4-6","implicit":true,"key":"JmbHlqkLjB"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Using Levenberg’s method","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":1}},"key":"PaOLMFCFBb"}],"key":"xO09tjuUUy"},{"type":"paragraph","position":{"start":{"line":728,"column":1},"end":{"line":728,"column":1}},"children":[{"type":"text","value":"To solve a nonlinear system, we need to code only the function defining the system, and not its Jacobian.","position":{"start":{"line":728,"column":1},"end":{"line":728,"column":1}},"key":"ZOytZOjSFN"}],"key":"p8gWR85D5V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def func(x):\n    return array([\n        exp(x[1] - x[0]) - 2, \n        x[0] * x[1] + x[2], \n        x[1] * x[2] + x[0]**2 - x[1]\n    ])","key":"GETwchdOq2"},{"type":"output","id":"7-aksHeIhI48-wvMlTZ1R","data":[],"key":"abpypvSsJ3"}],"data":{},"key":"sS14ekk66M"},{"type":"paragraph","position":{"start":{"line":739,"column":1},"end":{"line":739,"column":1}},"children":[{"type":"text","value":"In all other respects usage is the same as for the ","position":{"start":{"line":739,"column":1},"end":{"line":739,"column":1}},"key":"eA3ViO5Yal"},{"type":"inlineCode","value":"newtonsys","position":{"start":{"line":739,"column":1},"end":{"line":739,"column":1}},"key":"UICgxgCYqP"},{"type":"text","value":" function.","position":{"start":{"line":739,"column":1},"end":{"line":739,"column":1}},"key":"GG6bjP8p3b"}],"key":"nYE8SvkQM7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = zeros(3)\nx = FNC.levenberg(func, x1)\nprint(f\"Took {x.shape[1]-1} iterations.\")","key":"qAZVZtOvrM"},{"type":"output","id":"dKLNtOAYyrd7p2_7mZzzr","data":[{"output_type":"stream","name":"stdout","text":"Took 11 iterations.\n"}],"key":"AjnvIsIVI4"}],"data":{},"key":"D02R2O5q8X"},{"type":"paragraph","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"children":[{"type":"text","value":"It’s always a good idea to check the accuracy of the root, by measuring the residual (backward error).","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"hD98sGc0Hu"}],"key":"BBZlTvxrUQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"r = x[:, -1]\nprint(\"backward error:\", norm(func(r)))","key":"JzkkoDqwKg"},{"type":"output","id":"XWf_DYqHUSZJPgRcAVR9Y","data":[{"output_type":"stream","name":"stdout","text":"backward error: 1.2708308198538738e-13\n"}],"key":"jk2G30FNcf"}],"data":{},"key":"mux9gQK27S"},{"type":"paragraph","position":{"start":{"line":755,"column":1},"end":{"line":755,"column":1}},"children":[{"type":"text","value":"Looking at the convergence in norm, we find a convergence rate between linear and quadratic, like with the secant method:","position":{"start":{"line":755,"column":1},"end":{"line":755,"column":1}},"key":"mCmxqElC7u"}],"key":"IyNSbY99Kk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logerr = [log(norm(x[:, k] - r)) for k in range(x.shape[1] - 1)]\nfor k in range(len(logerr) - 1):\n    print(logerr[k+1] / logerr[k])","key":"HZcXqxWfb2"},{"type":"output","id":"gLkfXfUj4mG_AE23G1hUU","data":[{"output_type":"stream","name":"stdout","text":"1.3488093916747845\n2.6294109965748875\n1.4519728849832465\n1.3970235480592712\n1.2898554702767009\n1.273302844194998\n1.458758688582501\n1.5234698304213956\n1.1687771474875415\n1.1579168503648603\n"}],"key":"PFxsJRWS5b"}],"data":{},"key":"XaGJLNhJg0"}],"label":"demo-quasi-levenberg-python","identifier":"demo-quasi-levenberg-python","html_id":"demo-quasi-levenberg-python","key":"TWtaivA5iY"},{"type":"heading","depth":3,"position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"children":[{"type":"text","value":"Section 4.7","position":{"start":{"line":763,"column":1},"end":{"line":763,"column":1}},"key":"ma3EFkc0Qw"}],"identifier":"section-4-7","label":"Section 4.7","html_id":"section-4-7","implicit":true,"key":"TkAN6q5JU1"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Convergence of nonlinear least squares","position":{"start":{"line":765,"column":1},"end":{"line":765,"column":1}},"key":"JV2kdwtT1n"}],"key":"o6HX2L7fls"},{"type":"paragraph","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"children":[{"type":"text","value":"We will observe the convergence of ","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"key":"Q4ANgMfCJm"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-levenberg","label":"function-levenberg","children":[{"type":"text","value":"Function ","key":"coWKOJF4wJ"},{"type":"text","value":"4.6.3","key":"BEQ7JXpRDt"}],"template":"Algorithm %s","enumerator":"4.6.3","resolved":true,"html_id":"function-levenberg","remote":true,"url":"/quasinewton","dataUrl":"/quasinewton.json","key":"jbYHNdBgLO"},{"type":"text","value":" for different levels of the minimum least-squares residual. We start with a function mapping from ","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"key":"TGqY1wi6eR"},{"type":"inlineMath","value":"\\real^2","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"ziP5qoY1qD"},{"type":"text","value":" into ","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"key":"y4PkBtL4GS"},{"type":"inlineMath","value":"\\real^3","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"double-struck\">R</mi><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\real^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"e2B0GJuENX"},{"type":"text","value":", and a point that will be near the optimum.","position":{"start":{"line":766,"column":1},"end":{"line":766,"column":1}},"key":"B7zgV9AKNZ"}],"key":"jN2KoLIkZT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"g = lambda x: array([sin(x[0] + x[1]), cos(x[0] - x[1]), exp(x[0] - x[1])])\np = array([1, 1])","key":"p5Wgdnc9fF"},{"type":"output","id":"lP3QCLZbZ97HjIBfbiClJ","data":[],"key":"AeN8agT38O"}],"data":{},"key":"qxjNvBqi6a"},{"type":"paragraph","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"key":"pF99KluCJU"},{"type":"inlineMath","value":"\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"bold\">g</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">p</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{g}(\\mathbf{x}) - \\mathbf{g}(\\mathbf{p})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">p</span><span class=\"mclose\">)</span></span></span></span>","key":"JQtFl9kldL"},{"type":"text","value":" obviously has a zero residual at ","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"key":"rhLGREl7ug"},{"type":"inlineMath","value":"\\mathbf{p}","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">p</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">p</span></span></span></span>","key":"HQmQaBidcr"},{"type":"text","value":". We’ll make different perturbations of that function in order to create nonzero residuals.","position":{"start":{"line":773,"column":1},"end":{"line":773,"column":1}},"key":"e0F4FQuS4E"}],"key":"uZ9Kd4l9Tk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for R in [1e-3, 1e-2, 1e-1]:\n    # Define the perturbed function.\n    f = lambda x: g(x) - g(p) + R * array([-1, 1, -1]) / sqrt(3)\n    x = FNC.levenberg(f, [0, 0])\n    r = x[:, -1]\n    err = [norm(x[:, j] - r) for j in range(x.shape[1] - 1)]\n    normres = norm(f(r))\n    semilogy(err, label=f\"R={normres:.2g}\")\ntitle(\"Convergence of Gauss–Newton\")\nxlabel(\"iteration\"), ylabel(\"error\")\nlegend();","key":"ApNt2lGAtD"},{"type":"output","id":"GlMymMfdTM2S40yX_FWek","data":[{"output_type":"stream","name":"stderr","text":"/Users/driscoll/mambaforge/envs/myst/lib/python3.13/site-packages/FNC/FNC04.py:168: UserWarning: Iteration did not find a root.\n  warnings.warn(\"Iteration did not find a root.\")\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"a70d2fb781ad276cadc09c64b4233095","path":"/fnc/build/a70d2fb781ad276cadc09c64b4233095.png"}}}],"key":"lIaa8JeoRB"}],"data":{},"key":"CqVboPDfnl"},{"type":"paragraph","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"children":[{"type":"text","value":"In the least perturbed case, where the minimized residual is less than ","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"q1FauO7mMj"},{"type":"span","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"children":[{"type":"text","value":"10","key":"ejlI1a7Ly8"},{"type":"superscript","children":[{"type":"text","value":"-3","key":"b55S6QyadD"}],"key":"IMSO0wpghH"}],"key":"NutZAj47e9"},{"type":"text","value":", the convergence is plausibly quadratic. At the next level up, the convergence starts similarly but suddenly stagnates for a long time. In the most perturbed case, the quadratic phase is nearly gone and the overall shape looks linear.","position":{"start":{"line":789,"column":1},"end":{"line":789,"column":1}},"key":"VZAQdrAxUz"}],"key":"sI4QcM8yOj"}],"label":"demo-nlsq-converge-python","identifier":"demo-nlsq-converge-python","html_id":"demo-nlsq-converge-python","key":"BIC1HOqa5I"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"Nonlinear data fitting","position":{"start":{"line":793,"column":1},"end":{"line":793,"column":1}},"key":"ukXQdZcXBE"}],"key":"tzwFWr861I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"m = 25\nV, Km = 2, 0.5\ns = linspace(0.05, 6, m)\nmodel = lambda x: V * x / (Km + x)\nw = model(s) + 0.15 * cos(2 * exp(s / 16) * s)    # noise added\n\nfig, ax = subplots()\nax.scatter(s, w, label=\"data\")\nax.plot(s, model(s), 'k--', label=\"unperturbed model\")\nxlabel(\"s\"), ylabel(\"w\")\nlegend()","key":"EmWP7HmK24"},{"type":"output","id":"2hRLY_ghCO6nUnX6EGTgf","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"45977bf1ed31168e6052bf633d5efea1","path":"/fnc/build/45977bf1ed31168e6052bf633d5efea1.png"}}}],"key":"ggd0khTAu6"}],"data":{},"key":"aQnBC4jH1X"},{"type":"grid","columns":[1,1,2,2],"children":[{"type":"paragraph","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"children":[{"type":"text","value":"The idea is to pretend that we know nothing of the origins of this data and use nonlinear least squares to find the parameters in the theoretical model function ","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"pIOhhojDjg"},{"type":"inlineMath","value":"v(s)","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">v(s)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mclose\">)</span></span></span></span>","key":"mUbdHjUil5"},{"type":"text","value":". In ","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"eoPNlw79dg"},{"type":"crossReference","kind":"equation","identifier":"nlsq-misfit","label":"nlsq-misfit","children":[{"type":"text","value":"(","key":"J8ETLafbgx"},{"type":"text","value":"4.7.2","key":"lZnkwkiXns"},{"type":"text","value":")","key":"icGES3SqYj"}],"template":"(%s)","enumerator":"4.7.2","resolved":true,"html_id":"nlsq-misfit","remote":true,"url":"/nlsq","dataUrl":"/nlsq.json","key":"c7TRMIG0E0"},{"type":"text","value":", the ","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"n5VMBxvuvF"},{"type":"inlineMath","value":"s","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"qaihOMgc71"},{"type":"text","value":" variable plays the role of ","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"OOFPJlG2sA"},{"type":"inlineMath","value":"t","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"EvWkFiU0YW"},{"type":"text","value":", and ","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"WNnbvBdXiB"},{"type":"inlineMath","value":"v","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"jEYS9K4J75"},{"type":"text","value":" plays the role of ","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"LCcsBy5gtk"},{"type":"inlineMath","value":"g","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"zC7bzaIY8l"},{"type":"text","value":".","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"MXQwi9IeDW"}],"key":"XZvuf92KDN"},{"type":"card","children":[{"type":"paragraph","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"children":[{"type":"text","value":"Putting comma-separated values on the left of an assignment will ","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"Gfxpfypjty"},{"type":"strong","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"children":[{"type":"text","value":"destructure","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"q8Zt4YbRsE"}],"key":"MnaZIDuC1E"},{"type":"text","value":" the right-hand side, drawing individual assignments from entries of a vector, for example.","position":{"start":{"line":814,"column":1},"end":{"line":814,"column":1}},"key":"rLb0y7xgP0"}],"key":"VBkcdE0zie"}],"key":"qUKPJ0q3N8"}],"indexEntries":[{"entry":"Python","subEntry":{"value":"destructuring","kind":"entry"},"emphasis":true}],"label":"index-HadKw4M14h","identifier":"index-hadkw4m14h","html_id":"index-hadkw4m14h","key":"nne1b70qtg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def misfit(c):\n    V, Km = c  # rename components for clarity\n    f = V * s / (Km + s) - w\n    return f","key":"CVXWJUfRck"},{"type":"output","id":"TdrbL4hnFCsLZFJo7a1bG","data":[],"key":"h2etjBCidS"}],"data":{},"key":"W0xpZCpQ5o"},{"type":"paragraph","position":{"start":{"line":825,"column":1},"end":{"line":825,"column":1}},"children":[{"type":"text","value":"In the Jacobian the derivatives are with respect to the parameters in ","position":{"start":{"line":825,"column":1},"end":{"line":825,"column":1}},"key":"rjZEhYAmEu"},{"type":"inlineMath","value":"\\mathbf{x}","position":{"start":{"line":825,"column":1},"end":{"line":825,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"fA960UqfoR"},{"type":"text","value":".","position":{"start":{"line":825,"column":1},"end":{"line":825,"column":1}},"key":"V7BcsOEC6g"}],"key":"KenpGfb2sl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def misfitjac(x):\n    V, Km = x   # rename components for clarity\n    J = zeros([m, 2])\n    J[:, 0] = s / (Km + s)          # d/d(V)\n    J[:, 1] = -V * s / (Km + s)**2  # d/d(Km)\n    return J","key":"vHLOx2e6rE"},{"type":"output","id":"45BMeb401HZaC6-Vp_bTm","data":[],"key":"wYrjPd03Xc"}],"data":{},"key":"ZgcLfVhLVi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = [1, 0.75]\nx = FNC.newtonsys(misfit, misfitjac, x1)\nV, Km = x[:, -1]  # final values\nprint(f\"estimates are V = {V:.3f}, Km = {Km:.3f}\")","key":"JhNc9pKe3s"},{"type":"output","id":"7KoVpwhpYFHnK10TzSbv4","data":[{"output_type":"stream","name":"stdout","text":"estimates are V = 1.969, Km = 0.469\n"}],"key":"BIMuHUyIAk"}],"data":{},"key":"IAY6sOJETd"},{"type":"paragraph","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"children":[{"type":"text","value":"The final values are reasonably close to the values ","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"RneYhhkT7y"},{"type":"inlineMath","value":"V=2","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">V=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"N0f6YZfA6a"},{"type":"text","value":", ","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"MOtJJzfVH2"},{"type":"inlineMath","value":"K_m=0.5","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>K</mi><mi>m</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">K_m=0.5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span>","key":"KKmqDzFgBY"},{"type":"text","value":" that we used to generate the noise-free data. Graphically, the model looks close to the original data.","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"MRQQc58Jmc"}],"key":"AKb6jEh0GD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# since V and Km have been updated, model() is too\nax.plot(s, model(s), label=\"nonlinear fit\")","key":"nKWuUQGMBy"},{"type":"output","id":"LFSGyP4gnA8vBdMhgmIt5","data":[],"key":"xJRm0A3kt7"}],"data":{},"key":"G05xxXHCp8"},{"type":"paragraph","position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"children":[{"type":"text","value":"For this particular model, we also have the option of linearizing the fit process. Rewrite the model as","position":{"start":{"line":850,"column":1},"end":{"line":850,"column":1}},"key":"s8xg0UUwrL"}],"key":"yUUWgmaxnI"},{"type":"math","value":"\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta","enumerated":false,"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>w</mi></mfrac><mo>=</mo><mfrac><mi>α</mi><mi>s</mi></mfrac><mo>+</mo><mi>β</mi><mo>=</mo><mi>α</mi><mo>⋅</mo><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>β</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{w} = \\frac{\\alpha}{s} + \\beta = \\alpha \\cdot s^{-1} + \\beta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span></span></span></span></span>","key":"j0jE7FrGUO"},{"type":"paragraph","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"children":[{"type":"text","value":"for the new fitting parameters ","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"xgtzIVpnU4"},{"type":"inlineMath","value":"\\alpha=K_m/V","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><msub><mi>K</mi><mi>m</mi></msub><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha=K_m/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"oIIVpuuXu8"},{"type":"text","value":" and ","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"xTckoshh2G"},{"type":"inlineMath","value":"\\beta=1/V","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>V</mi></mrow><annotation encoding=\"application/x-tex\">\\beta=1/V</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span>","key":"Atp0R1hHtl"},{"type":"text","value":". This corresponds to the misfit function whose entries are","position":{"start":{"line":857,"column":1},"end":{"line":857,"column":1}},"key":"Vkp5mejNNf"}],"key":"w0oFFBvqRJ"},{"type":"math","value":"f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}","position":{"start":{"line":859,"column":1},"end":{"line":859,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mi>α</mi><mo separator=\"true\">,</mo><mi>β</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">(</mo><mi>α</mi><mo>⋅</mo><mfrac><mn>1</mn><msub><mi>s</mi><mi>i</mi></msub></mfrac><mo>+</mo><mi>β</mi><mo fence=\"true\">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><msub><mi>w</mi><mi>i</mi></msub></mfrac></mrow><annotation encoding=\"application/x-tex\">f_i([\\alpha,\\beta]) = \\left(\\alpha \\cdot \\frac{1}{s_i} + \\beta\\right) - \\frac{1}{w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">([</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1574em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"O3ZBnrqBv0"},{"type":"paragraph","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"children":[{"type":"text","value":"for ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"BEI92ZH6a0"},{"type":"inlineMath","value":"i=1,\\ldots,m","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=1,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"OGdeVP4e8V"},{"type":"text","value":". Although this misfit is nonlinear in ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"bu2rkLG5Td"},{"type":"inlineMath","value":"s","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"BM7D5Jprn3"},{"type":"text","value":" and ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"igXt0OTAUJ"},{"type":"inlineMath","value":"w","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>","key":"C0GfBDfuSU"},{"type":"text","value":", it’s linear in the unknown parameters ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"lu7nZHQDtX"},{"type":"text","value":"α","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"nUbWf1kn8V"},{"type":"text","value":" and ","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"slg1puhrVy"},{"type":"text","value":"β","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"F6lDNVeS5E"},{"type":"text","value":". This lets us pose and solve it as a linear least-squares problem.","position":{"start":{"line":860,"column":1},"end":{"line":860,"column":1}},"key":"NRxrOESocU"}],"key":"sGmjgZPILh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from numpy.linalg import lstsq\nA = array( [[1 / s[i], 1.0] for i in range(len(s))] )\nz = lstsq(A, 1 / w, rcond=None)[0]\nalpha, beta = z\nprint(\"alpha:\", alpha, \"beta:\", beta)","key":"pUvDAlcNBX"},{"type":"output","id":"ZPsKBNhSWthsF2y3dvsOW","data":[{"output_type":"stream","name":"stdout","text":"alpha: 0.12476333709901544 beta: 0.571395910043123\n"}],"key":"faTlUBpldt"}],"data":{},"key":"Vld52YSwxL"},{"type":"paragraph","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"children":[{"type":"text","value":"The two fits are different; they do not optimize the same quantities.","position":{"start":{"line":870,"column":1},"end":{"line":870,"column":1}},"key":"OInU9kxjBg"}],"key":"USEUVGG4IJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"linmodel = lambda x: 1 / (beta + alpha / x)\nax.plot(s, linmodel(s), label=\"linear fit\")\nax.legend()\nfig","key":"Bn3k4waLYZ"},{"type":"output","id":"YOdqMGYYy0THjHxyFnx1q","data":[{"output_type":"execute_result","execution_count":71,"metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"f376d8cbb351d04fc3802ca5af838502","path":"/fnc/build/f376d8cbb351d04fc3802ca5af838502.png"}}}],"key":"dCTVfpA6Rj"}],"data":{},"key":"tihPkesp8T"},{"type":"paragraph","position":{"start":{"line":879,"column":1},"end":{"line":879,"column":1}},"children":[{"type":"text","value":"The truly nonlinear fit is clearly better in this case. It optimizes a residual for the original measured quantity rather than a transformed one we picked for algorithmic convenience.","position":{"start":{"line":879,"column":1},"end":{"line":879,"column":1}},"key":"bRyiPsew64"}],"key":"NefzMrq8Jr"}],"label":"demo-nlsq-MM-python","identifier":"demo-nlsq-mm-python","html_id":"demo-nlsq-mm-python","key":"ricGOnayJU"}],"key":"ONqAHKCuoi"}],"key":"RnCc5wHXvn"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 3","url":"/chapter3-2","group":"Python codes"},"next":{"title":"Chapter 5","url":"/chapter5-2","group":"Python codes"}}},"domain":"http://localhost:3000"}