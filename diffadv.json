{"kind":"Article","sha256":"90110533e33bb59827082ea496f140be990ce9b4e5a6d1002087dfa32ec65653","slug":"diffadv","location":"/chapter13/section2/diffadv.md","dependencies":[],"frontmatter":{"title":"Two-dimensional diffusion and advection","numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false},"enumerator":{"template":"13.2.%s"}},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"md","filename":"diffadv.md","url":"/build/diffadv-27c06f7e7cae451544a7216a1fc469b4.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We next describe how to apply the method of lines to ","key":"LDixESI3WU"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"Za7kR9GccX"}],"key":"MXsizUboJx"},{"type":"text","value":"s of the form","key":"mvje8RkZES"}],"key":"AGUbBudcTR"},{"type":"math","value":"  u_t = \\phi(u,u_x,u_y,u_{xx},u_{xy},u_{yy}), \\quad (x,y)\\in [a,b]\\times [c,d].","label":"pde2d","identifier":"pde2d","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><mi>ϕ</mi><mo stretchy=\"false\">(</mo><mi>u</mi><mo separator=\"true\">,</mo><msub><mi>u</mi><mi>x</mi></msub><mo separator=\"true\">,</mo><msub><mi>u</mi><mi>y</mi></msub><mo separator=\"true\">,</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>∈</mo><mo stretchy=\"false\">[</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo stretchy=\"false\">]</mo><mo>×</mo><mo stretchy=\"false\">[</mo><mi>c</mi><mo separator=\"true\">,</mo><mi>d</mi><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">  u_t = \\phi(u,u_x,u_y,u_{xx},u_{xy},u_{yy}), \\quad (x,y)\\in [a,b]\\times [c,d].</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">ϕ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">u</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">c</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mclose\">]</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"13.2.1","html_id":"pde2d","key":"KaJIyEMVbt"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"The ","key":"X4gpe2TMbg"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"k2HgWiF2Jo"}],"key":"q6Sfjy2vhP"},{"type":"text","value":" may be of either parabolic or hyperbolic type, with the primary difference being potential restrictions on the time step size. To keep descriptions and implementations relatively simple, we will consider only periodic conditions, or Dirichlet boundary conditions imposed on all the edges of the rectangular domain.","key":"xQ4k69e0tu"}],"key":"GuW0VNVDr5"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"As described in ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Co8kv78oKm"},{"type":"link","kind":"numref","identifier":"section-twodim-tensorprod","label":"section-twodim-tensorprod","url":"/tensorprod","internal":true,"dataUrl":"/tensorprod.json","children":[{"type":"text","value":"Tensor-product discretizations","key":"BKggn5bnR3"}],"key":"TUYzU9L7GT"},{"type":"text","value":", the rectangular domain is discretized by a grid ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"fHkILaAGVM"},{"type":"inlineMath","value":"(x_i,y_j)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_i,y_j)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"ihPJzPXpTo"},{"type":"text","value":" for ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"wQp00ejgUo"},{"type":"inlineMath","value":"i=0,\\ldots,m","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">i=0,\\ldots,m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"UZObWyVDPi"},{"type":"text","value":" and ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CIV89O4dPB"},{"type":"inlineMath","value":"j=0,\\ldots,n","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi><mo>=</mo><mn>0</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">j=0,\\ldots,n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"bm3jcL5atf"},{"type":"text","value":". The solution is semidiscretized as a matrix ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"DUsdRmVc8m"},{"type":"inlineMath","value":"\\mathbf{U}(t)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"u0xwYOAjL3"},{"type":"text","value":" such that ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"e2rQggVKr9"},{"type":"inlineMath","value":"U_{ij}\\approx u(x_i,y_j,t)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>≈</mo><mi>u</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mi>j</mi></msub><mo separator=\"true\">,</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">U_{ij}\\approx u(x_i,y_j,t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">ij</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"GRQzracu4u"},{"type":"text","value":". Terms involving the spatial derivatives of ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"RneVgHXVZr"},{"type":"inlineMath","value":"u","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"rLTqYdHaKz"},{"type":"text","value":" are readily replaced by discrete counterparts: ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Ysd4MpoWMW"},{"type":"inlineMath","value":"\\mathbf{D}_x\\mathbf{U}","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">D</mi><mi>x</mi></msub><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{D}_x\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"h5Nt1HgrzF"},{"type":"text","value":" for ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"jZz90Q61ex"},{"type":"inlineMath","value":"u_x","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"HRu1wdEdpU"},{"type":"text","value":", ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"DC1C66tAaP"},{"type":"inlineMath","value":"\\mathbf{U}\\mathbf{D}_{y}^T","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><msubsup><mi mathvariant=\"bold\">D</mi><mi>y</mi><mi>T</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}\\mathbf{D}_{y}^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2244em;vertical-align:-0.3831em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Fcb0DdXV7f"},{"type":"text","value":" for ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Rq44aUXZ21"},{"type":"inlineMath","value":"u_y","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ywB3R3rk7P"},{"type":"text","value":", and so on.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"nRWsmi2CTN"}],"key":"EA1YCIa84o"},{"type":"heading","depth":2,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Matrix and vector shapes","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"T3Anw44x7s"}],"identifier":"matrix-and-vector-shapes","label":"Matrix and vector shapes","html_id":"matrix-and-vector-shapes","implicit":true,"enumerator":"13.2.1","key":"kgCmgDOBu2"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Our destination is an ","key":"ZywzqC4Hry"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"GlekBOhvHg"}],"key":"Jy7cavxKEL"},{"type":"text","value":" that can be solved by a Runge–Kutta or multistep solver. These solvers are intended for vector problems, but our unknowns naturally have a matrix shape, which is the most convenient for the differentiation formulas ","key":"aq5Spsa0iN"},{"type":"crossReference","kind":"equation","identifier":"partfpartx","label":"partfpartx","children":[{"type":"text","value":"(","key":"vEGXqytonV"},{"type":"text","value":"13.1.8","key":"nSGF1Seg1C"},{"type":"text","value":")","key":"HugxRTWh3Q"}],"template":"(%s)","enumerator":"13.1.8","resolved":true,"html_id":"partfpartx","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"K80jIXC3CW"},{"type":"text","value":" and ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"BDqeMzIwfr"},{"type":"crossReference","kind":"equation","identifier":"partfparty","label":"partfparty","children":[{"type":"text","value":"(","key":"lpHCn5oqAe"},{"type":"text","value":"13.1.9","key":"XaDwtJmjFy"},{"type":"text","value":")","key":"HjMS320nFw"}],"template":"(%s)","enumerator":"13.1.9","resolved":true,"html_id":"partfparty","remote":true,"url":"/tensorprod","dataUrl":"/tensorprod.json","key":"mbltcwTc1D"},{"type":"text","value":". Fortunately, it’s easy to translate back and forth between a matrix and an equivalent vector.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"gGrZPFJdpu"}],"indexEntries":[{"entry":"vec","emphasis":true},{"entry":"Julia","subEntry":{"value":"vec operation","kind":"entry"},"emphasis":true},{"entry":"unvec","emphasis":true},{"entry":"Julia","subEntry":{"value":"reshape","kind":"entry"},"emphasis":false}],"label":"index-gQUPaaaZb9","identifier":"index-gqupaaazb9","html_id":"index-gqupaaazb9","key":"IyYTOYGL9X"},{"type":"proof","kind":"definition","enumerated":true,"children":[{"type":"admonitionTitle","children":[{"type":"text","value":"vec and unvec operations","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"nx9ZhKnAyu"}],"key":"Dcq1OOjnGY"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"iANpxzg9ma"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"YzF18eJoks"},{"type":"text","value":" be an ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"pfIJJO6tJh"},{"type":"inlineMath","value":"m\\times n","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m\\times n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"iN75565HE9"},{"type":"text","value":" matrix. Define the ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"MEpJfcmb0K"},{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"vec","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"yazd1QRQsO"}],"key":"QlKJ6NqjUd"},{"type":"text","value":" function as stacking the columns of ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"O0ewn5akrZ"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Vi2YvLxJaH"},{"type":"text","value":" into a vector, i.e.,","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"NeVYNcpkT2"}],"key":"AlKiQl7kiI"},{"type":"math","value":"\\operatorname{vec}(\\mathbf{A}) =\n\\begin{bmatrix}\nA_{11} \\\\ \\vdots \\\\ A_{m1}  \\\\ \\vdots  \\\\ A_{1n} \\\\ \\vdots \\\\ A_{m n}\n\\end{bmatrix}.","label":"vecdef","identifier":"vecdef","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">vec</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">A</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>A</mi><mn>11</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>A</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>A</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>A</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{vec}(\\mathbf{A}) =\n\\begin{bmatrix}\nA_{11} \\\\ \\vdots \\\\ A_{m1}  \\\\ \\vdots  \\\\ A_{1n} \\\\ \\vdots \\\\ A_{m n}\n\\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">vec</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:10.38em;vertical-align:-4.94em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.3501em;\"><span style=\"top:-4.4111em;\"><span class=\"pstrut\" style=\"height:8.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-5.5581em;\"><span class=\"pstrut\" style=\"height:8.6161em;\"></span><span style=\"height:6.6161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='6.6161em' style='width:0.6667em' viewBox='0 0 666.67 6616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V6616 H319z M319 0 H403 V6616 H319z'/></svg></span></span><span style=\"top:-12.8112em;\"><span class=\"pstrut\" style=\"height:8.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.8501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.44em;\"><span style=\"top:-8.2875em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-6.4275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-5.2275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.3675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-2.1675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-0.3075em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:0.8925em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">mn</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.94em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.3501em;\"><span style=\"top:-4.4111em;\"><span class=\"pstrut\" style=\"height:8.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-5.5581em;\"><span class=\"pstrut\" style=\"height:8.6161em;\"></span><span style=\"height:6.6161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='6.6161em' style='width:0.6667em' viewBox='0 0 666.67 6616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V6616 H263z M263 0 H347 V6616 H263z'/></svg></span></span><span style=\"top:-12.8112em;\"><span class=\"pstrut\" style=\"height:8.6161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.8501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"13.2.2","html_id":"vecdef","key":"Ueyhebvfo5"},{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"kNtiL4Osce"},{"type":"inlineMath","value":"\\mathbf{z}","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">z</span></span></span></span>","key":"myBo589CHu"},{"type":"text","value":" be a vector of length ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"dgCWbnTuRa"},{"type":"inlineMath","value":"m n","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">m n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">mn</span></span></span></span>","key":"jc5S5aQ7CP"},{"type":"text","value":". Define the ","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"Cmw82c0CKZ"},{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"unvec","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"xpQiA7sQLn"}],"key":"DHmtCl2jjE"},{"type":"text","value":" function as the inverse of vec:","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"cm5DYxWadr"}],"key":"eIyu2ED4hk"},{"type":"math","value":"\\operatorname{unvec}(\\mathbf{z}) = \\begin{bmatrix}\n  z_1 & z_{m+1} & \\cdots & z_{m(n-1)+1} \\\\\n  z_2 & z_{m+2} & \\cdots & z_{m(n-1)+2} \\\\\n  \\vdots & \\vdots & & \\vdots \\\\\n  z_m & z_{2m} & \\cdots & z_{m n} \\\\\n\\end{bmatrix}.","label":"unvecdef","identifier":"unvecdef","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">unvec</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">z</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mrow><mi>m</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mrow><mi>m</mi><mo>+</mo><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mrow><mi>m</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>2</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mi>m</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mrow><mn>2</mn><mi>m</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>z</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{unvec}(\\mathbf{z}) = \\begin{bmatrix}\n  z_1 &amp; z_{m+1} &amp; \\cdots &amp; z_{m(n-1)+1} \\\\\n  z_2 &amp; z_{m+2} &amp; \\cdots &amp; z_{m(n-1)+2} \\\\\n  \\vdots &amp; \\vdots &amp; &amp; \\vdots \\\\\n  z_m &amp; z_{2m} &amp; \\cdots &amp; z_{m n} \\\\\n\\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">unvec</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">z</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:5.46em;vertical-align:-2.48em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.95em;\"><span style=\"top:-2.011em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.158em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span style=\"height:1.816em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.816em' style='width:0.6667em' viewBox='0 0 666.67 1816' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1816 H319z M319 0 H403 V1816 H319z'/></svg></span></span><span style=\"top:-5.6111em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.45em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.8275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-4.6275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.7675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.5675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.8275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-4.6275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.7675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.5675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.64em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span><span style=\"top:-4.44em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span><span style=\"top:-2.58em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.38em;\"><span class=\"pstrut\" style=\"height:3.5em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.98em;\"><span style=\"top:-5.8275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-4.6275em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.5198em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3552em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.7675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-1.5675em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">mn</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.48em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.95em;\"><span style=\"top:-2.011em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.158em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span style=\"height:1.816em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.816em' style='width:0.6667em' viewBox='0 0 666.67 1816' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1816 H263z M263 0 H347 V1816 H263z'/></svg></span></span><span style=\"top:-5.6111em;\"><span class=\"pstrut\" style=\"height:3.816em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.45em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"13.2.3","html_id":"unvecdef","key":"Nog2kcMYTe"}],"label":"definition-diffadv-vec","identifier":"definition-diffadv-vec","html_id":"definition-diffadv-vec","enumerator":"13.2.1","key":"M0mf7lx1k5"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"R3ozAFTs6B"},{"type":"inlineCode","value":"vec","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"UjvBCbYJnD"},{"type":"text","value":" is built-in to Julia, whereas unvec is a particular use case of the ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"QZ2roPTPhh"},{"type":"inlineCode","value":"reshape","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"qNwy0hG5nc"},{"type":"text","value":" function.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"mTliJytmM7"}],"key":"vhTaGgo6Sc"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Reshaping for grid functions","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"ZiYgu1dZKA"}],"key":"CtxMWTCG21"},{"type":"include","file":"julia/vec.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"iAza4y1G8R"},{"type":"text","value":"13.2.1","key":"hMyypw5RuT"}],"key":"C5zxPyNYJT"}],"identifier":"demo-diffadv-vec","label":"demo-diffadv-vec","kind":"proof:example","template":"Example %s","enumerator":"13.2.1","resolved":true,"html_id":"demo-diffadv-vec","key":"Sj4LqzTurd"}],"key":"zxfIvNGgbD"}],"key":"uYnpgAGoG4"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:52:59.066000Z","iopub.status.busy":"2025-01-14T15:52:30.306000Z","iopub.execute_input":"2025-01-14T15:52:33.160000Z","shell.execute_reply":"2025-01-14T15:52:59.029000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m = 2;\nn = 3;\nV = rand(1:9, m, n);\nv = vec(V)","key":"F311KMyozD"},{"type":"output","id":"AUDzIYvXoMBKxVmEd3Dxi","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"6-element Vector{Int64}:\n 9\n 1\n 2\n 5\n 4\n 3","content_type":"text/plain"}}}],"key":"l9IZIvXjrS"}],"key":"tJPZ0ifmgV"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bZCr1sxXMy"},{"type":"inlineCode","value":"unvec","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCIrv5ezNt"},{"type":"text","value":" operation is the inverse of vec.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iz8Syt4BLR"}],"key":"oA3v3z2Wuc"}],"key":"sETQ24pBfZ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:53:02.652000Z","iopub.status.busy":"2025-01-14T15:52:59.113000Z","iopub.execute_input":"2025-01-14T15:52:59.115000Z","shell.execute_reply":"2025-01-14T15:53:02.644000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"unvec = z -> reshape(z, m, n)\nunvec(v)","key":"Pgy1reAK6J"},{"type":"output","id":"VdaddkTcwBOco1E678zl-","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"2×3 Matrix{Int64}:\n 9  2  4\n 1  5  3","content_type":"text/plain"}}}],"key":"f0yboD3J5j"}],"key":"Lin6asy52K"}],"key":"qv18pRhT8K"}],"key":"ob9CdZNDnu"}],"key":"AHaHsKk9kD"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Reshaping for grid functions","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"B69G7FErsO"}],"key":"Cd7HzRmBMz"},{"type":"include","file":"matlab/vec.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"O7HcIWxz3e"},{"type":"text","value":"13.2.1","key":"PRfE62Qa0z"}],"key":"dODmfbT2nJ"}],"identifier":"demo-diffadv-vec","label":"demo-diffadv-vec","kind":"proof:example","template":"Example %s","enumerator":"13.2.1","resolved":true,"html_id":"demo-diffadv-vec","key":"OqbHOurjjB"}],"key":"gsO69sRQdo"}],"key":"BGoVAFAIeT"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 4;  n = 3;\nx = linspace(0, 2, m+1);\ny = linspace(-3, 0, n+1);\n\nf = @(x, y) cos(0.75*pi * x .* y - 0.5*pi * y);\n[mtx, X, Y, vec, unvec] = tensorgrid(x, y);\nF = mtx(f);\ndisp(\"function on a 4x3 grid:\")\ndisp(F)","key":"qGK4zI7lOh"},{"type":"output","id":"gBPnE2TELdNa51015GZwt","data":[{"name":"stdout","output_type":"stream","text":"function on a 4x3 grid:\n   -0.0000   -1.0000    0.0000    1.0000\n    0.3827    0.7071    0.9239    1.0000\n   -0.7071    0.0000    0.7071    1.0000\n    0.9239   -0.7071   -0.3827    1.0000\n   -1.0000    1.0000   -1.0000    1.0000\n\n"}],"key":"CWf4iRPhTv"}],"key":"eWeThrVGuP"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"vec(F):\")\ndisp(vec(F))","key":"RXRjybA6sH"},{"type":"output","id":"YmFVUxm5hP25DuUelxApA","data":[{"name":"stdout","output_type":"stream","text":"vec(F):\n   -0.0000\n    0.3827\n   -0.7071\n    0.9239\n   -1.0000\n   -1.0000\n    0.7071\n    0.0000\n   -0.7071\n    1.0000\n    0.0000\n    0.9239\n    0.7071\n   -0.3827\n   -1.0000\n    1.0000\n    1.0000\n    1.0000\n    1.0000\n    1.0000\n\n"}],"key":"zRwyUeTw43"}],"key":"wXQAFRhD5c"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VwzW1fmU3p"},{"type":"inlineCode","value":"unvec","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kdZ03TfbUB"},{"type":"text","value":" operation is the inverse of vec.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GOK0WvHBEC"}],"key":"TBsX52Bub3"}],"key":"utZVw3B3BJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"disp(\"unvec(vec(F)):\")\ndisp(unvec(vec(F)))","key":"SpGgQLGNCe"},{"type":"output","id":"QIOW0lD5QKkjZCudoCVVN","data":[{"name":"stdout","output_type":"stream","text":"unvec(vec(F)):\n   -0.0000   -1.0000    0.0000    1.0000\n    0.3827    0.7071    0.9239    1.0000\n   -0.7071    0.0000    0.7071    1.0000\n    0.9239   -0.7071   -0.3827    1.0000\n   -1.0000    1.0000   -1.0000    1.0000\n\n"}],"key":"GnlYWztxMb"}],"key":"sY8iMRXRFd"}],"key":"TS6SZ5O0BL"}],"key":"rnB9nLimAY"}],"key":"rlBaEgvaiE"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Reshaping for grid functions","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"NdbZKCT3aE"}],"key":"hhqtBtu6wT"},{"type":"include","file":"python/vec.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:29:16.133906Z","iopub.status.busy":"2025-01-09T20:29:16.133806Z","iopub.status.idle":"2025-01-09T20:29:16.509086Z","shell.execute_reply":"2025-01-09T20:29:16.508796Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"h0R6GiKkTV"},{"type":"output","id":"RWcU6VUsivq8Ner7MjbmR","data":[],"visibility":"show","key":"xSelaPjXBz"}],"visibility":"remove","key":"ijxvZK8xBW"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"piZ1oLxYj6"},{"type":"text","value":"13.2.1","key":"GW7dLTTOIO"}],"key":"Ykn0NhX18N"}],"identifier":"demo-diffadv-vec","label":"demo-diffadv-vec","kind":"proof:example","template":"Example %s","enumerator":"13.2.1","resolved":true,"html_id":"demo-diffadv-vec","key":"wKIS7uOj2V"}],"key":"TQg599NVQv"}],"key":"OpeWRADpvA"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:29:16.510649Z","iopub.status.busy":"2025-01-09T20:29:16.510521Z","iopub.status.idle":"2025-01-09T20:29:16.523907Z","shell.execute_reply":"2025-01-09T20:29:16.520035Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"m, n = 4, 3\nx = linspace(0, 2, m+1)\ny = linspace(-3, 0, n+1)\n\nf = lambda x, y: cos(0.75 * pi * x * y - 0.5 * pi * y)\nmtx, X, Y, vec, unvec, _ = FNC.tensorgrid(x, y)\nF = mtx(f)\nprint(f\"function on a {m}x{n} grid:\")\nwith printoptions(precision=4, suppress=True):\n    print(F)\n\nprint(\"vec(F):\")\nwith printoptions(precision=4, suppress=True):\n    print(vec(F))","key":"zH4ZYnTTaJ"},{"type":"output","id":"6wgorSeskTImZegcevXwM","data":[{"name":"stdout","output_type":"stream","text":"function on a 4x3 grid:\n[[-0.     -1.      0.      1.    ]\n [ 0.3827  0.7071  0.9239  1.    ]\n [-0.7071  0.      0.7071  1.    ]\n [ 0.9239 -0.7071 -0.3827  1.    ]\n [-1.      1.     -1.      1.    ]]\nvec(F):\n[-0.      0.3827 -0.7071  0.9239 -1.     -1.      0.7071  0.     -0.7071\n  1.      0.      0.9239  0.7071 -0.3827 -1.      1.      1.      1.\n  1.      1.    ]\n"}],"key":"CMFT4TeOqt"}],"key":"K5uYtlAgoG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KsBwZKxLe9"},{"type":"inlineCode","value":"unvec","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jNa0ba5dsv"},{"type":"text","value":" operation is the inverse of vec.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ay8sMxaKT9"}],"key":"qXmIMfVsd9"}],"key":"bz409UQKCo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:29:16.527034Z","iopub.status.busy":"2025-01-09T20:29:16.526807Z","iopub.status.idle":"2025-01-09T20:29:16.530166Z","shell.execute_reply":"2025-01-09T20:29:16.529663Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"unvec(vec(F)):\")\nwith printoptions(precision=4, suppress=True):\n    print(unvec(vec(F)))","key":"M4cqhmI81z"},{"type":"output","id":"a0q1d7NZLi7El3bF7v99y","data":[{"name":"stdout","output_type":"stream","text":"unvec(vec(F)):\n[[-0.     -1.      0.      1.    ]\n [ 0.3827  0.7071  0.9239  1.    ]\n [-0.7071  0.      0.7071  1.    ]\n [ 0.9239 -0.7071 -0.3827  1.    ]\n [-1.      1.     -1.      1.    ]]\n"}],"key":"QJoYGL2Rxb"}],"key":"E4cRQ5evbZ"}],"key":"igB16CNCl9"}],"key":"kNnmCV9fmC"}],"key":"fYASqBilqy"}],"key":"Cf1B4jUrVj"}],"label":"demo-diffadv-vec","identifier":"demo-diffadv-vec","html_id":"demo-diffadv-vec","enumerator":"13.2.1","key":"sbwXoxevry"},{"type":"heading","depth":2,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"Periodic end conditions","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"qVVUxKSsMX"}],"identifier":"periodic-end-conditions","label":"Periodic end conditions","html_id":"periodic-end-conditions","implicit":true,"enumerator":"13.2.2","key":"mF1haF7iQu"},{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"If the boundary conditions are periodic, then the unknowns in the method of lines are the elements of the matrix ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"iQUhBAYTfX"},{"type":"inlineMath","value":"\\mathbf{U}(t)","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"hZ7G5s1xL1"},{"type":"text","value":" representing grid values of the numerical solution. For the purposes of an ","key":"MKQiJllRF0"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"t4Js6hpr29"}],"key":"Om5QueBFuD"},{"type":"text","value":" solution, this matrix is equivalent to the vector ","key":"yFMgfBDn8Y"},{"type":"inlineMath","value":"\\mathbf{u}(t)","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"GlQ8sJNgNJ"},{"type":"text","value":" defined as ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"pWNwg2GNhq"},{"type":"inlineMath","value":"\\mathbf{u}=\\operatorname{vec}(\\mathbf{U})","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">u</mi><mo>=</mo><mi mathvariant=\"normal\">vec</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">U</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{u}=\\operatorname{vec}(\\mathbf{U})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">vec</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">U</span><span class=\"mclose\">)</span></span></span></span>","key":"sqsAY01S8H"},{"type":"text","value":".","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"zcxoZlDAQF"}],"key":"URw3J7DF4d"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Heat equation in 2D","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"red30oArXJ"}],"key":"WEap5T8I3g"},{"type":"include","file":"julia/heat.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Le1kyF9rGx"},{"type":"text","value":"13.2.2","key":"JF1njRBjIJ"}],"key":"IbCJkfK3wM"}],"identifier":"demo-diffadv-heat","label":"demo-diffadv-heat","kind":"proof:example","template":"Example %s","enumerator":"13.2.2","resolved":true,"html_id":"demo-diffadv-heat","key":"eDYkr9i1Kv"}],"key":"b52i7aBZIL"}],"key":"bALyxZVT2E"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:47:30.577000Z","iopub.status.busy":"2025-01-14T15:47:25.354000Z","iopub.execute_input":"2025-01-14T15:47:27.794000Z","shell.execute_reply":"2025-01-14T15:47:30.554000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = (60, 25)\nx, Dx, Dxx = FNC.diffper(m, [-1, 1])\ny, Dy, Dyy = FNC.diffper(n, [-1, 1])\nmtx = f -> [f(x, y) for x in x, y in y]\nunvec = z -> reshape(z, m, n);","key":"O9CmUEf6gU"},{"type":"output","id":"28ofUBQuAecR0TyUHyh4Z","data":[],"key":"mA0eoOGtXH"}],"key":"iK6Zw2aiaP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that the initial condition should also be periodic on the domain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dk6AQ4V9c4"}],"key":"Y44TzpOGtP"}],"key":"bJpEIYyWNp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:48:14.000000Z","iopub.status.busy":"2025-01-14T15:47:30.600000Z","iopub.execute_input":"2025-01-14T15:47:30.601000Z","shell.execute_reply":"2025-01-14T15:48:13.992000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"u_init = (x, y) -> sin(4 * π * x) * exp(cos(π * y))\nU₀ = mtx(u_init)\nM = maximum(abs, U₀)\ncontour(x, y, U₀';\n    color=:redsblues,  clims=(-M, M), \n    aspect_ratio=1,\n    xaxis=(\"x\", (-1, 1)),  yaxis=(\"y\", (-1, 1)), \n    title=\"Initial condition\" )","key":"H2CUH6skul"},{"type":"output","id":"gBslt7Mn7lUE8RZivCBPE","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"525c3bd608d1d46d7e0be4eb3861bbc6","path":"/build/525c3bd608d1d46d7e0be4eb3861bbc6.png"},"text/html":{"content_type":"text/html","hash":"286cda8e61a99d8076db09c069267f23","path":"/build/286cda8e61a99d8076db09c069267f23.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"88a7a640496e7f2eaec81dcaec871d55","path":"/build/88a7a640496e7f2eaec81dcaec871d55.svg"}}}],"key":"pQyDzJn7v4"}],"key":"zOzb7eGXlQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This function computes the time derivative for the unknowns. The actual calculations take place using the matrix shape.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tjTwBqLJdU"}],"key":"F1zrz1Df0k"}],"key":"QsWE7vPwvO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:48:14.139000Z","iopub.status.busy":"2025-01-14T15:48:14.125000Z","iopub.execute_input":"2025-01-14T15:48:14.126000Z","shell.execute_reply":"2025-01-14T15:48:14.139000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"function du_dt(u, α, t)\n    U = unvec(u)\n    Uxx = Dxx * U\n    Uyy = U * Dyy'            # 2nd partials\n    du_dt = α * (Uxx + Uyy)    # PDE\n    return vec(du_dt)\nend;","key":"V7saXCpQCZ"},{"type":"output","id":"2TdPEY9rUydagp3sSJ6bW","data":[],"key":"TSfAEvMmVQ"}],"key":"LMe1ACMsng"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since this problem is parabolic, a stiff integrator is appropriate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nIpInO36K2"}],"key":"jKZBPxQoSi"}],"key":"Vyf1A03qNo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:49:25.553000Z","iopub.status.busy":"2025-01-14T15:48:14.147000Z","iopub.execute_input":"2025-01-14T15:48:14.147000Z","shell.execute_reply":"2025-01-14T15:49:25.542000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nIVP = ODEProblem(du_dt, vec(U₀), (0, 0.2), 0.1)\nsol = solve(IVP, Rodas4P());","key":"rfB9Snb6r4"},{"type":"output","id":"DfQnCKFc_sktYfH4oG90w","data":[],"key":"BkD7Kei3ZQ"}],"key":"O7lTgpWRA7"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is an animation of the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mh76Gp31CW"}],"key":"EK9dDzLbxt"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"aAO3Alfm3C"}],"key":"DdKpx8ithE"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sKtvWkSg6k"},{"type":"inlineCode","value":"clims","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kZOFepFhYl"},{"type":"text","value":" are set so that colors remain at fixed values throughout the animation.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KghLSvsU8j"}],"key":"slSjRRDbUB"}],"class":"dropdown","key":"YrgyD9U13v"}],"key":"U2SJcbIJZD"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:50:31.134000Z","iopub.status.busy":"2025-01-14T15:49:25.598000Z","iopub.execute_input":"2025-01-14T15:49:25.599000Z","shell.execute_reply":"2025-01-14T15:50:31.122000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in range(0, 0.2, 81)\n    surface(x, y, unvec(sol(t))';\n        color=:redsblues,  clims=(-M, M),\n        xaxis=(L\"x\", (-1, 1)), \n        yaxis=(L\"y\", (-1, 1)), \n        zlims=(-M, M),\n        title=@sprintf(\"Heat equation, t=%.3f\", t),\n        dpi=150, colorbar=:none)\nend\ncloseall();\nmp4(anim, \"heat-2d.mp4\");","key":"k3IkSUfGTQ"},{"type":"output","id":"LpWUbKnZWpY1V9MWlcpV3","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter13/section2/julia/heat-2d.mp4\n"}],"key":"YmsHWOqDip"}],"key":"XB6hwak3nG"}],"key":"jU9VYYRD0S"},{"type":"image","url":"/build/heat-2d-ba7482ba7fbc4cf006c79cca03271dc2.mp4","alt":"Heat equation in 2D","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"urlSource":"julia/heat-2d.mp4","key":"ZKraz30GAq"}],"key":"tRzYYo0ANr"}],"key":"o0WMnVjrnK"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Heat equation in 2D","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"DXek9MBKF4"}],"key":"i7gJmiyfvz"},{"type":"include","file":"matlab/heat.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"e0xiyn5dHi"},{"type":"text","value":"13.2.2","key":"LcIdQuMhWk"}],"key":"QnjatPKWKT"}],"identifier":"demo-diffadv-heat","label":"demo-diffadv-heat","kind":"proof:example","template":"Example %s","enumerator":"13.2.2","resolved":true,"html_id":"demo-diffadv-heat","key":"X61d2qFhj0"}],"key":"gN8341BzMz"}],"key":"Xd6TbxFmme"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 60;  n = 40;\n[x, Dx, Dxx] = diffper(m, [-1, 1]);\n[y, Dy, Dyy] = diffper(n, [-1, 1]);\n[mtx, X, Y, vec, unvec] = tensorgrid(x, y);","key":"nQB1S9tjZT"},{"type":"output","id":"_ouj8P3oFRZThsI42eeoM","data":[],"key":"x2RbdZ5jZs"}],"key":"VPUUBCmS60"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that the initial condition should also be periodic on the domain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pXPvlgSpcN"}],"key":"CCKSU64cWi"}],"key":"FJxQ3Lyf6c"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U0 = sin(4*pi*X) .* exp( cos(pi*Y) );\nclf,  surf(X', Y', U0')\nmx = max(abs(vec(U0)));\nclim([-mx, mx]),  shading interp\ncolormap(redsblues)\nxlabel('x'),  ylabel('y')  \ntitle('Initial condition')  ","key":"YSbA36QwFZ"},{"type":"output","id":"BakPZkc1IaN5x-Aita7av","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1db0bb8a86528466bf9983d70c2076d8","path":"/build/1db0bb8a86528466bf9983d70c2076d8.png"}}}],"key":"tyiMhnn1I8"}],"key":"Lc5OEOG9fF"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This function computes the time derivative for the unknowns. The actual calculations take place using the matrix shape.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dcd29pDoIw"}],"key":"PQ28BWOD5S"},{"type":"include","file":"f13_2_heat.m","literal":true,"filter":{},"children":[{"type":"code","value":"function du_dt = timederiv(t, u, p)\n    [alpha, Dxx, Dyy, vec, unvec] = p{:};\n    U = unvec(u);\n    Uxx = Dxx * U;  Uyy = U * Dyy';     % 2nd partials\n    dU_dt = alpha * (Uxx + Uyy);  % PDE\n    du_dt = vec(dU_dt);\nend","lang":"matlab","filename":"f13_2_heat.m","key":"ow0s0K33xl"}],"key":"WEAzGN0Ah0"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Since this problem is parabolic, a stiff integrator is appropriate.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"iaIW8nUzGL"}],"key":"lQ94B6Oyuy"}],"key":"tTGMreeKRe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_heat);\nivp.InitialTime = 0;\nivp.InitialValue = vec(U0);\nivp.Parameters = {0.1, Dxx, Dyy, vec, unvec};\nivp.Solver = \"stiff\";\nsol = solutionFcn(ivp, 0, 0.2);\nU = @(t) unvec(sol(t));","key":"mUrcDm1Kxn"},{"type":"output","id":"Dki-xEmDGzcB4c7oDwaJE","data":[],"key":"yaBFhKbhX6"}],"key":"PRuYsQviFi"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"surf(X', Y', U0')\nmx = max(abs(vec(U0)));\nclim([-mx, mx]),  shading interp\ncolormap(redsblues)\nxlabel('x'),  ylabel('y')  \ntitle('Initial condition') ","visibility":"hide","key":"zI0ahh7iHZ"},{"type":"output","id":"Jvek8OgNJiy-VTrFW_RVe","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2bab3409adc011fefb50e3fd2fd6cfc3","path":"/build/2bab3409adc011fefb50e3fd2fd6cfc3.png"}}}],"visibility":"show","key":"F1DYdQMUlV"}],"visibility":"show","key":"haEA1meWe6"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is an animation of the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l0jRLIxJVs"}],"key":"yisfoDipc1"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"p5lmB8LBIQ"}],"key":"t06x9uFlB8"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EjLPoFLp4d"},{"type":"inlineCode","value":"clims","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"G3vtGQAcTx"},{"type":"text","value":" are set so that colors remain at fixed values throughout the animation.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cVJeGpjELt"}],"key":"ncDGkKiBig"}],"class":"dropdown","key":"Be3S1fTXMt"}],"key":"h75dvRCjpJ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"title('Heat equation on a periodic domain')\nvid = VideoWriter(\"figures/2d-heat.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 0.2, 61)\n    cla, surf(X', Y', U(t)')\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-0.9, 0.75, 2, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"MhYXAQJ21w"},{"type":"output","id":"s4GKsABqdptVbfsTKEeHi","data":[],"visibility":"remove","key":"TtlEYi5hIy"}],"visibility":"show","key":"HSZXfviO2F"}],"key":"fYtqH0ARMo"},{"type":"image","url":"/build/2d-heat-0aee05c174707843368b3c81139442bf.mp4","alt":"Heat equation in 2D","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"urlSource":"../../matlab/2d-heat.mp4","key":"nRjdE5jrVd"}],"key":"xG30iqDD3p"}],"key":"kkTchEtwAb"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Heat equation in 2D","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"bnJRcyF1v9"}],"key":"A2KLPDQ7jI"},{"type":"include","file":"python/heat.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:31:27.870854Z","iopub.status.busy":"2025-01-09T20:31:27.870758Z","iopub.status.idle":"2025-01-09T20:31:28.356853Z","shell.execute_reply":"2025-01-09T20:31:28.356558Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"jQ0LirF2wV"},{"type":"output","id":"B6W9R2Der8MV3-ILolpip","data":[],"visibility":"show","key":"iHK6DCWQ6a"}],"visibility":"remove","key":"qGoEPv2kFl"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"NzHpFJwFvl"},{"type":"text","value":"13.2.2","key":"AUsaXIpzEG"}],"key":"L0PMhNmBrC"}],"identifier":"demo-diffadv-heat","label":"demo-diffadv-heat","kind":"proof:example","template":"Example %s","enumerator":"13.2.2","resolved":true,"html_id":"demo-diffadv-heat","key":"kAVrNDLTaF"}],"key":"hNX2zkP3nW"}],"key":"dxWL2af5Sk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:31:28.358635Z","iopub.status.busy":"2025-01-09T20:31:28.358453Z","iopub.status.idle":"2025-01-09T20:31:28.361739Z","shell.execute_reply":"2025-01-09T20:31:28.361468Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"m, n = 60, 40\nx, Dx, Dxx = FNC.diffper(m, [-1, 1])\ny, Dy, Dyy = FNC.diffper(n, [-1, 1])\nmtx, X, Y, vec, unvec, _ = FNC.tensorgrid(x, y)","key":"hShpoduxjK"},{"type":"output","id":"m9t598PuvD3D0IWYe_jm5","data":[],"key":"B78RIbSogu"}],"key":"RffKl1SDte"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that the initial condition should also be periodic on the domain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nS7RrYqawD"}],"key":"BFIGOH7OU4"}],"key":"YqSSH6qI1P"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:31:28.363142Z","iopub.status.busy":"2025-01-09T20:31:28.363028Z","iopub.status.idle":"2025-01-09T20:31:28.624024Z","shell.execute_reply":"2025-01-09T20:31:28.623725Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"u_init = lambda x, y: sin(4 * pi * x) * exp(cos(pi * y))\nU0 = mtx(u_init)\nmx = max(abs(U0))\npcolormesh(X, Y, U0, vmin=-mx, vmax=mx, cmap=\"RdBu\", shading=\"gouraud\")\naxis(\"equal\"),  colorbar()\nxlabel(\"$x$\"),  ylabel(\"$y$\")\ntitle(\"Initial condition\");","key":"fXTPWgVMqC"},{"type":"output","id":"ZjKca0vMEzW7GQJUPNWfE","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7097a172375616d3915f63c7e233b3fd","path":"/build/7097a172375616d3915f63c7e233b3fd.png"},"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"z25Tudtbsc"}],"key":"NY7ARtPbUz"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This function computes the time derivative for the unknowns. The actual calculations take place using the matrix shape.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FA6JcSLWYp"}],"key":"ftjSsbKP3G"}],"key":"uI8WvaUcNN"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:31:28.625701Z","iopub.status.busy":"2025-01-09T20:31:28.625599Z","iopub.status.idle":"2025-01-09T20:31:28.627810Z","shell.execute_reply":"2025-01-09T20:31:28.627532Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"alpha = 0.1\ndef du_dt(t, u):\n    U = unvec(u)\n    Uyy = Dxx @ U\n    Uxx = U @ Dyy.T\n    dU_dt = alpha * (Uxx + Uyy)  # PDE\n    return vec(dU_dt)","key":"XEvfPM7dbG"},{"type":"output","id":"FbH_wC5SmDJr6MFWRJmuB","data":[],"key":"iHN4AXKULj"}],"key":"QQw7J9aSis"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since this problem is parabolic, a stiff integrator is appropriate.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zZfS5gujiC"}],"key":"gyX3GSYyTZ"}],"key":"jfNqtr7uAW"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:31:28.629116Z","iopub.status.busy":"2025-01-09T20:31:28.629026Z","iopub.status.idle":"2025-01-09T20:31:30.498560Z","shell.execute_reply":"2025-01-09T20:31:30.498243Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nsol = solve_ivp(du_dt, (0, 0.2), vec(U0), method=\"BDF\", dense_output=True)\nU = lambda t: unvec(sol.sol(t))\n\npcolormesh(X.T, Y.T, U(0.02).T, \n    vmin=-mx, vmax=mx, cmap=\"RdBu\", shading=\"gouraud\")\naxis(\"equal\"),  colorbar()\nxlabel(\"$x$\"),  ylabel(\"$y$\")\ntitle(\"Heat equation, t=0.02\")","key":"gQjXZa8Ss1"},{"type":"output","id":"VGjNK0XIsdE0e-NNnFfud","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"00ce65773ac430c68cfbaaef4cab4cd9","path":"/build/00ce65773ac430c68cfbaaef4cab4cd9.png"},"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"wcrADHDN5P"}],"key":"BuckmfkE4S"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is an animation of the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kr4fRg3pDx"}],"key":"mEknPU5dQF"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"VgXi5JNoDk"}],"key":"QACMBKjtbU"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Here ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"GkrfXD27hD"},{"type":"inlineCode","value":"clims","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"d6tpkhpTJy"},{"type":"text","value":" are set so that colors remain at fixed values throughout the animation.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rbSY1U042L"}],"key":"KokYPXonmi"}],"class":"dropdown","key":"OWlvyHopIo"}],"key":"J8qtgG0H0s"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:31:30.500458Z","iopub.status.busy":"2025-01-09T20:31:30.500318Z","iopub.status.idle":"2025-01-09T20:31:32.520393Z","shell.execute_reply":"2025-01-09T20:31:32.519934Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\nobj = ax.pcolormesh(X, Y, U(0), vmin=-mx, vmax=mx, cmap=\"RdBu\", shading=\"gouraud\")\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\"),  ax.set_ylabel(\"$y$\")\nax.set_aspect(\"equal\")\nax.set_title(\"Heat equation on a periodic domain\")\ndef snapshot(t):\n    global obj\n    obj.remove()\n    obj = ax.pcolormesh(X, Y, U(t), vmin=-mx, vmax=mx, cmap=\"RdBu\", shading=\"gouraud\")\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(fig, snapshot, frames=linspace(0, 0.2, 121))\nanim.save(\"heat-2d.mp4\", fps=30)\nclose()\n","key":"E4YxFSijS3"},{"type":"output","id":"NPuFfcy2IgIpTXHoKV9Wq","data":[{"ename":"AttributeError","evalue":"'Axes' object has no attribute 'surface'","output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)\nCell \u001b[0;32mIn[18], line 3\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mmatplotlib\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m animation\n\u001b[1;32m      2\u001b[0m fig, ax \u001b[38;5;241m=\u001b[39m subplots()\n\u001b[0;32m----> 3\u001b[0m obj \u001b[38;5;241m=\u001b[39m \u001b[43max\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43msurface\u001b[49m(X, Y, U(\u001b[38;5;241m0\u001b[39m), vmin\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m-\u001b[39mmx, vmax\u001b[38;5;241m=\u001b[39mmx, cmap\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mRdBu\u001b[39m\u001b[38;5;124m\"\u001b[39m, shading\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mgouraud\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m      4\u001b[0m time_text \u001b[38;5;241m=\u001b[39m ax\u001b[38;5;241m.\u001b[39mtext(\u001b[38;5;241m0.05\u001b[39m, \u001b[38;5;241m0.9\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m, transform\u001b[38;5;241m=\u001b[39max\u001b[38;5;241m.\u001b[39mtransAxes)\n\u001b[1;32m      5\u001b[0m ax\u001b[38;5;241m.\u001b[39mset_xlabel(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m$x$\u001b[39m\u001b[38;5;124m\"\u001b[39m),  ax\u001b[38;5;241m.\u001b[39mset_ylabel(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m$y$\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\n\u001b[0;31mAttributeError\u001b[0m: 'Axes' object has no attribute 'surface'"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"254a70947f8fed19d6730b9988d38419","path":"/build/254a70947f8fed19d6730b9988d38419.png"},"text/plain":{"content":"<Figure size 700x400 with 1 Axes>","content_type":"text/plain"}}}],"key":"EouGpeBRjd"}],"key":"CpBODs5LI7"}],"key":"ROyAhhJrFW"},{"type":"image","url":"/build/heat-2d-713039500e718d80eb355f76608e4696.mp4","alt":"Heat equation in 2D","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"urlSource":"python/heat-2d.mp4","key":"B9gkHhY30X"}],"key":"kZOjgxiPAC"}],"key":"ATEu9Mcbvt"}],"key":"HKyYLWcAjJ"}],"label":"demo-diffadv-heat","identifier":"demo-diffadv-heat","html_id":"demo-diffadv-heat","indexEntries":[{"entry":"heat equation","emphasis":false}],"enumerator":"13.2.2","key":"KTOUJHNY2r"},{"type":"heading","depth":2,"position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"children":[{"type":"text","value":"Dirichlet conditions","position":{"start":{"line":130,"column":1},"end":{"line":130,"column":1}},"key":"aMSCU5kM6W"}],"identifier":"dirichlet-conditions","label":"Dirichlet conditions","html_id":"dirichlet-conditions","implicit":true,"enumerator":"13.2.3","key":"k2rq9MvJnL"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"x0ar5DMFfL"},{"type":"link","kind":"numref","identifier":"section-diffusion-boundaries","label":"section-diffusion-boundaries","url":"/boundaries","internal":true,"dataUrl":"/boundaries.json","children":[{"type":"text","value":"Boundaries","key":"NuuEduRD8L"}],"key":"Py52kNwawl"},{"type":"text","value":" we coped with boundary conditions by removing the boundary values from the vector of unknowns being solved in the semidiscretized ","key":"aT9kisIdLd"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"fjAPF0unBp"}],"key":"EsvYSVjNox"},{"type":"text","value":". Each evaluation of the time derivative required us to extend the values to include the boundaries before applying differentiation matrices in space. We proceed similarly here, except that we have changes in the shape as well as boundary conditions to consider.","key":"eM7dEM2rWu"}],"indexEntries":[{"entry":"boundary conditions","subEntry":{"value":"numerical implementation of","kind":"entry"},"emphasis":false}],"label":"index-T0t6rrIun6","identifier":"index-t0t6rriun6","html_id":"index-t0t6rriun6","key":"oPiB7LVyee"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Suppose we are given a matrix ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"HBSQTzjFmA"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"tbiAuAlxZl"},{"type":"text","value":" that represents the solution on an ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"NIpRz12LxW"},{"type":"inlineMath","value":"(m+1)\\times (n+1)","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(m+1)\\times (n+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"UChAW79GEv"},{"type":"text","value":" grid, including boundary values. Then we define","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"NPPcQ3i9v8"}],"key":"ZYOBsokiwc"},{"type":"math","value":"\\operatorname{pack}(\\mathbf{U}) = \\operatorname{vec}(\\mathbf{E}_x \\mathbf{U} \\mathbf{E}_y^T),","label":"tpdeletion","identifier":"tpdeletion","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">pack</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">U</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"normal\">vec</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi mathvariant=\"bold\">E</mi><mi>x</mi></msub><mi mathvariant=\"bold\">U</mi><msubsup><mi mathvariant=\"bold\">E</mi><mi>y</mi><mi>T</mi></msubsup><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\operatorname{pack}(\\mathbf{U}) = \\operatorname{vec}(\\mathbf{E}_x \\mathbf{U} \\mathbf{E}_y^T),</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">pack</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">U</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2744em;vertical-align:-0.3831em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">vec</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathbf\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">U</span><span class=\"mord\"><span class=\"mord mathbf\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3831em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"13.2.4","html_id":"tpdeletion","key":"ahuJIpwLMC"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"where","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"vPEzUBaeHM"}],"key":"fEXc9CjxoQ"},{"type":"math","value":"\\mathbf{E}_x = \\begin{bmatrix}\n  0 & 1 & 0 & \\cdots & 0 & 0 \\\\\n  0 & 0 & 1 & \\cdots & 0 & 0 \\\\\n   &  &  & \\ddots &  & \\\\\n  0 & 0 & 0 & \\cdots & 1 & 0\n\\end{bmatrix}","position":{"start":{"line":146,"column":1},"end":{"line":153,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">E</mi><mi>x</mi></msub><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mo lspace=\"0em\" rspace=\"0em\">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\mathbf{E}_x = \\begin{bmatrix}\n  0 &amp; 1 &amp; 0 &amp; \\cdots &amp; 0 &amp; 0 \\\\\n  0 &amp; 0 &amp; 1 &amp; \\cdots &amp; 0 &amp; 0 \\\\\n   &amp;  &amp;  &amp; \\ddots &amp;  &amp; \\\\\n  0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 1 &amp; 0\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.8001em;vertical-align:-2.15em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋱</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"minner\">⋯</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-1.711em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-2.858em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span style=\"height:1.216em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='1.216em' style='width:0.6667em' viewBox='0 0 666.67 1216' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z'/></svg></span></span><span style=\"top:-4.7111em;\"><span class=\"pstrut\" style=\"height:3.216em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"13.2.5","key":"FqUHgs677m"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"is ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"L4mBQf4USf"},{"type":"inlineMath","value":"(m-1)\\times (m+1)","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>m</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(m-1)\\times (m+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"AN3LurCxiJ"},{"type":"text","value":", and ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"kpXj74bNFJ"},{"type":"inlineMath","value":"\\mathbf{E}_y","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">E</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{E}_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9722em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ZSmZIk3zxX"},{"type":"text","value":" is analogous but of size ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"iz3YFkU8H5"},{"type":"inlineMath","value":"(n-1)\\times (n+1)","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(n-1)\\times (n+1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"ngbrmDTFoW"},{"type":"text","value":". The left multiplication in ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"l8Q3ywaOTZ"},{"type":"crossReference","kind":"equation","identifier":"tpdeletion","label":"tpdeletion","children":[{"type":"text","value":"(","key":"LmOWadGsjN"},{"type":"text","value":"13.2.4","key":"Zhyg5lcOG2"},{"type":"text","value":")","key":"ju5xnXD3gO"}],"template":"(%s)","enumerator":"13.2.4","resolved":true,"html_id":"tpdeletion","key":"GjaGEqXXMt"},{"type":"text","value":" deletes the first and last row of ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"fSDoMjGzNr"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"MahtchS4FV"},{"type":"text","value":" and the right multiplication deletes its first and last column. All that remains, then, are the interior values, which are converted into a vector by the vec operator.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"PW4J8megK5"}],"key":"F8p1VppBOK"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"For the inverse transformation, let us be given a vector ","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"t6nFHPhYpO"},{"type":"inlineMath","value":"\\mathbf{w}","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span></span></span></span>","key":"xv4F1pDYJ6"},{"type":"text","value":" of interior solution values. Then we define","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"aFgmq6wrl8"}],"key":"Qr5WmvYUg5"},{"type":"math","value":"\\operatorname{unpack}(\\mathbf{w}) = \\mathbf{E}_x^T \\cdot \\operatorname{unvec}(\\mathbf{w}) \\cdot \\mathbf{E}_y.","position":{"start":{"line":159,"column":1},"end":{"line":161,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">unpack</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">w</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mi mathvariant=\"bold\">E</mi><mi>x</mi><mi>T</mi></msubsup><mo>⋅</mo><mi mathvariant=\"normal\">unvec</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">w</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><msub><mi mathvariant=\"bold\">E</mi><mi>y</mi></msub><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\operatorname{unpack}(\\mathbf{w}) = \\mathbf{E}_x^T \\cdot \\operatorname{unvec}(\\mathbf{w}) \\cdot \\mathbf{E}_y.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">unpack</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1383em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">unvec</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9722em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"13.2.6","key":"ZqT6Ao4GnL"},{"type":"paragraph","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"This operator reshapes the vector to a grid of interior values, then appends one extra zero row and column on each side of the grid.","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"wtsKTrpEFZ"},{"type":"footnoteReference","identifier":"jacobian","label":"jacobian","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"number":1,"enumerator":"1","key":"NBLJo4IEmL"}],"key":"peSfLapnK7"},{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"Now suppose the ","key":"b4OUtm4t9B"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"SMXq3g7hZX"}],"key":"XxtjYa0AhT"},{"type":"text","value":" unknowns for the interior solution values are in the vector ","key":"zSq5jYWGsd"},{"type":"inlineMath","value":"\\mathbf{w}(t)","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"cKeKt73Pl5"},{"type":"text","value":". When we form ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"GVTHigWhAM"},{"type":"inlineMath","value":"\\operatorname{unpack}(\\mathbf{w})","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">unpack</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">w</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\operatorname{unpack}(\\mathbf{w})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">unpack</span></span><span class=\"mopen\">(</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"mclose\">)</span></span></span></span>","key":"Oh62sxJv9C"},{"type":"text","value":", we reinterpret the values on the tensor-product grid and then extend these values to zero around the boundary. If the boundary values are given as ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"GIrZpsQwiJ"},{"type":"inlineMath","value":"g(x,y)","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">g(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"npezjp8pg7"},{"type":"text","value":", then ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"YHpqFDmXiR"},{"type":"inlineMath","value":"g","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>g</mi></mrow><annotation encoding=\"application/x-tex\">g</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span>","key":"qHKdY2Ki3P"},{"type":"text","value":" has to be evaluated at the boundary nodes of the grid and inserted into the grid function matrix. Then the grid values are used to compute partial derivatives in ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"HiJFSu9kom"},{"type":"inlineMath","value":"x","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"eqCJaOtBvX"},{"type":"text","value":" and ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"CHm4KzpBm8"},{"type":"inlineMath","value":"y","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"SvyVRAbmuv"},{"type":"text","value":", the discrete form of the ","key":"nzLoTPTQIn"},{"type":"abbreviation","title":"partial differential equation","children":[{"type":"text","value":"PDE","key":"UxKnsMX8Pi"}],"key":"xeBtr2GPIg"},{"type":"text","value":" is evaluated, and we pack the result as the computation of ","key":"b0lL7MNl6o"},{"type":"inlineMath","value":"\\mathbf{w}'","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">w</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}&#x27;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span>","key":"GXYe7YU8Tn"},{"type":"text","value":".","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"P34EENWUny"}],"key":"vL75PwJ2rb"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Advection-diffusion equation in 2D","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"CqEfwJtQad"}],"key":"HN2sOyeEZU"},{"type":"include","file":"julia/advdiff.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"qwf0dsxCZe"},{"type":"text","value":"13.2.3","key":"u3GOlYfzwL"}],"key":"F7VqEgcaGX"}],"identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","kind":"proof:example","template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","key":"mUukZZqaZK"}],"key":"mObTXlfc79"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The first step is to define a discretization of the domain.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rFiN9FvHok"}],"key":"L9TC5AiZuH"}],"key":"qzXDdOl1Hh"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:42:48.533000Z","iopub.status.busy":"2025-01-14T15:42:30.526000Z","iopub.execute_input":"2025-01-14T15:42:34.581000Z","shell.execute_reply":"2025-01-14T15:42:48.526000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = 50, 36\nx, Dx, Dxx = FNC.diffcheb(m, [-1, 1])\ny, Dy, Dyy = FNC.diffcheb(n, [-1, 1])\nmtx, X, Y, _ = FNC.tensorgrid(x, y)\nU₀ = mtx( (x, y) -> (1 + y) * (1 - x)^4 * (1 + x)^2 * (1 - y^4) );","key":"I3tsUi8nHp"},{"type":"output","id":"clzMiNc0triVfkFDgD1vV","data":[],"key":"L3BUz98QSr"}],"key":"TihDpw8B8o"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are really two grids now: the full grid and the subset grid of interior points. Since the ","key":"QBYGI32sod"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"NyRhvyuKkg"}],"key":"oxFVDkizfs"},{"type":"text","value":" unknowns are on the interior grid, that is the one we need to change shapes on. We also need the functions ","key":"srTbUC7PjA"},{"type":"inlineCode","value":"extend","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JvMosaEsEz"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n4jbLFr6ap"},{"type":"inlineCode","value":"chop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T7Ifzmsdfa"},{"type":"text","value":" to add and remove boundary values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xBQq1cgqWJ"}],"key":"VU6FbuGTld"}],"key":"uUvAyu9gJJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:42:52.643000Z","iopub.status.busy":"2025-01-14T15:42:48.632000Z","iopub.execute_input":"2025-01-14T15:42:48.632000Z","shell.execute_reply":"2025-01-14T15:42:52.642000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"chop = U -> U[2:m, 2:n]\nextend = U -> [zeros(m+1) [zeros(1, n-1); U; zeros(1, n-1)] zeros(m+1)]\nunvec = u -> reshape(u, m-1, n-1)\npack = U -> vec(chop(U))\nunpack = w -> extend(unvec(w))","key":"s72cyzzq6B"},{"type":"output","id":"_-dReCWIWJu20c6iEoNk-","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"#15 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"n1BIuLMbxf"}],"key":"jXj5ualNjk"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can define and solve the ","key":"FC4qOXr2lF"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"wduGV8GvhP"}],"key":"XBVWbqOvMm"},{"type":"text","value":" using a stiff solver.","key":"xAFzAmKgAV"}],"key":"k4DRyR4jrX"}],"key":"UoXwdIZDs2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:46:38.226000Z","iopub.status.busy":"2025-01-14T15:42:52.683000Z","iopub.execute_input":"2025-01-14T15:42:52.685000Z","shell.execute_reply":"2025-01-14T15:46:38.225000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nfunction dw_dt(w, ϵ, t)\n    U = unpack(w)\n    Ux, Uxx = Dx * U, Dxx * U\n    Uyy = U * Dyy'\n    du_dt = @. 1 - Ux + ϵ * (Uxx + Uyy)\n    return pack(du_dt)\nend\n\nIVP = ODEProblem(dw_dt, pack(U₀), (0.0, 2), 0.05)\nw = solve(IVP, Rodas4P());","key":"AmvZrz0wFQ"},{"type":"output","id":"ObrHNqriu8Gj7uTD-RagA","data":[],"key":"egGuMHEc5E"}],"key":"xR6XL0uZ6Q"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When we evaluate the solution at a particular value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eLymty39op"},{"type":"inlineMath","value":"t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"umJeUNKLAu"},{"type":"text","value":", we get a vector of the interior grid values. The same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"moxpMshIRt"},{"type":"inlineCode","value":"unpack","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Du4cvbTOpO"},{"type":"text","value":" function above converts this to a complete matrix of grid values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tmUNi9V2E7"}],"key":"Skuh1Uncm9"}],"key":"ve06JDsM2b"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:47:15.798000Z","iopub.status.busy":"2025-01-14T15:46:38.238000Z","iopub.execute_input":"2025-01-14T15:46:38.239000Z","shell.execute_reply":"2025-01-14T15:47:15.790000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"U = t -> unpack(w(t))\ncontour(x, y, U(0.5)';\n    fill=true,  color=:blues,  levels=20, l=0,\n    aspect_ratio=1,  xlabel=L\"x\",  ylabel=L\"y\",\n    title=\"Solution at t = 0.5\")","key":"mr6zVjlsUl"},{"type":"output","id":"Ax7BmlURVV0YA9DGnYiqH","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1cf90e735b5cf2f25932fac53af432b4","path":"/build/1cf90e735b5cf2f25932fac53af432b4.png"},"text/html":{"content_type":"text/html","hash":"219526d2e8d52a593a8fa98cfef0247e","path":"/build/219526d2e8d52a593a8fa98cfef0247e.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"ee0c11658d30962bae142ae22e24f916","path":"/build/ee0c11658d30962bae142ae22e24f916.svg"}}}],"key":"TQ3ZG99Y2Z"}],"key":"GcIJJGvJMk"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:51:09.286000Z","iopub.status.busy":"2025-01-14T15:47:15.870000Z","iopub.execute_input":"2025-01-14T15:47:15.874000Z","shell.execute_reply":"2025-01-14T15:51:09.285000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in 0:0.02:2\n    U = unpack(w(t))\n    surface(x, y, U';\n        layout=(1, 2),  size=(640, 320),\n        xlabel=L\"x\",  ylabel=L\"y\",  zaxis=((0, 2), L\"u(x,y)\"),\n        color=:blues,  alpha=0.66,  clims=(0, 2), colorbar=:none,\n        title=\"Advection-diffusion\",  dpi=150)\n    contour!(x, y, U'; \n        levels=24, \n        aspect_ratio=1,  subplot=2, \n        xlabel=L\"x\",  ylabel=L\"y\",\n        color=:blues,  clims=(0, 2),  colorbar=:none,\n        title=@sprintf(\"t = %.2f\", t))\nend\ncloseall();\nmp4(anim, \"advdiff-2d.mp4\");","key":"e06BpQaYX7"},{"type":"output","id":"4zXjL3ZLL7kzwxXJA6DUC","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter13/section2/julia/advdiff-2d.mp4\n"}],"key":"xepepFKRpa"}],"key":"fWg1rmswbb"}],"key":"jCCJRMg7Le"},{"type":"image","url":"/build/advdiff-2d-07b0acd48fddb440eb385ee51f955d82.mp4","alt":"Advection-diffusion in 2D","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"urlSource":"julia/advdiff-2d.mp4","key":"mXMfICeqps"}],"key":"osKwUQrR8p"}],"key":"miY9vqiAWF"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Advection-diffusion equation in 2D","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"vsaAlBKlUT"}],"key":"i8nYdAKI0j"},{"type":"include","file":"matlab/advdiff.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"PxcrGYqEg6"},{"type":"text","value":"13.2.3","key":"FvO467Bz5K"}],"key":"RVB5xyyDAW"}],"identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","kind":"proof:example","template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","key":"pnxmWP4Fx2"}],"key":"TIkZTm7h8l"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The first step is to define a discretization of the domain and the initial state.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LtQp3KPSbE"}],"key":"PdMdtWuYIe"}],"key":"x5XiOzMVgo"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 50;  n = 40;\n[x, Dx, Dxx] = diffcheb(m, [-1, 1]);\n[y, Dy, Dyy] = diffcheb(n, [-1, 1]);\n[mtx, X, Y] = tensorgrid(x, y);\nu_init = @(x, y) (1+y) .* (1-x).^4 .* (1+x).^2 .* (1-y.^4);","key":"EyPqOG9aTO"},{"type":"output","id":"C2q28HlPp53fRNgRMjrir","data":[],"key":"fKrONzkH35"}],"key":"qKNPseQeKt"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are really two grids now: the full grid and the subset grid of interior points. Since the ","key":"U2x6P5Q1ed"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"N6VVb6Duj8"}],"key":"t423QFckzc"},{"type":"text","value":" unknowns are on the interior grid, that is the one we need to change shapes on. We also need the functions ","key":"W9GjtxScdh"},{"type":"inlineCode","value":"extend","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"clthBbFiAJ"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GAL6MMNJb1"},{"type":"inlineCode","value":"chop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qz3dfSfNoq"},{"type":"text","value":" to add and remove boundary values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BKwOyE5RG7"}],"key":"XkcDxzNzGx"}],"key":"SdfXzeroNJ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, ~, ~, vec, unvec] = tensorgrid(x(2:m), y(2:n));\nchop = @(U) U(2:m, 2:n);\nz = zeros(1, n-1);\nextend = @(U) [ zeros(m+1, 1) [z; U; z] zeros(m+1, 1)];\npack = @(U) vec(chop(U));\nunpack = @(u) extend(unvec(u));","key":"yVGTkv0OqB"},{"type":"output","id":"6eRVPXDSIpi3IJM_VHls6","data":[],"key":"R3nKxmOyNM"}],"key":"rblDVfpoCG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can define and solve the ","key":"zXifsG0G6Q"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"Kf8JO2xkaB"}],"key":"taSKncZNCJ"},{"type":"text","value":" using a stiff solver.","key":"QDgHkB23O9"}],"key":"u8GxUgo2UV"},{"type":"include","file":"f13_2_advdiff.m","literal":true,"filter":{},"children":[{"type":"code","value":"function du_dt = timederiv(t, u, p)\n    [ep, Dx, Dxx, Dy, Dyy, pack, unpack] = p{:};\n    U = unpack(u);\n    Uxx = Dxx * U;  Uyy = U * Dyy'; \n    dU_dt = 1 - Dx * U + ep * (Uxx + Uyy);  % PDE\n    du_dt = pack(dU_dt);\nend","lang":"matlab","filename":"f13_2_advdiff.m","key":"y65iIu7GbH"}],"key":"pqDWz4j8EQ"}],"key":"dszSzCmClK"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_advdiff);\nivp.InitialTime = 0;\nivp.InitialValue = pack(mtx(u_init));\nivp.Parameters = {0.05, Dx, Dxx, Dy, Dyy, pack, unpack};\nivp.Solver = \"stiff\";\nsol = solutionFcn(ivp, 0, 2);","key":"BGvesVgpjr"},{"type":"output","id":"Dl2ERYbuNGmS1QWBOYzi2","data":[],"key":"zQFyCWZL8U"}],"key":"jzjRN6UFp0"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When we evaluate the solution at a particular value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oved86plQO"},{"type":"inlineMath","value":"t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"RDSDEBVcpZ"},{"type":"text","value":", we get a vector of the interior grid values. The same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y3wrtEyekb"},{"type":"inlineCode","value":"unpack","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fRR7TDwgRK"},{"type":"text","value":" function above converts this to a complete matrix of grid values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W8PxmatBGs"}],"key":"Vd5TTKyGxb"}],"key":"N5E16NCfBT"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"U = @(t) unpack(sol(t));\n\nclf,  pcolor(X', Y', U(0.5)')\nclim([0, 2]), shading interp\naxis equal,  colormap(sky), colorbar\ntitle('Advection-diffusion at t = 0.5')  \nxlabel('x'),  ylabel('y')  ","key":"EFtu1tdT77"},{"type":"output","id":"EuBZiWB-VCindaNyVQumb","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"975b724a0e4b73fa1d040c474859aae8","path":"/build/975b724a0e4b73fa1d040c474859aae8.png"}}}],"key":"p86NBM9wwJ"}],"key":"d0HTxOlHQn"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nvid = VideoWriter(\"figures/2d-advdiff.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 2, 81)\n    cla, pcolor(X', Y', U(t)')\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-1.5, 0.75, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"mwFKbn5bZO"},{"type":"output","id":"6yyWV8yW6kbzci7qYgdOI","data":[],"visibility":"remove","key":"Eb9LnIH2kd"}],"visibility":"show","key":"cMEns3DSTs"}],"key":"VKcq4Jsrag"},{"type":"image","url":"/build/2d-advdiff-6e9541a1ff4a828e16d205ffd5f44763.mp4","alt":"Advection-diffusion in 2D","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"urlSource":"../../matlab/2d-advdiff.mp4","key":"Bmht4eN1ab"}],"key":"MAP6VsU5lh"}],"key":"YLr1NiZalP"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Advection-diffusion equation in 2D","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"yL7gJTjsNs"}],"key":"UqXEtXrLJI"},{"type":"include","file":"python/advdiff.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:30:55.334369Z","iopub.status.busy":"2025-01-09T20:30:55.334288Z","iopub.status.idle":"2025-01-09T20:30:55.759390Z","shell.execute_reply":"2025-01-09T20:30:55.759119Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"YLswF02plc"},{"type":"output","id":"k51bSTUOrO5tvtXViAMNq","data":[],"visibility":"show","key":"JFwifybYzu"}],"visibility":"remove","key":"xbqdXVcM6n"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"Lj36HqRpAO"},{"type":"text","value":"13.2.3","key":"i2ZvZcwvIT"}],"key":"lxFhDIerlz"}],"identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","kind":"proof:example","template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","key":"xC2zVedvCZ"}],"key":"vMyMiu9rQv"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The first step is to define a discretization of the domain.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"roWBbZXuP9"}],"key":"r9oh0J7zFs"}],"key":"HEc9CAgpIy"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:30:55.760972Z","iopub.status.busy":"2025-01-09T20:30:55.760815Z","iopub.status.idle":"2025-01-09T20:30:55.766111Z","shell.execute_reply":"2025-01-09T20:30:55.765899Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"m, n = 50, 36\nx, Dx, Dxx = FNC.diffcheb(m, [-1, 1])\ny, Dy, Dyy = FNC.diffcheb(n, [-1, 1])\nmtx, X, Y, _, _, _ = FNC.tensorgrid(x, y)\nu_init = lambda x, y: (1 + y) * (1 - x)**4 * (1 + x)**2 * (1 - y**4)","key":"UdgmH3Ewfe"},{"type":"output","id":"1Oig2p6XMDQwwNvn9__FL","data":[],"key":"dZDszWHG59"}],"key":"EW1hFCzc9A"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are really two grids now: the full grid and the subset grid of interior points. Since the ","key":"pPqrCKkpml"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"fCQ9tQCz3W"}],"key":"tFw5UfOtvE"},{"type":"text","value":" unknowns are on the interior grid, that is the one we need to change shapes on. We also need the functions ","key":"QYnfCa0agI"},{"type":"inlineCode","value":"extend","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kBNAqe1prQ"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RnnC2uUjhL"},{"type":"inlineCode","value":"chop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FmufPT0y0p"},{"type":"text","value":" to add and remove boundary values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S0RrOhkWWX"}],"key":"O3bo2beraj"}],"key":"tSL10FLmzR"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:30:55.767299Z","iopub.status.busy":"2025-01-09T20:30:55.767203Z","iopub.status.idle":"2025-01-09T20:30:55.769705Z","shell.execute_reply":"2025-01-09T20:30:55.769466Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"_, _, _, vec, unvec, _ = FNC.tensorgrid(x[1:-1], y[1:-1])\n\ndef chop(U):\n    return U[1:-1, 1:-1]\n\ndef extend(U):\n    UU = zeros((m+1, n+1))\n    UU[1:-1, 1:-1] = U\n    return UU\n\npack = lambda U: vec(chop(U))          # restrict to interior, then vectorize\nunpack = lambda u: extend(unvec(u))    # unvectorize, then extend to boundary\n","key":"SOJFnessTe"},{"type":"output","id":"g6xEi2OBvTp8dA7Jl6-_v","data":[],"key":"fxwBUbSNbB"}],"key":"nE3s3K1OgT"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can define and solve the ","key":"br9S5wIK2s"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"ydZnUc5omE"}],"key":"sz8IfVdgdN"},{"type":"text","value":" using a stiff solver.","key":"tWa8Xqb1im"}],"key":"HL7GvX7l36"}],"key":"Kq2IqIloxc"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:30:55.770909Z","iopub.status.busy":"2025-01-09T20:30:55.770810Z","iopub.status.idle":"2025-01-09T20:30:56.725561Z","shell.execute_reply":"2025-01-09T20:30:56.725261Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\nep = 0.05\ndef dw_dt(t, w):\n    U = unpack(w)\n    Uyy = Dxx @ U\n    Uxx = U @ Dyy.T \n    dU_dt = 1 - Dx @ U + ep * (Uxx + Uyy)\n    return pack(dU_dt)\n\nU0 = mtx(u_init)\nsol = solve_ivp(dw_dt, (0, 2), pack(U0), method=\"BDF\", dense_output=True)","key":"VnCKbj5bHN"},{"type":"output","id":"aD8hkwE5VjqUoDN2fPrO5","data":[],"key":"c0p9yMBq6f"}],"key":"ZFj4lUYb5l"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When we evaluate the solution at a particular value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xbhJRDX7vp"},{"type":"inlineMath","value":"t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"fca4WkEENS"},{"type":"text","value":", we get a vector of the interior grid values. The same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YtzVAKXB5s"},{"type":"inlineCode","value":"unpack","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kU2fYrRlbd"},{"type":"text","value":" function above converts this to a complete matrix of grid values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M5kAaSIS9Y"}],"key":"rbk2LB1IvZ"}],"key":"EZjbMzCttP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:30:56.727064Z","iopub.status.busy":"2025-01-09T20:30:56.726968Z","iopub.status.idle":"2025-01-09T20:30:56.973655Z","shell.execute_reply":"2025-01-09T20:30:56.973357Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"U = lambda t: unpack(sol.sol(t))    # function of time on the grid\n\npcolormesh(X.T, Y.T, U(0.5).T, cmap=\"Blues\", shading=\"gouraud\")\ncolorbar()\nxlabel(\"$x$\"),  ylabel(\"$y$\")\naxis(\"equal\"),  title(\"Solution at t=0.5\");","key":"bxna3gs6L5"},{"type":"output","id":"l5rtaMWH2KjPstPMGAuU5","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"aa5e9308ab9bdc28a9ec5a90014c0339","path":"/build/aa5e9308ab9bdc28a9ec5a90014c0339.png"},"text/plain":{"content":"<Figure size 700x400 with 2 Axes>","content_type":"text/plain"}}}],"key":"FKz3FQfCVG"}],"key":"gQbcjvYcRj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:30:56.975041Z","iopub.status.busy":"2025-01-09T20:30:56.974941Z","iopub.status.idle":"2025-01-09T20:31:00.849114Z","shell.execute_reply":"2025-01-09T20:31:00.848715Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import animation\nfig, ax = subplots()\nobj = ax.pcolormesh(X.T, Y.T, U(0).T, vmin=0, vmax=2, cmap=\"Blues\", shading=\"gouraud\")\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\"),  ax.set_ylabel(\"$y$\")\nax.set_aspect(\"equal\")\nax.set_title(\"Advection-diffusion in 2d\")\ndef snapshot(t):\n    global obj\n    obj.remove()\n    obj = ax.pcolormesh(X.T, Y.T, U(t).T, vmin=0, vmax=2, cmap=\"Blues\", shading=\"gouraud\")\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = animation.FuncAnimation(fig, snapshot, frames=linspace(0, 2, 91))\nanim.save(\"advdiff-2d.mp4\", fps=30)\nclose()","key":"s3X1cx53v7"},{"type":"output","id":"e1EmS7zv6AxuNoroxKrv9","data":[],"key":"bqSR1BMjDy"}],"key":"xoRGw5fklO"}],"key":"jKHbx8p8w3"},{"type":"image","url":"/build/advdiff-2d-521fda1f8085fc025d641f960add94c6.mp4","alt":"Advection-diffusion in 2D","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"urlSource":"python/advdiff-2d.mp4","key":"xw8WsiHzxc"}],"key":"MYtCJh51z1"}],"key":"g3jzJ0slKa"}],"key":"K0iB9tVwGV"}],"label":"demo-diffadv-advdiff","identifier":"demo-diffadv-advdiff","html_id":"demo-diffadv-advdiff","indexEntries":[{"entry":"advection-diffusion equation","emphasis":false}],"enumerator":"13.2.3","key":"GuAaRATaZA"},{"type":"paragraph","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"The wave equation introduces a little additional complexity. First, we write the 2D wave equation ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"LfqS4KD546"},{"type":"inlineMath","value":"u_{tt}=c^2(u_{xx}+u_{yy})","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mrow><mi>t</mi><mi>t</mi></mrow></msub><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_{tt}=c^2(u_{xx}+u_{yy})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">tt</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"fPmp6CY78h"},{"type":"text","value":" in first-order form as","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"uqshZ5O2Ji"}],"indexEntries":[{"entry":"wave equation","emphasis":false}],"label":"index-Mh3n321Mvz","identifier":"index-mh3n321mvz","html_id":"index-mh3n321mvz","key":"VQBI4DS3Gn"},{"type":"math","value":"\\begin{split}\n    u_t &= v, \\\\\n    v_t &= c^2(u_{xx}+u_{yy}).\n\\end{split}","label":"wave2dfirst","identifier":"wave2dfirst","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>u</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>v</mi><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>v</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{split}\n    u_t &amp;= v, \\\\\n    v_t &amp;= c^2(u_{xx}+u_{yy}).\n\\end{split}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0241em;vertical-align:-1.2621em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7621em;\"><span style=\"top:-3.9221em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.3979em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2621em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7621em;\"><span style=\"top:-3.9221em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mpunct\">,</span></span></span><span style=\"top:-2.3979em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">.</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2621em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"13.2.7","html_id":"wave2dfirst","key":"QkEy7VXqZU"},{"type":"paragraph","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"Now the grid unknowns are a pair of matrices ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"xJwgh4V3ND"},{"type":"inlineMath","value":"\\mathbf{U}(t)","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">U</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"vurgQMVij8"},{"type":"text","value":" and ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"BhEaUWWF89"},{"type":"inlineMath","value":"\\mathbf{V}(t)","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"epugF0oPJm"},{"type":"text","value":". Typical boundary conditions would prescribe ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"cDjnv8tfKI"},{"type":"inlineMath","value":"u","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"EErarDO0xh"},{"type":"text","value":" on all of the boundary and let ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"GZOzyYDhO0"},{"type":"inlineMath","value":"v","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"UCGUG9qVzD"},{"type":"text","value":" be unspecified. Since the boundary values of ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"kEvvJ435m4"},{"type":"inlineMath","value":"\\mathbf{U}","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">U</span></span></span></span>","key":"QetW1Xt7UV"},{"type":"text","value":" are prescribed, those values are omitted from the semidiscretization ","key":"B5gSztANwc"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"eO5rAIGLds"}],"key":"VX61lkCZdd"},{"type":"text","value":", while all of ","key":"xBjaVxHfr6"},{"type":"inlineMath","value":"\\mathbf{V}","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">V</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{V}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">V</span></span></span></span>","key":"Gol8AQGJug"},{"type":"text","value":" is included. All of these unknowns need to be packed into and unpacked from a single vector ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"ucENgdRYfw"},{"type":"inlineMath","value":"\\mathbf{w}(t)","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">w</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{w}(t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">w</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"TZu0xip2iB"},{"type":"text","value":" for the ","key":"aqTr70rZ9v"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"P5ts9z19Xh"}],"key":"dui68tLujn"},{"type":"text","value":" solver.","key":"Ck2kNyWqBd"}],"key":"b3LdIXpu46"},{"type":"proof","kind":"example","enumerated":true,"children":[{"type":"tabSet","children":[{"type":"tabItem","title":"Julia","sync":"julia","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Wave equation in 2D","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"wWqYzH8DfG"}],"key":"DjsgdjbqG0"},{"type":"include","file":"julia/wave.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"lrv3dc8vKi"},{"type":"text","value":"13.2.4","key":"OwZHoq35uJ"}],"key":"qqCKrUNeKW"}],"identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","kind":"proof:example","template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","key":"gzTLxWew5z"}],"key":"pKmQmeuOtQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We start with the discretization and initial condition.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TPnz1YDpAh"}],"key":"vU686o1FM0"}],"key":"alrO0mAFuS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:38:45.960000Z","iopub.status.busy":"2025-01-14T15:38:31.961000Z","iopub.execute_input":"2025-01-14T15:38:34.313000Z","shell.execute_reply":"2025-01-14T15:38:45.949000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = 40, 40\nx, Dx, Dxx = FNC.diffcheb(m, [-2, 2])\ny, Dy, Dyy = FNC.diffcheb(n, [-2, 2])\nmtx, X, Y, _ = FNC.tensorgrid(x, y)\nU₀ = mtx( (x, y) -> (x + 0.2) * exp(-12 * (x^2 + y^2)) )\nV₀ = zeros(size(U₀));","key":"Mm8Hq8DUqh"},{"type":"output","id":"YKDdtOQQ_lh2UTs1UNYSd","data":[],"key":"NC8H3dffD9"}],"key":"cFl2BtSiWP"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that because ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JrK2KFgwtQ"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"tsSEru1lBs"},{"type":"text","value":" is known on the boundary, while ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dlIVSYWD4m"},{"type":"inlineMath","value":"v","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"qlabLEO0te"},{"type":"text","value":" is unknown over the full grid, there are two different sizes of vec/unvec operations. We also need to define functions to pack grid unknowns into a vector and to unpack them. When the unknowns for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XEMijsytzL"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"kKaNQMcjGn"},{"type":"text","value":" are packed, the boundary values are chopped off, and these are restored when unpacking.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m9jRf3rhG6"}],"key":"Y1JvXTOdS6"}],"key":"yhakxndNQd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:38:50.303000Z","iopub.status.busy":"2025-01-14T15:38:45.993000Z","iopub.execute_input":"2025-01-14T15:38:45.993000Z","shell.execute_reply":"2025-01-14T15:38:50.300000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"_, _, _, unvec_v, _ = FNC.tensorgrid(x, y)\n_, _, _, unvec_u, _ = FNC.tensorgrid(x[2:m], y[2:n])\nchop = U -> U[2:m, 2:n]\nextend = U -> [zeros(m+1) [zeros(1, n-1); U; zeros(1, n-1)] zeros(m+1)]\npack = (U, V) -> [vec(chop(U)); vec(V)]\nN = (m-1) * (n-1)    # number of interior unknowns\nunpack = w -> ( extend(unvec_u(w[1:N])), unvec_v(w[N+1:end]) )","key":"xlPBhvVdmK"},{"type":"output","id":"3IDL4zsQ-5CK14whxtirH","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"#13 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"lW2XxF2nya"}],"key":"vG6keUCsPi"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now define and solve the ","key":"fxFAUHJyvH"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"HSdAxk5qbn"}],"key":"nTY4OV0iYL"},{"type":"text","value":". Since this problem is hyperbolic, not parabolic, a nonstiff integrator is faster than a stiff one.","key":"WJXlzzgQVV"}],"key":"eZ2nQ59hgP"}],"key":"mOQm7UphxK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:39:23.424000Z","iopub.status.busy":"2025-01-14T15:38:50.348000Z","iopub.execute_input":"2025-01-14T15:38:50.354000Z","shell.execute_reply":"2025-01-14T15:39:23.422000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nfunction dw_dt(w, c, t)\n    U, V = unpack(w)\n    du_dt = V\n    dv_dt = c^2 * (Dxx * U + U * Dyy')\n    return pack(du_dt, dv_dt)\nend\n\nIVP = ODEProblem(dw_dt, pack(U₀, V₀), (0, 4.0), 1)\nsol = solve(IVP, Tsit5())\nU = t -> unpack(sol(t))[1]","key":"EZp6nsmJNi"},{"type":"output","id":"7wBDzGmAK5R2Orw-TUSKx","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"#15 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"Wf6Zy54hZS"}],"key":"xOlM082A6R"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:44:54.218000Z","iopub.status.busy":"2025-01-14T15:39:23.460000Z","iopub.execute_input":"2025-01-14T15:39:23.460000Z","shell.execute_reply":"2025-01-14T15:44:54.217000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in 0:4/100:4\n    Ut = U(t)\n    surface(x, y, Ut';\n        layout=(1, 2), size=(640, 320),\n        xlabel=L\"x\",  ylabel=L\"y\",  zaxis=((-0.1, 0.1), L\"u(x,y)\"),\n        color=:redsblues,  alpha=0.66,  clims=(-0.1, 0.1), colorbar=:none,\n        title=\"Wave equation\",  dpi=150)\n    contour!(x, y, Ut'; \n        levels=24,  subplot=2, \n        aspect_ratio=1,\n        xlabel=L\"x\",  ylabel=L\"y\",\n        color=:redsblues,  clims=(-0.1, 0.1), \n        colorbar=:none,  title=@sprintf(\"t = %.2f\", t))\nend\ncloseall();\nmp4(anim, \"wave-2d.mp4\");","key":"Gr6PqGURHs"},{"type":"output","id":"jeYzIxpK7AR285A2Fw0EB","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter13/section2/julia/wave-2d.mp4\n"}],"key":"SrodcdXINs"}],"key":"rn2sTFBzhv"}],"key":"HJcz9Dxts3"},{"type":"image","url":"/build/wave-2d-b958ef660ee9cdffb6fc4c637c85b575.mp4","alt":"Wave equation in 2D","position":{"start":{"line":236,"column":1},"end":{"line":236,"column":1}},"urlSource":"julia/wave-2d.mp4","key":"zHho4GI5dW"}],"key":"RJiSQmRspN"}],"key":"nWQDmwhEkU"},{"type":"tabItem","title":"MATLAB","sync":"matlab","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Wave equation in 2D","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"lq15mcbIFa"}],"key":"ihwR6tyt0A"},{"type":"include","file":"matlab/wave.ipynb","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"WdwlmGWds2"},{"type":"text","value":"13.2.4","key":"JcuGV1ufzx"}],"key":"hST5sdvY0s"}],"identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","kind":"proof:example","template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","key":"GlyOA1ZPXm"}],"key":"x0IUn3PzLr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We start with the discretization and initial condition.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yFes1kEGHA"}],"key":"fo8xpZr5em"}],"key":"vNQhIiqvT6"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 40; n = 42;\n[x, Dx, Dxx] = diffcheb(m, [-2, 2]);\n[y, Dy, Dyy] = diffcheb(n, [-2, 2]);\n[mtx, X, Y] = tensorgrid(x, y);\n\nu_init = @(x, y) (x+0.2) .* exp(-12*(x.^2 + y.^2));\nU0 = mtx(u_init);\nV0 = zeros(size(U0));","key":"iZYPrrJfF7"},{"type":"output","id":"MScl50aRn8eX8Prk1XOVD","data":[],"key":"PQz1cpgjC0"}],"key":"GFiLX4oj8F"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that because ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zx4q776eYT"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"Bb9GP4QrWw"},{"type":"text","value":" is known on the boundary, while ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FfXLBfvdME"},{"type":"inlineMath","value":"v","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"igKGsL1RjJ"},{"type":"text","value":" is unknown over the full grid, there are two different sizes of vec/unvec operations. We also need to define functions to pack grid unknowns into a vector and to unpack them. When the unknowns for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C5mapx0Mvh"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"hNpl0DY2V4"},{"type":"text","value":" are packed, the boundary values are chopped off, and these are restored when unpacking.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"chL7A2m862"}],"key":"RPEOHhCb72"}],"key":"O8V1oqjn8k"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, ~, ~, vec_v, unvec_v] = tensorgrid(x, y);\n[~, ~, ~, vec_u, unvec_u] = tensorgrid(x(2:m), y(2:n));\n\nchop = @(U) U(2:m, 2:n);\nz = zeros(1, n-1);\nextend = @(U) [ zeros(m+1, 1) [z; U; z] zeros(m+1, 1)];\npack = @(U, V) [vec_u(chop(U)); vec_v(V)];\nN = (m-1) * (n-1);\nunpack = @(u) f13_2_wave_unpack(u, N, unvec_u, unvec_v, extend);","key":"Jdxlx2QyNF"},{"type":"output","id":"aHsn9AizxpiOkJuZ9rPj-","data":[],"key":"LqrenTAaP5"}],"key":"hewflZdZTG"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"include","file":"f13_2_wave_unpack.m","literal":true,"filter":{},"children":[{"type":"code","value":"function [U, V] = unpack(w, N, unvec_u, unvec_v, extend)\n    U = extend( unvec_u(w(1:N)) );\n    V = unvec_v(w(N+1:end));\nend","lang":"matlab","filename":"f13_2_wave_unpack.m","key":"TECrcv1TZ1"}],"key":"K9mVsWyTAb"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We can now define and solve the ","key":"MmLwSEIbFy"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"bnvlyvwJom"}],"key":"SAuUEphHvN"},{"type":"text","value":". Since this problem is hyperbolic, not parabolic, a nonstiff integrator is faster than a stiff one.","key":"E1Mu6ZHNEU"}],"key":"fc5enrD7EH"},{"type":"include","file":"f13_2_wave.m","literal":true,"filter":{},"children":[{"type":"code","value":"function dw_dt = timederiv(t, w, p)\n    [Dxx, Dyy, pack, unpack] = p{:};\n    [U, V] = unpack(w);\n    dU_dt = V;\n    dV_dt = Dxx * U + U * Dyy';\n    dw_dt = pack(dU_dt, dV_dt);\nend","lang":"matlab","filename":"f13_2_wave.m","key":"w2D6t278M7"}],"key":"QLLuLDuQW3"}],"key":"gYKXnHkxbT"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"ivp = ode(ODEFcn=@f13_2_wave);\nivp.InitialTime = 0;\nivp.InitialValue = pack(U0, V0);\nivp.Parameters = {Dxx, Dyy, pack, unpack};\nivp.Solver = \"nonstiff\";\nsol = solutionFcn(ivp, 0, 4);","key":"MIirpNuU8k"},{"type":"output","id":"S2QnCrmGVx5OGA1B9jDbC","data":[],"key":"s1YAuWari4"}],"key":"He5Je3vheW"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\n[U, V] = unpack(sol(0.5));\npcolor(X', Y', U')\naxis equal,  clim([-0.1, 0.1])\ncolormap(redsblues),  shading interp\nxlabel(\"x\"),  ylabel(\"y\")\ntitle(\"Wave equation at t = 0.5\")","key":"WznlUvFUiT"},{"type":"output","id":"2pRo2ldT17OM3oQIVTQth","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dcb412f74b1e8fbb01fc7d737e049868","path":"/build/dcb412f74b1e8fbb01fc7d737e049868.png"}}}],"key":"zzjBJBFKyA"}],"key":"GKezroxGV4"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"hold on\nvid = VideoWriter(\"figures/2d-wave.mp4\",\"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor t = linspace(0, 4, 121)\n    [U, V] = unpack(sol(t));\n    cla, pcolor(X, Y, U)\n    shading interp\n    str = sprintf(\"t = %.2f\", t);\n    text(-3, 1.75, str, fontsize=14);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)\n  ","visibility":"hide","key":"BLhACwT63c"},{"type":"output","id":"nLMDJkZlOwCT187YhhR0T","data":[],"visibility":"remove","key":"synMg52edm"}],"visibility":"show","key":"irRIbP4rn8"}],"key":"mQrAprZKtn"},{"type":"image","url":"/build/2d-wave-f159408834ef27a7127ec8ddf650ed71.mp4","alt":"Wave equation in 2D","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"urlSource":"../../matlab/2d-wave.mp4","key":"gxro4wSk6l"}],"key":"y0W1X4MaJI"}],"key":"YCkfV0dtpf"},{"type":"tabItem","title":"Python","sync":"python","children":[{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Wave equation in 2D","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"xX0Dt81IPz"}],"key":"M8hr7jH1e7"},{"type":"include","file":"python/wave.ipynb","children":[{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:32:01.273346Z","iopub.status.busy":"2025-01-09T20:32:01.273060Z","iopub.status.idle":"2025-01-09T20:32:01.849514Z","shell.execute_reply":"2025-01-09T20:32:01.849097Z"},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"exec(open(\"../../../python/FNC_init.py\").read())","visibility":"show","key":"QH5R06x4Qd"},{"type":"output","id":"Dn-vPlWTSk_iNNVyD-CIk","data":[],"visibility":"show","key":"lIEbyvzoIW"}],"visibility":"remove","key":"zIRduNgJ8A"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"fheARhPAfl"},{"type":"text","value":"13.2.4","key":"DPrOFj8zYi"}],"key":"RnzgyW4Vss"}],"identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","kind":"proof:example","template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","key":"SOJy6JWPwZ"}],"key":"dq6m5g09lr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We start with the discretization and initial condition.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G0p0AiQz80"}],"key":"XpIc1u55qI"}],"key":"JlweJ1lmPr"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:32:01.851265Z","iopub.status.busy":"2025-01-09T20:32:01.851083Z","iopub.status.idle":"2025-01-09T20:32:01.858313Z","shell.execute_reply":"2025-01-09T20:32:01.858052Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"m, n = 40, 42\nx, Dx, Dxx = FNC.diffcheb(m, [-2, 2])\ny, Dy, Dyy = FNC.diffcheb(n, [-2, 2])\nmtx, X, Y, _, _, _ = FNC.tensorgrid(x, y)\n\nU0 = mtx(lambda x, y: (x + 0.2) * exp(-12 * (x**2 + y**2)))\nV0 = zeros(U0.shape)","key":"hbKhTO6WWu"},{"type":"output","id":"qIBOqOsuRxd1hDwUlcmKF","data":[],"key":"Fz3cIzMYVC"}],"key":"J6CBoRJZrQ"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that because ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ue6nX4Ejt4"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"QtZpbwb8db"},{"type":"text","value":" is known on the boundary, while ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uCm9sC9bYA"},{"type":"inlineMath","value":"v","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"XvCUvYt7qj"},{"type":"text","value":" is unknown over the full grid, there are two different sizes of vec/unvec operations. We also need to define functions to pack grid unknowns into a vector and to unpack them. When the unknowns for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fw2rm1BeMU"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"PYrlPtfgK1"},{"type":"text","value":" are packed, the boundary values are chopped off, and these are restored when unpacking.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J1il8di2Ec"}],"key":"lKDahY8gSp"}],"key":"Lm3MZJyAu2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:32:01.859659Z","iopub.status.busy":"2025-01-09T20:32:01.859548Z","iopub.status.idle":"2025-01-09T20:32:01.863503Z","shell.execute_reply":"2025-01-09T20:32:01.863191Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"_, _, _, vec_v, unvec_v, _ = FNC.tensorgrid(x, y)\n_, _, _, vec_u, unvec_u, _ = FNC.tensorgrid(x[1:-1], y[1:-1])\n\ndef extend(U):\n    UU = zeros((m+1, n+1))\n    UU[1:-1, 1:-1] = U\n    return UU\n\ndef chop(U):\n    return U[1:-1, 1:-1]\n\ndef pack(U, V): \n    return hstack([vec_u(chop(U)), vec_v(V)])\n\nN = (m-1) * (n-1)\ndef unpack(w):\n    U = extend(unvec_u(w[:N]))\n    V = unvec_v(w[N:])\n    return U, V","key":"sKZcb6kKr1"},{"type":"output","id":"Vxzn9vQuMi-lS_e10YWPR","data":[],"key":"oYLUYdNq3w"}],"key":"HH99ks3ock"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now define and solve the ","key":"iKR4eVTvxV"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"Hfz43GLj3d"}],"key":"wZl7aR5dNO"},{"type":"text","value":". Since this problem is hyperbolic, not parabolic, a nonstiff integrator is faster than a stiff one.","key":"lccPSQidag"}],"key":"ywqGIcOJxj"}],"key":"sHTHpHY5F7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:32:01.864817Z","iopub.status.busy":"2025-01-09T20:32:01.864726Z","iopub.status.idle":"2025-01-09T20:32:02.171138Z","shell.execute_reply":"2025-01-09T20:32:02.170412Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from scipy.integrate import solve_ivp\ndef dw_dt(t, w):\n    U, V = unpack(w)\n    dU_dt = V\n    dV_dt = Dxx @ U + U @ Dyy.T\n    return pack(dU_dt, dV_dt)\n\nfrom scipy.integrate import solve_ivp\nsol = solve_ivp(dw_dt, (0, 4), pack(U0, V0), method=\"RK45\", dense_output=True)\nU = lambda t: unpack(sol.sol(t))[0]","key":"iwSM7AHW92"},{"type":"output","id":"PkjANl3vnysVvi2B23-oG","data":[],"key":"bzvPMdR5XM"}],"key":"PTDjd3q2Zu"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2025-01-09T20:32:02.175781Z","iopub.status.busy":"2025-01-09T20:32:02.175474Z","iopub.status.idle":"2025-01-09T20:32:07.510706Z","shell.execute_reply":"2025-01-09T20:32:07.510266Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib.animation import FuncAnimation\nfig, ax = subplots()\nobj = ax.pcolormesh(X, Y, U(0), vmin=-0.1, vmax=0.1, cmap=\"RdBu\", shading=\"gouraud\")\ntime_text = ax.text(0.05, 0.9, '', transform=ax.transAxes)\nax.set_xlabel(\"$x$\"),  ax.set_ylabel(\"$y$\")\nax.set_aspect(\"equal\")\nax.set_title(\"Wave equation in 2d\")\n\ndef snapshot(t):\n    global obj\n    obj.remove()\n    obj = ax.pcolormesh(X, Y, U(t), vmin=-0.1, vmax=0.1, cmap=\"RdBu\", shading=\"gouraud\")\n    time_text.set_text(f\"t = {t:.2f}\")\n\nanim = FuncAnimation(fig, snapshot, frames=linspace(0, 4, 91))\nanim.save(\"wave-2d.mp4\", fps=30);\nclose()","key":"nm6yhWqZrm"},{"type":"output","id":"9qt6wZO0MiyZ2KyTAlT8I","data":[],"key":"yOz8MjZ3Bj"}],"key":"zzSPCedfv4"}],"key":"cVw1qDxBTl"},{"type":"image","url":"/build/wave-2d-d79033bc9a3c1765ce7de2da9a36ff51.mp4","alt":"Wave equation in 2D","position":{"start":{"line":257,"column":1},"end":{"line":257,"column":1}},"urlSource":"python/wave-2d.mp4","key":"SK68mG3RVu"}],"key":"YfDC9DGLbS"}],"key":"llmSYiSM8L"}],"key":"QbI4AzIxF6"}],"label":"demo-diffadv-wave","identifier":"demo-diffadv-wave","html_id":"demo-diffadv-wave","enumerator":"13.2.4","key":"kdXW7m8Fsl"},{"type":"heading","depth":2,"position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":264,"column":1},"end":{"line":264,"column":1}},"key":"an3v5DxZJ1"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"enumerator":"13.2.4","key":"djnor3f94H"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":266,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":266,"column":1},"end":{"line":273,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"children":[{"type":"text","value":"⌨  For the given ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"eP17kDHMJS"},{"type":"inlineMath","value":"u(x,y)","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"Mrb9ptdiaQ"},{"type":"text","value":", make a plot of the given quantity on the square ","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"CSRx4vGciO"},{"type":"inlineMath","value":"[-2,2]^2","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>2</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">[-2,2]^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"DKdX8y5eFd"},{"type":"text","value":" using appropriate differentiation matrices.","position":{"start":{"line":266,"column":1},"end":{"line":266,"column":1}},"key":"gIlS3LoWas"}],"key":"fwr0NRl2fg"},{"type":"paragraph","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"strong","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"M6Z8YxLT16"}],"key":"ldsn2cJFno"},{"type":"text","value":" ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"shATefsI1g"},{"type":"inlineMath","value":"u(x,y) = \\exp(x-y^2)","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y) = \\exp(x-y^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"wOwCBM0A2Z"},{"type":"text","value":"; plot ","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"key":"eXZucxrapb"},{"type":"inlineMath","value":"u_{xx}+u_{yy}","position":{"start":{"line":268,"column":1},"end":{"line":268,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">u_{xx}+u_{yy}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"fkFCv9TORO"}],"key":"QPex90WZLb"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"strong","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"AzBFYMvveC"}],"key":"Urmu5diQIP"},{"type":"text","value":" ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"EARDO4CctJ"},{"type":"inlineMath","value":"u(x,y) =\\cos (\\pi x)+\\sin (\\pi y)","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>π</mi><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y) =\\cos (\\pi x)+\\sin (\\pi y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"I9zjeT9LyQ"},{"type":"text","value":"; plot ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"OrxEC9c68R"},{"type":"inlineMath","value":"u_x+u_y","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>x</mi></msub><mo>+</mo><msub><mi>u</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">u_x+u_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rE0MRU4W9i"}],"key":"swUeL8gpgm"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"strong","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"(c)","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"yoOTC9gy0F"}],"key":"ruf3W0THmH"},{"type":"text","value":" ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"KFVtyllbNY"},{"type":"inlineMath","value":"u(x,y) =\\exp(-x^2-4y^2)","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>4</mn><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y) =\\exp(-x^2-4y^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">4</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"zPNzrcRjE1"},{"type":"text","value":"; plot ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"SV5meDhItt"},{"type":"inlineMath","value":"x u_y","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><msub><mi>u</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">x u_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7167em;vertical-align:-0.2861em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PDjqqmmlXj"}],"key":"boQFAUf0Y4"}],"key":"cPU1BB9zEE"},{"type":"listItem","spread":true,"position":{"start":{"line":274,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"⌨ Following ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"msl0WaTrvv"},{"type":"crossReference","kind":"proof:example","identifier":"demo-diffadv-heat","label":"demo-diffadv-heat","children":[{"type":"text","value":"Demo ","key":"ds2DMv4Ivx"},{"type":"text","value":"13.2.2","key":"lyXjGHivWG"}],"template":"Example %s","enumerator":"13.2.2","resolved":true,"html_id":"demo-diffadv-heat","key":"KYYq6GwuQl"},{"type":"text","value":" as a model, solve the Allen–Cahn equation ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"l70X9EdWU8"},{"type":"inlineMath","value":"u_t=u(1-u^2)+0.001(u_{xx}+u_{yy})","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><mi>u</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msup><mi>u</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo>+</mo><mn>0.001</mn><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_t=u(1-u^2)+0.001(u_{xx}+u_{yy})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0.001</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"NyUqa2QDeE"},{"type":"text","value":" on the square ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"VwFbHPaG3T"},{"type":"inlineMath","value":"[-1,1]^2","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">[-1,1]^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"l8FuSo9abw"},{"type":"text","value":" with periodic conditions, taking ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"dxco6zOPcB"},{"type":"inlineMath","value":"u(x,y,0)=\\sin(\\pi x)\\cos(2\\pi y)","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>sin</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>π</mi><mi>x</mi><mo stretchy=\"false\">)</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>π</mi><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y,0)=\\sin(\\pi x)\\cos(2\\pi y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">sin</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"zuJdTyHPNw"},{"type":"text","value":". Use ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"Ju1eSqCTnG"},{"type":"inlineMath","value":"m=n=60","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>=</mo><mn>60</mn></mrow><annotation encoding=\"application/x-tex\">m=n=60</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">60</span></span></span></span>","key":"XNQMK5qQTy"},{"type":"text","value":" to solve up to ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"hHP7r4egDW"},{"type":"inlineMath","value":"t=4","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">t=4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span></span></span></span>","key":"ykKxXCYytF"},{"type":"text","value":", and make an animation of the result.","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"ISBgzYFgN3"}],"key":"MJ717Xo5qV"}],"key":"XAywHMVwop"},{"type":"listItem","spread":true,"position":{"start":{"line":277,"column":1},"end":{"line":278,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"children":[{"type":"text","value":"⌨ Following ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"RAzMSCfBjO"},{"type":"crossReference","kind":"proof:example","identifier":"demo-diffadv-advdiff","label":"demo-diffadv-advdiff","children":[{"type":"text","value":"Demo ","key":"RZpvGdh5ay"},{"type":"text","value":"13.2.3","key":"wqsoSs3GRb"}],"template":"Example %s","enumerator":"13.2.3","resolved":true,"html_id":"demo-diffadv-advdiff","key":"qDc06V21MZ"},{"type":"text","value":" as a model, solve ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"aX7OhVEFkn"},{"type":"inlineMath","value":"u_t=y u_x-u_y+0.03(u_{xx}+u_{yy})","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><mi>y</mi><msub><mi>u</mi><mi>x</mi></msub><mo>−</mo><msub><mi>u</mi><mi>y</mi></msub><mo>+</mo><mn>0.03</mn><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_t=y u_x-u_y+0.03(u_{xx}+u_{yy})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0.03</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"EpnwLb9LD3"},{"type":"text","value":" on the square ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"mJgnnQv88W"},{"type":"inlineMath","value":"[-1,1]^2","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">[-1,1]^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"hJsAiMHkGR"},{"type":"text","value":", with ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"xjjajAgAEH"},{"type":"inlineMath","value":"u(x,y,0)=(1-x^2)(1-y^2)","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y,0)=(1-x^2)(1-y^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"xzK0hlMn1g"},{"type":"text","value":" and homogeneous Dirichlet boundary conditions. Use ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"pz7PJwJHwf"},{"type":"inlineMath","value":"m=n=40","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>=</mo><mn>40</mn></mrow><annotation encoding=\"application/x-tex\">m=n=40</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">40</span></span></span></span>","key":"PDOCt6TDtv"},{"type":"text","value":" to solve up to ","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"n1S6Mq1SQO"},{"type":"inlineMath","value":"t=2","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">t=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"b2E3O3SbMU"},{"type":"text","value":", and make an animation of the result.","position":{"start":{"line":277,"column":1},"end":{"line":277,"column":1}},"key":"xEj41wOY5V"}],"key":"hRAhllatur"}],"key":"iLyupFEycC"},{"type":"listItem","spread":true,"position":{"start":{"line":279,"column":1},"end":{"line":280,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"⌨ Following ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"LO8g2BP2wV"},{"type":"crossReference","kind":"proof:example","identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","children":[{"type":"text","value":"Demo ","key":"lpf0rxXTUJ"},{"type":"text","value":"13.2.4","key":"n9ZtIMiIEv"}],"template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","key":"TzpgeHjXmO"},{"type":"text","value":" as a model, solve ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"YkTsjrmUui"},{"type":"inlineMath","value":"u_{tt}=u_{xx}+u_{yy}+\\cos(7t)","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mrow><mi>t</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>7</mn><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_{tt}=u_{xx}+u_{yy}+\\cos(7t)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">tt</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8694em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">cos</span><span class=\"mopen\">(</span><span class=\"mord\">7</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"bKswvPujIN"},{"type":"text","value":" on the square ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"uM0mTTGcid"},{"type":"inlineMath","value":"[-1,1]^2","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">[-1,1]^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"WTaMoZmPXw"},{"type":"text","value":", with ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"BLinizaq5e"},{"type":"inlineMath","value":"u(x,y,0)=x(1-x^6)(1-y^2)","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>x</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msup><mi>x</mi><mn>6</mn></msup><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y,0)=x(1-x^6)(1-y^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"B2AeWRTTT5"},{"type":"text","value":", ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"uCqQeDzya9"},{"type":"inlineMath","value":"u_t(x,y,0)=0","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u_t(x,y,0)=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"bn09Js5Usi"},{"type":"text","value":", subject to homogeneous Dirichlet boundary conditions. Take ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"yTsOXntlIg"},{"type":"inlineMath","value":"m=n=60","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mi>n</mi><mo>=</mo><mn>60</mn></mrow><annotation encoding=\"application/x-tex\">m=n=60</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">60</span></span></span></span>","key":"vtsu7lqsaw"},{"type":"text","value":" to solve between ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"dCYTDBEFz8"},{"type":"inlineMath","value":"t=0","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">t=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"FuZkkwo2px"},{"type":"text","value":" and ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"BzdDniBF7J"},{"type":"inlineMath","value":"t=12","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>12</mn></mrow><annotation encoding=\"application/x-tex\">t=12</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">12</span></span></span></span>","key":"l5Q10Ztb8p"},{"type":"text","value":", and make an animation of the result.","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"rdipZW6gcz"}],"key":"GAvGi93VmH"}],"key":"oMRLLjNYAY"},{"type":"listItem","spread":true,"position":{"start":{"line":281,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"From Maxwell’s equations we can find a way to convert the wave equation to a first-order form that, unlike ","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"PBk14q2DZC"},{"type":"crossReference","kind":"equation","identifier":"wave2dfirst","label":"wave2dfirst","children":[{"type":"text","value":"(","key":"A3RNveUZfP"},{"type":"text","value":"13.2.7","key":"OzjO5Rf88t"},{"type":"text","value":")","key":"SH4oR7SsCU"}],"template":"(%s)","enumerator":"13.2.7","resolved":true,"html_id":"wave2dfirst","key":"n26qGeGfyO"},{"type":"text","value":", uses only first-order derivatives in space:","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"l2YcsBlUVz"}],"key":"j5SJ92CVoS"},{"type":"math","value":"\\begin{split}\nu_t &= c^2(v_y - w_x),\\\\\nv_t &= u_y, \\\\\nw_t &= -u_x,\n\\end{split}","label":"wave2dTM","identifier":"wave2dtm","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>u</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><msub><mi>v</mi><mi>y</mi></msub><mo>−</mo><msub><mi>w</mi><mi>x</mi></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>v</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>u</mi><mi>y</mi></msub><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>w</mi><mi>t</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msub><mi>u</mi><mi>x</mi></msub><mo separator=\"true\">,</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{split}\nu_t &amp;= c^2(v_y - w_x),\\\\\nv_t &amp;= u_y, \\\\\nw_t &amp;= -u_x,\n\\end{split}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.5241em;vertical-align:-2.0121em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5121em;\"><span style=\"top:-4.6479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.1479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.6479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0121em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.5121em;\"><span style=\"top:-4.6479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span></span></span><span style=\"top:-3.1479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span><span style=\"top:-1.6479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0121em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"13.2.8","html_id":"wave2dtm","key":"riw6G4Az1i"},{"type":"paragraph","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"subject to ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"QwB6Z3P6Br"},{"type":"inlineMath","value":"u=0","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">u=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"DYQ3eGsoaN"},{"type":"text","value":" on the boundary.","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"fytqdDp0OA"}],"key":"jPX8vUvteC"},{"type":"paragraph","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"strong","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"(a)","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"rYhMzs0V6Y"}],"key":"pzr8uRMv70"},{"type":"text","value":" ✍ Show that a solution of ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"zrEkgSJMv4"},{"type":"crossReference","kind":"equation","identifier":"wave2dtm","label":"wave2dTM","children":[{"type":"text","value":"(","key":"GZpTfjUwOE"},{"type":"text","value":"13.2.8","key":"PGOG2DUvnF"},{"type":"text","value":")","key":"CRBu1TQzZz"}],"template":"(%s)","enumerator":"13.2.8","resolved":true,"html_id":"wave2dtm","key":"EtZpVooz0u"},{"type":"text","value":" satisfies ","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"Jh3s4BlXui"},{"type":"inlineMath","value":"u_t=c^2(u_{xx}+u_{yy})","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><msub><mi>u</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub><mo>+</mo><msub><mi>u</mi><mrow><mi>y</mi><mi>y</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u_t=c^2(u_{xx}+u_{yy})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">xx</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">u</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">yy</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"Eq54NJmhho"},{"type":"text","value":".","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"Dw4cKYRoSx"}],"key":"HDLjYfV6uX"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"strong","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"(b)","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"YgvSCyUnGE"}],"key":"reBvoky5Ng"},{"type":"text","value":" ⌨ Solve ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"TdHfCfmwzK"},{"type":"crossReference","kind":"equation","identifier":"wave2dtm","label":"wave2dTM","children":[{"type":"text","value":"(","key":"KzoCmovbAm"},{"type":"text","value":"13.2.8","key":"kdRlwpuhOx"},{"type":"text","value":")","key":"MMSLzFApJE"}],"template":"(%s)","enumerator":"13.2.8","resolved":true,"html_id":"wave2dtm","key":"vZZKskoiU5"},{"type":"text","value":" with ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"QAi7SKasfx"},{"type":"inlineMath","value":"c=2","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">c=2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"z1WUFJnfGl"},{"type":"text","value":" in the rectangle ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"Tqp81GPVDv"},{"type":"inlineMath","value":"x\\in[-3,3]","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mo>−</mo><mn>3</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">x\\in[-3,3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>","key":"zeQ3XDcf1Q"},{"type":"text","value":", ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"HoXs7OOl4T"},{"type":"inlineMath","value":"y\\in[-1,1]","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">y\\in[-1,1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"g4x2MID7hY"},{"type":"text","value":", ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"Mzzgkwvs7q"},{"type":"inlineMath","value":"u(x,y,0) = \\exp(x-x^2)(9-x^2)(1-y^2)","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mn>9</mn><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">u(x,y,0) = \\exp(x-x^2)(9-x^2)(1-y^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">u</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\">9</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"BURTN3m94t"},{"type":"text","value":", and ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"Y2E0ulJqkg"},{"type":"inlineMath","value":"v=w=0","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi><mo>=</mo><mi>w</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">v=w=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"wP1hdUNOpR"},{"type":"text","value":" at ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"Vm5poNy27n"},{"type":"inlineMath","value":"t=0","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">t=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"dejJMR8CA6"},{"type":"text","value":". Use ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"rJi5ZRiIqX"},{"type":"inlineMath","value":"m=50","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding=\"application/x-tex\">m=50</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">50</span></span></span></span>","key":"HmO5LGikWD"},{"type":"text","value":" for ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"xcrRW5UJ5i"},{"type":"inlineMath","value":"x","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"lBHXrhL3S8"},{"type":"text","value":" and ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"tYYv2W3g7l"},{"type":"inlineMath","value":"n=25","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi><mo>=</mo><mn>25</mn></mrow><annotation encoding=\"application/x-tex\">n=25</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">25</span></span></span></span>","key":"fbFKr0yGrd"},{"type":"text","value":" for ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"gIZmDd6BkP"},{"type":"inlineMath","value":"y","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"BfNg0XU294"},{"type":"text","value":", solve for ","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"ZKduGfMWso"},{"type":"inlineMath","value":"0\\le t \\le 6","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">0\\le t \\le 6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">6</span></span></span></span>","key":"i7fZjZ0Auf"},{"type":"text","value":", and make an animation of the solution.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"j4I9o7wb4R"}],"key":"SCSPZZ4MhN"}],"key":"LiVarbFt8c"}],"key":"A5gBdkNMSj"},{"type":"footnoteDefinition","identifier":"jacobian","label":"jacobian","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"You might wonder why we use linear algebra to define the extension and deletion of boundary values rather than directly accessing row and column indices in the grid function. The linear algebra approach allows ","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"DDXdk6w3HN"},{"type":"inlineCode","value":"DifferentialEquations","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"CzSUImpgDa"},{"type":"text","value":" to compute the Jacobian matrix of the implicit ","key":"HN3xgjmNDh"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"ZLthAMvF5n"}],"key":"Vbv1ko88Jd"},{"type":"text","value":" solver quickly using ","key":"YQyyz4G4bt"},{"type":"emphasis","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"automatic differentiation","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"NTOtQQ3QRz"}],"key":"A6QK00X7Es"},{"type":"text","value":" tools, greatly speeding up the solution process. Since the matrices in our expressions are sparse, multiplications by them do not affect running time perceptibly.","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"ifYDbh7g3y"}],"key":"qpgzfd9PoA"}],"number":1,"enumerator":"1","key":"WiFAMHlwol"}],"key":"V11kHCVdDe"}],"key":"P2qwiS75TY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Tensor-product discretizations","url":"/tensorprod","group":"Preface"},"next":{"title":"Laplace and Poisson equations","url":"/laplace","group":"Preface"}}},"domain":"http://localhost:3000"}