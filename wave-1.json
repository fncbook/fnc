{"kind":"Notebook","sha256":"d298a3dc59a7b01509072b08c13215879ee154c0365e8f23261fee991c7f7204","slug":"wave-1","location":"/chapter13/section2/julia/wave.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1.11.2","language":"julia"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"wave.ipynb","url":"/build/wave-46b7a55ef3477ba8a85ffd0bd4a82ae2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"RErKgmM2PT"},{"type":"text","value":"13.2.4","key":"P1AgSDepHK"}],"key":"uP3xD06XsC"}],"identifier":"demo-diffadv-wave","label":"demo-diffadv-wave","kind":"proof:example","template":"Example %s","enumerator":"13.2.4","resolved":true,"html_id":"demo-diffadv-wave","remote":true,"url":"/diffadv","dataUrl":"/diffadv.json","key":"H7ZOWMqKHB"}],"key":"u1OdREnxug"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We start with the discretization and initial condition.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OZuqHKYgHC"}],"key":"nYo5HFk5TR"}],"key":"vyni1q2Ko3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:38:45.960000Z","iopub.status.busy":"2025-01-14T15:38:31.961000Z","iopub.execute_input":"2025-01-14T15:38:34.313000Z","shell.execute_reply":"2025-01-14T15:38:45.949000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"m, n = 40, 40\nx, Dx, Dxx = FNC.diffcheb(m, [-2, 2])\ny, Dy, Dyy = FNC.diffcheb(n, [-2, 2])\nmtx, X, Y, _ = FNC.tensorgrid(x, y)\nU₀ = mtx( (x, y) -> (x + 0.2) * exp(-12 * (x^2 + y^2)) )\nV₀ = zeros(size(U₀));","key":"Zx1q0EgMBu"},{"type":"output","id":"zpCru9HuKhVry-EyNkg0N","data":[],"key":"I7m9lMEgmG"}],"key":"lKFAuqylEU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note that because ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vhA77LwXBm"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"SdEezJTgDx"},{"type":"text","value":" is known on the boundary, while ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NiK3Y9jB1p"},{"type":"inlineMath","value":"v","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"jS0WuuebHS"},{"type":"text","value":" is unknown over the full grid, there are two different sizes of vec/unvec operations. We also need to define functions to pack grid unknowns into a vector and to unpack them. When the unknowns for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CrA4YzwXo9"},{"type":"inlineMath","value":"u","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>u</mi></mrow><annotation encoding=\"application/x-tex\">u</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">u</span></span></span></span>","key":"z0MEqVMWIV"},{"type":"text","value":" are packed, the boundary values are chopped off, and these are restored when unpacking.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jrutahLUQE"}],"key":"X2hUaRT7XV"}],"key":"dGVpdOkOPl"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:38:50.303000Z","iopub.status.busy":"2025-01-14T15:38:45.993000Z","iopub.execute_input":"2025-01-14T15:38:45.993000Z","shell.execute_reply":"2025-01-14T15:38:50.300000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"_, _, _, unvec_v, _ = FNC.tensorgrid(x, y)\n_, _, _, unvec_u, _ = FNC.tensorgrid(x[2:m], y[2:n])\nchop = U -> U[2:m, 2:n]\nextend = U -> [zeros(m+1) [zeros(1, n-1); U; zeros(1, n-1)] zeros(m+1)]\npack = (U, V) -> [vec(chop(U)); vec(V)]\nN = (m-1) * (n-1)    # number of interior unknowns\nunpack = w -> ( extend(unvec_u(w[1:N])), unvec_v(w[N+1:end]) )","key":"sesXo15Muq"},{"type":"output","id":"2ZsNuLqdXNMNG5tOt9tAc","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"#13 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"n1Sc7zWsIk"}],"key":"iJKDlLppuI"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now define and solve the ","key":"GVbU2SFY0P"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"KaRVOvHqPe"}],"key":"bf8nClgh7u"},{"type":"text","value":". Since this problem is hyperbolic, not parabolic, a nonstiff integrator is faster than a stiff one.","key":"KA6Rz22Wn1"}],"key":"cproW0mP1f"}],"key":"GC8FOjPWtK"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:39:23.424000Z","iopub.status.busy":"2025-01-14T15:38:50.348000Z","iopub.execute_input":"2025-01-14T15:38:50.354000Z","shell.execute_reply":"2025-01-14T15:39:23.422000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq\nfunction dw_dt(w, c, t)\n    U, V = unpack(w)\n    du_dt = V\n    dv_dt = c^2 * (Dxx * U + U * Dyy')\n    return pack(du_dt, dv_dt)\nend\n\nIVP = ODEProblem(dw_dt, pack(U₀, V₀), (0, 4.0), 1)\nsol = solve(IVP, Tsit5())\nU = t -> unpack(sol(t))[1]","key":"pxsmT1Nyef"},{"type":"output","id":"eBBxA8ne3Hve55Ntby4c9","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"#15 (generic function with 1 method)","content_type":"text/plain"}}}],"key":"ZoNSdx0HMe"}],"key":"UetWelaTnb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.status.idle":"2025-01-14T15:44:54.218000Z","iopub.status.busy":"2025-01-14T15:39:23.460000Z","iopub.execute_input":"2025-01-14T15:39:23.460000Z","shell.execute_reply":"2025-01-14T15:44:54.217000Z"}},"children":[{"type":"code","lang":"julia","executable":true,"value":"anim = @animate for t in 0:4/100:4\n    Ut = U(t)\n    surface(x, y, Ut';\n        layout=(1, 2), size=(640, 320),\n        xlabel=L\"x\",  ylabel=L\"y\",  zaxis=((-0.1, 0.1), L\"u(x,y)\"),\n        color=:redsblues,  alpha=0.66,  clims=(-0.1, 0.1), colorbar=:none,\n        title=\"Wave equation\",  dpi=150)\n    contour!(x, y, Ut'; \n        levels=24,  subplot=2, \n        aspect_ratio=1,\n        xlabel=L\"x\",  ylabel=L\"y\",\n        color=:redsblues,  clims=(-0.1, 0.1), \n        colorbar=:none,  title=@sprintf(\"t = %.2f\", t))\nend\ncloseall();\nmp4(anim, \"wave-2d.mp4\");","key":"IQAV6WdIM7"},{"type":"output","id":"_4UKPuM-xJ4VfHwew1jlO","data":[{"name":"stderr","output_type":"stream","text":"\u001b[36m\u001b[1m[ \u001b[22m\u001b[39m\u001b[36m\u001b[1mInfo: \u001b[22m\u001b[39mSaved animation to /Users/driscoll/Dropbox/Mac/Documents/GitHub/fnc-notebooks/chapter13/section2/julia/wave-2d.mp4\n"}],"key":"WbMLJElnjj"}],"key":"qqmvbxsDgf"}],"key":"Soi1EcFEYg"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Advdiff","url":"/advdiff-1","group":"Chapter 13"},"next":{"title":"Kron","url":"/kron","group":"Chapter 13"}}},"domain":"http://localhost:3000"}