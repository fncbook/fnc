{"kind":"Notebook","sha256":"519e9c43c8e62115d06cb439784ce46f4e60eb8d30678428b1ee60d0a0449fed","slug":"heatfe-1","location":"/chapter11/section2/matlab/heatFE.ipynb","dependencies":[],"frontmatter":{"numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB Kernel","language":"matlab"},"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[{"format":"ipynb","filename":"heatFE.ipynb","url":"/fnc/build/heatFE-9b90fe0540b62a5bd768c23ef521343a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demo ","key":"oeBEHHx3P0"},{"type":"text","value":"11.2.2","key":"z3CR6PZ6WZ"}],"key":"HyJgQHQYfZ"}],"identifier":"demo-methodlines-heatfe","label":"demo-methodlines-heatFE","kind":"proof:example","template":"Example %s","enumerator":"11.2.2","resolved":true,"html_id":"demo-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"nurxyTkGS0"}],"key":"WQSEiLNOwz"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Let’s implement the method of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UiLjJJbsGS"},{"type":"crossReference","kind":"proof:example","identifier":"example-methodlines-heatfe","label":"example-methodlines-heatFE","children":[{"type":"text","value":"Example ","key":"Q1g8Xh1ut5"},{"type":"text","value":"11.2.1","key":"Z3pM30yTjJ"}],"template":"Example %s","enumerator":"11.2.1","resolved":true,"html_id":"example-methodlines-heatfe","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"CyVAq8Pwdy"},{"type":"text","value":" with second-order space semidiscretization.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XLwMTkzDmI"}],"key":"ZH0mFyGV5d"}],"key":"pRZsTKZWC8"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"m = 100;  \n[x, Dx, Dxx] = diffper(m, [0, 1]);\nIx = eye(m);","key":"ZKj2A7hHku"},{"type":"output","id":"GZT4nL7DIHxGokdPvuape","data":[],"key":"YzJI2sW098"}],"key":"vlfyhpmVcA"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we set an initial condition. It isn’t mathematically periodic, but the end values and derivatives are so small that for numerical purposes it may as well be.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JelKweh7R4"}],"key":"BNY8ZDdAdK"}],"key":"UwAnkXEqxe"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"tfinal = 0.15;  n = 2400;  \ntau = tfinal / n;  t = tau * (0:n)';\nU = zeros(m, n+1);\nU(:, 1) = exp( -60*(x - 0.5).^2 );","key":"ZFPdjlcd47"},{"type":"output","id":"q8OvUaaUuAWPW5H9wxFsP","data":[],"key":"uR6N7r8ACo"}],"key":"ku7rtHiTlw"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Euler time stepping simply multiplies the solution vector by the constant matrix in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OF1o4UHCjJ"},{"type":"crossReference","kind":"equation","identifier":"eulerxx","label":"Eulerxx","children":[{"type":"text","value":"(","key":"Ku5zgPui5N"},{"type":"text","value":"11.2.6","key":"FINX4b0PHr"},{"type":"text","value":")","key":"oR1WBnsnxm"}],"template":"(%s)","enumerator":"11.2.6","resolved":true,"html_id":"eulerxx","remote":true,"url":"/methodlines","dataUrl":"/methodlines.json","key":"UpQPEoo6W8"},{"type":"text","value":" at each time step. Since that matrix is sparse, we will declare it as such, even though the run-time savings may not be detectable for this small value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LO5RvEQflq"},{"type":"inlineMath","value":"m","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"TKO4rBgAmq"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yaCNFBpEWH"}],"key":"EPQyAqinzu"}],"key":"LZrH1Jhdby"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"A = sparse(Ix + tau * Dxx);\nfor j = 1:n\n    U(:, j+1) = A * U(:,j);\nend\n\nindex_times = 1:10:31;\nshow_times = t(index_times);\nclf\nfor j = index_times\n    str = sprintf(\"t = %.2e\", t(j));\n    plot(x, U(:, j), displayname=str) \n    hold on\nend\nlegend(location=\"northwest\")\nxlabel('x'), ylabel('u(x,t)')\ntitle('Heat equation by forward Euler')","key":"VOQxwCnt4Y"},{"type":"output","id":"1-5otDzqyT7Iy5-fw_mLT","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"96cae27b80b49c84694a9360b3fa10e0","path":"/fnc/build/96cae27b80b49c84694a9360b3fa10e0.png"}}}],"key":"N5FKNGP5DD"}],"key":"JOCkthGn2m"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You see above that things seem to start well, with the initial peak widening and shrinking. But then there is a nonphysical exponential growth in the solution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hukWPy1Ix4"}],"key":"UvT4uchCoU"}],"key":"JkKlt1Ym8t"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"matlab","executable":true,"value":"M = max(abs(U), [], 1);     % max in each column\nclf,  semilogy(t, M)\nxlabel('t'), ylabel('max_x |u(x,t)|') \ntitle('Nonphysical growth')","key":"R4mlSFqt9o"},{"type":"output","id":"8VK02uPHM1eTCpUn--3yP","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3d4db4f703a7b967e524fd757eb08719","path":"/fnc/build/3d4db4f703a7b967e524fd757eb08719.png"}}}],"key":"qQtLkXPJN3"}],"key":"ntzxNjfcO6"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nindex_times = 1:101;\nplot(x, U(:, 1))\nhold on,  grid on\naxis([0, 1, -1, 2])\ntitle('Heat equation by forward Euler') \nxlabel('x'),  ylabel('u(x,t)')\nvid = VideoWriter(\"figures/diffusionFE.mp4\", \"MPEG-4\");\nvid.Quality = 85;\nopen(vid);\nfor frame = index_times\n    cla, plot(x, U(:, frame))\n    str = sprintf(\"t = %.3f\", t(frame));\n    text(0.05, 0.92, str);\n    writeVideo(vid, frame2im(getframe(gcf)));\nend\nclose(vid)","visibility":"hide","key":"Xs6p6faiLl"},{"type":"output","id":"KZ7Z3kes2AnydQlK1vlIz","data":[],"visibility":"remove","key":"qC55dweWJo"}],"visibility":"show","key":"wf35Nzj5DA"}],"key":"B7nyBUJfM4"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Unstable","url":"/unstable-5","group":"Chapter 11"},"next":{"title":"HeatBE","url":"/heatbe-1","group":"Chapter 11"}}},"domain":"http://localhost:3000"}