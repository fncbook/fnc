<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Chapter 10 - Fundamentals of Numerical Computation</title><meta property="og:title" content="Chapter 10 - Fundamentals of Numerical Computation"/><meta name="generator" content="mystmd"/><meta name="description" content="Online textbook for computational mathematics"/><meta property="og:description" content="Online textbook for computational mathematics"/><meta name="keywords" content=""/><meta name="image" content="/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.webp"/><meta property="og:image" content="/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.webp"/><link rel="stylesheet" href="/2025-06-04/build/_assets/app-PRKMAQYK.css"/><link rel="stylesheet" href="/2025-06-04/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script defer="" data-domain="fncbook.com" src="https://plausible.io/js/plausible.js"></script><link rel="icon" href="/2025-06-04/favicon.ico"/><link rel="stylesheet" href="/2025-06-04/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/2025-06-04/"><div class="p-1 mr-3 dark:bg-white dark:rounded"><img src="/2025-06-04/build/FNClogo-f49aeb0772a5106e0fc95cf3cb49725f.png" class="h-9" alt="Fundamentals of Numerical Computation" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R3iop:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode." aria-label="Toggle theme between light and dark mode."><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rdiop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://buymeacoffee.com/tobydriscoll" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Support us!</a><a href="https://github.com/fncbook/fnc/issues/new/choose" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Report a problem</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Fundamentals of Numerical Computation" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/2025-06-04/">FNC</a><a title="How to use this book" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/2025-06-04/usage">How to use this book</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preface" class="block break-words rounded py-2 grow cursor-pointer">Preface</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rfd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rfd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Key language differences" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/2025-06-04/differences">Key language differences</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="1. Introduction" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview">1. Introduction</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rnd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rnd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="2. Linear systems of equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-1">2. Linear systems of equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rrd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rrd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="3. Overdetermined linear systems" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-2">3. Overdetermined linear systems</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rvd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rvd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="4. Roots of nonlinear equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-3">4. Roots of nonlinear equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R13d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R13d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="5. Piecewise interpolation" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-4">5. Piecewise interpolation</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R17d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R17d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="6. Initial-value problems for ODEs" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-5">6. Initial-value problems for ODEs</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1bd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1bd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="7. Matrix analysis" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-6">7. Matrix analysis</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1fd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1fd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="8. Krylov methods in linear algebra" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-7">8. Krylov methods in linear algebra</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1jd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1jd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="9. Global function approximation" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-8">9. Global function approximation</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1nd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1nd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="10. Boundary-value problems" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-9">10. Boundary-value problems</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1rd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1rd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="11. Diffusion equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-10">11. Diffusion equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1vd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1vd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="12. Advection equations" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-11">12. Advection equations</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R23d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R23d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><a title="13. Two-dimensional problems" class="block break-words focus:outline outline-blue-200 outline-2 rounded py-2 grow" href="/2025-06-04/overview-12">13. Two-dimensional problems</a><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R27d8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R27d8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Appendices" class="block break-words rounded py-2 grow cursor-pointer">Appendices</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R2bd8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R2bd8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Glossary" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/2025-06-04/glossary">Glossary</a><a title="Index" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/2025-06-04/genindex">Index</a></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://github.com/fncbook/fnc" title="GitHub Repository: fncbook/fnc" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/fncbook/fnc/blob/master/julia/chapter10.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Re4fop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Chapter 10</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block text-comma"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R5kfop:" data-state="closed">Tobin A. Driscoll</button><a class="ml-1" href="mailto:driscoll@udel.edu" title="Tobin A. Driscoll &lt;driscoll@udel.edu&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1rem" height="1rem" class="inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a></span><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R6kfop:" data-state="closed">Richard J. Braun</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><h2 id="functions" class="relative group"><span class="heading-text">Functions</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#functions" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Shooting method for a two-point boundary-value problem</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">shoot.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    shoot(ϕ, xspan, g₁, g₂, init)

Shooting method to solve a two-point boundary value problem with
ODE u&#x27;&#x27; = `ϕ`(x, u, u&#x27;) for x in `xspan`, left boundary condition
`g₁`(u,u&#x27;)=0, and right boundary condition `g₂`(u,u&#x27;)=0. The
value `init` is an initial estimate for vector [u,u&#x27;] at x=a.

Returns vectors for the nodes, the solution u, and derivative u&#x27;.
&quot;&quot;&quot;
function shoot(ϕ, xspan, g₁, g₂, init, tol = 1e-5)
    # ODE posed as a first-order equation in 2 variables.
    shootivp = (v, p, x) -&gt; [v[2]; ϕ(x, v[1], v[2])]

    # Evaluate the difference between computed and target values at x=b.
    function objective(s)
        IVP = ODEProblem(shootivp, s, float.(xspan))
        sol = solve(IVP, Tsit5(), abstol = tol / 10, reltol = tol / 10)
        x = sol.t
        y = sol
        return [g₁(s...), g₂(y.u[end]...)]
    end

    # Find the unknown quantity at x=a by rootfinding.
    x = []
    y = []   # these values will be overwritten
    s = levenberg(objective, init, xtol = tol)[:, end]

    # Use the stored last solution of the IVP.
    u, du_dx = y[1, :], y[2, :]
    return x, u, du_dx
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>Because <code>x</code> and <code>y</code> are assigned empty values in line 24, when the function <code>objective</code> runs it uses those values rather than new ones in local scope. Thus, line 19 updates them to hold the latest results of the <abbr aria-label="initial-value problem" class="border-b border-dotted cursor-help" data-state="closed">IVP</abbr> solver, saving the need to solve it again after <code>levenberg</code> has finished the rootfinding.</p><p>The error tolerance in the <abbr aria-label="initial-value problem" class="border-b border-dotted cursor-help" data-state="closed">IVP</abbr> solver is kept smaller than in the rootfinder, to prevent the rootfinder from searching in a noisy landscape. Finally, note how line 28 uses destructuring of <code>eachrow(y)</code> to assign the columns of <code>y</code> to separate names.</p></div></details></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Second-order differentiation matrices</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">diffmat2.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    diffmat2(n, xspan)

Compute 2nd-order-accurate differentiation matrices on `n`+1 points
in the interval `xspan`. Returns a vector of nodes and the matrices
for the first and second derivatives.
&quot;&quot;&quot;
function diffmat2(n, xspan)
    a, b = xspan
    h = (b - a) / n
    x = [a + i * h for i in 0:n]   # nodes

    # Define most of Dₓ by its diagonals.
    dp = fill(0.5 / h, n)        # superdiagonal
    dm = fill(-0.5 / h, n)       # subdiagonal
    Dₓ = diagm(-1 =&gt; dm, 1 =&gt; dp)

    # Fix first and last rows.
    Dₓ[1, 1:3] = [-1.5, 2, -0.5] / h
    Dₓ[n+1, n-1:n+1] = [0.5, -2, 1.5] / h

    # Define most of Dₓₓ by its diagonals.
    d0 = fill(-2 / h^2, n + 1)    # main diagonal
    dp = ones(n) / h^2         # super- and subdiagonal
    Dₓₓ = diagm(-1 =&gt; dp, 0 =&gt; d0, 1 =&gt; dp)

    # Fix first and last rows.
    Dₓₓ[1, 1:4] = [2, -5, 4, -1] / h^2
    Dₓₓ[n+1, n-2:n+1] = [-1, 4, -5, 2] / h^2

    return x, Dₓ, Dₓₓ
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Chebyshev differentiation matrices</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">diffcheb.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    diffcheb(n, xspan)

Compute Chebyshev differentiation matrices on `n`+1 points in the
interval `xspan`. Returns a vector of nodes and the matrices for the
first and second derivatives.
&quot;&quot;&quot;
function diffcheb(n, xspan)
    x = [-cos(k * π / n) for k in 0:n]    # nodes in [-1,1]

    # Off-diagonal entries.
    c = [2; ones(n - 1); 2]    # endpoint factors
    dij = (i, j) -&gt; (-1)^(i + j) * c[i+1] / (c[j+1] * (x[i+1] - x[j+1]))
    Dₓ = [dij(i, j) for i in 0:n, j in 0:n]

    # Diagonal entries.
    Dₓ[isinf.(Dₓ)] .= 0         # fix divisions by zero on diagonal
    s = sum(Dₓ, dims = 2)
    Dₓ -= diagm(s[:, 1])         # &quot;negative sum trick&quot;

    # Transplant to [a,b].
    a, b = xspan
    x = @. a + (b - a) * (x + 1) / 2
    Dₓ = 2 * Dₓ / (b - a)             # chain rule

    # Second derivative.
    Dₓₓ = Dₓ^2
    return x, Dₓ, Dₓₓ
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Solution of a linear boundary-value problem</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">bvplin.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    bvplin(p, q, r, xspan, lval, rval, n)

Use finite differences to solve a linear bopundary value problem.
The ODE is u&#x27;&#x27;+`p`(x)u&#x27;+`q`(x)u = `r`(x) on the interval `xspan`,
with endpoint function values given as `lval` and `rval`. There will
be `n`+1 equally spaced nodes, including the endpoints.

Returns vectors of the nodes and the solution values.
&quot;&quot;&quot;
function bvplin(p, q, r, xspan, lval, rval, n)
    x, Dₓ, Dₓₓ = diffmat2(n, xspan)

    P = diagm(p.(x))
    Q = diagm(q.(x))
    L = Dₓₓ + P * Dₓ + Q     # ODE expressed at the nodes

    # Replace first and last rows using boundary conditions.
    z = zeros(1, n)
    A = [[1 z]; L[2:n, :]; [z 1]]
    b = [lval; r.(x[2:n]); rval]

    # Solve the system.
    u = A \ b
    return x, u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>Note that there is no need to explicitly form the row-deletion matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">E</mi></mrow><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">E</span></span></span></span></span> from <span data-state="closed"><a class="hover-link" href="/2025-06-04/linear#rowdeletion">(<!-- -->10.4.8<!-- -->)</a></span>. Since it only appears as left-multiplying <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">L</mi></mrow><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">L</span></span></span></span></span> or <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">r</mi></mrow><annotation encoding="application/x-tex">\mathbf{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">r</span></span></span></span></span>, we simply perform the row deletions as needed using indexing.</p></div></details></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Solution of a nonlinear boundary-value problem</span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">bvp.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    bvp(ϕ, xspan, g₁, g₂, init)

Finite differences to solve a two-point boundary value problem with
ODE u&#x27;&#x27; = `ϕ`(x,u,u&#x27;) for x in `xspan`, left boundary condition
`g₁`(u,u&#x27;)=0, and right boundary condition `g₂`(u,u&#x27;)=0. The value
`init` is an initial estimate for the values of the solution u at
equally spaced values of x, which also sets the number of nodes.

Returns vectors for the nodes and the values of u.
&quot;&quot;&quot;
function bvp(ϕ, xspan, g₁, g₂, init)
    n = length(init) - 1
    x, Dₓ, Dₓₓ = diffmat2(n, xspan)
    h = x[2] - x[1]

    function residual(u)
        # Residual of the ODE at the nodes.
        du_dx = Dₓ * u                   # discrete u&#x27;
        d2u_dx2 = Dₓₓ * u                # discrete u&#x27;&#x27;
        f = d2u_dx2 - ϕ.(x, u, du_dx)

        # Replace first and last values by boundary conditions.
        f[1] = g₁(u[1], du_dx[1]) / h
        f[n+1] = g₂(u[n+1], du_dx[n+1]) / h
        return f
    end

    u = levenberg(residual, init)
    return x, u[end]
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-blue-500 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">About the code</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>The nested function <code>residual</code> uses differentiation matrices computed externally to it, rather than computing them anew on each invocation. As in <span data-state="closed"><a class="hover-link" href="/2025-06-04/linear#function-bvplin">Function <!-- -->10.4.1</a></span>, there is no need to form the row-deletion matrix <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">E</mi></mrow><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">E</span></span></span></span></span> explicitly. In lines 23--24, we divide the values of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">g_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">g_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> by a factor of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span></span>. This helps scale the residual components more uniformly and improves the robustness of convergence a bit.</p></div></details></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span>Piecewise linear finite elements for a linear <abbr aria-label="boundary-value problem" class="border-b border-dotted cursor-help" data-state="closed">BVP</abbr></span></summary><div class="px-4 py-1 details-body"><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm bg-stone-200/10"><div class="flex flex-row pl-2 bg-white border-b dark:bg-slate-600 dark:border-slate-300"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="16px" height="16px" class="self-center flex-none inline-block text-gray-500 dark:text-gray-100"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"></path></svg><div class="self-center p-2 text-sm leading-3 prose text-slate-600 dark:text-white">fem.jl</div></div><pre class="block p-3 hljs" style="background-color:unset"><code style="display:inline-block;float:left;min-width:1.25em;padding-right:1em;text-align:right;user-select:none;border-left:4px solid transparent"><span class="react-syntax-highlighter-line-number">1
</span><span class="react-syntax-highlighter-line-number">2
</span><span class="react-syntax-highlighter-line-number">3
</span><span class="react-syntax-highlighter-line-number">4
</span><span class="react-syntax-highlighter-line-number">5
</span><span class="react-syntax-highlighter-line-number">6
</span><span class="react-syntax-highlighter-line-number">7
</span><span class="react-syntax-highlighter-line-number">8
</span><span class="react-syntax-highlighter-line-number">9
</span><span class="react-syntax-highlighter-line-number">10
</span><span class="react-syntax-highlighter-line-number">11
</span><span class="react-syntax-highlighter-line-number">12
</span><span class="react-syntax-highlighter-line-number">13
</span><span class="react-syntax-highlighter-line-number">14
</span><span class="react-syntax-highlighter-line-number">15
</span><span class="react-syntax-highlighter-line-number">16
</span><span class="react-syntax-highlighter-line-number">17
</span><span class="react-syntax-highlighter-line-number">18
</span><span class="react-syntax-highlighter-line-number">19
</span><span class="react-syntax-highlighter-line-number">20
</span><span class="react-syntax-highlighter-line-number">21
</span><span class="react-syntax-highlighter-line-number">22
</span><span class="react-syntax-highlighter-line-number">23
</span><span class="react-syntax-highlighter-line-number">24
</span><span class="react-syntax-highlighter-line-number">25
</span><span class="react-syntax-highlighter-line-number">26
</span><span class="react-syntax-highlighter-line-number">27
</span><span class="react-syntax-highlighter-line-number">28
</span><span class="react-syntax-highlighter-line-number">29
</span><span class="react-syntax-highlighter-line-number">30
</span><span class="react-syntax-highlighter-line-number">31
</span><span class="react-syntax-highlighter-line-number">32
</span><span class="react-syntax-highlighter-line-number">33
</span><span class="react-syntax-highlighter-line-number">34
</span><span class="react-syntax-highlighter-line-number">35
</span><span class="react-syntax-highlighter-line-number">36
</span><span class="react-syntax-highlighter-line-number">37
</span><span class="react-syntax-highlighter-line-number">38
</span><span class="react-syntax-highlighter-line-number">39
</span><span class="react-syntax-highlighter-line-number">40
</span><span class="react-syntax-highlighter-line-number">41
</span><span class="react-syntax-highlighter-line-number">42
</span><span class="react-syntax-highlighter-line-number">43
</span><span class="react-syntax-highlighter-line-number">44
</span><span class="react-syntax-highlighter-line-number">45
</span><span class="react-syntax-highlighter-line-number">46
</span><span class="react-syntax-highlighter-line-number">47
</span><span class="react-syntax-highlighter-line-number">48
</span><span class="react-syntax-highlighter-line-number">49
</span></code><code class="language-julia" style="white-space:pre">&quot;&quot;&quot;
    fem(c, s, f, a, b, n)

Use a piecewise linear finite element method to solve a two-point
boundary value problem. The ODE is (`c`(x)u&#x27;)&#x27; + `s`(x)u = `f`(x) on
the interval [`a`,`b`], and the boundary values are zero. The
discretization uses `n` equal subintervals.

Return vectors for the nodes and the values of u.
&quot;&quot;&quot;
function fem(c, s, f, a, b, n)
    # Define the grid.
    h = (b - a) / n
    x = @. a + h * (0:n)

    # Templates for the subinterval matrix and vector contributions.
    Ke = [1 -1; -1 1]
    Me = (1 / 6) * [2 1; 1 2]
    fe = (1 / 2) * [1; 1]

    # Evaluate coefficent functions and find average values.
    cval = c.(x)
    cbar = (cval[1:n] + cval[2:n+1]) / 2
    sval = s.(x)
    sbar = (sval[1:n] + sval[2:n+1]) / 2
    fval = f.(x)
    fbar = (fval[1:n] + fval[2:n+1]) / 2

    # Assemble global system, one interval at a time.
    K = zeros(n - 1, n - 1)
    M = zeros(n - 1, n - 1)
    f = zeros(n - 1)
    K[1, 1] = cbar[1] / h
    M[1, 1] = sbar[1] * h / 3
    f[1] = fbar[1] * h / 2
    K[n-1, n-1] = cbar[n] / h
    M[n-1, n-1] = sbar[n] * h / 3
    f[n-1] = fbar[n] * h / 2
    for k in 2:n-1
        K[k-1:k, k-1:k] += (cbar[k] / h) * Ke
        M[k-1:k, k-1:k] += (sbar[k] * h) * Me
        f[k-1:k] += (fbar[k] * h) * fe
    end

    # Solve system for the interior values.
    u = (K + M) \ f
    u = [0; u; 0]      # put the boundary values into the result
    return x, u
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-[32px]" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div></details><h2 id="examples" class="relative group"><span class="heading-text">Examples</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#examples" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><div id="Cfmu6bLlAH" class="relative group/block hidden"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">include(&quot;FNC_init.jl&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FF0rs2McV2elDdPOZuKBB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(0, 187, 0);font-weight:bold">  Activating</span><span> </span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>project at `~/Documents/GitHub/fnc`
</span></code></pre></div></div></div><h3 id="id-10-1" class="relative group"><span class="heading-text">10.1 <a class="" href="/2025-06-04/tpbvp">Two-point BVP</a></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/tpbvp#demo-tpbvp-mems">Example <!-- -->10.1.3</a></span></span></summary><div class="px-4 py-1 details-body"><p id="index-a9kcujnkci">To solve this problem, we have to define functions for the <abbr aria-label="ordinary differential equation" class="border-b border-dotted cursor-help" data-state="closed">ODE</abbr> and boundary conditions. The first, which is similar to what we do for solving <abbr aria-label="initial-value problem" class="border-b border-dotted cursor-help" data-state="closed">IVP</abbr>s, returns the computed values of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">y_1&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">y_2&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span></span> given values of the dependent and independent variable. We will use an <em>in-place</em> form of this function here, where the desired output is actually the first input argument. (Notice that the <code>return</code> value is irrelevant with the in-place style.)</p><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Tip</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>The in-place code here saves the computing time that would otherwise be needed to allocate memory for <code>f</code> repeatedly. For a small problem like this, we wouldn’t expect to see a difference, but for larger problems, the savings can be significant.</p></div></details><div id="iMXxFgLgNG" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">function ode!(f, y, λ, r)
    f[1] = y[2]
    f[2] = λ / y[1]^2 - y[2] / r
    return nothing
end;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fiuxSsvLQnEnVPFOy3PXt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>To encode the boundary conditions <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y_2(0)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo><mo>−</mo><mn>1</mn><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y_1(2)-1=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>, we define a function for their residual values. In other words, these are quantities that the solver has to make zero in order to satisfy the boundary conditions. This uses in-place style as well.</p><div id="YvgZW6Hnd0" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">function bc!(g, y, λ, r)    # output, solution vector, parameter, indep. var.
    g[1] = y[1][2]          # first node, second component = 0
    g[2] = y[end][1] - 1    # last node, first component = 1
    return nothing
end;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ebSfnaEaczq3JCyp2YeoY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>In the <code>bc!</code> function, the <code>y</code> argument is just like an <abbr aria-label="initial-value problem" class="border-b border-dotted cursor-help" data-state="closed">IVP</abbr> solution from <a class="" href="/2025-06-04/basics">Basics of IVPs</a>. Thus, <code>y(0)</code> is the value of the solution at <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>, and the second component of that value is what we wish to make zero. Similarly, <code>y(1)[1]</code> is the notation for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_1(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>, which is supposed to equal 1.</p><p>The domain of the mathematical problem is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">r\in [0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>. However, there is a division by <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></span> in the <abbr aria-label="ordinary differential equation" class="border-b border-dotted cursor-help" data-state="closed">ODE</abbr>, so we want to avoid <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span> by truncating the domain a bit.</p><div id="vN1BbXKBjX" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">domain = (1e-15, 1.0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6q-9z-bSbnaT4NoalKbU_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>(1.0e-15, 1.0)</span></code></div></div></div><p>We need one last ingredient that is not part of the mathematical specification: an initial guess for the solution <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{y}(r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span></span>. As we will see, this plays the same role as initialization in Newton’s method for rootfinding. Here, we try a constant value for each component.</p><div id="xLOXcjytJ1" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">est = [1, 0]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3vrl8a8hzoOcETGlKqYci" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>2-element Vector{Int64}:
 1
 0</span></code></div></div></div><p>Now we set up and solve a <code>BVProblem</code> with the parameter value <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\lambda=0.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.6</span></span></span></span></span>.</p><div id="qv4vcmQL6W" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">using BoundaryValueDiffEq, OrdinaryDiffEq, Plots
bvp = BVProblem(ode!, bc!, est, domain, 0.6)
y = solve(bvp, Shooting(Tsit5()))
plot(y;
    label = [L&quot;w&quot; L&quot;w&#x27;&quot;],
    legend = :right,
    xlabel = L&quot;r&quot;,
    ylabel = &quot;solution&quot;,
    title = &quot;Solution of MEMS problem for λ=0.6&quot;,
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zDNdXRTCNDrEXx5RtOo1k" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>To visual accuracy, the boundary conditions have been enforced. We can check them numerically.</p><div id="uWEHyOOTZt" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">@show y(0)[2];    # y vector at r=0, 2nd component
@show y(1)[1];    # y vector at r=1, 1st component</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NIg97cLcqGgVdQyeCOFOg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>(y(0))[2] = -9.668656384782223e-16</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
(y(1))[1] = 0.9999999999999035
</span></code></pre></div></div></div><p>If the solver failed to satisfy these conditions, we would have to try a different initial guess.</p></div></details><h3 id="id-10-2" class="relative group"><span class="heading-text">10.2 <a class="" href="/2025-06-04/shooting">Shooting</a></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/shooting#demo-shooting-naive">Example <!-- -->10.2.1</a></span></span></summary><div class="px-4 py-1 details-body"><p>Let’s first examine the shooting approach for the <abbr aria-label="two-point boundary-value problem" class="border-b border-dotted cursor-help" data-state="closed">TPBVP</abbr> from <span data-state="closed"><a class="hover-link" href="/2025-06-04/tpbvp#example-tpbvp-mems">Example <!-- -->10.1.2</a></span> with <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\lambda=0.6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.6</span></span></span></span></span>.</p><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Tip</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>The character <code>ϕ</code> is typed as <code>\phi</code><kbd>Tab</kbd>.</p></div></details><div id="Uvz7wswPWl" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">λ = 0.6
ϕ = (r, w, dwdr) -&gt; λ / w^2 - dwdr / r;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UgJIfdSGf4CQ3l5HYNdLQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We convert the <abbr aria-label="ordinary differential equation" class="border-b border-dotted cursor-help" data-state="closed">ODE</abbr> to a first-order system in order to apply a numerical method. We also have to truncate the domain to avoid division by zero.</p><div id="RQgqTJkxoK" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f = (y, p, r) -&gt; [y[2]; ϕ(r, y[1], y[2])]
a, b = eps(), 1.0;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7nw-AGCfbcOL7s68uYx52" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The <abbr aria-label="boundary-value problem" class="border-b border-dotted cursor-help" data-state="closed">BVP</abbr> specifies <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>w</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w&#x27;(0)=y_2(0)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>. We can try multiple values for the unknown <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(0)=y_1(0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> and plot the solutions.</p><div id="QWahZLpKEF" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">using OrdinaryDiffEq, Plots
plt = plot(
    xaxis = (L&quot;x&quot;),  yaxis = (L&quot;w(x)&quot;),
    title = &quot;Different initial values&quot;,  legend = :bottomright)

for w0 in 0.4:0.1:0.9
    IVP = ODEProblem(f, [w0, 0], (a, b))
    y = solve(IVP, Tsit5())
    plot!(y, idxs = [1], label = &quot;w(0) = $w0&quot;)
end
plt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="btdIyszmwigI2mlyrFhHM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>On the graph, it’s the curve starting at <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.8</mn></mrow><annotation encoding="application/x-tex">w(0)=0.8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.8</span></span></span></span></span> that comes closest to the required condition <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w(1)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>, but it’s a bit too large.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/shooting#demo-shooting-mems">Example <!-- -->10.2.2</a></span></span></summary><div class="px-4 py-1 details-body"><p>We revisit <span data-state="closed"><a class="hover-link" href="/2025-06-04/shooting#demo-shooting-naive">Example <!-- -->10.2.1</a></span>&gt;<code> but let {numref}</code>Function {number} &lt;function-shoot do the heavy lifting.</p><div id="xQ33sM7Ua9" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">λ = 0.6
ϕ = (r, w, dwdr) -&gt; λ / w^2 - dwdr / r;
a, b = eps(), 1.0;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="YzKaceFCBbGxSiYQTpgDo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We specify the given and unknown endpoint values.</p><div id="qbyZncbrvO" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">g₁(w, dw) = dw       # w&#x27; = 0 at left
g₂(w, dw) = w - 1    # w = 1 at right
r, w, dw_dx = FNC.shoot(ϕ, (a, b), g₁, g₂, [0.8, 0])
plot(r, w, title = &quot;Shooting solution&quot;, xaxis = (L&quot;x&quot;), yaxis = (L&quot;w(x)&quot;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FTJ8BaKI_jzCwITZXUAPP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The value of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span> at <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>, meant to be exactly one, was computed to be</p><div id="iaux3zxcBO" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">@show w[end];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Zt3x9lqazahxw2aEcp_CN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>w[end] = 0.9999999997952056
</span></code></pre></div></div></div><p>The accuracy is consistent with the error tolerance used for the <abbr aria-label="initial-value problem" class="border-b border-dotted cursor-help" data-state="closed">IVP</abbr> solution. The initial value <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w(0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span> that gave this solution is</p><div id="zXQSCX579R" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">@show w[1];</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4PKNsYCwTQwIL8P7rnh7b" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>w[1] = 0.787757639919671
</span></code></pre></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/shooting#demo-shooting-unstable">Example <!-- -->10.2.3</a></span></span></summary><div class="px-4 py-1 details-body"><div id="agtTzzy5VI" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plt = plot(
    xaxis = (L&quot;x&quot;),
    yaxis = ([-1.2, 0.5], L&quot;u(x)&quot;),
    title = &quot;Shooting instability&quot;,
    leg = :topleft,
)
for λ in 6:4:18
    g₁(u, du) = u + 1
    g₂(u, du) = u
    ϕ = (x, u, du_dx) -&gt; λ^2 * (u + 1)
    x, u = FNC.shoot(ϕ, (0.0, 1.0), g₁, g₂, [-1, 0])
    plot!(x, u, label = &quot;λ=$λ&quot;)
end
plt</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VBMzJCVMF2NzqAnpFlYOi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>The numerical solutions evidently don’t satisfy the right boundary condition as <!-- -->λ<!-- --> increases, which makes them invalid.</p></div></details><h3 id="id-10-3" class="relative group"><span class="heading-text">10.3 <a class="" href="/2025-06-04/diffmats">Differentiation matrices</a></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-3" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/diffmats#demo-diffmats-2nd">Example <!-- -->10.3.2</a></span></span></summary><div class="px-4 py-1 details-body"><p>We test first-order and second-order differentiation matrices for the function <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>sin</mi><mo>⁡</mo><mn>4</mn><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x + \exp(\sin 4x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mop">sin</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">4</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> over <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-1,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span>.</p><div id="OX6X2HWhzw" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f = x -&gt; x + exp(sin(4 * x));</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5haVpse1FeGWTfF6Yb-_m" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>For reference, here are the exact first and second derivatives.</p><div id="DiWnsbV8By" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">df_dx = x -&gt; 1 + 4 * exp(sin(4x)) * cos(4x);
d2f_dx2 = x -&gt; 4 * exp(sin(4x)) * (4 * cos(4x)^2 - 4 * sin(4x));</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DdFkSx1pviHgTh_sGM1jR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We discretize on equally spaced nodes and evaluate <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span> at the nodes.</p><div id="unMn65IG7D" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t, Dₓ, Dₓₓ = FNC.diffmat2(18, [-1, 1])
y = f.(t);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="x5Q4XefWwLusZQbEX23LV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Then the first two derivatives of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span> each require one matrix-vector multiplication.</p><div id="BYD1kbWXOy" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">yₓ = Dₓ * y
yₓₓ = Dₓₓ * y;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8BI_ZfF8hvgk1R3chGrJJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The results show poor accuracy for this small value of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>.</p><div id="q1bVJdXfeO" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">using Plots
plot(df_dx, -1, 1, layout = 2, xaxis = (L&quot;x&quot;), yaxis = (L&quot;f&#x27;(x)&quot;))
scatter!(t, yₓ, subplot = 1)
plot!(d2f_dx2, -1, 1, subplot = 2, xaxis = (L&quot;x&quot;), yaxis = (L&quot;f&#x27;&#x27;(x)&quot;))
scatter!(t, yₓₓ, subplot = 2)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="36rBuJ65ZT9ux8rHrYfqI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>A convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.</p><div id="Y2zDp6Gh1N" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">n = @. round(Int, 2^(4:0.5:11))
err = zeros(length(n), 2)
for (k, n) in enumerate(n)
    t, Dₓ, Dₓₓ = FNC.diffmat2(n, [-1, 1])
    y = f.(t)
    err[k, 1] = norm(df_dx.(t) - Dₓ * y, Inf)
    err[k, 2] = norm(d2f_dx2.(t) - Dₓₓ * y, Inf)
end
plot(n, err, m = :o, label = [L&quot;f&#x27;&quot; L&quot;f&#x27;&#x27;&quot;])
plot!(n, 10 * 10 * n .^ (-2);
    l = (:dash, :black),
    label = &quot;2nd order&quot;,
    xaxis = (:log10, &quot;n&quot;),
    yaxis = (:log10, &quot;max error&quot;),
    title = &quot;Convergence of finite differences&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wIiHGuNFZcJjAwScWBHGg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/diffmats#demo-diffmats-cheb">Example <!-- -->10.3.3</a></span></span></summary><div class="px-4 py-1 details-body"><p>Here is a <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">4\times 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span> Chebyshev differentiation matrix.</p><div id="K7oQVABTLL" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t, Dₓ = FNC.diffcheb(3, [-1, 1])
Dₓ</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_bF9w6MbYNXS4Uj17WlpB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>4×4 Matrix{Float64}:
 -3.16667    4.0       -1.33333    0.5
 -1.0        0.333333   1.0       -0.333333
  0.333333  -1.0       -0.333333   1.0
 -0.5        1.33333   -4.0        3.16667</span></code></div></div></div><p>We again test the convergence rate.</p><div id="aPj9dM69JZ" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">f = x -&gt; x + exp(sin(4 * x));
df_dx = x -&gt; 1 + 4 * exp(sin(4 * x)) * cos(4 * x);
d2f_dx2 = x -&gt; 4 * exp(sin(4 * x)) * (4 * cos(4 * x)^2 - 4 * sin(4 * x));</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EZs6RMglO-9p6O9TMIZ-M" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="no1C217L7m" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">n = 5:5:70
err1 = zeros(size(n))
err2 = zeros(size(n))
for (k, n) in enumerate(n)
    t, Dₓ, Dₓₓ = FNC.diffcheb(n, [-1, 1])
    y = f.(t)
    err1[k] = norm(df_dx.(t) - Dₓ * y, Inf)
    err2[k] = norm(d2f_dx2.(t) - Dₓₓ * y, Inf)
end</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mqGBNYki9hXy5RT0EgJtN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Since we expect a spectral convergence rate, we use a semi-log plot for the error.</p><div id="so2gVAYwhS" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(n, [err1 err2]; m = :o,
    label=[L&quot;f&#x27;&quot; L&quot;f&#x27;&#x27;&quot;],
    xaxis=(L&quot;n&quot;),  yaxis = (:log10, &quot;max error&quot;),
    title=&quot;Convergence of Chebyshev derivatives&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="aYXG2lC1yEiHB9Dev6mLb" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="id-10-4" class="relative group"><span class="heading-text">10.4 <a class="" href="/2025-06-04/linear">Collocation for linear problems</a></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-4" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/linear#demo-linear-solve">Example <!-- -->10.4.2</a></span></span></summary><div class="px-4 py-1 details-body"><div id="tyzywULVFz" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">exact = x -&gt; exp(sin(x));</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wsUGuukEvbWYUuuzmWV4z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The problem is presented above in our standard form, so we can identify the coefficient functions in the <abbr aria-label="ordinary differential equation" class="border-b border-dotted cursor-help" data-state="closed">ODE</abbr>. Each should be coded as a function.</p><div id="SPxJnhEhZe" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">p = x -&gt; -cos(x);
q = sin;
r = x -&gt; 0;      # function, not value</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2QEH0HvWKp613pQWn0aIf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We solve the <abbr aria-label="boundary-value problem" class="border-b border-dotted cursor-help" data-state="closed">BVP</abbr> and compare the result to the exact solution.</p><div id="FjlJOup1CT" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">x, u = FNC.bvplin(p, q, r, [0, 3π / 2], 1, exp(-1), 30);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="plzX8lTrPK3BugqOrrhpU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XotKpi8bK6" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">using Plots
plot(exact, 0, 3π / 2, layout = (2, 1), label = &quot;exact&quot;)
scatter!(x, u, m = :o,
    subplot=1,  label=&quot;numerical&quot;,
    yaxis=(&quot;solution&quot;),
    title=&quot;Solution of a linear BVP&quot;)
plot!(x, exact.(x) - u, subplot = 2, xaxis = L&quot;x&quot;, yaxis = (&quot;error&quot;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="uRz-m78meHOLRIM9Muhcf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/linear#demo-linear-converge">Example <!-- -->10.4.3</a></span></span></summary><div class="px-4 py-1 details-body"><div id="T4gD6DDq1v" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">λ = 10
exact = x -&gt; sinh(λ * x) / sinh(λ) - 1;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5pVR0YY0yM6yUt99ZsvJ9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>The following functions define the <abbr aria-label="ordinary differential equation" class="border-b border-dotted cursor-help" data-state="closed">ODE</abbr>.</p><div id="zUjC4asx4B" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">p = x -&gt; 0
q = x -&gt; -λ^2
r = x -&gt; λ^2;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="w-FxG0tJo97FP8YoQ1Ck-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We compare the computed solution to the exact one for increasing <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span>.</p><div id="vAlboQ2kaF" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">n = 5 * [round(Int, 10^d) for d in 0:0.25:3]
err = zeros(length(n))
for (k, n) in enumerate(n)
    x, u = FNC.bvplin(p, q, r, [0, 1], -1, 0, n)
    err[k] = norm(exact.(x) - u, Inf)
end
data = (n = n[1:4:end], err = err[1:4:end])
@pt :header = [&quot;n&quot;, &quot;inf-norm error&quot;] data</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Xb5Te__Y68LBDAGfcvMaY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>Each factor of 10 in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span> reduces error by a factor of 100, which is indicative of second-order convergence.</p><div id="M6kjW42gYJ" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">plot(n, err, m = :o,
    label = &quot;observed&quot;,
    xaxis = (:log10, L&quot;n&quot;),
    yaxis = (:log10, &quot;inf-norm error&quot;),
    title = &quot;Convergence for a linear BVP&quot;)
plot!(n, 0.25 * n .^ (-2), l = (:dash, :gray), label = &quot;2nd order&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="K0u0vg8ojH1Hv3Fm1I2NG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="id-10-5" class="relative group"><span class="heading-text">10.5 <a class="" href="/2025-06-04/nonlinear">Nonlinearity and boundary conditions</a></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-5" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/nonlinear#demo-nonlinear-pendulum">Example <!-- -->10.5.2</a></span></span></summary><div class="px-4 py-1 details-body"><p>The first step is to define the function <!-- -->ϕ<!-- --> that equals <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>θ</mi><mrow><mo mathvariant="normal">′</mo><mo mathvariant="normal">′</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\theta&#x27;&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′′</span></span></span></span></span></span></span></span></span></span></span></span></span>.</p><div id="pBMQTK9fth" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ϕ = (t, θ, ω) -&gt; -0.05 * ω - sin(θ);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Er5khJd2Q5yzUr_ifpzk_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Next, we define the boundary conditions.</p><div id="OHW5c7UBxn" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">g₁(u, du) = u - 2.5
g₂(u, du) = u + 2;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8MocnpyD5G0Uy5YkrDbzm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p id="index-axuhsvqekc">The last ingredient is an initial estimate of the solution. Here we choose <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">n=100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span></span></span></span></span> and a linear function between the endpoint values.</p><details class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden rounded border-l-4 border-green-600 dropdown"><summary class="m-0 font-medium py-1 flex min-w-0 text-lg text-green-600 bg-green-50 dark:bg-slate-900 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03]"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none text-green-600"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Tip</div><div class="self-center flex-none text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="inline-block pl-2 mr-2 self-center flex-none transition-transform details-toggle"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></div></summary><div class="px-4 py-1 details-body"><p>The <code>collect</code> function turns a range object into a true vector.</p></div></details><div id="rY9WyJJ3of" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">init = collect(range(2.5, -2, length = 101));</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OX8Ar8S42U4_w7NISOPka" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>We find a solution with negative initial slope, i.e., the pendulum is initially pushed back toward equilibrium.</p><div id="tAsCq9Ry6f" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">using Plots
t, θ = FNC.bvp(ϕ, [0, 5], g₁, g₂, init)
plot(t, θ;
    xaxis=(L&quot;t&quot;),  yaxis=(L&quot;\theta(t)&quot;),
    title=&quot;Pendulum over [0,5]&quot; )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tDSd_zDa8DoGY5j282wLZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>If we extend the time interval longer for the same boundary values, then the initial slope must adjust.</p><div id="mcdpr5twii" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">t, θ = FNC.bvp(ϕ, [0, 8], g₁, g₂, init)
plot(t, θ;
    xaxis=(L&quot;t&quot;),  yaxis=(L&quot;\theta(t)&quot;),
    title=&quot;Pendulum over [0,8]&quot; )</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZZB3Squxj1pgCv21x3MHN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>This time, the pendulum is initially pushed toward the unstable equilibrium in the upright vertical position before gravity pulls it back down.</p></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/nonlinear#demo-nonlinear-mems">Example <!-- -->10.5.3</a></span></span></summary><div class="px-4 py-1 details-body"><p>Here is the problem definition. We use a truncated domain to avoid division by zero at <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">r=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span>.</p><div id="PcOgAIV6Sn" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">domain = [eps(), 1]
λ = 0.5
ϕ = (r, w, dwdr) -&gt; λ / w^2 - dwdr / r
g₁(w, dw) = dw
g₂(w, dw) = w - 1;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Xxwa_VwUT4OATicOm0RXt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>First we try a constant function as the initialization.</p><div id="fRQSUbFpgr" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">init = ones(301)
r, w₁ = FNC.bvp(ϕ, domain, g₁, g₂, init)

plot(r, w₁;
    xaxis = (L&quot;r&quot;),  yaxis = (L&quot;w(r)&quot;), 
    title = &quot;Solution of the MEMS problem&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xx5hm5J47QDzJV9UEu_gT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>It’s not necessary that the initialization satisfy the boundary conditions. In fact, by choosing a different constant function as the initial guess, we arrive at another valid solution.</p><div id="BN1IggTWf1" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">init = 0.5 * ones(301)
r, w₂ = FNC.bvp(ϕ, domain, g₁, g₂, init)
plot!(r, w₂, title = &quot;Two solutions of the MEMS problem&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6wB2HnFglf1P0tsXL5lva" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/nonlinear#demo-nonlinear-allencahn">Example <!-- -->10.5.4</a></span></span></summary><div class="px-4 py-1 details-body"><div id="CnwOhV8fRq" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ϕ = (x, u, dudx) -&gt; (u^3 - u) / ϵ;
g₁(u, du) = du
g₂(u, du) = u - 1;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Hx_xE2_Gp5_V7hhsnNt_M" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><p>Finding a solution is easy at larger values of <!-- -->ε<!-- -->.</p><div id="pv7FNiUJjA" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ϵ = 0.05
init = collect(range(-1, 1, length = 141))
x, u₁ = FNC.bvp(ϕ, [0, 1], g₁, g₂, init)

plot(x, u₁;
    label=L&quot;\epsilon = 0.05&quot;,  legend=:bottomright,
    xaxis=(L&quot;x&quot;),  yaxis=(L&quot;u(x)&quot;),
    title = &quot;Allen–Cahn solution&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pbQLv7292n955VvgyjZPc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>However, finding a good initialization is not trivial for smaller values of <!-- -->ε<!-- -->. Note below that the iteration stops without converging to a solution.</p><div id="L6uQygpZL1" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ϵ = 0.002;
x, z = FNC.bvp(ϕ, [0, 1], g₁, g₂, init);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Wdj4ZErZA5pLMq4Qk6u1D" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(187, 187, 0);font-weight:bold">┌ </span><span style="color:rgb(187, 187, 0);font-weight:bold">Warning: </span><span>Maximum number of iterations reached.
</span><span style="color:rgb(187, 187, 0);font-weight:bold">└ </span><span style="color:rgb(85, 85, 85)">@ FNCFunctions ~/.julia/packages/FNCFunctions/Hk7fC/src/chapter04.jl:178</span><span>
</span></code></pre></div></div></div><p>The iteration succeeds if we use the first solution instead as the initialization here.</p><div id="Gy6U9UKUSW" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">x, u₂ = FNC.bvp(ϕ, [0, 1], g₁, g₂, u₁)
plot!(x, u₂; label = L&quot;\epsilon = 0.002&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Vc91Lni8a4i6z9sgVPdCy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><p>In this case we can continue further.</p><div id="kE2Nx2CV9X" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">ϵ = 0.0005
x, u₃ = FNC.bvp(ϕ, [0, 1], g₁, g₂, u₂)
plot!(x, u₃, label = L&quot;\epsilon = 0.0005&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lhX3eRuiymJHOFeq2d4B4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><h3 id="id-10-6" class="relative group"><span class="heading-text">10.6 <a class="" href="/2025-06-04/galerkin">The Galerkin method</a></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-10-6" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><details class="rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800" open=""><summary class="m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><span data-state="closed"><a class="hover-link" href="/2025-06-04/galerkin#demo-galerkin-fem">Example <!-- -->10.6.2</a></span></span></summary><div class="px-4 py-1 details-body"><p>Here are the coefficient function definitions. Even though <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></span> is a constant, it has to be defined as a function for <span data-state="closed"><a class="hover-link" href="/2025-06-04/galerkin#function-fem">Function <!-- -->10.6.1</a></span> to use it.</p><div id="fZX4Fsv2QP" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">c = x -&gt; x^2;
q = x -&gt; 4;
f = x -&gt; sin(π * x);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="n4sOcBFW3so6bZ3k-j1YZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wJX8aXF3Tq" class="relative group/block"><div class="flex sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:hidden"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative group not-prose overflow-auto shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre class="block p-3 hljs" style="background-color:unset"><code class="language-julia" style="white-space:pre">using Plots
x, u = FNC.fem(c, q, f, 0, 1, 50)
plot(x, u;
    xaxis=(L&quot;x&quot;),  yaxis = (L&quot;u&quot;),
    title = &quot;Solution by finite elements&quot;, legend=:none)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vUOttc75FjUTDWIWhS3P0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div></div></details><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/2025-06-04/chapter9"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Julia codes</div>Chapter 9</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/2025-06-04/chapter11"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Julia codes</div>Chapter 11</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/2025-06-04/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-PWBSBTIX.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-CPTH56EW.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-S4SWV34C.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/2025-06-04/build/root-RPF4Y46X.js"/><link rel="modulepreload" href="/2025-06-04/build/_shared/chunk-FBWF35SQ.js"/><link rel="modulepreload" href="/2025-06-04/build/routes/$-B7OTHJKZ.js"/><script>window.__remixContext = {"url":"/chapter10","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.3.28","title":"Fundamentals of Numerical Computation","options":{"favicon":"/2025-06-04/build/favicon-5a4a56796022ba57772c68e7773845f6.png","logo":"/2025-06-04/build/FNClogo-f49aeb0772a5106e0fc95cf3cb49725f.png","analytics_plausible":"fncbook.com","style":"/2025-06-04/build/style-0d6158e9be425d3d76b919da285c858f.css"},"nav":[],"actions":[{"title":"Support us!","url":"https://buymeacoffee.com/tobydriscoll","internal":false,"static":false},{"title":"Report a problem","url":"https://github.com/fncbook/fnc/issues/new/choose","internal":false,"static":false}],"projects":[{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"file":"usage.md"},{"children":[{"file":"frontmatter/preface-original.md"},{"file":"frontmatter/preface.md"}],"title":"Preface"},{"file":"frontmatter/differences.md"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"chapter7/insight.md"},{"file":"chapter7/evd.md"},{"file":"chapter7/svd.md"},{"file":"chapter7/symm-eig.md"},{"file":"chapter7/dimreduce.md"},{"file":"chapter7/next.md"}],"file":"chapter7/overview.md"},{"children":[{"file":"chapter8/structure.md"},{"file":"chapter8/power.md"},{"file":"chapter8/inviter.md"},{"file":"chapter8/subspace.md"},{"file":"chapter8/gmres.md"},{"file":"chapter8/minrescg.md"},{"file":"chapter8/matrixfree.md"},{"file":"chapter8/precond.md"},{"file":"chapter8/next.md"}],"file":"chapter8/overview.md"},{"children":[{"file":"chapter9/polynomial.md"},{"file":"chapter9/barycentric.md"},{"file":"chapter9/stability.md"},{"file":"chapter9/orthogonal.md"},{"file":"chapter9/trig.md"},{"file":"chapter9/spectral-integration.md"},{"file":"chapter9/improper.md"},{"file":"chapter9/next.md"}],"file":"chapter9/overview.md"},{"children":[{"file":"chapter10/tpbvp.md"},{"file":"chapter10/shooting.md"},{"file":"chapter10/diffmats.md"},{"file":"chapter10/linear.md"},{"file":"chapter10/nonlinear.md"},{"file":"chapter10/galerkin.md"},{"file":"chapter10/next.md"}],"file":"chapter10/overview.md"},{"children":[{"file":"chapter11/blackscholes.md"},{"file":"chapter11/methodlines.md"},{"file":"chapter11/absstab-diffusion.md"},{"file":"chapter11/stiffness.md"},{"file":"chapter11/boundaries.md"},{"file":"chapter11/next.md"}],"file":"chapter11/overview.md"},{"children":[{"file":"chapter12/traffic.md"},{"file":"chapter12/upwind.md"},{"file":"chapter12/absstab-advection.md"},{"file":"chapter12/wave.md"},{"file":"chapter12/next.md"}],"file":"chapter12/overview.md"},{"children":[{"file":"chapter13/tensorprod.md"},{"file":"chapter13/diffadv.md"},{"file":"chapter13/laplace.md"},{"file":"chapter13/nonlinear.md"},{"file":"chapter13/next.md"}],"file":"chapter13/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/setup.md"},{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"},{"file":"julia/chapter7.md"},{"file":"julia/chapter8.md"},{"file":"julia/chapter9.md"},{"file":"julia/chapter10.md"},{"file":"julia/chapter11.md"},{"file":"julia/chapter12.md"},{"file":"julia/chapter13.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/setup.md"},{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"},{"file":"matlab/chapter7.md"},{"file":"matlab/chapter8.md"},{"file":"matlab/chapter9.md"},{"file":"matlab/chapter10.md"},{"file":"matlab/chapter11.md"},{"file":"matlab/chapter12.md"},{"file":"matlab/chapter13.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/setup.md"},{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"},{"file":"python/chapter7.md"},{"file":"python/chapter8.md"},{"file":"python/chapter9.md"},{"file":"python/chapter10.md"},{"file":"python/chapter11.md"},{"file":"python/chapter12.md"},{"file":"python/chapter13.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"appendix/glossary.md"},{"file":"genindex.md"}],"thumbnail":"/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.png","thumbnailOptimized":"/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.webp","bibliography":[],"index":"index","pages":[{"slug":"usage","title":"How to use this book","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Preface"},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"differences","title":"Key language differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"overview","title":"1. Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/2025-06-04/build/backwarderror-55621e558c526e24b8fc1d61b00b65a3.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"2. Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"3. Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/2025-06-04/build/normaleqns2d-642be59011d84c84d3baa16fc8b87698.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/2025-06-04/build/nonorthogonal-ae7f2af9aa7443e77a54cabf4002110b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/2025-06-04/build/hhreflect-8e7676ada4b21a8eedad229c497e7e12.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"4. Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"5. Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/2025-06-04/build/trapezoid-ef8b8f521799da9fa523f9c42c68eca7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"6. Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-6","title":"7. Matrix analysis","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"insight","title":"From matrix to insight","description":"","date":"","thumbnail":"/2025-06-04/build/littlegraph-9c05511710268b393ed760b1385973aa.png","thumbnailOptimized":"/2025-06-04/build/littlegraph-9c05511710268b393ed760b1385973aa.webp","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"evd","title":"Eigenvalue decomposition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"svd","title":"Singular value decomposition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"symm-eig","title":"Symmetry and definiteness","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dimreduce","title":"Dimension reduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-6","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-7","title":"8. Krylov methods in linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"structure-1","title":"Sparsity and structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"power","title":"Power iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inviter","title":"Inverse iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"subspace","title":"Krylov subspaces","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gmres","title":"GMRES","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"minrescg","title":"MINRES and conjugate gradients","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrixfree","title":"Matrix-free iterations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"precond","title":"Preconditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-7","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-8","title":"9. Global function approximation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polynomial","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"barycentric","title":"The barycentric formula","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability-1","title":"Stability of polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"orthogonal","title":"Orthogonal polynomials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"trig","title":"Trigonometric interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spectral-integration","title":"Spectrally accurate integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"improper","title":"Improper integrals","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-8","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-9","title":"10. Boundary-value problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tpbvp","title":"Two-point BVP","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"shooting","title":"Shooting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"diffmats","title":"Differentiation matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear","title":"Collocation for linear problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear","title":"Nonlinearity and boundary conditions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"galerkin","title":"The Galerkin method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-9","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-10","title":"11. Diffusion equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"blackscholes","title":"Black–Scholes equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"methodlines","title":"The method of lines","description":"","date":"","thumbnail":"/2025-06-04/build/periodicfun-92c161b142a3e94d789992429c5c7ae5.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"absstab-diffusion","title":"Absolute stability","description":"","date":"","thumbnail":"/2025-06-04/build/stabreg_ab_am-dd281f36807791ec496725bfecb3253a.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stiffness","title":"Stiffness","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"boundaries","title":"Boundaries","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-10","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-11","title":"12. Advection equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"traffic","title":"Traffic flow","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"upwind","title":"Upwinding and stability","description":"","date":"","thumbnail":"/2025-06-04/build/cflpicture-fa914bf5e4a7f49a8026890658f0a2e6.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"absstab-advection","title":"Absolute stability","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wave","title":"The wave equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-11","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-12","title":"13. Two-dimensional problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tensorprod","title":"Tensor-product discretizations","description":"","date":"","thumbnail":"/2025-06-04/build/tensor-grid-e2430e350f5ae802ebc9e05e4e1752f0.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"diffadv","title":"Two-dimensional diffusion and advection","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"laplace","title":"Laplace and Poisson equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear-1","title":"Nonlinear elliptic PDEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-12","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"setup","title":"Julia setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"setup-1","title":"MATLAB setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7-1","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8-1","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9-1","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10-1","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11-1","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12-1","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13-1","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"setup-2","title":"Python setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7-2","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8-2","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9-2","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10-2","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11-2","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12-2","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13-2","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"glossary","title":"Glossary","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/2025-06-04"},"routes/$":{"config":{"version":2,"myst":"1.3.28","title":"Fundamentals of Numerical Computation","options":{"favicon":"/2025-06-04/build/favicon-5a4a56796022ba57772c68e7773845f6.png","logo":"/2025-06-04/build/FNClogo-f49aeb0772a5106e0fc95cf3cb49725f.png","analytics_plausible":"fncbook.com","style":"/2025-06-04/build/style-0d6158e9be425d3d76b919da285c858f.css"},"nav":[],"actions":[{"title":"Support us!","url":"https://buymeacoffee.com/tobydriscoll","internal":false,"static":false},{"title":"Report a problem","url":"https://github.com/fncbook/fnc/issues/new/choose","internal":false,"static":false}],"projects":[{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"file":"usage.md"},{"children":[{"file":"frontmatter/preface-original.md"},{"file":"frontmatter/preface.md"}],"title":"Preface"},{"file":"frontmatter/differences.md"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"chapter7/insight.md"},{"file":"chapter7/evd.md"},{"file":"chapter7/svd.md"},{"file":"chapter7/symm-eig.md"},{"file":"chapter7/dimreduce.md"},{"file":"chapter7/next.md"}],"file":"chapter7/overview.md"},{"children":[{"file":"chapter8/structure.md"},{"file":"chapter8/power.md"},{"file":"chapter8/inviter.md"},{"file":"chapter8/subspace.md"},{"file":"chapter8/gmres.md"},{"file":"chapter8/minrescg.md"},{"file":"chapter8/matrixfree.md"},{"file":"chapter8/precond.md"},{"file":"chapter8/next.md"}],"file":"chapter8/overview.md"},{"children":[{"file":"chapter9/polynomial.md"},{"file":"chapter9/barycentric.md"},{"file":"chapter9/stability.md"},{"file":"chapter9/orthogonal.md"},{"file":"chapter9/trig.md"},{"file":"chapter9/spectral-integration.md"},{"file":"chapter9/improper.md"},{"file":"chapter9/next.md"}],"file":"chapter9/overview.md"},{"children":[{"file":"chapter10/tpbvp.md"},{"file":"chapter10/shooting.md"},{"file":"chapter10/diffmats.md"},{"file":"chapter10/linear.md"},{"file":"chapter10/nonlinear.md"},{"file":"chapter10/galerkin.md"},{"file":"chapter10/next.md"}],"file":"chapter10/overview.md"},{"children":[{"file":"chapter11/blackscholes.md"},{"file":"chapter11/methodlines.md"},{"file":"chapter11/absstab-diffusion.md"},{"file":"chapter11/stiffness.md"},{"file":"chapter11/boundaries.md"},{"file":"chapter11/next.md"}],"file":"chapter11/overview.md"},{"children":[{"file":"chapter12/traffic.md"},{"file":"chapter12/upwind.md"},{"file":"chapter12/absstab-advection.md"},{"file":"chapter12/wave.md"},{"file":"chapter12/next.md"}],"file":"chapter12/overview.md"},{"children":[{"file":"chapter13/tensorprod.md"},{"file":"chapter13/diffadv.md"},{"file":"chapter13/laplace.md"},{"file":"chapter13/nonlinear.md"},{"file":"chapter13/next.md"}],"file":"chapter13/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/setup.md"},{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"},{"file":"julia/chapter7.md"},{"file":"julia/chapter8.md"},{"file":"julia/chapter9.md"},{"file":"julia/chapter10.md"},{"file":"julia/chapter11.md"},{"file":"julia/chapter12.md"},{"file":"julia/chapter13.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/setup.md"},{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"},{"file":"matlab/chapter7.md"},{"file":"matlab/chapter8.md"},{"file":"matlab/chapter9.md"},{"file":"matlab/chapter10.md"},{"file":"matlab/chapter11.md"},{"file":"matlab/chapter12.md"},{"file":"matlab/chapter13.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/setup.md"},{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"},{"file":"python/chapter7.md"},{"file":"python/chapter8.md"},{"file":"python/chapter9.md"},{"file":"python/chapter10.md"},{"file":"python/chapter11.md"},{"file":"python/chapter12.md"},{"file":"python/chapter13.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"appendix/glossary.md"},{"file":"genindex.md"}],"thumbnail":"/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.png","thumbnailOptimized":"/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.webp","bibliography":[],"index":"index","pages":[{"slug":"usage","title":"How to use this book","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Preface"},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"differences","title":"Key language differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"overview","title":"1. Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/2025-06-04/build/backwarderror-55621e558c526e24b8fc1d61b00b65a3.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"2. Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"3. Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/2025-06-04/build/normaleqns2d-642be59011d84c84d3baa16fc8b87698.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/2025-06-04/build/nonorthogonal-ae7f2af9aa7443e77a54cabf4002110b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/2025-06-04/build/hhreflect-8e7676ada4b21a8eedad229c497e7e12.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"4. Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"5. Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/2025-06-04/build/trapezoid-ef8b8f521799da9fa523f9c42c68eca7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"6. Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-6","title":"7. Matrix analysis","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"insight","title":"From matrix to insight","description":"","date":"","thumbnail":"/2025-06-04/build/littlegraph-9c05511710268b393ed760b1385973aa.png","thumbnailOptimized":"/2025-06-04/build/littlegraph-9c05511710268b393ed760b1385973aa.webp","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"evd","title":"Eigenvalue decomposition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"svd","title":"Singular value decomposition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"symm-eig","title":"Symmetry and definiteness","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dimreduce","title":"Dimension reduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-6","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-7","title":"8. Krylov methods in linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"structure-1","title":"Sparsity and structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"power","title":"Power iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inviter","title":"Inverse iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"subspace","title":"Krylov subspaces","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gmres","title":"GMRES","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"minrescg","title":"MINRES and conjugate gradients","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrixfree","title":"Matrix-free iterations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"precond","title":"Preconditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-7","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-8","title":"9. Global function approximation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polynomial","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"barycentric","title":"The barycentric formula","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability-1","title":"Stability of polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"orthogonal","title":"Orthogonal polynomials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"trig","title":"Trigonometric interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spectral-integration","title":"Spectrally accurate integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"improper","title":"Improper integrals","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-8","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-9","title":"10. Boundary-value problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tpbvp","title":"Two-point BVP","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"shooting","title":"Shooting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"diffmats","title":"Differentiation matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear","title":"Collocation for linear problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear","title":"Nonlinearity and boundary conditions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"galerkin","title":"The Galerkin method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-9","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-10","title":"11. Diffusion equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"blackscholes","title":"Black–Scholes equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"methodlines","title":"The method of lines","description":"","date":"","thumbnail":"/2025-06-04/build/periodicfun-92c161b142a3e94d789992429c5c7ae5.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"absstab-diffusion","title":"Absolute stability","description":"","date":"","thumbnail":"/2025-06-04/build/stabreg_ab_am-dd281f36807791ec496725bfecb3253a.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stiffness","title":"Stiffness","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"boundaries","title":"Boundaries","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-10","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-11","title":"12. Advection equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"traffic","title":"Traffic flow","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"upwind","title":"Upwinding and stability","description":"","date":"","thumbnail":"/2025-06-04/build/cflpicture-fa914bf5e4a7f49a8026890658f0a2e6.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"absstab-advection","title":"Absolute stability","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wave","title":"The wave equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-11","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-12","title":"13. Two-dimensional problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tensorprod","title":"Tensor-product discretizations","description":"","date":"","thumbnail":"/2025-06-04/build/tensor-grid-e2430e350f5ae802ebc9e05e4e1752f0.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"diffadv","title":"Two-dimensional diffusion and advection","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"laplace","title":"Laplace and Poisson equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear-1","title":"Nonlinear elliptic PDEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-12","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"setup","title":"Julia setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"setup-1","title":"MATLAB setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7-1","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8-1","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9-1","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10-1","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11-1","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12-1","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13-1","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"setup-2","title":"Python setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7-2","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8-2","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9-2","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10-2","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11-2","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12-2","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13-2","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"glossary","title":"Glossary","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":2,"kind":"Notebook","sha256":"132d3edea97bdf74857022190777c40a51dbfc8ecda02f36238a02b42a168942","slug":"chapter10","location":"/julia/chapter10.md","dependencies":[],"frontmatter":{"title":"Chapter 10","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"julia-1.11","display_name":"Julia 1","language":"julia"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/julia/chapter10.md","exports":[{"format":"md","filename":"chapter10.md","url":"/2025-06-04/build/chapter10-d0ef629c244875b8c37ef6e1582a6253.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"lfFeRAR9yi"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"hocB6OvhGd"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Shooting method for a two-point boundary-value problem","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"DBbwS7im3E"}],"key":"Gykgvp1xup"},{"type":"include","file":"FNCFunctions/src/chapter10.jl","literal":true,"filter":{"startAfter":"# begin shoot","endBefore":"# end shoot"},"children":[{"type":"code","value":"\"\"\"\n    shoot(ϕ, xspan, g₁, g₂, init)\n\nShooting method to solve a two-point boundary value problem with\nODE u'' = `ϕ`(x, u, u') for x in `xspan`, left boundary condition\n`g₁`(u,u')=0, and right boundary condition `g₂`(u,u')=0. The\nvalue `init` is an initial estimate for vector [u,u'] at x=a.\n\nReturns vectors for the nodes, the solution u, and derivative u'.\n\"\"\"\nfunction shoot(ϕ, xspan, g₁, g₂, init, tol = 1e-5)\n    # ODE posed as a first-order equation in 2 variables.\n    shootivp = (v, p, x) -\u003e [v[2]; ϕ(x, v[1], v[2])]\n\n    # Evaluate the difference between computed and target values at x=b.\n    function objective(s)\n        IVP = ODEProblem(shootivp, s, float.(xspan))\n        sol = solve(IVP, Tsit5(), abstol = tol / 10, reltol = tol / 10)\n        x = sol.t\n        y = sol\n        return [g₁(s...), g₂(y.u[end]...)]\n    end\n\n    # Find the unknown quantity at x=a by rootfinding.\n    x = []\n    y = []   # these values will be overwritten\n    s = levenberg(objective, init, xtol = tol)[:, end]\n\n    # Use the stored last solution of the IVP.\n    u, du_dx = y[1, :], y[2, :]\n    return x, u, du_dx\nend","lang":"julia","showLineNumbers":true,"filename":"shoot.jl","key":"bvtX0uzwOM"}],"key":"T1pDHZla47"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"kUpKHLGO6K"}],"key":"DDu1xOHxHT"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Because ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"PRzYMHUMDz"},{"type":"inlineCode","value":"x","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"nwrs3Q42Ym"},{"type":"text","value":" and ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"BbJlkMdfKD"},{"type":"inlineCode","value":"y","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"SmIWlCvI9v"},{"type":"text","value":" are assigned empty values in line 24, when the function ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xG51pyKb22"},{"type":"inlineCode","value":"objective","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"ajWtzloMAR"},{"type":"text","value":" runs it uses those values rather than new ones in local scope. Thus, line 19 updates them to hold the latest results of the ","key":"rAVXhe2BGN"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"Ui09EYeMO3"}],"key":"nPy0AH0tC2"},{"type":"text","value":" solver, saving the need to solve it again after ","key":"lcgQbTjVxL"},{"type":"inlineCode","value":"levenberg","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"vHIGztSzcO"},{"type":"text","value":" has finished the rootfinding.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"EU98oLUjwo"}],"key":"g88UO9rPf9"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"The error tolerance in the ","key":"IpHf3jV4eo"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"I3cPpECgnt"}],"key":"nbIo90aAEq"},{"type":"text","value":" solver is kept smaller than in the rootfinder, to prevent the rootfinder from searching in a noisy landscape. Finally, note how line 28 uses destructuring of ","key":"boLXpNDNxY"},{"type":"inlineCode","value":"eachrow(y)","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"eUiJohVe6K"},{"type":"text","value":" to assign the columns of ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"GTHk6JPVxZ"},{"type":"inlineCode","value":"y","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"eLNoPB1dm3"},{"type":"text","value":" to separate names.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"THjdTFuvgw"}],"key":"fhqOu9Dz6L"}],"class":"dropdown","key":"epDcqHo5KV"}],"label":"function-shoot-julia","identifier":"function-shoot-julia","html_id":"function-shoot-julia","key":"qiTJwXxcs2"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Second-order differentiation matrices","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"dAydfmynlo"}],"key":"IIh1gtno5K"},{"type":"include","file":"FNCFunctions/src/chapter10.jl","literal":true,"filter":{"startAfter":"# begin diffmat2","endBefore":"# end diffmat2"},"children":[{"type":"code","value":"\"\"\"\n    diffmat2(n, xspan)\n\nCompute 2nd-order-accurate differentiation matrices on `n`+1 points\nin the interval `xspan`. Returns a vector of nodes and the matrices\nfor the first and second derivatives.\n\"\"\"\nfunction diffmat2(n, xspan)\n    a, b = xspan\n    h = (b - a) / n\n    x = [a + i * h for i in 0:n]   # nodes\n\n    # Define most of Dₓ by its diagonals.\n    dp = fill(0.5 / h, n)        # superdiagonal\n    dm = fill(-0.5 / h, n)       # subdiagonal\n    Dₓ = diagm(-1 =\u003e dm, 1 =\u003e dp)\n\n    # Fix first and last rows.\n    Dₓ[1, 1:3] = [-1.5, 2, -0.5] / h\n    Dₓ[n+1, n-1:n+1] = [0.5, -2, 1.5] / h\n\n    # Define most of Dₓₓ by its diagonals.\n    d0 = fill(-2 / h^2, n + 1)    # main diagonal\n    dp = ones(n) / h^2         # super- and subdiagonal\n    Dₓₓ = diagm(-1 =\u003e dp, 0 =\u003e d0, 1 =\u003e dp)\n\n    # Fix first and last rows.\n    Dₓₓ[1, 1:4] = [2, -5, 4, -1] / h^2\n    Dₓₓ[n+1, n-2:n+1] = [-1, 4, -5, 2] / h^2\n\n    return x, Dₓ, Dₓₓ\nend","lang":"julia","showLineNumbers":true,"filename":"diffmat2.jl","key":"jgNnQmNVlp"}],"key":"j66afDDhI2"}],"label":"function-diffmat2-julia","identifier":"function-diffmat2-julia","html_id":"function-diffmat2-julia","key":"VHUl9C5lEY"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Chebyshev differentiation matrices","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"wUMRy4WCDj"}],"key":"LtnXOxFcOY"},{"type":"include","file":"FNCFunctions/src/chapter10.jl","literal":true,"filter":{"startAfter":"# begin diffcheb","endBefore":"# end diffcheb"},"children":[{"type":"code","value":"\"\"\"\n    diffcheb(n, xspan)\n\nCompute Chebyshev differentiation matrices on `n`+1 points in the\ninterval `xspan`. Returns a vector of nodes and the matrices for the\nfirst and second derivatives.\n\"\"\"\nfunction diffcheb(n, xspan)\n    x = [-cos(k * π / n) for k in 0:n]    # nodes in [-1,1]\n\n    # Off-diagonal entries.\n    c = [2; ones(n - 1); 2]    # endpoint factors\n    dij = (i, j) -\u003e (-1)^(i + j) * c[i+1] / (c[j+1] * (x[i+1] - x[j+1]))\n    Dₓ = [dij(i, j) for i in 0:n, j in 0:n]\n\n    # Diagonal entries.\n    Dₓ[isinf.(Dₓ)] .= 0         # fix divisions by zero on diagonal\n    s = sum(Dₓ, dims = 2)\n    Dₓ -= diagm(s[:, 1])         # \"negative sum trick\"\n\n    # Transplant to [a,b].\n    a, b = xspan\n    x = @. a + (b - a) * (x + 1) / 2\n    Dₓ = 2 * Dₓ / (b - a)             # chain rule\n\n    # Second derivative.\n    Dₓₓ = Dₓ^2\n    return x, Dₓ, Dₓₓ\nend","lang":"julia","showLineNumbers":true,"filename":"diffcheb.jl","key":"MJONMsEPU8"}],"key":"YpHwc5Mkkj"}],"label":"function-diffcheb-julia","identifier":"function-diffcheb-julia","html_id":"function-diffcheb-julia","key":"mWuNMINObY"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a linear boundary-value problem","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"eVQ56rojft"}],"key":"QPxUfAxgSs"},{"type":"include","file":"FNCFunctions/src/chapter10.jl","literal":true,"filter":{"startAfter":"# begin bvplin","endBefore":"# end bvplin"},"children":[{"type":"code","value":"\"\"\"\n    bvplin(p, q, r, xspan, lval, rval, n)\n\nUse finite differences to solve a linear bopundary value problem.\nThe ODE is u''+`p`(x)u'+`q`(x)u = `r`(x) on the interval `xspan`,\nwith endpoint function values given as `lval` and `rval`. There will\nbe `n`+1 equally spaced nodes, including the endpoints.\n\nReturns vectors of the nodes and the solution values.\n\"\"\"\nfunction bvplin(p, q, r, xspan, lval, rval, n)\n    x, Dₓ, Dₓₓ = diffmat2(n, xspan)\n\n    P = diagm(p.(x))\n    Q = diagm(q.(x))\n    L = Dₓₓ + P * Dₓ + Q     # ODE expressed at the nodes\n\n    # Replace first and last rows using boundary conditions.\n    z = zeros(1, n)\n    A = [[1 z]; L[2:n, :]; [z 1]]\n    b = [lval; r.(x[2:n]); rval]\n\n    # Solve the system.\n    u = A \\ b\n    return x, u\nend","lang":"julia","showLineNumbers":true,"filename":"bvplin.jl","key":"vkcuFiEBFe"}],"key":"VtB1ExEm5Q"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"jv9x6v5tUf"}],"key":"RlV2Q8wgcg"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"Note that there is no need to explicitly form the row-deletion matrix ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"VF9B2h6zES"},{"type":"inlineMath","value":"\\mathbf{E}","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eE\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{E}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eE\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RKmj7EZC1i"},{"type":"text","value":" from ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"dVUYOGsBoP"},{"type":"crossReference","kind":"equation","identifier":"rowdeletion","label":"rowdeletion","children":[{"type":"text","value":"(","key":"ifGvp6sTcZ"},{"type":"text","value":"10.4.8","key":"NJTKJky7UV"},{"type":"text","value":")","key":"wCUpux2up0"}],"template":"(%s)","enumerator":"10.4.8","resolved":true,"html_id":"rowdeletion","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"t7L1o5d23j"},{"type":"text","value":". Since it only appears as left-multiplying ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"LJEwgFs9cU"},{"type":"inlineMath","value":"\\mathbf{L}","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eL\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{L}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eL\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lbgoajSKN4"},{"type":"text","value":" or ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"sQh8xyTntM"},{"type":"inlineMath","value":"\\mathbf{r}","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003er\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{r}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003er\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Ry2lrf83nC"},{"type":"text","value":", we simply perform the row deletions as needed using indexing.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"plCC61fLuA"}],"key":"myx9FMfBaV"}],"class":"dropdown","key":"tiYlkcK9Cw"}],"label":"function-bvplin-julia","identifier":"function-bvplin-julia","html_id":"function-bvplin-julia","key":"cNQXVLbM5g"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Solution of a nonlinear boundary-value problem","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"NYNkWRpPVw"}],"key":"d1VRb16gwc"},{"type":"include","file":"FNCFunctions/src/chapter10.jl","literal":true,"filter":{"lines":[[133,163]]},"children":[{"type":"code","value":"\"\"\"\n    bvp(ϕ, xspan, g₁, g₂, init)\n\nFinite differences to solve a two-point boundary value problem with\nODE u'' = `ϕ`(x,u,u') for x in `xspan`, left boundary condition\n`g₁`(u,u')=0, and right boundary condition `g₂`(u,u')=0. The value\n`init` is an initial estimate for the values of the solution u at\nequally spaced values of x, which also sets the number of nodes.\n\nReturns vectors for the nodes and the values of u.\n\"\"\"\nfunction bvp(ϕ, xspan, g₁, g₂, init)\n    n = length(init) - 1\n    x, Dₓ, Dₓₓ = diffmat2(n, xspan)\n    h = x[2] - x[1]\n\n    function residual(u)\n        # Residual of the ODE at the nodes.\n        du_dx = Dₓ * u                   # discrete u'\n        d2u_dx2 = Dₓₓ * u                # discrete u''\n        f = d2u_dx2 - ϕ.(x, u, du_dx)\n\n        # Replace first and last values by boundary conditions.\n        f[1] = g₁(u[1], du_dx[1]) / h\n        f[n+1] = g₂(u[n+1], du_dx[n+1]) / h\n        return f\n    end\n\n    u = levenberg(residual, init)\n    return x, u[end]\nend","lang":"julia","showLineNumbers":true,"filename":"bvp.jl","key":"mjDeI8A8MM"}],"key":"z3M7c5cFak"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"About the code","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"hZthZn7Mzq"}],"key":"utktViW7XK"},{"type":"paragraph","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"The nested function ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"aIKzTYQJ6m"},{"type":"inlineCode","value":"residual","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"n3X67xWqk8"},{"type":"text","value":" uses differentiation matrices computed externally to it, rather than computing them anew on each invocation. As in ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"pXQ4uvpDZ4"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-bvplin","label":"function-bvplin","children":[{"type":"text","value":"Function ","key":"GCmKQZ5EUk"},{"type":"text","value":"10.4.1","key":"FwHCdKh2v2"}],"template":"Algorithm %s","enumerator":"10.4.1","resolved":true,"html_id":"function-bvplin","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"n09SzIv1tQ"},{"type":"text","value":", there is no need to form the row-deletion matrix ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"POs0d8A1ae"},{"type":"inlineMath","value":"\\mathbf{E}","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eE\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{E}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eE\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"UOqpiKP9Mi"},{"type":"text","value":" explicitly. In lines 23--24, we divide the values of ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"XCWw2mfByP"},{"type":"inlineMath","value":"g_1","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eg\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eg_1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"b1BX9VMeW9"},{"type":"text","value":" and ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"vAbKQC83Sy"},{"type":"inlineMath","value":"g_2","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003eg\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eg_2\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eg\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"hAdmt5VDvr"},{"type":"text","value":" by a factor of ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"aJxQ0nvHs4"},{"type":"inlineMath","value":"h","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eh\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eh\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"MeWQ6Rm1j0"},{"type":"text","value":". This helps scale the residual components more uniformly and improves the robustness of convergence a bit.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"NjyWzn5xGR"}],"key":"BYFu9VCACO"}],"class":"dropdown","key":"ckZVpU5uWM"}],"label":"function-bvp-julia","identifier":"function-bvp-julia","html_id":"function-bvp-julia","key":"egaoic3TaE"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Piecewise linear finite elements for a linear ","key":"SHGP5sx6F8"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"ZBzxBeRCPQ"}],"key":"fHRtKKvwQV"}],"key":"xamkS7zSAq"},{"type":"include","file":"FNCFunctions/src/chapter10.jl","literal":true,"filter":{"startAfter":"# begin fem","endBefore":"# end fem"},"children":[{"type":"code","value":"\"\"\"\n    fem(c, s, f, a, b, n)\n\nUse a piecewise linear finite element method to solve a two-point\nboundary value problem. The ODE is (`c`(x)u')' + `s`(x)u = `f`(x) on\nthe interval [`a`,`b`], and the boundary values are zero. The\ndiscretization uses `n` equal subintervals.\n\nReturn vectors for the nodes and the values of u.\n\"\"\"\nfunction fem(c, s, f, a, b, n)\n    # Define the grid.\n    h = (b - a) / n\n    x = @. a + h * (0:n)\n\n    # Templates for the subinterval matrix and vector contributions.\n    Ke = [1 -1; -1 1]\n    Me = (1 / 6) * [2 1; 1 2]\n    fe = (1 / 2) * [1; 1]\n\n    # Evaluate coefficent functions and find average values.\n    cval = c.(x)\n    cbar = (cval[1:n] + cval[2:n+1]) / 2\n    sval = s.(x)\n    sbar = (sval[1:n] + sval[2:n+1]) / 2\n    fval = f.(x)\n    fbar = (fval[1:n] + fval[2:n+1]) / 2\n\n    # Assemble global system, one interval at a time.\n    K = zeros(n - 1, n - 1)\n    M = zeros(n - 1, n - 1)\n    f = zeros(n - 1)\n    K[1, 1] = cbar[1] / h\n    M[1, 1] = sbar[1] * h / 3\n    f[1] = fbar[1] * h / 2\n    K[n-1, n-1] = cbar[n] / h\n    M[n-1, n-1] = sbar[n] * h / 3\n    f[n-1] = fbar[n] * h / 2\n    for k in 2:n-1\n        K[k-1:k, k-1:k] += (cbar[k] / h) * Ke\n        M[k-1:k, k-1:k] += (sbar[k] * h) * Me\n        f[k-1:k] += (fbar[k] * h) * fe\n    end\n\n    # Solve system for the interior values.\n    u = (K + M) \\ f\n    u = [0; u; 0]      # put the boundary values into the result\n    return x, u\nend","lang":"julia","showLineNumbers":true,"filename":"fem.jl","key":"PidH6iHaAa"}],"key":"fjHZALwP2E"}],"label":"function-fem-julia","identifier":"function-fem-julia","html_id":"function-fem-julia","key":"qIfkY1UPMf"},{"type":"heading","depth":2,"position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"WR7lDei1pz"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"D7dV0QVL2Y"}],"key":"LfnkgJEzoM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"include(\"FNC_init.jl\")","visibility":"show","key":"EeCwYDe1DZ"},{"type":"output","id":"FF0rs2McV2elDdPOZuKBB","data":[{"output_type":"stream","name":"stderr","text":"\u001b[32m\u001b[1m  Activating\u001b[22m\u001b[39m "},{"output_type":"stream","name":"stderr","text":"project at `~/Documents/GitHub/fnc`\n"}],"visibility":"show","key":"Ow9GGKb2AG"}],"data":{"tags":[]},"visibility":"remove","key":"Cfmu6bLlAH"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"text","value":"10.1 ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"Fej1OFINcM"},{"type":"link","identifier":"section-bvp-tpbvp","label":"section-bvp-tpbvp","kind":"narrative","position":{"start":{"line":109,"column":6},"end":{"line":109,"column":24}},"url":"/tpbvp","internal":true,"dataUrl":"/tpbvp.json","children":[{"type":"text","value":"Two-point BVP","key":"hI3AIsjGNY"}],"key":"SKYI2zYYRr"}],"identifier":"id-10-1","label":"10.1 ","html_id":"id-10-1","implicit":true,"key":"SzQRGhkKQj"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-tpbvp-mems","label":"demo-tpbvp-mems","kind":"proof:example","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":17}},"children":[{"type":"text","value":"Example ","key":"UMKJarKFRd"},{"type":"text","value":"10.1.3","key":"OXg45ccEVF"}],"template":"Example %s","enumerator":"10.1.3","resolved":true,"html_id":"demo-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"tXq5LnG1AV"}],"key":"prZ9mwDTdW"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"To solve this problem, we have to define functions for the ","key":"tBCDfaNhlt"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"egp8tYOcus"}],"key":"LuvcsJOXeQ"},{"type":"text","value":" and boundary conditions. The first, which is similar to what we do for solving ","key":"bhbUFLQlDH"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"xYOBrt1u4t"}],"key":"JXTHoFF4oo"},{"type":"text","value":"s, returns the computed values of ","key":"fXCgUjKetV"},{"type":"inlineMath","value":"y_1'","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsubsup\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msubsup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey_1\u0026#x27;\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2481em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RTV3fSyvnb"},{"type":"text","value":" and ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"updPQy4Vre"},{"type":"inlineMath","value":"y_2'","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsubsup\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msubsup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey_2\u0026#x27;\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.2481em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2481em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"FCOk2ANkdE"},{"type":"text","value":" given values of the dependent and independent variable. We will use an ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"GDPAXlGDGI"},{"type":"emphasis","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"in-place","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"nx2AszbEgG"}],"key":"r2NpsrOF2r"},{"type":"text","value":" form of this function here, where the desired output is actually the first input argument. (Notice that the ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"PQjukuVOVJ"},{"type":"inlineCode","value":"return","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"FATlbEx86V"},{"type":"text","value":" value is irrelevant with the in-place style.)","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"E7oAHGhzoE"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"in-place function","kind":"entry"},"emphasis":true}],"label":"index-A9KcUJnkcI","identifier":"index-a9kcujnkci","html_id":"index-a9kcujnkci","key":"YFA3ZZxbZG"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"I9hi06lgPI"}],"key":"XizmUWD9mJ"},{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"The in-place code here saves the computing time that would otherwise be needed to allocate memory for ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"GXGyt3ypnJ"},{"type":"inlineCode","value":"f","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"YbCeUnOnEp"},{"type":"text","value":" repeatedly. For a small problem like this, we wouldn’t expect to see a difference, but for larger problems, the savings can be significant.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"KHybzF4FT4"}],"key":"h3sbkumoby"}],"class":"dropdown","key":"zWd2ZQp6mu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function ode!(f, y, λ, r)\n    f[1] = y[2]\n    f[2] = λ / y[1]^2 - y[2] / r\n    return nothing\nend;","key":"BUCRmtwpoS"},{"type":"output","id":"fiuxSsvLQnEnVPFOy3PXt","data":[],"key":"z8dsJg2FJX"}],"key":"iMXxFgLgNG"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"To encode the boundary conditions ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"EizU71z7q8"},{"type":"inlineMath","value":"y_2(0)=0","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey_2(0)=0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jFN1y4CDcy"},{"type":"text","value":", ","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"xBqNOsAh8G"},{"type":"inlineMath","value":"y_1(2)-1=0","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey_1(2)-1=0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"x5fyYHCBAM"},{"type":"text","value":", we define a function for their residual values. In other words, these are quantities that the solver has to make zero in order to satisfy the boundary conditions. This uses in-place style as well.","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"qHRqP3oksX"}],"key":"tYcdNqxQew"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"function bc!(g, y, λ, r)    # output, solution vector, parameter, indep. var.\n    g[1] = y[1][2]          # first node, second component = 0\n    g[2] = y[end][1] - 1    # last node, first component = 1\n    return nothing\nend;","key":"YuhXFNeAYL"},{"type":"output","id":"ebSfnaEaczq3JCyp2YeoY","data":[],"key":"Jsz4fHgBok"}],"key":"YvgZW6Hnd0"},{"type":"paragraph","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"In the ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"wQkNcJJRC1"},{"type":"inlineCode","value":"bc!","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"pgLqkHKu24"},{"type":"text","value":" function, the ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"Vxp1weXUHR"},{"type":"inlineCode","value":"y","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"JjV7Ofe1SR"},{"type":"text","value":" argument is just like an ","key":"LvRQ39LfO1"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"m8SU6hDjBz"}],"key":"HIJ4j6GwdG"},{"type":"text","value":" solution from ","key":"ORobwkmORP"},{"type":"link","kind":"numref","identifier":"section-ivp-basics","label":"section-ivp-basics","url":"/basics","internal":true,"dataUrl":"/basics.json","children":[{"type":"text","value":"Basics of IVPs","key":"HLOaYWMf6G"}],"key":"lHjkiI0GDH"},{"type":"text","value":". Thus, ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"LZVURLX660"},{"type":"inlineCode","value":"y(0)","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"Psiu7RtIeQ"},{"type":"text","value":" is the value of the solution at ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"QV8qSDGvTL"},{"type":"inlineMath","value":"x=0","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex=0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"OZp60LkW7H"},{"type":"text","value":", and the second component of that value is what we wish to make zero. Similarly, ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"u3FrpwQnOs"},{"type":"inlineCode","value":"y(1)[1]","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"YCUTcvNaAA"},{"type":"text","value":" is the notation for ","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"PwIw59Bob5"},{"type":"inlineMath","value":"y_1(1)","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey_1(1)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"x6CXtFO0dv"},{"type":"text","value":", which is supposed to equal 1.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"gx6e02qYgd"}],"key":"a6gp6SvrlT"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"The domain of the mathematical problem is ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"cLJOBGCMOE"},{"type":"inlineMath","value":"r\\in [0,1]","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmo\u003e∈\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er\\in [0,1]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e∈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Rvjk5ZsJeU"},{"type":"text","value":". However, there is a division by ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"ON6yJI5jSb"},{"type":"inlineMath","value":"r","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003er\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"uZEV8Wyvi8"},{"type":"text","value":" in the ","key":"TVuD4aHzJV"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"yeZLrbzdn4"}],"key":"jlwLk4axeY"},{"type":"text","value":", so we want to avoid ","key":"dHNiE1wyfb"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er=0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"hzIJgCb97W"},{"type":"text","value":" by truncating the domain a bit.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"bOPIK6wToz"}],"key":"Ueu4PIPHKt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"domain = (1e-15, 1.0)","key":"IyKJ5GrNp8"},{"type":"output","id":"6q-9z-bSbnaT4NoalKbU_","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"(1.0e-15, 1.0)","content_type":"text/plain"}}}],"key":"M8RChXUGCF"}],"key":"vN1BbXKBjX"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"We need one last ingredient that is not part of the mathematical specification: an initial guess for the solution ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"E5uTfn49LX"},{"type":"inlineMath","value":"\\mathbf{y}(r)","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{y}(r)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"gCtYFDKJHw"},{"type":"text","value":". As we will see, this plays the same role as initialization in Newton’s method for rootfinding. Here, we try a constant value for each component.","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"KfCmqWlStM"}],"key":"sKRWivqnyM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"est = [1, 0]","key":"xf5YxFpZLF"},{"type":"output","id":"3vrl8a8hzoOcETGlKqYci","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"2-element Vector{Int64}:\n 1\n 0","content_type":"text/plain"}}}],"key":"jOodDODAmn"}],"key":"xLOXcjytJ1"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"Now we set up and solve a ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"c8sajqc1eP"},{"type":"inlineCode","value":"BVProblem","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"BFtIx5Q9Tf"},{"type":"text","value":" with the parameter value ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"yWH6PmVgbJ"},{"type":"inlineMath","value":"\\lambda=0.6","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eλ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0.6\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\lambda=0.6\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eλ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.6\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"k6EgWrJ64X"},{"type":"text","value":".","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"umixd1686o"}],"key":"ra7e9jpLMO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using BoundaryValueDiffEq, OrdinaryDiffEq, Plots\nbvp = BVProblem(ode!, bc!, est, domain, 0.6)\ny = solve(bvp, Shooting(Tsit5()))\nplot(y;\n    label = [L\"w\" L\"w'\"],\n    legend = :right,\n    xlabel = L\"r\",\n    ylabel = \"solution\",\n    title = \"Solution of MEMS problem for λ=0.6\",\n)","key":"HYUoiscDkC"},{"type":"output","id":"zDNdXRTCNDrEXx5RtOo1k","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mFirst function call produced NaNs. Exiting. Double check that none of the initial conditions, parameters, or timespan values are NaN.\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ OrdinaryDiffEqCore ~/.julia/packages/OrdinaryDiffEqCore/yWlnm/src/initdt.jl:132\u001b[39m\n"},{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"042be0d7aa0ea149b3b122e9bd0e4ec1","path":"/2025-06-04/build/042be0d7aa0ea149b3b122e9bd0e4ec1.png"},"text/html":{"content_type":"text/html","hash":"873c223de001a97cdfc7f8e28a4f87e0","path":"/2025-06-04/build/873c223de001a97cdfc7f8e28a4f87e0.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"7647f4ce94960a27963bd061f614b5e5","path":"/2025-06-04/build/7647f4ce94960a27963bd061f614b5e5.svg"}}}],"key":"EhSzmiiC2d"}],"key":"qv4vcmQL6W"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"To visual accuracy, the boundary conditions have been enforced. We can check them numerically.","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"eiw4oBp3Qu"}],"key":"gwqW8NUoXn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show y(0)[2];    # y vector at r=0, 2nd component\n@show y(1)[1];    # y vector at r=1, 1st component","key":"l06hbZsok4"},{"type":"output","id":"NIg97cLcqGgVdQyeCOFOg","data":[{"output_type":"stream","name":"stdout","text":"(y(0))[2] = -9.668656384782223e-16"},{"output_type":"stream","name":"stdout","text":"\n(y(1))[1] = 0.9999999999999035\n"}],"key":"wcJmmBrV5h"}],"key":"uWEHyOOTZt"},{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"If the solver failed to satisfy these conditions, we would have to try a different initial guess.","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"LmOeDbe82B"}],"key":"WrtvNdC83P"}],"label":"demo-tpbvp-mems-julia","identifier":"demo-tpbvp-mems-julia","html_id":"demo-tpbvp-mems-julia","key":"fopw6hLnSL"},{"type":"heading","depth":3,"position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"10.2 ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"Oeiu9CbspZ"},{"type":"link","identifier":"section-bvp-shooting","label":"section-bvp-shooting","kind":"narrative","position":{"start":{"line":180,"column":6},"end":{"line":180,"column":27}},"url":"/shooting","internal":true,"dataUrl":"/shooting.json","children":[{"type":"text","value":"Shooting","key":"ZuKFdEcKae"}],"key":"nJZ9QiPfmf"}],"identifier":"id-10-2","label":"10.2 ","html_id":"id-10-2","implicit":true,"key":"VpnEls0sx2"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-naive","label":"demo-shooting-naive","kind":"proof:example","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":21}},"children":[{"type":"text","value":"Example ","key":"mxqrAukW0d"},{"type":"text","value":"10.2.1","key":"J7pFlY0c86"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"XDuqJNKhji"}],"key":"D38iPKyIcr"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Let’s first examine the shooting approach for the ","key":"m71u8tPFdw"},{"type":"abbreviation","title":"two-point boundary-value problem","children":[{"type":"text","value":"TPBVP","key":"Zu1pF3hpzP"}],"key":"Jn9ma2pgKI"},{"type":"text","value":" from ","key":"BpXylXzRqJ"},{"type":"crossReference","kind":"proof:example","identifier":"example-tpbvp-mems","label":"example-tpbvp-mems","children":[{"type":"text","value":"Example ","key":"axcUunR5Ce"},{"type":"text","value":"10.1.2","key":"PNY8bkW4YK"}],"template":"Example %s","enumerator":"10.1.2","resolved":true,"html_id":"example-tpbvp-mems","remote":true,"url":"/tpbvp","dataUrl":"/tpbvp.json","key":"wcx1K4XEfh"},{"type":"text","value":" with ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"QF85mieA9V"},{"type":"inlineMath","value":"\\lambda=0.6","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eλ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0.6\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\lambda=0.6\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eλ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.6\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Jqd6B49ArH"},{"type":"text","value":".","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"mLU3aRjDJd"}],"key":"PJQJUwsrtF"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Ngoe2DIVs6"}],"key":"wzRQobmSpc"},{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"The character ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"TTTcl2hXje"},{"type":"inlineCode","value":"ϕ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"Ns7cPsDdHT"},{"type":"text","value":" is typed as ","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"F0xMc3f86d"},{"type":"inlineCode","value":"\\phi","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"obwPtCLyre"},{"type":"keyboard","children":[{"type":"text","value":"Tab","key":"DHqlKjGiUb"}],"key":"rtzPQddl62"},{"type":"text","value":".","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"j7eahkJFvY"}],"key":"j0T766LaPL"}],"class":"dropdown","key":"sM7AheoR3p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"λ = 0.6\nϕ = (r, w, dwdr) -\u003e λ / w^2 - dwdr / r;","key":"dLM9iXUotY"},{"type":"output","id":"UgJIfdSGf4CQ3l5HYNdLQ","data":[],"key":"xwhVxG8Ejw"}],"key":"Uvz7wswPWl"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"We convert the ","key":"RqpEtioBKD"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"ZrtIz4uUvz"}],"key":"LPiG3u4OiS"},{"type":"text","value":" to a first-order system in order to apply a numerical method. We also have to truncate the domain to avoid division by zero.","key":"ToN2WaWT9l"}],"key":"uFqi5saTeh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = (y, p, r) -\u003e [y[2]; ϕ(r, y[1], y[2])]\na, b = eps(), 1.0;","key":"oTT9l6GeBf"},{"type":"output","id":"7nw-AGCfbcOL7s68uYx52","data":[],"key":"j6FZScRjn9"}],"key":"RQgqTJkxoK"},{"type":"paragraph","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"children":[{"type":"text","value":"The ","key":"uzC4ZOuic5"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"qVnuHF05Vf"}],"key":"UdV7ACl8t6"},{"type":"text","value":" specifies ","key":"JHp4ZV4VOr"},{"type":"inlineMath","value":"w'(0)=y_2(0)=0","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003ew\u003c/mi\u003e\u003cmo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\"\u003e′\u003c/mo\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ew\u0026#x27;(0)=y_2(0)=0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0019em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"mMJFYXtj4l"},{"type":"text","value":". We can try multiple values for the unknown ","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"Ec9Wr0qAml"},{"type":"inlineMath","value":"w(0)=y_1(0)","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ew\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ew(0)=y_1(0)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"vbzyZl5Xkc"},{"type":"text","value":" and plot the solutions.","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"KTXSaVoCqW"}],"key":"WAjLeL73Ga"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using OrdinaryDiffEq, Plots\nplt = plot(\n    xaxis = (L\"x\"),  yaxis = (L\"w(x)\"),\n    title = \"Different initial values\",  legend = :bottomright)\n\nfor w0 in 0.4:0.1:0.9\n    IVP = ODEProblem(f, [w0, 0], (a, b))\n    y = solve(IVP, Tsit5())\n    plot!(y, idxs = [1], label = \"w(0) = $w0\")\nend\nplt","key":"GmlPE8o02d"},{"type":"output","id":"btdIyszmwigI2mlyrFhHM","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d375dbe98cfc5bf16e338b522c8c9260","path":"/2025-06-04/build/d375dbe98cfc5bf16e338b522c8c9260.png"},"text/html":{"content_type":"text/html","hash":"381b0ba6111dd4a3bf2381f91d6a9fbb","path":"/2025-06-04/build/381b0ba6111dd4a3bf2381f91d6a9fbb.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"331937045526d68b4f246194fcf8a4ab","path":"/2025-06-04/build/331937045526d68b4f246194fcf8a4ab.svg"}}}],"key":"gI6VePWnb5"}],"key":"QWahZLpKEF"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"On the graph, it’s the curve starting at ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"txbs2t2i7j"},{"type":"inlineMath","value":"w(0)=0.8","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ew\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0.8\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ew(0)=0.8\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.8\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"razhGaboFW"},{"type":"text","value":" that comes closest to the required condition ","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"LGgKtSpRPM"},{"type":"inlineMath","value":"w(1)=1","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ew\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ew(1)=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"cyPCtx7i1c"},{"type":"text","value":", but it’s a bit too large.","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"Eq58AwY6FC"}],"key":"ADpVQpzBg3"}],"label":"demo-shooting-naive-julia","identifier":"demo-shooting-naive-julia","html_id":"demo-shooting-naive-julia","key":"HwioKOwRNB"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-mems","label":"demo-shooting-mems","kind":"proof:example","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":20}},"children":[{"type":"text","value":"Example ","key":"pDUPYiPJ1A"},{"type":"text","value":"10.2.2","key":"IMmKTI8ypX"}],"template":"Example %s","enumerator":"10.2.2","resolved":true,"html_id":"demo-shooting-mems","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"VjYtlAQniP"}],"key":"sSczZqcPay"},{"type":"paragraph","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"We revisit ","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"L5HlgsoNne"},{"type":"crossReference","identifier":"demo-shooting-naive","label":"demo-shooting-naive","kind":"proof:example","position":{"start":{"line":225,"column":12},"end":{"line":225,"column":32}},"children":[{"type":"text","value":"Example ","key":"fFzqPVD93M"},{"type":"text","value":"10.2.1","key":"I7yDZJwXKR"}],"template":"Example %s","enumerator":"10.2.1","resolved":true,"html_id":"demo-shooting-naive","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"pQaBEgZDhi"},{"type":"text","value":"\u003e","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"UmbaC4hg3D"},{"type":"inlineCode","value":" but let {numref}","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"DnqM0SirGv"},{"type":"text","value":"Function {number} \u003cfunction-shoot do the heavy lifting.","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"PW21OecTbR"}],"key":"TeBGJ6eBiy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"λ = 0.6\nϕ = (r, w, dwdr) -\u003e λ / w^2 - dwdr / r;\na, b = eps(), 1.0;","key":"cyjlpjCja2"},{"type":"output","id":"YzKaceFCBbGxSiYQTpgDo","data":[],"key":"XzVLc6yBUa"}],"key":"xQ33sM7Ua9"},{"type":"paragraph","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"children":[{"type":"text","value":"We specify the given and unknown endpoint values.","position":{"start":{"line":233,"column":1},"end":{"line":233,"column":1}},"key":"QbOliyGyml"}],"key":"E6UBsTYtE9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"g₁(w, dw) = dw       # w' = 0 at left\ng₂(w, dw) = w - 1    # w = 1 at right\nr, w, dw_dx = FNC.shoot(ϕ, (a, b), g₁, g₂, [0.8, 0])\nplot(r, w, title = \"Shooting solution\", xaxis = (L\"x\"), yaxis = (L\"w(x)\"))","key":"KZxsKn3JqP"},{"type":"output","id":"FTJ8BaKI_jzCwITZXUAPP","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"93ce6bfcde89489ce7a913365032b39d","path":"/2025-06-04/build/93ce6bfcde89489ce7a913365032b39d.png"},"text/html":{"content_type":"text/html","hash":"24aa8fcb4d6a97a968faaa27130e1186","path":"/2025-06-04/build/24aa8fcb4d6a97a968faaa27130e1186.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"964e7bc1f43cc7de90975b1ff0a367cc","path":"/2025-06-04/build/964e7bc1f43cc7de90975b1ff0a367cc.svg"}}}],"key":"JTehC8RnKR"}],"key":"qbyZncbrvO"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"The value of ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"HogutQZanp"},{"type":"inlineMath","value":"w","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ew\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ew\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RspbT2Tcwl"},{"type":"text","value":" at ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"rhTrjr6GnD"},{"type":"inlineMath","value":"r=1","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er=1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"H0PEIKJEDa"},{"type":"text","value":", meant to be exactly one, was computed to be","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"sZFXGbO9HW"}],"key":"WlkW6BPMAi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show w[end];","key":"YNAYrv4rmV"},{"type":"output","id":"Zt3x9lqazahxw2aEcp_CN","data":[{"output_type":"stream","name":"stdout","text":"w[end] = 0.9999999997952056\n"}],"key":"toKRSOUhGQ"}],"key":"iaux3zxcBO"},{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"The accuracy is consistent with the error tolerance used for the ","key":"f1UML6JnlO"},{"type":"abbreviation","title":"initial-value problem","children":[{"type":"text","value":"IVP","key":"VDZB9xMLj2"}],"key":"dsAmv6K3mC"},{"type":"text","value":" solution. The initial value ","key":"eXMm54KYyE"},{"type":"inlineMath","value":"w(0)","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ew\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ew(0)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02691em;\"\u003ew\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"PsHo5gNnT9"},{"type":"text","value":" that gave this solution is","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"U7buC1wDKL"}],"key":"KtRGVq8KYX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"@show w[1];","key":"NXcAE6Uwgh"},{"type":"output","id":"4PKNsYCwTQwIL8P7rnh7b","data":[{"output_type":"stream","name":"stdout","text":"w[1] = 0.787757639919671\n"}],"key":"SC1l3GZKic"}],"key":"zXQSCX579R"}],"label":"demo-shooting-mems-julia","identifier":"demo-shooting-mems-julia","html_id":"demo-shooting-mems-julia","key":"qxfD72h1s6"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-shooting-unstable","label":"demo-shooting-unstable","kind":"proof:example","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":24}},"children":[{"type":"text","value":"Example ","key":"PxNt1ZPvND"},{"type":"text","value":"10.2.3","key":"zNIGClO6J0"}],"template":"Example %s","enumerator":"10.2.3","resolved":true,"html_id":"demo-shooting-unstable","remote":true,"url":"/shooting","dataUrl":"/shooting.json","key":"PjpFanUB5k"}],"key":"BJSDjnXjQK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plt = plot(\n    xaxis = (L\"x\"),\n    yaxis = ([-1.2, 0.5], L\"u(x)\"),\n    title = \"Shooting instability\",\n    leg = :topleft,\n)\nfor λ in 6:4:18\n    g₁(u, du) = u + 1\n    g₂(u, du) = u\n    ϕ = (x, u, du_dx) -\u003e λ^2 * (u + 1)\n    x, u = FNC.shoot(ϕ, (0.0, 1.0), g₁, g₂, [-1, 0])\n    plot!(x, u, label = \"λ=$λ\")\nend\nplt","key":"DMeYK68ABh"},{"type":"output","id":"VBMzJCVMF2NzqAnpFlYOi","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a378143116547b20d852bd8920fcf4c0","path":"/2025-06-04/build/a378143116547b20d852bd8920fcf4c0.png"},"text/html":{"content_type":"text/html","hash":"ed6dec98dc0351884adbed67f48a0b12","path":"/2025-06-04/build/ed6dec98dc0351884adbed67f48a0b12.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a3d4013d4af30ab5fabb76e81208a273","path":"/2025-06-04/build/a3d4013d4af30ab5fabb76e81208a273.svg"}}}],"key":"ZToZQoPGLx"}],"key":"agtTzzy5VI"},{"type":"paragraph","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"children":[{"type":"text","value":"The numerical solutions evidently don’t satisfy the right boundary condition as ","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"VPVj98fVHU"},{"type":"text","value":"λ","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"weBodapcFI"},{"type":"text","value":" increases, which makes them invalid.","position":{"start":{"line":276,"column":1},"end":{"line":276,"column":1}},"key":"EnXAKjrZTR"}],"key":"tTerTEO5pP"}],"label":"demo-shooting-unstable-julia","identifier":"demo-shooting-unstable-julia","html_id":"demo-shooting-unstable-julia","key":"PYUMah6ydy"},{"type":"heading","depth":3,"position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"children":[{"type":"text","value":"10.3 ","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"ZX3gylqzJp"},{"type":"link","identifier":"section-bvp-diffmats","label":"section-bvp-diffmats","kind":"narrative","position":{"start":{"line":279,"column":6},"end":{"line":279,"column":27}},"url":"/diffmats","internal":true,"dataUrl":"/diffmats.json","children":[{"type":"text","value":"Differentiation matrices","key":"viz5WuojJT"}],"key":"YS0qxlrqNu"}],"identifier":"id-10-3","label":"10.3 ","html_id":"id-10-3","implicit":true,"key":"WRiIDZG0cV"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-2nd","label":"demo-diffmats-2nd","kind":"proof:example","position":{"start":{"line":282,"column":1},"end":{"line":282,"column":19}},"children":[{"type":"text","value":"Example ","key":"suj43CbBFZ"},{"type":"text","value":"10.3.2","key":"g95Pw6eliW"}],"template":"Example %s","enumerator":"10.3.2","resolved":true,"html_id":"demo-diffmats-2nd","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"lBjhnXfIOU"}],"key":"Jxr3P1bNuT"},{"type":"paragraph","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"children":[{"type":"text","value":"We test first-order and second-order differentiation matrices for the function ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"TA5brfpMh7"},{"type":"inlineMath","value":"x + \\exp(\\sin 4x)","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eexp\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex + \\exp(\\sin 4x)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003eexp\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"GlfBTxj85n"},{"type":"text","value":" over ","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"s0Rr19Zav4"},{"type":"inlineMath","value":"[-1,1]","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e[-1,1]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"tr30IZ2ALt"},{"type":"text","value":".","position":{"start":{"line":284,"column":1},"end":{"line":284,"column":1}},"key":"c0P7F98Pfd"}],"key":"rUHXgh5Nnj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = x -\u003e x + exp(sin(4 * x));","key":"eJJE6tjV9H"},{"type":"output","id":"5haVpse1FeGWTfF6Yb-_m","data":[],"key":"gicPMJqQVB"}],"key":"OX6X2HWhzw"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"For reference, here are the exact first and second derivatives.","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"ATcIYZpxf0"}],"key":"gGK6wzXo5O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"df_dx = x -\u003e 1 + 4 * exp(sin(4x)) * cos(4x);\nd2f_dx2 = x -\u003e 4 * exp(sin(4x)) * (4 * cos(4x)^2 - 4 * sin(4x));","key":"KL2HBpgHHD"},{"type":"output","id":"DdFkSx1pviHgTh_sGM1jR","data":[],"key":"HC2F8TTNEX"}],"key":"DiWnsbV8By"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"We discretize on equally spaced nodes and evaluate ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"T2HuFqlCqe"},{"type":"inlineMath","value":"f","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"T9kQS4a3bs"},{"type":"text","value":" at the nodes.","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"x0EXNqfhao"}],"key":"KE6E2ZTttc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, Dₓ, Dₓₓ = FNC.diffmat2(18, [-1, 1])\ny = f.(t);","key":"FFLe0vI6jS"},{"type":"output","id":"x5Q4XefWwLusZQbEX23LV","data":[],"key":"uPNCaA4KIm"}],"key":"unMn65IG7D"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"Then the first two derivatives of ","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"JqYBwcUcjz"},{"type":"inlineMath","value":"f","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ef\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DQMaADkN7n"},{"type":"text","value":" each require one matrix-vector multiplication.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"pzIulouFDK"}],"key":"JCoIdcHxVe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"yₓ = Dₓ * y\nyₓₓ = Dₓₓ * y;","key":"PoAmtSpkqP"},{"type":"output","id":"8BI_ZfF8hvgk1R3chGrJJ","data":[],"key":"Cqs5K2J8sm"}],"key":"BYD1kbWXOy"},{"type":"paragraph","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"text","value":"The results show poor accuracy for this small value of ","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"vCfof0nAAW"},{"type":"inlineMath","value":"n","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"bSCbdNxpHg"},{"type":"text","value":".","position":{"start":{"line":311,"column":1},"end":{"line":311,"column":1}},"key":"c3GfTrEKJf"}],"key":"OafCzVKYGh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplot(df_dx, -1, 1, layout = 2, xaxis = (L\"x\"), yaxis = (L\"f'(x)\"))\nscatter!(t, yₓ, subplot = 1)\nplot!(d2f_dx2, -1, 1, subplot = 2, xaxis = (L\"x\"), yaxis = (L\"f''(x)\"))\nscatter!(t, yₓₓ, subplot = 2)","key":"AFNGTq2PoH"},{"type":"output","id":"36rBuJ65ZT9ux8rHrYfqI","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"775dd46354e93e07461d9c4a640f3880","path":"/2025-06-04/build/775dd46354e93e07461d9c4a640f3880.png"},"text/html":{"content_type":"text/html","hash":"121e675a78f4a689e3385aa3e897b0cd","path":"/2025-06-04/build/121e675a78f4a689e3385aa3e897b0cd.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"96a13975519b95be9735be12b61f02cd","path":"/2025-06-04/build/96a13975519b95be9735be12b61f02cd.svg"}}}],"key":"s7dH2VShGR"}],"key":"q1bVJdXfeO"},{"type":"paragraph","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"text","value":"A convergence experiment confirms the order of accuracy. Because we expect an algebraic convergence rate, we use a log-log plot of the errors.","position":{"start":{"line":321,"column":1},"end":{"line":321,"column":1}},"key":"P9oJLzhTqT"}],"key":"WpuJrF5Wz1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = @. round(Int, 2^(4:0.5:11))\nerr = zeros(length(n), 2)\nfor (k, n) in enumerate(n)\n    t, Dₓ, Dₓₓ = FNC.diffmat2(n, [-1, 1])\n    y = f.(t)\n    err[k, 1] = norm(df_dx.(t) - Dₓ * y, Inf)\n    err[k, 2] = norm(d2f_dx2.(t) - Dₓₓ * y, Inf)\nend\nplot(n, err, m = :o, label = [L\"f'\" L\"f''\"])\nplot!(n, 10 * 10 * n .^ (-2);\n    l = (:dash, :black),\n    label = \"2nd order\",\n    xaxis = (:log10, \"n\"),\n    yaxis = (:log10, \"max error\"),\n    title = \"Convergence of finite differences\")","key":"PFVFvCFM8o"},{"type":"output","id":"wIiHGuNFZcJjAwScWBHGg","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cf04358e67277d7df5af5c4901499897","path":"/2025-06-04/build/cf04358e67277d7df5af5c4901499897.png"},"text/html":{"content_type":"text/html","hash":"dabfc046215af1cb906f04e714be4685","path":"/2025-06-04/build/dabfc046215af1cb906f04e714be4685.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a8237ddee062d78aa73cde1d69c9893d","path":"/2025-06-04/build/a8237ddee062d78aa73cde1d69c9893d.svg"}}}],"key":"ucRXM2QAJg"}],"key":"Y2zDp6Gh1N"}],"label":"demo-diffmats-2nd-julia","identifier":"demo-diffmats-2nd-julia","html_id":"demo-diffmats-2nd-julia","key":"PzmCO8z1s1"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-diffmats-cheb","label":"demo-diffmats-cheb","kind":"proof:example","position":{"start":{"line":343,"column":1},"end":{"line":343,"column":20}},"children":[{"type":"text","value":"Example ","key":"ZcJVq3Y3uN"},{"type":"text","value":"10.3.3","key":"Ee0MSMPZmT"}],"template":"Example %s","enumerator":"10.3.3","resolved":true,"html_id":"demo-diffmats-cheb","remote":true,"url":"/diffmats","dataUrl":"/diffmats.json","key":"f7LCXT0QX8"}],"key":"TNkerf8ugZ"},{"type":"paragraph","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"Here is a ","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"PjFlMDqQ8b"},{"type":"inlineMath","value":"4\\times 4","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e4\u003c/mn\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e4\\times 4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"YJHp5Zt2HK"},{"type":"text","value":" Chebyshev differentiation matrix.","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"QLG5aNkMbI"}],"key":"Uu7UDu9H4p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, Dₓ = FNC.diffcheb(3, [-1, 1])\nDₓ","key":"LZzhnA10GL"},{"type":"output","id":"_bF9w6MbYNXS4Uj17WlpB","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"4×4 Matrix{Float64}:\n -3.16667    4.0       -1.33333    0.5\n -1.0        0.333333   1.0       -0.333333\n  0.333333  -1.0       -0.333333   1.0\n -0.5        1.33333   -4.0        3.16667","content_type":"text/plain"}}}],"key":"ZeYKqORD6z"}],"key":"K7oQVABTLL"},{"type":"paragraph","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"children":[{"type":"text","value":"We again test the convergence rate.","position":{"start":{"line":352,"column":1},"end":{"line":352,"column":1}},"key":"NUnpb5bgcm"}],"key":"EkO1RPKnLK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"f = x -\u003e x + exp(sin(4 * x));\ndf_dx = x -\u003e 1 + 4 * exp(sin(4 * x)) * cos(4 * x);\nd2f_dx2 = x -\u003e 4 * exp(sin(4 * x)) * (4 * cos(4 * x)^2 - 4 * sin(4 * x));","key":"nl2VgKoYZD"},{"type":"output","id":"EZs6RMglO-9p6O9TMIZ-M","data":[],"key":"ych7JsofOn"}],"key":"aPj9dM69JZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = 5:5:70\nerr1 = zeros(size(n))\nerr2 = zeros(size(n))\nfor (k, n) in enumerate(n)\n    t, Dₓ, Dₓₓ = FNC.diffcheb(n, [-1, 1])\n    y = f.(t)\n    err1[k] = norm(df_dx.(t) - Dₓ * y, Inf)\n    err2[k] = norm(d2f_dx2.(t) - Dₓₓ * y, Inf)\nend","key":"Sp7H15OOOh"},{"type":"output","id":"mqGBNYki9hXy5RT0EgJtN","data":[],"key":"fMyKGXr1GK"}],"key":"no1C217L7m"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"Since we expect a spectral convergence rate, we use a semi-log plot for the error.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"Ap15wttvyF"}],"key":"PvgSYWF24w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(n, [err1 err2]; m = :o,\n    label=[L\"f'\" L\"f''\"],\n    xaxis=(L\"n\"),  yaxis = (:log10, \"max error\"),\n    title=\"Convergence of Chebyshev derivatives\")","key":"iF0cBYesJC"},{"type":"output","id":"aYXG2lC1yEiHB9Dev6mLb","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"67ce162df385ee6174464b28b27f9bee","path":"/2025-06-04/build/67ce162df385ee6174464b28b27f9bee.png"},"text/html":{"content_type":"text/html","hash":"9a0d98d9fdec475ef9b9aa0b9186f51d","path":"/2025-06-04/build/9a0d98d9fdec475ef9b9aa0b9186f51d.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"0f527946d22a690e6000777027a22965","path":"/2025-06-04/build/0f527946d22a690e6000777027a22965.svg"}}}],"key":"KmDi2u3YFh"}],"key":"so2gVAYwhS"}],"label":"demo-diffmats-cheb-julia","identifier":"demo-diffmats-cheb-julia","html_id":"demo-diffmats-cheb-julia","key":"M9HDeXV5ps"},{"type":"heading","depth":3,"position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"text","value":"10.4 ","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"R0CLrnS0PG"},{"type":"link","identifier":"section-bvp-linear","label":"section-bvp-linear","kind":"narrative","position":{"start":{"line":382,"column":6},"end":{"line":382,"column":25}},"url":"/linear","internal":true,"dataUrl":"/linear.json","children":[{"type":"text","value":"Collocation for linear problems","key":"uzyFxLZHvi"}],"key":"hbWGLDApj6"}],"identifier":"id-10-4","label":"10.4 ","html_id":"id-10-4","implicit":true,"key":"D9i71p7Ml9"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-solve","label":"demo-linear-solve","kind":"proof:example","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":19}},"children":[{"type":"text","value":"Example ","key":"SNnBd8rWAg"},{"type":"text","value":"10.4.2","key":"ofVdQxxIas"}],"template":"Example %s","enumerator":"10.4.2","resolved":true,"html_id":"demo-linear-solve","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"b7EaERKlzk"}],"key":"ADoiPfVfS1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"exact = x -\u003e exp(sin(x));","key":"tQnasDegn0"},{"type":"output","id":"wsUGuukEvbWYUuuzmWV4z","data":[],"key":"cqYvHVZtam"}],"key":"tyzywULVFz"},{"type":"paragraph","position":{"start":{"line":391,"column":1},"end":{"line":391,"column":1}},"children":[{"type":"text","value":"The problem is presented above in our standard form, so we can identify the coefficient functions in the ","key":"taUy5Fx3sA"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"fSP75ddLXj"}],"key":"w7Na7WUgt2"},{"type":"text","value":". Each should be coded as a function.","key":"LVnPJqW3J0"}],"key":"vuklVwD9GF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"p = x -\u003e -cos(x);\nq = sin;\nr = x -\u003e 0;      # function, not value","key":"I1RkRxJzUq"},{"type":"output","id":"2QEH0HvWKp613pQWn0aIf","data":[],"key":"FujDWFd41F"}],"key":"SPxJnhEhZe"},{"type":"paragraph","position":{"start":{"line":399,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"We solve the ","key":"nddGv9cwba"},{"type":"abbreviation","title":"boundary-value problem","children":[{"type":"text","value":"BVP","key":"r5q5bkw2Oz"}],"key":"gOHc58exJD"},{"type":"text","value":" and compare the result to the exact solution.","key":"mqY98QSJx1"}],"key":"OL8aahzH73"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, u = FNC.bvplin(p, q, r, [0, 3π / 2], 1, exp(-1), 30);","key":"TcUBHWcoAN"},{"type":"output","id":"plzX8lTrPK3BugqOrrhpU","data":[],"key":"EFe0pRjqE8"}],"key":"FjlJOup1CT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nplot(exact, 0, 3π / 2, layout = (2, 1), label = \"exact\")\nscatter!(x, u, m = :o,\n    subplot=1,  label=\"numerical\",\n    yaxis=(\"solution\"),\n    title=\"Solution of a linear BVP\")\nplot!(x, exact.(x) - u, subplot = 2, xaxis = L\"x\", yaxis = (\"error\"))","key":"ug9BvNqK19"},{"type":"output","id":"uRz-m78meHOLRIM9Muhcf","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"11f764c5e57d954dad92137ee1b10772","path":"/2025-06-04/build/11f764c5e57d954dad92137ee1b10772.png"},"text/html":{"content_type":"text/html","hash":"74920dfa95683743927048c7d2684847","path":"/2025-06-04/build/74920dfa95683743927048c7d2684847.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"c1c9a4ec754c5a614b0cd374a4da9f73","path":"/2025-06-04/build/c1c9a4ec754c5a614b0cd374a4da9f73.svg"}}}],"key":"QiiIZD4qfQ"}],"key":"XotKpi8bK6"}],"label":"demo-linear-solve-julia","identifier":"demo-linear-solve-julia","html_id":"demo-linear-solve-julia","key":"Cuzr9lm7Lm"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-linear-converge","label":"demo-linear-converge","kind":"proof:example","position":{"start":{"line":417,"column":1},"end":{"line":417,"column":22}},"children":[{"type":"text","value":"Example ","key":"n77wBh6L0d"},{"type":"text","value":"10.4.3","key":"kRbREms419"}],"template":"Example %s","enumerator":"10.4.3","resolved":true,"html_id":"demo-linear-converge","remote":true,"url":"/linear","dataUrl":"/linear.json","key":"Z0vutkwK00"}],"key":"daRy9UwnNS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"λ = 10\nexact = x -\u003e sinh(λ * x) / sinh(λ) - 1;","key":"TjnojaTziD"},{"type":"output","id":"5pVR0YY0yM6yUt99ZsvJ9","data":[],"key":"Ibo26CFKuT"}],"key":"T4gD6DDq1v"},{"type":"paragraph","position":{"start":{"line":424,"column":1},"end":{"line":424,"column":1}},"children":[{"type":"text","value":"The following functions define the ","key":"S9gInXOqhp"},{"type":"abbreviation","title":"ordinary differential equation","children":[{"type":"text","value":"ODE","key":"s9714BrkcT"}],"key":"peeoGZuO6U"},{"type":"text","value":".","key":"o4DzzXZRxB"}],"key":"yw5FZ4z0u4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"p = x -\u003e 0\nq = x -\u003e -λ^2\nr = x -\u003e λ^2;","key":"zKq5doc6Xv"},{"type":"output","id":"w-FxG0tJo97FP8YoQ1Ck-","data":[],"key":"Gm5ihJPOID"}],"key":"zUjC4asx4B"},{"type":"paragraph","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"We compare the computed solution to the exact one for increasing ","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"zHCYofsUzC"},{"type":"inlineMath","value":"n","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"KJdZbqlLal"},{"type":"text","value":".","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"TTt2mflQzv"}],"key":"gzD0ZaVFst"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"n = 5 * [round(Int, 10^d) for d in 0:0.25:3]\nerr = zeros(length(n))\nfor (k, n) in enumerate(n)\n    x, u = FNC.bvplin(p, q, r, [0, 1], -1, 0, n)\n    err[k] = norm(exact.(x) - u, Inf)\nend\ndata = (n = n[1:4:end], err = err[1:4:end])\n@pt :header = [\"n\", \"inf-norm error\"] data","key":"SkzYuijxBC"},{"type":"output","id":"Xb5Te__Y68LBDAGfcvMaY","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr class = \"header headerLastRow\"\u003e\n      \u003cth style = \"text-align: right;\"\u003en\u003c/th\u003e\n      \u003cth style = \"text-align: right;\"\u003einf-norm error\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd style = \"text-align: right;\"\u003e5\u003c/td\u003e\n      \u003ctd style = \"text-align: right;\"\u003e0.0362375\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style = \"text-align: right;\"\u003e50\u003c/td\u003e\n      \u003ctd style = \"text-align: right;\"\u003e0.000610896\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style = \"text-align: right;\"\u003e500\u003c/td\u003e\n      \u003ctd style = \"text-align: right;\"\u003e6.1311e-6\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style = \"text-align: right;\"\u003e5000\u003c/td\u003e\n      \u003ctd style = \"text-align: right;\"\u003e6.13171e-8\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n","content_type":"text/html"}}}],"key":"oYIe0igOpE"}],"key":"vAlboQ2kaF"},{"type":"paragraph","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"children":[{"type":"text","value":"Each factor of 10 in ","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"ho72QmMtTt"},{"type":"inlineMath","value":"n","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"S5GbnuAQvE"},{"type":"text","value":" reduces error by a factor of 100, which is indicative of second-order convergence.","position":{"start":{"line":445,"column":1},"end":{"line":445,"column":1}},"key":"FOEyPVLIY4"}],"key":"GSiS0yIsKr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"plot(n, err, m = :o,\n    label = \"observed\",\n    xaxis = (:log10, L\"n\"),\n    yaxis = (:log10, \"inf-norm error\"),\n    title = \"Convergence for a linear BVP\")\nplot!(n, 0.25 * n .^ (-2), l = (:dash, :gray), label = \"2nd order\")","key":"B3IOlZlcv3"},{"type":"output","id":"K0u0vg8ojH1Hv3Fm1I2NG","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f083daa79978e9eb7087dd6b36985ac3","path":"/2025-06-04/build/f083daa79978e9eb7087dd6b36985ac3.png"},"text/html":{"content_type":"text/html","hash":"f7f1ea14f3a65067efa7e9424ff3cdc4","path":"/2025-06-04/build/f7f1ea14f3a65067efa7e9424ff3cdc4.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"e3a04c7c97296f3367f03319a72e6a78","path":"/2025-06-04/build/e3a04c7c97296f3367f03319a72e6a78.svg"}}}],"key":"d2cikxpebQ"}],"key":"M6kjW42gYJ"}],"label":"demo-linear-converge-julia","identifier":"demo-linear-converge-julia","html_id":"demo-linear-converge-julia","key":"Nv42puzuRA"},{"type":"heading","depth":3,"position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"children":[{"type":"text","value":"10.5 ","position":{"start":{"line":457,"column":1},"end":{"line":457,"column":1}},"key":"fEhlS682wq"},{"type":"link","identifier":"section-bvp-nonlinear","label":"section-bvp-nonlinear","kind":"narrative","position":{"start":{"line":457,"column":6},"end":{"line":457,"column":28}},"url":"/nonlinear","internal":true,"dataUrl":"/nonlinear.json","children":[{"type":"text","value":"Nonlinearity and boundary conditions","key":"lgEXpMPeUm"}],"key":"NnmebD4vyj"}],"identifier":"id-10-5","label":"10.5 ","html_id":"id-10-5","implicit":true,"key":"CHzIjJas6z"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-pendulum","label":"demo-nonlinear-pendulum","kind":"proof:example","position":{"start":{"line":460,"column":1},"end":{"line":460,"column":25}},"children":[{"type":"text","value":"Example ","key":"EW8un8uIEN"},{"type":"text","value":"10.5.2","key":"NPYqJMURHv"}],"template":"Example %s","enumerator":"10.5.2","resolved":true,"html_id":"demo-nonlinear-pendulum","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"LCejn4nEyl"}],"key":"Cik8cEoR9D"},{"type":"paragraph","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"children":[{"type":"text","value":"The first step is to define the function ","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"efRlcd1c1n"},{"type":"text","value":"ϕ","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"ldshIP0yX0"},{"type":"text","value":" that equals ","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"cVZYl8pwcC"},{"type":"inlineMath","value":"\\theta''","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsup\u003e\u003cmi\u003eθ\u003c/mi\u003e\u003cmrow\u003e\u003cmo mathvariant=\"normal\"\u003e′\u003c/mo\u003e\u003cmo mathvariant=\"normal\"\u003e′\u003c/mo\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\theta\u0026#x27;\u0026#x27;\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7519em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eθ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7519em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e′′\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lGM2rvnq5I"},{"type":"text","value":".","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"tIxPuLMmvg"}],"key":"fhMgSursUm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϕ = (t, θ, ω) -\u003e -0.05 * ω - sin(θ);","key":"EoRNPOY9hJ"},{"type":"output","id":"Er5khJd2Q5yzUr_ifpzk_","data":[],"key":"FIvbh8yRxy"}],"key":"pBMQTK9fth"},{"type":"paragraph","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"children":[{"type":"text","value":"Next, we define the boundary conditions.","position":{"start":{"line":468,"column":1},"end":{"line":468,"column":1}},"key":"aobkLUVNpl"}],"key":"DKF2GiY2VP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"g₁(u, du) = u - 2.5\ng₂(u, du) = u + 2;","key":"OmNNsl0d5r"},{"type":"output","id":"8MocnpyD5G0Uy5YkrDbzm","data":[],"key":"f6lfwIlw7f"}],"key":"OHW5c7UBxn"},{"type":"paragraph","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"children":[{"type":"text","value":"The last ingredient is an initial estimate of the solution. Here we choose ","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"bqZaubAJ8T"},{"type":"inlineMath","value":"n=100","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e100\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003en=100\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e100\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"FjtaGTjJBG"},{"type":"text","value":" and a linear function between the endpoint values.","position":{"start":{"line":478,"column":1},"end":{"line":478,"column":1}},"key":"orSvKIpGSA"}],"indexEntries":[{"entry":"Julia","subEntry":{"value":"collect","kind":"entry"},"emphasis":true}],"label":"index-axuHsvQEKc","identifier":"index-axuhsvqekc","html_id":"index-axuhsvqekc","key":"JyJGUxXj0F"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"HhB4XPSA9G"}],"key":"wkjAaPkaZ5"},{"type":"paragraph","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"q9OARPT5iE"},{"type":"inlineCode","value":"collect","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"s5av72raNe"},{"type":"text","value":" function turns a range object into a true vector.","position":{"start":{"line":481,"column":1},"end":{"line":481,"column":1}},"key":"RWb2z5enbG"}],"key":"QjLfZc8VSo"}],"class":"dropdown","key":"ZCo7SdLFb2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"init = collect(range(2.5, -2, length = 101));","key":"h6kJqS4sZl"},{"type":"output","id":"OX8Ar8S42U4_w7NISOPka","data":[],"key":"LRGqB8lOpu"}],"key":"rY9WyJJ3of"},{"type":"paragraph","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"children":[{"type":"text","value":"We find a solution with negative initial slope, i.e., the pendulum is initially pushed back toward equilibrium.","position":{"start":{"line":488,"column":1},"end":{"line":488,"column":1}},"key":"h4PYpS7Xvg"}],"key":"B9KVCjxBjF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nt, θ = FNC.bvp(ϕ, [0, 5], g₁, g₂, init)\nplot(t, θ;\n    xaxis=(L\"t\"),  yaxis=(L\"\\theta(t)\"),\n    title=\"Pendulum over [0,5]\" )","key":"WrmGeUmRa9"},{"type":"output","id":"tDSd_zDa8DoGY5j282wLZ","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"633244fd2ee906f4a3b745017c795229","path":"/2025-06-04/build/633244fd2ee906f4a3b745017c795229.png"},"text/html":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip660\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip660)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip661\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip660)\" d=\"M203.49 1111.02 L1952.76 1111.02 L1952.76 107.256 L203.49 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip662\"\u003e\n    \u003crect x=\"203\" y=\"107\" width=\"1750\" height=\"1005\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"252.997,1111.02 252.997,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"583.047,1111.02 583.047,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"913.098,1111.02 913.098,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1243.15,1111.02 1243.15,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1573.2,1111.02 1573.2,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1903.25,1111.02 1903.25,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,1060.77 1952.76,1060.77 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,855.188 1952.76,855.188 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,649.61 1952.76,649.61 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,444.032 1952.76,444.032 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,238.453 1952.76,238.453 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 1952.76,1111.02 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"252.997,1111.02 252.997,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"583.047,1111.02 583.047,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"913.098,1111.02 913.098,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1243.15,1111.02 1243.15,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1573.2,1111.02 1573.2,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1903.25,1111.02 1903.25,1092.12 \"/\u003e\n\u003cpath clip-path=\"url(#clip660)\" d=\"M252.997 1138.74 Q249.386 1138.74 247.557 1142.3 Q245.752 1145.84 245.752 1152.97 Q245.752 1160.08 247.557 1163.64 Q249.386 1167.19 252.997 1167.19 Q256.631 1167.19 258.437 1163.64 Q260.266 1160.08 260.266 1152.97 Q260.266 1145.84 258.437 1142.3 Q256.631 1138.74 252.997 1138.74 M252.997 1135.03 Q258.807 1135.03 261.863 1139.64 Q264.942 1144.22 264.942 1152.97 Q264.942 1161.7 261.863 1166.31 Q258.807 1170.89 252.997 1170.89 Q247.187 1170.89 244.108 1166.31 Q241.053 1161.7 241.053 1152.97 Q241.053 1144.22 244.108 1139.64 Q247.187 1135.03 252.997 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M573.429 1166.28 L581.068 1166.28 L581.068 1139.92 L572.758 1141.58 L572.758 1137.33 L581.022 1135.66 L585.698 1135.66 L585.698 1166.28 L593.337 1166.28 L593.337 1170.22 L573.429 1170.22 L573.429 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M907.75 1166.28 L924.07 1166.28 L924.07 1170.22 L902.126 1170.22 L902.126 1166.28 Q904.788 1163.53 909.371 1158.9 Q913.977 1154.25 915.158 1152.9 Q917.403 1150.38 918.283 1148.64 Q919.186 1146.89 919.186 1145.2 Q919.186 1142.44 917.241 1140.7 Q915.32 1138.97 912.218 1138.97 Q910.019 1138.97 907.565 1139.73 Q905.135 1140.5 902.357 1142.05 L902.357 1137.33 Q905.181 1136.19 907.635 1135.61 Q910.088 1135.03 912.125 1135.03 Q917.496 1135.03 920.69 1137.72 Q923.885 1140.4 923.885 1144.89 Q923.885 1147.02 923.074 1148.95 Q922.287 1150.84 920.181 1153.44 Q919.602 1154.11 916.5 1157.33 Q913.399 1160.52 907.75 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M1247.4 1151.58 Q1250.75 1152.3 1252.63 1154.57 Q1254.53 1156.84 1254.53 1160.17 Q1254.53 1165.29 1251.01 1168.09 Q1247.49 1170.89 1241.01 1170.89 Q1238.83 1170.89 1236.52 1170.45 Q1234.22 1170.03 1231.77 1169.18 L1231.77 1164.66 Q1233.72 1165.8 1236.03 1166.38 Q1238.34 1166.95 1240.87 1166.95 Q1245.27 1166.95 1247.56 1165.22 Q1249.87 1163.48 1249.87 1160.17 Q1249.87 1157.12 1247.72 1155.4 Q1245.59 1153.67 1241.77 1153.67 L1237.74 1153.67 L1237.74 1149.83 L1241.96 1149.83 Q1245.4 1149.83 1247.23 1148.46 Q1249.06 1147.07 1249.06 1144.48 Q1249.06 1141.82 1247.16 1140.4 Q1245.29 1138.97 1241.77 1138.97 Q1239.85 1138.97 1237.65 1139.39 Q1235.45 1139.8 1232.81 1140.68 L1232.81 1136.51 Q1235.47 1135.77 1237.79 1135.4 Q1240.13 1135.03 1242.19 1135.03 Q1247.51 1135.03 1250.61 1137.46 Q1253.71 1139.87 1253.71 1143.99 Q1253.71 1146.86 1252.07 1148.85 Q1250.43 1150.82 1247.4 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M1576.21 1139.73 L1564.4 1158.18 L1576.21 1158.18 L1576.21 1139.73 M1574.98 1135.66 L1580.86 1135.66 L1580.86 1158.18 L1585.79 1158.18 L1585.79 1162.07 L1580.86 1162.07 L1580.86 1170.22 L1576.21 1170.22 L1576.21 1162.07 L1560.61 1162.07 L1560.61 1157.56 L1574.98 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M1893.53 1135.66 L1911.88 1135.66 L1911.88 1139.59 L1897.81 1139.59 L1897.81 1148.07 Q1898.83 1147.72 1899.85 1147.56 Q1900.86 1147.37 1901.88 1147.37 Q1907.67 1147.37 1911.05 1150.54 Q1914.43 1153.71 1914.43 1159.13 Q1914.43 1164.71 1910.96 1167.81 Q1907.48 1170.89 1901.17 1170.89 Q1898.99 1170.89 1896.72 1170.52 Q1894.48 1170.15 1892.07 1169.41 L1892.07 1164.71 Q1894.15 1165.84 1896.37 1166.4 Q1898.6 1166.95 1901.07 1166.95 Q1905.08 1166.95 1907.42 1164.85 Q1909.75 1162.74 1909.75 1159.13 Q1909.75 1155.52 1907.42 1153.41 Q1905.08 1151.31 1901.07 1151.31 Q1899.2 1151.31 1897.32 1151.72 Q1895.47 1152.14 1893.53 1153.02 L1893.53 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip660)\"\u003e\n\u003cimage width=\"21\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABUAAAAqCAYAAABcOxDuAAABh0lEQVRIia2WYbGDMBCEN09BaiES\nOkioBDRUArWABLBAHaABCZ1KABxs/5Q3DRzJJcDM/ehw7C3fLdMYkki92rblPM94PB5Gum9SRY0x\n3gMkN8J/KYLP51PngKS6rLUE4JXUl+R0nmfvd1VVYl8SUw1PIIFp27b66WfzTGK65lnX9W6vmqmW\nJ6Bkqs7nz8RoOefUPEnqRNeCdV2HRYdh4PV63TjJrdvtJkflaP1vf5omcRnOOS9O1lq8329xP5fL\nxagWtXbRNE2QJ8l4TlPyuVzBnCZ976vJ6u/dWht99WhOkcEzyjSHJxBgms3zO/1UnkGmyOQZZJrL\nE9hheojn18GpPHeZ4gDPXaZHeAIC08M8vy5O4fl6vdh1HUWmyOS59KtENYJd1xEA+77fivZ9n/RX\nLLnciJZlmcyzaRoC4DAMOtGyLKOi0nAvUkVReMlwzgWTs+R5miY/x6FFhZwuR6FxHDc90ZxKgkvP\nL8eg6Nrtcm4ax5G/zCWHQVGSuN/v4pGmqqro8j4AYO8cPUgUyAAAAABJRU5ErkJggg==\n\" transform=\"translate(1068, 1200)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 203.49,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1060.77 222.387,1060.77 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,855.188 222.387,855.188 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,649.61 222.387,649.61 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,444.032 222.387,444.032 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip660)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,238.453 222.387,238.453 \"/\u003e\n\u003cpath clip-path=\"url(#clip660)\" d=\"M113.374 1061.22 L143.05 1061.22 L143.05 1065.15 L113.374 1065.15 L113.374 1061.22 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M157.17 1074.11 L173.49 1074.11 L173.49 1078.05 L151.545 1078.05 L151.545 1074.11 Q154.207 1071.36 158.791 1066.73 Q163.397 1062.07 164.578 1060.73 Q166.823 1058.21 167.703 1056.47 Q168.605 1054.71 168.605 1053.02 Q168.605 1050.27 166.661 1048.53 Q164.74 1046.8 161.638 1046.8 Q159.439 1046.8 156.985 1047.56 Q154.555 1048.32 151.777 1049.88 L151.777 1045.15 Q154.601 1044.02 157.055 1043.44 Q159.508 1042.86 161.545 1042.86 Q166.916 1042.86 170.11 1045.55 Q173.305 1048.23 173.305 1052.72 Q173.305 1054.85 172.494 1056.77 Q171.707 1058.67 169.601 1061.26 Q169.022 1061.94 165.92 1065.15 Q162.818 1068.35 157.17 1074.11 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M113.004 855.64 L142.68 855.64 L142.68 859.575 L113.004 859.575 L113.004 855.64 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M153.582 868.533 L161.221 868.533 L161.221 842.168 L152.911 843.834 L152.911 839.575 L161.175 837.908 L165.851 837.908 L165.851 868.533 L173.49 868.533 L173.49 872.468 L153.582 872.468 L153.582 868.533 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M161.545 635.409 Q157.934 635.409 156.106 638.973 Q154.3 642.515 154.3 649.645 Q154.3 656.751 156.106 660.316 Q157.934 663.858 161.545 663.858 Q165.18 663.858 166.985 660.316 Q168.814 656.751 168.814 649.645 Q168.814 642.515 166.985 638.973 Q165.18 635.409 161.545 635.409 M161.545 631.705 Q167.355 631.705 170.411 636.311 Q173.49 640.895 173.49 649.645 Q173.49 658.372 170.411 662.978 Q167.355 667.561 161.545 667.561 Q155.735 667.561 152.656 662.978 Q149.601 658.372 149.601 649.645 Q149.601 640.895 152.656 636.311 Q155.735 631.705 161.545 631.705 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M153.582 457.377 L161.221 457.377 L161.221 431.011 L152.911 432.678 L152.911 428.418 L161.175 426.752 L165.851 426.752 L165.851 457.377 L173.49 457.377 L173.49 461.312 L153.582 461.312 L153.582 457.377 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip660)\" d=\"M157.17 251.798 L173.49 251.798 L173.49 255.733 L151.545 255.733 L151.545 251.798 Q154.207 249.044 158.791 244.414 Q163.397 239.761 164.578 238.419 Q166.823 235.896 167.703 234.159 Q168.605 232.4 168.605 230.71 Q168.605 227.956 166.661 226.22 Q164.74 224.484 161.638 224.484 Q159.439 224.484 156.985 225.247 Q154.555 226.011 151.777 227.562 L151.777 222.84 Q154.601 221.706 157.055 221.127 Q159.508 220.548 161.545 220.548 Q166.916 220.548 170.11 223.234 Q173.305 225.919 173.305 230.409 Q173.305 232.539 172.494 234.46 Q171.707 236.359 169.601 238.951 Q169.022 239.622 165.92 242.84 Q162.818 246.034 157.17 251.798 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip660)\"\u003e\n\u003cimage width=\"66\" height=\"98\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAAEIAAABiCAYAAADk+AXeAAAFTUlEQVR4nO2d7XWzIBTHr88EpCPQ\nTmAcgXQCs4LdgK7gCKQjeDpBkhE4nUAzAskG9/kQSa3RKAq+tN5z/h+SqoGfF4QL13qICEPY+XxG\nKSUcj0c4nU43AQBcLhcghMDT0xNQSoEQAkEQAGMM1uu1N0gBEdG6kiRBxhgCgHVxzlEphbbLbOUi\nSilnFW+SEMIKlF4nh2E4SuXrJKXsDKXTSYSQ1oWjlGIYhiiEMCqoUgr3+z3GcYymwOM4NgZidDCl\n9GEBwjDsdVdMJITAphti0mxaHRRFUe3d3u/3g1S8SZzzWiBtOtdG93TZQblSVcft+/7DMtf+IY7j\nu4uNXUFTVXmyEYhyX+DiuT2kys2mqh+7JzOjJmCqR0+W2gPHLrQrFZs85/xWzzsIjLFfC6Hqpmuv\nB8TvAVKXgcicpWGkaYqw3+8RACYzHhha2gk8RIQsy/D5+XmY6e4EbbfbXUEsBvBv7AJMxRYQuS0g\ncltA5OYExGazQc/z5tULuxyo9L1OkiSDjXGcgug7a03T1FpMctYgyp4BAEgIcQJjFiC0hBDOYiRG\nFYPS1HVoEOXr22wqjQdUheyKqpqxugaB+B1Fs/UbRu7YRkVwrkN8euY4CIjiHTYVIcR5uK9tc7UC\nAvHac5uscA0FRq+CDQairDYrTUOA0Wsvo4Go8pimJUFXYCYFolwwXTHXYHTnPGkQxaeGraYUhiFy\nzu9WyGcDoiwbYLSiKJovCJtgrJR5KiC6gLE5AXMSxdZBGaUUrFYrK8sEh8MBPz4+AAAgCAJ4f3+3\nuvwwGxCuzUmozvd9AIDZQABw5BFztCWKndsCIrcFRG4LiNz+AQBkWfane8zdbvcdKh9qx+zUBHqk\nivgd+/ttu+jaQpBS3n/51zaT6Sh8tZtYmtFNUXrPGJSm77WkirR+i4qz2YcbTqtOgJ7T6SmovEhV\ntbpee3LVtv+5AamqQ92xDy9Ul6aQJMmkgVRl/HROU2i6MOQRojRNJwGlLrkGAFqV0ejHmkJnURQN\n1nzahPJMOvtOhTAJsjLGkHOOSZIYe4+UEoUQGEWRUWC3S1S7112ZWrpjn77LipsqpdD3/VEqb2Ml\n3BqIsoQQzsC4SqkcLGaZZRkej0f4+vq6JcgrpeByudyOIYQApRQopRAEAfi+D5vNZpAA8BK8zW2J\nUOW2gMhtAZHbAiK3BURuC4jcFhC5LSByaw3icDjgdrtFz/Naab1e4263m89orWkyBZbnCVMN99X+\nwdaOtzpRSicT3aoF4RJAnadMDkS5kJxzlFLeubRSCqWUGMextZdxEUJGazo/PhSTyfpcVEpp/O6o\nMpBRQeg7a/tHpJSdgDSF4J2BsOENVSp7WpqmRh4zxCr9jw86zcA1iLLapEu5bi4/BlRhGMIY9vb2\n5iGih4heHMeVx1wuF/A8D8/nMzopxJ2LOKDfpRMuZwEX5SJF+u4LPZCy+Wzv+zSqGtzZhlH9peV2\naeOxXDXctzkyrZx06XbqvF0a2Gq1uutDXl5e7P1AHaFyohqltDN9WwM1l15bOw3PsswjhNw+n04n\n8DwPt9vt6N4BAICIHsDVa63sE20iVZfCaNKZuvCIomfY8IpWBz16eyi06MFdghg8E/jRcx0K7bUK\niksQ2isGA6FlssqtN2z8ShCI/UJ4tiHovVOjgNAq7mLtIs55r0FRcQNZXxBWtgUcDgd8fX3tfR2A\na2IcYwyCILj9YwGAa8bg6XSC4/EIn5+fP86xkk1o002VUr3fGGAqW3MOqyCKKr4yyZVszjWcgShK\nSmn1vy242Pk7CIgqCSGQMdZq/yRjzHmG0X8dk2z/ab7RIQAAAABJRU5ErkJggg==\n\" transform=\"translate(22, 560)\"/\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip660)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1078.12, 57.6)\" x=\"1078.12\" y=\"57.6\"\u003ePendulum over [0,5]\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip662)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"252.997,135.664 269.5,137.563 286.002,139.768 302.505,142.283 319.007,145.111 335.51,148.259 352.012,151.73 368.515,155.531 385.017,159.668 401.52,164.148 418.022,168.978 434.525,174.165 451.027,179.717 467.53,185.643 484.032,191.952 500.535,198.652 517.037,205.752 533.54,213.261 550.042,221.189 566.545,229.544 583.047,238.335 599.55,247.571 616.052,257.26 632.555,267.409 649.058,278.024 665.56,289.112 682.063,300.677 698.565,312.723 715.068,325.25 731.57,338.259 748.073,351.749 764.575,365.714 781.078,380.149 797.58,395.043 814.083,410.386 830.585,426.161 847.088,442.352 863.59,458.936 880.093,475.89 896.595,493.185 913.098,510.791 929.6,528.674 946.103,546.797 962.605,565.121 979.108,583.604 995.61,602.203 1012.11,620.873 1028.62,639.568 1045.12,658.241 1061.62,676.846 1078.12,695.337 1094.63,713.669 1111.13,731.797 1127.63,749.68 1144.13,767.279 1160.64,784.555 1177.14,801.475 1193.64,818.008 1210.14,834.124 1226.65,849.798 1243.15,865.009 1259.65,879.737 1276.15,893.967 1292.66,907.684 1309.16,920.88 1325.66,933.545 1342.16,945.675 1358.67,957.265 1375.17,968.314 1391.67,978.823 1408.17,988.793 1424.68,998.225 1441.18,1007.13 1457.68,1015.5 1474.18,1023.35 1490.69,1030.68 1507.19,1037.5 1523.69,1043.81 1540.19,1049.63 1556.7,1054.95 1573.2,1059.79 1589.7,1064.15 1606.2,1068.04 1622.71,1071.45 1639.21,1074.41 1655.71,1076.9 1672.21,1078.94 1688.72,1080.53 1705.22,1081.67 1721.72,1082.36 1738.22,1082.61 1754.73,1082.42 1771.23,1081.79 1787.73,1080.71 1804.23,1079.2 1820.74,1077.24 1837.24,1074.84 1853.74,1072 1870.24,1068.7 1886.75,1064.96 1903.25,1060.77 \"/\u003e\n\u003c/svg\u003e\n","content_type":"text/html"},"image/svg+xml":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip610\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip610)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip611\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip610)\" d=\"M203.49 1111.02 L1952.76 1111.02 L1952.76 107.256 L203.49 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip612\"\u003e\n    \u003crect x=\"203\" y=\"107\" width=\"1750\" height=\"1005\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"252.997,1111.02 252.997,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"583.047,1111.02 583.047,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"913.098,1111.02 913.098,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1243.15,1111.02 1243.15,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1573.2,1111.02 1573.2,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1903.25,1111.02 1903.25,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,1060.77 1952.76,1060.77 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,855.188 1952.76,855.188 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,649.61 1952.76,649.61 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,444.032 1952.76,444.032 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,238.453 1952.76,238.453 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 1952.76,1111.02 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"252.997,1111.02 252.997,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"583.047,1111.02 583.047,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"913.098,1111.02 913.098,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1243.15,1111.02 1243.15,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1573.2,1111.02 1573.2,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1903.25,1111.02 1903.25,1092.12 \"/\u003e\n\u003cpath clip-path=\"url(#clip610)\" d=\"M252.997 1138.74 Q249.386 1138.74 247.557 1142.3 Q245.752 1145.84 245.752 1152.97 Q245.752 1160.08 247.557 1163.64 Q249.386 1167.19 252.997 1167.19 Q256.631 1167.19 258.437 1163.64 Q260.266 1160.08 260.266 1152.97 Q260.266 1145.84 258.437 1142.3 Q256.631 1138.74 252.997 1138.74 M252.997 1135.03 Q258.807 1135.03 261.863 1139.64 Q264.942 1144.22 264.942 1152.97 Q264.942 1161.7 261.863 1166.31 Q258.807 1170.89 252.997 1170.89 Q247.187 1170.89 244.108 1166.31 Q241.053 1161.7 241.053 1152.97 Q241.053 1144.22 244.108 1139.64 Q247.187 1135.03 252.997 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M573.429 1166.28 L581.068 1166.28 L581.068 1139.92 L572.758 1141.58 L572.758 1137.33 L581.022 1135.66 L585.698 1135.66 L585.698 1166.28 L593.337 1166.28 L593.337 1170.22 L573.429 1170.22 L573.429 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M907.75 1166.28 L924.07 1166.28 L924.07 1170.22 L902.126 1170.22 L902.126 1166.28 Q904.788 1163.53 909.371 1158.9 Q913.977 1154.25 915.158 1152.9 Q917.403 1150.38 918.283 1148.64 Q919.186 1146.89 919.186 1145.2 Q919.186 1142.44 917.241 1140.7 Q915.32 1138.97 912.218 1138.97 Q910.019 1138.97 907.565 1139.73 Q905.135 1140.5 902.357 1142.05 L902.357 1137.33 Q905.181 1136.19 907.635 1135.61 Q910.088 1135.03 912.125 1135.03 Q917.496 1135.03 920.69 1137.72 Q923.885 1140.4 923.885 1144.89 Q923.885 1147.02 923.074 1148.95 Q922.287 1150.84 920.181 1153.44 Q919.602 1154.11 916.5 1157.33 Q913.399 1160.52 907.75 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M1247.4 1151.58 Q1250.75 1152.3 1252.63 1154.57 Q1254.53 1156.84 1254.53 1160.17 Q1254.53 1165.29 1251.01 1168.09 Q1247.49 1170.89 1241.01 1170.89 Q1238.83 1170.89 1236.52 1170.45 Q1234.22 1170.03 1231.77 1169.18 L1231.77 1164.66 Q1233.72 1165.8 1236.03 1166.38 Q1238.34 1166.95 1240.87 1166.95 Q1245.27 1166.95 1247.56 1165.22 Q1249.87 1163.48 1249.87 1160.17 Q1249.87 1157.12 1247.72 1155.4 Q1245.59 1153.67 1241.77 1153.67 L1237.74 1153.67 L1237.74 1149.83 L1241.96 1149.83 Q1245.4 1149.83 1247.23 1148.46 Q1249.06 1147.07 1249.06 1144.48 Q1249.06 1141.82 1247.16 1140.4 Q1245.29 1138.97 1241.77 1138.97 Q1239.85 1138.97 1237.65 1139.39 Q1235.45 1139.8 1232.81 1140.68 L1232.81 1136.51 Q1235.47 1135.77 1237.79 1135.4 Q1240.13 1135.03 1242.19 1135.03 Q1247.51 1135.03 1250.61 1137.46 Q1253.71 1139.87 1253.71 1143.99 Q1253.71 1146.86 1252.07 1148.85 Q1250.43 1150.82 1247.4 1151.58 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M1576.21 1139.73 L1564.4 1158.18 L1576.21 1158.18 L1576.21 1139.73 M1574.98 1135.66 L1580.86 1135.66 L1580.86 1158.18 L1585.79 1158.18 L1585.79 1162.07 L1580.86 1162.07 L1580.86 1170.22 L1576.21 1170.22 L1576.21 1162.07 L1560.61 1162.07 L1560.61 1157.56 L1574.98 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M1893.53 1135.66 L1911.88 1135.66 L1911.88 1139.59 L1897.81 1139.59 L1897.81 1148.07 Q1898.83 1147.72 1899.85 1147.56 Q1900.86 1147.37 1901.88 1147.37 Q1907.67 1147.37 1911.05 1150.54 Q1914.43 1153.71 1914.43 1159.13 Q1914.43 1164.71 1910.96 1167.81 Q1907.48 1170.89 1901.17 1170.89 Q1898.99 1170.89 1896.72 1170.52 Q1894.48 1170.15 1892.07 1169.41 L1892.07 1164.71 Q1894.15 1165.84 1896.37 1166.4 Q1898.6 1166.95 1901.07 1166.95 Q1905.08 1166.95 1907.42 1164.85 Q1909.75 1162.74 1909.75 1159.13 Q1909.75 1155.52 1907.42 1153.41 Q1905.08 1151.31 1901.07 1151.31 Q1899.2 1151.31 1897.32 1151.72 Q1895.47 1152.14 1893.53 1153.02 L1893.53 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip610)\"\u003e\n\u003cimage width=\"21\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABUAAAAqCAYAAABcOxDuAAABh0lEQVRIia2WYbGDMBCEN09BaiES\nOkioBDRUArWABLBAHaABCZ1KABxs/5Q3DRzJJcDM/ehw7C3fLdMYkki92rblPM94PB5Gum9SRY0x\n3gMkN8J/KYLP51PngKS6rLUE4JXUl+R0nmfvd1VVYl8SUw1PIIFp27b66WfzTGK65lnX9W6vmqmW\nJ6Bkqs7nz8RoOefUPEnqRNeCdV2HRYdh4PV63TjJrdvtJkflaP1vf5omcRnOOS9O1lq8329xP5fL\nxagWtXbRNE2QJ8l4TlPyuVzBnCZ976vJ6u/dWht99WhOkcEzyjSHJxBgms3zO/1UnkGmyOQZZJrL\nE9hheojn18GpPHeZ4gDPXaZHeAIC08M8vy5O4fl6vdh1HUWmyOS59KtENYJd1xEA+77fivZ9n/RX\nLLnciJZlmcyzaRoC4DAMOtGyLKOi0nAvUkVReMlwzgWTs+R5miY/x6FFhZwuR6FxHDc90ZxKgkvP\nL8eg6Nrtcm4ax5G/zCWHQVGSuN/v4pGmqqro8j4AYO8cPUgUyAAAAABJRU5ErkJggg==\n\" transform=\"translate(1068, 1200)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 203.49,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1060.77 222.387,1060.77 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,855.188 222.387,855.188 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,649.61 222.387,649.61 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,444.032 222.387,444.032 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip610)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,238.453 222.387,238.453 \"/\u003e\n\u003cpath clip-path=\"url(#clip610)\" d=\"M113.374 1061.22 L143.05 1061.22 L143.05 1065.15 L113.374 1065.15 L113.374 1061.22 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M157.17 1074.11 L173.49 1074.11 L173.49 1078.05 L151.545 1078.05 L151.545 1074.11 Q154.207 1071.36 158.791 1066.73 Q163.397 1062.07 164.578 1060.73 Q166.823 1058.21 167.703 1056.47 Q168.605 1054.71 168.605 1053.02 Q168.605 1050.27 166.661 1048.53 Q164.74 1046.8 161.638 1046.8 Q159.439 1046.8 156.985 1047.56 Q154.555 1048.32 151.777 1049.88 L151.777 1045.15 Q154.601 1044.02 157.055 1043.44 Q159.508 1042.86 161.545 1042.86 Q166.916 1042.86 170.11 1045.55 Q173.305 1048.23 173.305 1052.72 Q173.305 1054.85 172.494 1056.77 Q171.707 1058.67 169.601 1061.26 Q169.022 1061.94 165.92 1065.15 Q162.818 1068.35 157.17 1074.11 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M113.004 855.64 L142.68 855.64 L142.68 859.575 L113.004 859.575 L113.004 855.64 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M153.582 868.533 L161.221 868.533 L161.221 842.168 L152.911 843.834 L152.911 839.575 L161.175 837.908 L165.851 837.908 L165.851 868.533 L173.49 868.533 L173.49 872.468 L153.582 872.468 L153.582 868.533 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M161.545 635.409 Q157.934 635.409 156.106 638.973 Q154.3 642.515 154.3 649.645 Q154.3 656.751 156.106 660.316 Q157.934 663.858 161.545 663.858 Q165.18 663.858 166.985 660.316 Q168.814 656.751 168.814 649.645 Q168.814 642.515 166.985 638.973 Q165.18 635.409 161.545 635.409 M161.545 631.705 Q167.355 631.705 170.411 636.311 Q173.49 640.895 173.49 649.645 Q173.49 658.372 170.411 662.978 Q167.355 667.561 161.545 667.561 Q155.735 667.561 152.656 662.978 Q149.601 658.372 149.601 649.645 Q149.601 640.895 152.656 636.311 Q155.735 631.705 161.545 631.705 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M153.582 457.377 L161.221 457.377 L161.221 431.011 L152.911 432.678 L152.911 428.418 L161.175 426.752 L165.851 426.752 L165.851 457.377 L173.49 457.377 L173.49 461.312 L153.582 461.312 L153.582 457.377 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip610)\" d=\"M157.17 251.798 L173.49 251.798 L173.49 255.733 L151.545 255.733 L151.545 251.798 Q154.207 249.044 158.791 244.414 Q163.397 239.761 164.578 238.419 Q166.823 235.896 167.703 234.159 Q168.605 232.4 168.605 230.71 Q168.605 227.956 166.661 226.22 Q164.74 224.484 161.638 224.484 Q159.439 224.484 156.985 225.247 Q154.555 226.011 151.777 227.562 L151.777 222.84 Q154.601 221.706 157.055 221.127 Q159.508 220.548 161.545 220.548 Q166.916 220.548 170.11 223.234 Q173.305 225.919 173.305 230.409 Q173.305 232.539 172.494 234.46 Q171.707 236.359 169.601 238.951 Q169.022 239.622 165.92 242.84 Q162.818 246.034 157.17 251.798 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip610)\"\u003e\n\u003cimage width=\"66\" height=\"98\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAAEIAAABiCAYAAADk+AXeAAAFTUlEQVR4nO2d7XWzIBTHr88EpCPQ\nTmAcgXQCs4LdgK7gCKQjeDpBkhE4nUAzAskG9/kQSa3RKAq+tN5z/h+SqoGfF4QL13qICEPY+XxG\nKSUcj0c4nU43AQBcLhcghMDT0xNQSoEQAkEQAGMM1uu1N0gBEdG6kiRBxhgCgHVxzlEphbbLbOUi\nSilnFW+SEMIKlF4nh2E4SuXrJKXsDKXTSYSQ1oWjlGIYhiiEMCqoUgr3+z3GcYymwOM4NgZidDCl\n9GEBwjDsdVdMJITAphti0mxaHRRFUe3d3u/3g1S8SZzzWiBtOtdG93TZQblSVcft+/7DMtf+IY7j\nu4uNXUFTVXmyEYhyX+DiuT2kys2mqh+7JzOjJmCqR0+W2gPHLrQrFZs85/xWzzsIjLFfC6Hqpmuv\nB8TvAVKXgcicpWGkaYqw3+8RACYzHhha2gk8RIQsy/D5+XmY6e4EbbfbXUEsBvBv7AJMxRYQuS0g\ncltA5OYExGazQc/z5tULuxyo9L1OkiSDjXGcgug7a03T1FpMctYgyp4BAEgIcQJjFiC0hBDOYiRG\nFYPS1HVoEOXr22wqjQdUheyKqpqxugaB+B1Fs/UbRu7YRkVwrkN8euY4CIjiHTYVIcR5uK9tc7UC\nAvHac5uscA0FRq+CDQairDYrTUOA0Wsvo4Go8pimJUFXYCYFolwwXTHXYHTnPGkQxaeGraYUhiFy\nzu9WyGcDoiwbYLSiKJovCJtgrJR5KiC6gLE5AXMSxdZBGaUUrFYrK8sEh8MBPz4+AAAgCAJ4f3+3\nuvwwGxCuzUmozvd9AIDZQABw5BFztCWKndsCIrcFRG4LiNz+AQBkWfane8zdbvcdKh9qx+zUBHqk\nivgd+/ttu+jaQpBS3n/51zaT6Sh8tZtYmtFNUXrPGJSm77WkirR+i4qz2YcbTqtOgJ7T6SmovEhV\ntbpee3LVtv+5AamqQ92xDy9Ul6aQJMmkgVRl/HROU2i6MOQRojRNJwGlLrkGAFqV0ejHmkJnURQN\n1nzahPJMOvtOhTAJsjLGkHOOSZIYe4+UEoUQGEWRUWC3S1S7112ZWrpjn77LipsqpdD3/VEqb2Ml\n3BqIsoQQzsC4SqkcLGaZZRkej0f4+vq6JcgrpeByudyOIYQApRQopRAEAfi+D5vNZpAA8BK8zW2J\nUOW2gMhtAZHbAiK3BURuC4jcFhC5LSByaw3icDjgdrtFz/Naab1e4263m89orWkyBZbnCVMN99X+\nwdaOtzpRSicT3aoF4RJAnadMDkS5kJxzlFLeubRSCqWUGMextZdxEUJGazo/PhSTyfpcVEpp/O6o\nMpBRQeg7a/tHpJSdgDSF4J2BsOENVSp7WpqmRh4zxCr9jw86zcA1iLLapEu5bi4/BlRhGMIY9vb2\n5iGih4heHMeVx1wuF/A8D8/nMzopxJ2LOKDfpRMuZwEX5SJF+u4LPZCy+Wzv+zSqGtzZhlH9peV2\naeOxXDXctzkyrZx06XbqvF0a2Gq1uutDXl5e7P1AHaFyohqltDN9WwM1l15bOw3PsswjhNw+n04n\n8DwPt9vt6N4BAICIHsDVa63sE20iVZfCaNKZuvCIomfY8IpWBz16eyi06MFdghg8E/jRcx0K7bUK\niksQ2isGA6FlssqtN2z8ShCI/UJ4tiHovVOjgNAq7mLtIs55r0FRcQNZXxBWtgUcDgd8fX3tfR2A\na2IcYwyCILj9YwGAa8bg6XSC4/EIn5+fP86xkk1o002VUr3fGGAqW3MOqyCKKr4yyZVszjWcgShK\nSmn1vy242Pk7CIgqCSGQMdZq/yRjzHmG0X8dk2z/ab7RIQAAAABJRU5ErkJggg==\n\" transform=\"translate(22, 560)\"/\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip610)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1078.12, 57.6)\" x=\"1078.12\" y=\"57.6\"\u003ePendulum over [0,5]\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip612)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"252.997,135.664 269.5,137.563 286.002,139.768 302.505,142.283 319.007,145.111 335.51,148.259 352.012,151.73 368.515,155.531 385.017,159.668 401.52,164.148 418.022,168.978 434.525,174.165 451.027,179.717 467.53,185.643 484.032,191.952 500.535,198.652 517.037,205.752 533.54,213.261 550.042,221.189 566.545,229.544 583.047,238.335 599.55,247.571 616.052,257.26 632.555,267.409 649.058,278.024 665.56,289.112 682.063,300.677 698.565,312.723 715.068,325.25 731.57,338.259 748.073,351.749 764.575,365.714 781.078,380.149 797.58,395.043 814.083,410.386 830.585,426.161 847.088,442.352 863.59,458.936 880.093,475.89 896.595,493.185 913.098,510.791 929.6,528.674 946.103,546.797 962.605,565.121 979.108,583.604 995.61,602.203 1012.11,620.873 1028.62,639.568 1045.12,658.241 1061.62,676.846 1078.12,695.337 1094.63,713.669 1111.13,731.797 1127.63,749.68 1144.13,767.279 1160.64,784.555 1177.14,801.475 1193.64,818.008 1210.14,834.124 1226.65,849.798 1243.15,865.009 1259.65,879.737 1276.15,893.967 1292.66,907.684 1309.16,920.88 1325.66,933.545 1342.16,945.675 1358.67,957.265 1375.17,968.314 1391.67,978.823 1408.17,988.793 1424.68,998.225 1441.18,1007.13 1457.68,1015.5 1474.18,1023.35 1490.69,1030.68 1507.19,1037.5 1523.69,1043.81 1540.19,1049.63 1556.7,1054.95 1573.2,1059.79 1589.7,1064.15 1606.2,1068.04 1622.71,1071.45 1639.21,1074.41 1655.71,1076.9 1672.21,1078.94 1688.72,1080.53 1705.22,1081.67 1721.72,1082.36 1738.22,1082.61 1754.73,1082.42 1771.23,1081.79 1787.73,1080.71 1804.23,1079.2 1820.74,1077.24 1837.24,1074.84 1853.74,1072 1870.24,1068.7 1886.75,1064.96 1903.25,1060.77 \"/\u003e\n\u003c/svg\u003e\n","content_type":"image/svg+xml"}}}],"key":"jXEte1BRLF"}],"key":"tAsCq9Ry6f"},{"type":"paragraph","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"children":[{"type":"text","value":"If we extend the time interval longer for the same boundary values, then the initial slope must adjust.","position":{"start":{"line":498,"column":1},"end":{"line":498,"column":1}},"key":"WzGl621b9C"}],"key":"SqA64BWIEw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"t, θ = FNC.bvp(ϕ, [0, 8], g₁, g₂, init)\nplot(t, θ;\n    xaxis=(L\"t\"),  yaxis=(L\"\\theta(t)\"),\n    title=\"Pendulum over [0,8]\" )","key":"mgR9U5aeF2"},{"type":"output","id":"ZZB3Squxj1pgCv21x3MHN","data":[{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0b666d72d279911e10ddd52d6fa7c2fa","path":"/2025-06-04/build/0b666d72d279911e10ddd52d6fa7c2fa.png"},"text/html":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip750\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip750)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip751\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip750)\" d=\"M203.49 1111.02 L1952.76 1111.02 L1952.76 107.256 L203.49 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip752\"\u003e\n    \u003crect x=\"203\" y=\"107\" width=\"1750\" height=\"1005\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"252.997,1111.02 252.997,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"665.56,1111.02 665.56,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1078.12,1111.02 1078.12,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1490.69,1111.02 1490.69,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1903.25,1111.02 1903.25,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,1037.23 1952.76,1037.23 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,852.088 1952.76,852.088 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,666.947 1952.76,666.947 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,481.806 1952.76,481.806 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,296.664 1952.76,296.664 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,111.523 1952.76,111.523 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 1952.76,1111.02 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"252.997,1111.02 252.997,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"665.56,1111.02 665.56,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1078.12,1111.02 1078.12,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1490.69,1111.02 1490.69,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1903.25,1111.02 1903.25,1092.12 \"/\u003e\n\u003cpath clip-path=\"url(#clip750)\" d=\"M252.997 1138.74 Q249.386 1138.74 247.557 1142.3 Q245.752 1145.84 245.752 1152.97 Q245.752 1160.08 247.557 1163.64 Q249.386 1167.19 252.997 1167.19 Q256.631 1167.19 258.437 1163.64 Q260.266 1160.08 260.266 1152.97 Q260.266 1145.84 258.437 1142.3 Q256.631 1138.74 252.997 1138.74 M252.997 1135.03 Q258.807 1135.03 261.863 1139.64 Q264.942 1144.22 264.942 1152.97 Q264.942 1161.7 261.863 1166.31 Q258.807 1170.89 252.997 1170.89 Q247.187 1170.89 244.108 1166.31 Q241.053 1161.7 241.053 1152.97 Q241.053 1144.22 244.108 1139.64 Q247.187 1135.03 252.997 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M660.213 1166.28 L676.532 1166.28 L676.532 1170.22 L654.588 1170.22 L654.588 1166.28 Q657.25 1163.53 661.833 1158.9 Q666.44 1154.25 667.62 1152.9 Q669.866 1150.38 670.745 1148.64 Q671.648 1146.89 671.648 1145.2 Q671.648 1142.44 669.704 1140.7 Q667.782 1138.97 664.68 1138.97 Q662.481 1138.97 660.028 1139.73 Q657.597 1140.5 654.819 1142.05 L654.819 1137.33 Q657.643 1136.19 660.097 1135.61 Q662.551 1135.03 664.588 1135.03 Q669.958 1135.03 673.153 1137.72 Q676.347 1140.4 676.347 1144.89 Q676.347 1147.02 675.537 1148.95 Q674.75 1150.84 672.643 1153.44 Q672.065 1154.11 668.963 1157.33 Q665.861 1160.52 660.213 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M1081.13 1139.73 L1069.33 1158.18 L1081.13 1158.18 L1081.13 1139.73 M1079.91 1135.66 L1085.78 1135.66 L1085.78 1158.18 L1090.72 1158.18 L1090.72 1162.07 L1085.78 1162.07 L1085.78 1170.22 L1081.13 1170.22 L1081.13 1162.07 L1065.53 1162.07 L1065.53 1157.56 L1079.91 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M1491.09 1151.08 Q1487.94 1151.08 1486.09 1153.23 Q1484.26 1155.38 1484.26 1159.13 Q1484.26 1162.86 1486.09 1165.03 Q1487.94 1167.19 1491.09 1167.19 Q1494.24 1167.19 1496.07 1165.03 Q1497.92 1162.86 1497.92 1159.13 Q1497.92 1155.38 1496.07 1153.23 Q1494.24 1151.08 1491.09 1151.08 M1500.37 1136.42 L1500.37 1140.68 Q1498.61 1139.85 1496.81 1139.41 Q1495.03 1138.97 1493.27 1138.97 Q1488.64 1138.97 1486.18 1142.09 Q1483.75 1145.22 1483.41 1151.54 Q1484.77 1149.52 1486.83 1148.46 Q1488.89 1147.37 1491.37 1147.37 Q1496.58 1147.37 1499.59 1150.54 Q1502.62 1153.69 1502.62 1159.13 Q1502.62 1164.45 1499.47 1167.67 Q1496.32 1170.89 1491.09 1170.89 Q1485.1 1170.89 1481.92 1166.31 Q1478.75 1161.7 1478.75 1152.97 Q1478.75 1144.78 1482.64 1139.92 Q1486.53 1135.03 1493.08 1135.03 Q1494.84 1135.03 1496.62 1135.38 Q1498.43 1135.73 1500.37 1136.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M1903.25 1153.81 Q1899.92 1153.81 1897.99 1155.59 Q1896.1 1157.37 1896.1 1160.5 Q1896.1 1163.62 1897.99 1165.4 Q1899.92 1167.19 1903.25 1167.19 Q1906.58 1167.19 1908.5 1165.4 Q1910.42 1163.6 1910.42 1160.5 Q1910.42 1157.37 1908.5 1155.59 Q1906.6 1153.81 1903.25 1153.81 M1898.57 1151.82 Q1895.56 1151.08 1893.87 1149.01 Q1892.21 1146.95 1892.21 1143.99 Q1892.21 1139.85 1895.15 1137.44 Q1898.11 1135.03 1903.25 1135.03 Q1908.41 1135.03 1911.35 1137.44 Q1914.29 1139.85 1914.29 1143.99 Q1914.29 1146.95 1912.6 1149.01 Q1910.93 1151.08 1907.95 1151.82 Q1911.33 1152.6 1913.2 1154.89 Q1915.1 1157.19 1915.1 1160.5 Q1915.1 1165.52 1912.02 1168.2 Q1908.97 1170.89 1903.25 1170.89 Q1897.53 1170.89 1894.45 1168.2 Q1891.4 1165.52 1891.4 1160.5 Q1891.4 1157.19 1893.29 1154.89 Q1895.19 1152.6 1898.57 1151.82 M1896.86 1144.43 Q1896.86 1147.12 1898.53 1148.62 Q1900.22 1150.13 1903.25 1150.13 Q1906.26 1150.13 1907.95 1148.62 Q1909.66 1147.12 1909.66 1144.43 Q1909.66 1141.75 1907.95 1140.24 Q1906.26 1138.74 1903.25 1138.74 Q1900.22 1138.74 1898.53 1140.24 Q1896.86 1141.75 1896.86 1144.43 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip750)\"\u003e\n\u003cimage width=\"21\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABUAAAAqCAYAAABcOxDuAAABh0lEQVRIia2WYbGDMBCEN09BaiES\nOkioBDRUArWABLBAHaABCZ1KABxs/5Q3DRzJJcDM/ehw7C3fLdMYkki92rblPM94PB5Gum9SRY0x\n3gMkN8J/KYLP51PngKS6rLUE4JXUl+R0nmfvd1VVYl8SUw1PIIFp27b66WfzTGK65lnX9W6vmqmW\nJ6Bkqs7nz8RoOefUPEnqRNeCdV2HRYdh4PV63TjJrdvtJkflaP1vf5omcRnOOS9O1lq8329xP5fL\nxagWtXbRNE2QJ8l4TlPyuVzBnCZ976vJ6u/dWht99WhOkcEzyjSHJxBgms3zO/1UnkGmyOQZZJrL\nE9hheojn18GpPHeZ4gDPXaZHeAIC08M8vy5O4fl6vdh1HUWmyOS59KtENYJd1xEA+77fivZ9n/RX\nLLnciJZlmcyzaRoC4DAMOtGyLKOi0nAvUkVReMlwzgWTs+R5miY/x6FFhZwuR6FxHDc90ZxKgkvP\nL8eg6Nrtcm4ax5G/zCWHQVGSuN/v4pGmqqro8j4AYO8cPUgUyAAAAABJRU5ErkJggg==\n\" transform=\"translate(1068, 1200)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 203.49,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1037.23 222.387,1037.23 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,852.088 222.387,852.088 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,666.947 222.387,666.947 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,481.806 222.387,481.806 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,296.664 222.387,296.664 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip750)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,111.523 222.387,111.523 \"/\u003e\n\u003cpath clip-path=\"url(#clip750)\" d=\"M113.374 1037.68 L143.05 1037.68 L143.05 1041.62 L113.374 1041.62 L113.374 1037.68 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M157.17 1050.57 L173.49 1050.57 L173.49 1054.51 L151.545 1054.51 L151.545 1050.57 Q154.207 1047.82 158.791 1043.19 Q163.397 1038.54 164.578 1037.19 Q166.823 1034.67 167.703 1032.94 Q168.605 1031.18 168.605 1029.49 Q168.605 1026.73 166.661 1025 Q164.74 1023.26 161.638 1023.26 Q159.439 1023.26 156.985 1024.02 Q154.555 1024.79 151.777 1026.34 L151.777 1021.62 Q154.601 1020.48 157.055 1019.9 Q159.508 1019.32 161.545 1019.32 Q166.916 1019.32 170.11 1022.01 Q173.305 1024.69 173.305 1029.19 Q173.305 1031.32 172.494 1033.24 Q171.707 1035.13 169.601 1037.73 Q169.022 1038.4 165.92 1041.62 Q162.818 1044.81 157.17 1050.57 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M113.004 852.54 L142.68 852.54 L142.68 856.475 L113.004 856.475 L113.004 852.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M153.582 865.433 L161.221 865.433 L161.221 839.067 L152.911 840.734 L152.911 836.475 L161.175 834.808 L165.851 834.808 L165.851 865.433 L173.49 865.433 L173.49 869.368 L153.582 869.368 L153.582 865.433 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M161.545 652.746 Q157.934 652.746 156.106 656.31 Q154.3 659.852 154.3 666.982 Q154.3 674.088 156.106 677.653 Q157.934 681.195 161.545 681.195 Q165.18 681.195 166.985 677.653 Q168.814 674.088 168.814 666.982 Q168.814 659.852 166.985 656.31 Q165.18 652.746 161.545 652.746 M161.545 649.042 Q167.355 649.042 170.411 653.648 Q173.49 658.232 173.49 666.982 Q173.49 675.708 170.411 680.315 Q167.355 684.898 161.545 684.898 Q155.735 684.898 152.656 680.315 Q149.601 675.708 149.601 666.982 Q149.601 658.232 152.656 653.648 Q155.735 649.042 161.545 649.042 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M153.582 495.151 L161.221 495.151 L161.221 468.785 L152.911 470.452 L152.911 466.192 L161.175 464.526 L165.851 464.526 L165.851 495.151 L173.49 495.151 L173.49 499.086 L153.582 499.086 L153.582 495.151 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M157.17 310.009 L173.49 310.009 L173.49 313.944 L151.545 313.944 L151.545 310.009 Q154.207 307.255 158.791 302.625 Q163.397 297.972 164.578 296.63 Q166.823 294.107 167.703 292.37 Q168.605 290.611 168.605 288.921 Q168.605 286.167 166.661 284.431 Q164.74 282.695 161.638 282.695 Q159.439 282.695 156.985 283.458 Q154.555 284.222 151.777 285.773 L151.777 281.051 Q154.601 279.917 157.055 279.338 Q159.508 278.759 161.545 278.759 Q166.916 278.759 170.11 281.445 Q173.305 284.13 173.305 288.62 Q173.305 290.75 172.494 292.671 Q171.707 294.57 169.601 297.162 Q169.022 297.833 165.92 301.051 Q162.818 304.245 157.17 310.009 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip750)\" d=\"M166.36 110.169 Q169.717 110.887 171.592 113.155 Q173.49 115.424 173.49 118.757 Q173.49 123.873 169.971 126.674 Q166.453 129.474 159.971 129.474 Q157.795 129.474 155.481 129.035 Q153.189 128.618 150.735 127.762 L150.735 123.248 Q152.68 124.382 154.994 124.961 Q157.309 125.539 159.832 125.539 Q164.23 125.539 166.522 123.803 Q168.837 122.067 168.837 118.757 Q168.837 115.701 166.684 113.988 Q164.555 112.252 160.735 112.252 L156.707 112.252 L156.707 108.41 L160.92 108.41 Q164.369 108.41 166.198 107.044 Q168.027 105.655 168.027 103.063 Q168.027 100.401 166.129 98.9885 Q164.254 97.5533 160.735 97.5533 Q158.814 97.5533 156.615 97.97 Q154.416 98.3867 151.777 99.2663 L151.777 95.0996 Q154.439 94.3589 156.754 93.9885 Q159.092 93.6182 161.152 93.6182 Q166.476 93.6182 169.578 96.0487 Q172.68 98.4561 172.68 102.576 Q172.68 105.447 171.036 107.438 Q169.392 109.405 166.36 110.169 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip750)\"\u003e\n\u003cimage width=\"66\" height=\"98\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAAEIAAABiCAYAAADk+AXeAAAFTUlEQVR4nO2d7XWzIBTHr88EpCPQ\nTmAcgXQCs4LdgK7gCKQjeDpBkhE4nUAzAskG9/kQSa3RKAq+tN5z/h+SqoGfF4QL13qICEPY+XxG\nKSUcj0c4nU43AQBcLhcghMDT0xNQSoEQAkEQAGMM1uu1N0gBEdG6kiRBxhgCgHVxzlEphbbLbOUi\nSilnFW+SEMIKlF4nh2E4SuXrJKXsDKXTSYSQ1oWjlGIYhiiEMCqoUgr3+z3GcYymwOM4NgZidDCl\n9GEBwjDsdVdMJITAphti0mxaHRRFUe3d3u/3g1S8SZzzWiBtOtdG93TZQblSVcft+/7DMtf+IY7j\nu4uNXUFTVXmyEYhyX+DiuT2kys2mqh+7JzOjJmCqR0+W2gPHLrQrFZs85/xWzzsIjLFfC6Hqpmuv\nB8TvAVKXgcicpWGkaYqw3+8RACYzHhha2gk8RIQsy/D5+XmY6e4EbbfbXUEsBvBv7AJMxRYQuS0g\ncltA5OYExGazQc/z5tULuxyo9L1OkiSDjXGcgug7a03T1FpMctYgyp4BAEgIcQJjFiC0hBDOYiRG\nFYPS1HVoEOXr22wqjQdUheyKqpqxugaB+B1Fs/UbRu7YRkVwrkN8euY4CIjiHTYVIcR5uK9tc7UC\nAvHac5uscA0FRq+CDQairDYrTUOA0Wsvo4Go8pimJUFXYCYFolwwXTHXYHTnPGkQxaeGraYUhiFy\nzu9WyGcDoiwbYLSiKJovCJtgrJR5KiC6gLE5AXMSxdZBGaUUrFYrK8sEh8MBPz4+AAAgCAJ4f3+3\nuvwwGxCuzUmozvd9AIDZQABw5BFztCWKndsCIrcFRG4LiNz+AQBkWfane8zdbvcdKh9qx+zUBHqk\nivgd+/ttu+jaQpBS3n/51zaT6Sh8tZtYmtFNUXrPGJSm77WkirR+i4qz2YcbTqtOgJ7T6SmovEhV\ntbpee3LVtv+5AamqQ92xDy9Ul6aQJMmkgVRl/HROU2i6MOQRojRNJwGlLrkGAFqV0ejHmkJnURQN\n1nzahPJMOvtOhTAJsjLGkHOOSZIYe4+UEoUQGEWRUWC3S1S7112ZWrpjn77LipsqpdD3/VEqb2Ml\n3BqIsoQQzsC4SqkcLGaZZRkej0f4+vq6JcgrpeByudyOIYQApRQopRAEAfi+D5vNZpAA8BK8zW2J\nUOW2gMhtAZHbAiK3BURuC4jcFhC5LSByaw3icDjgdrtFz/Naab1e4263m89orWkyBZbnCVMN99X+\nwdaOtzpRSicT3aoF4RJAnadMDkS5kJxzlFLeubRSCqWUGMextZdxEUJGazo/PhSTyfpcVEpp/O6o\nMpBRQeg7a/tHpJSdgDSF4J2BsOENVSp7WpqmRh4zxCr9jw86zcA1iLLapEu5bi4/BlRhGMIY9vb2\n5iGih4heHMeVx1wuF/A8D8/nMzopxJ2LOKDfpRMuZwEX5SJF+u4LPZCy+Wzv+zSqGtzZhlH9peV2\naeOxXDXctzkyrZx06XbqvF0a2Gq1uutDXl5e7P1AHaFyohqltDN9WwM1l15bOw3PsswjhNw+n04n\n8DwPt9vt6N4BAICIHsDVa63sE20iVZfCaNKZuvCIomfY8IpWBz16eyi06MFdghg8E/jRcx0K7bUK\niksQ2isGA6FlssqtN2z8ShCI/UJ4tiHovVOjgNAq7mLtIs55r0FRcQNZXxBWtgUcDgd8fX3tfR2A\na2IcYwyCILj9YwGAa8bg6XSC4/EIn5+fP86xkk1o002VUr3fGGAqW3MOqyCKKr4yyZVszjWcgShK\nSmn1vy242Pk7CIgqCSGQMdZq/yRjzHmG0X8dk2z/ab7RIQAAAABJRU5ErkJggg==\n\" transform=\"translate(22, 560)\"/\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip750)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1078.12, 57.6)\" x=\"1078.12\" y=\"57.6\"\u003ePendulum over [0,8]\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip752)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"252.997,204.094 269.5,195.857 286.002,188.318 302.505,181.433 319.007,175.163 335.51,169.469 352.012,164.318 368.515,159.676 385.017,155.515 401.52,151.809 418.022,148.533 434.525,145.666 451.027,143.189 467.53,141.086 484.032,139.343 500.535,137.946 517.037,136.887 533.54,136.157 550.042,135.751 566.545,135.664 583.047,135.896 599.55,136.446 616.052,137.316 632.555,138.51 649.058,140.035 665.56,141.898 682.063,144.11 698.565,146.682 715.068,149.629 731.57,152.966 748.073,156.713 764.575,160.89 781.078,165.52 797.58,170.627 814.083,176.24 830.585,182.388 847.088,189.104 863.59,196.422 880.093,204.378 896.595,213.012 913.098,222.364 929.6,232.476 946.103,243.392 962.605,255.156 979.108,267.811 995.61,281.402 1012.11,295.97 1028.62,311.553 1045.12,328.186 1061.62,345.895 1078.12,364.7 1094.63,384.61 1111.13,405.622 1127.63,427.718 1144.13,450.863 1160.64,475.003 1177.14,500.064 1193.64,525.952 1210.14,552.553 1226.65,579.733 1243.15,607.341 1259.65,635.213 1276.15,663.176 1292.66,691.051 1309.16,718.661 1325.66,745.835 1342.16,772.412 1358.67,798.245 1375.17,823.204 1391.67,847.181 1408.17,870.083 1424.68,891.842 1441.18,912.406 1457.68,931.74 1474.18,949.827 1490.69,966.659 1507.19,982.244 1523.69,996.594 1540.19,1009.73 1556.7,1021.68 1573.2,1032.46 1589.7,1042.12 1606.2,1050.68 1622.71,1058.16 1639.21,1064.6 1655.71,1070.03 1672.21,1074.46 1688.72,1077.92 1705.22,1080.42 1721.72,1081.98 1738.22,1082.61 1754.73,1082.31 1771.23,1081.09 1787.73,1078.94 1804.23,1075.87 1820.74,1071.85 1837.24,1066.89 1853.74,1060.96 1870.24,1054.06 1886.75,1046.15 1903.25,1037.23 \"/\u003e\n\u003c/svg\u003e\n","content_type":"text/html"},"image/svg+xml":{"content":"\u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e\n\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"500\" height=\"320\" viewBox=\"0 0 2000 1280\"\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip700\"\u003e\n    \u003crect x=\"0\" y=\"0\" width=\"2000\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip700)\" d=\"M0 1280 L2000 1280 L2000 0 L0 0  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip701\"\u003e\n    \u003crect x=\"400\" y=\"0\" width=\"1401\" height=\"1280\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpath clip-path=\"url(#clip700)\" d=\"M203.49 1111.02 L1952.76 1111.02 L1952.76 107.256 L203.49 107.256  Z\" fill=\"#ffffff\" fill-rule=\"evenodd\" fill-opacity=\"1\"/\u003e\n\u003cdefs\u003e\n  \u003cclipPath id=\"clip702\"\u003e\n    \u003crect x=\"203\" y=\"107\" width=\"1750\" height=\"1005\"/\u003e\n  \u003c/clipPath\u003e\n\u003c/defs\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"252.997,1111.02 252.997,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"665.56,1111.02 665.56,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1078.12,1111.02 1078.12,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1490.69,1111.02 1490.69,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"1903.25,1111.02 1903.25,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,1037.23 1952.76,1037.23 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,852.088 1952.76,852.088 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,666.947 1952.76,666.947 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,481.806 1952.76,481.806 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,296.664 1952.76,296.664 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none\" points=\"203.49,111.523 1952.76,111.523 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 1952.76,1111.02 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"252.997,1111.02 252.997,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"665.56,1111.02 665.56,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1078.12,1111.02 1078.12,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1490.69,1111.02 1490.69,1092.12 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"1903.25,1111.02 1903.25,1092.12 \"/\u003e\n\u003cpath clip-path=\"url(#clip700)\" d=\"M252.997 1138.74 Q249.386 1138.74 247.557 1142.3 Q245.752 1145.84 245.752 1152.97 Q245.752 1160.08 247.557 1163.64 Q249.386 1167.19 252.997 1167.19 Q256.631 1167.19 258.437 1163.64 Q260.266 1160.08 260.266 1152.97 Q260.266 1145.84 258.437 1142.3 Q256.631 1138.74 252.997 1138.74 M252.997 1135.03 Q258.807 1135.03 261.863 1139.64 Q264.942 1144.22 264.942 1152.97 Q264.942 1161.7 261.863 1166.31 Q258.807 1170.89 252.997 1170.89 Q247.187 1170.89 244.108 1166.31 Q241.053 1161.7 241.053 1152.97 Q241.053 1144.22 244.108 1139.64 Q247.187 1135.03 252.997 1135.03 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M660.213 1166.28 L676.532 1166.28 L676.532 1170.22 L654.588 1170.22 L654.588 1166.28 Q657.25 1163.53 661.833 1158.9 Q666.44 1154.25 667.62 1152.9 Q669.866 1150.38 670.745 1148.64 Q671.648 1146.89 671.648 1145.2 Q671.648 1142.44 669.704 1140.7 Q667.782 1138.97 664.68 1138.97 Q662.481 1138.97 660.028 1139.73 Q657.597 1140.5 654.819 1142.05 L654.819 1137.33 Q657.643 1136.19 660.097 1135.61 Q662.551 1135.03 664.588 1135.03 Q669.958 1135.03 673.153 1137.72 Q676.347 1140.4 676.347 1144.89 Q676.347 1147.02 675.537 1148.95 Q674.75 1150.84 672.643 1153.44 Q672.065 1154.11 668.963 1157.33 Q665.861 1160.52 660.213 1166.28 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M1081.13 1139.73 L1069.33 1158.18 L1081.13 1158.18 L1081.13 1139.73 M1079.91 1135.66 L1085.78 1135.66 L1085.78 1158.18 L1090.72 1158.18 L1090.72 1162.07 L1085.78 1162.07 L1085.78 1170.22 L1081.13 1170.22 L1081.13 1162.07 L1065.53 1162.07 L1065.53 1157.56 L1079.91 1135.66 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M1491.09 1151.08 Q1487.94 1151.08 1486.09 1153.23 Q1484.26 1155.38 1484.26 1159.13 Q1484.26 1162.86 1486.09 1165.03 Q1487.94 1167.19 1491.09 1167.19 Q1494.24 1167.19 1496.07 1165.03 Q1497.92 1162.86 1497.92 1159.13 Q1497.92 1155.38 1496.07 1153.23 Q1494.24 1151.08 1491.09 1151.08 M1500.37 1136.42 L1500.37 1140.68 Q1498.61 1139.85 1496.81 1139.41 Q1495.03 1138.97 1493.27 1138.97 Q1488.64 1138.97 1486.18 1142.09 Q1483.75 1145.22 1483.41 1151.54 Q1484.77 1149.52 1486.83 1148.46 Q1488.89 1147.37 1491.37 1147.37 Q1496.58 1147.37 1499.59 1150.54 Q1502.62 1153.69 1502.62 1159.13 Q1502.62 1164.45 1499.47 1167.67 Q1496.32 1170.89 1491.09 1170.89 Q1485.1 1170.89 1481.92 1166.31 Q1478.75 1161.7 1478.75 1152.97 Q1478.75 1144.78 1482.64 1139.92 Q1486.53 1135.03 1493.08 1135.03 Q1494.84 1135.03 1496.62 1135.38 Q1498.43 1135.73 1500.37 1136.42 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M1903.25 1153.81 Q1899.92 1153.81 1897.99 1155.59 Q1896.1 1157.37 1896.1 1160.5 Q1896.1 1163.62 1897.99 1165.4 Q1899.92 1167.19 1903.25 1167.19 Q1906.58 1167.19 1908.5 1165.4 Q1910.42 1163.6 1910.42 1160.5 Q1910.42 1157.37 1908.5 1155.59 Q1906.6 1153.81 1903.25 1153.81 M1898.57 1151.82 Q1895.56 1151.08 1893.87 1149.01 Q1892.21 1146.95 1892.21 1143.99 Q1892.21 1139.85 1895.15 1137.44 Q1898.11 1135.03 1903.25 1135.03 Q1908.41 1135.03 1911.35 1137.44 Q1914.29 1139.85 1914.29 1143.99 Q1914.29 1146.95 1912.6 1149.01 Q1910.93 1151.08 1907.95 1151.82 Q1911.33 1152.6 1913.2 1154.89 Q1915.1 1157.19 1915.1 1160.5 Q1915.1 1165.52 1912.02 1168.2 Q1908.97 1170.89 1903.25 1170.89 Q1897.53 1170.89 1894.45 1168.2 Q1891.4 1165.52 1891.4 1160.5 Q1891.4 1157.19 1893.29 1154.89 Q1895.19 1152.6 1898.57 1151.82 M1896.86 1144.43 Q1896.86 1147.12 1898.53 1148.62 Q1900.22 1150.13 1903.25 1150.13 Q1906.26 1150.13 1907.95 1148.62 Q1909.66 1147.12 1909.66 1144.43 Q1909.66 1141.75 1907.95 1140.24 Q1906.26 1138.74 1903.25 1138.74 Q1900.22 1138.74 1898.53 1140.24 Q1896.86 1141.75 1896.86 1144.43 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip700)\"\u003e\n\u003cimage width=\"21\" height=\"42\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAABUAAAAqCAYAAABcOxDuAAABh0lEQVRIia2WYbGDMBCEN09BaiES\nOkioBDRUArWABLBAHaABCZ1KABxs/5Q3DRzJJcDM/ehw7C3fLdMYkki92rblPM94PB5Gum9SRY0x\n3gMkN8J/KYLP51PngKS6rLUE4JXUl+R0nmfvd1VVYl8SUw1PIIFp27b66WfzTGK65lnX9W6vmqmW\nJ6Bkqs7nz8RoOefUPEnqRNeCdV2HRYdh4PV63TjJrdvtJkflaP1vf5omcRnOOS9O1lq8329xP5fL\nxagWtXbRNE2QJ8l4TlPyuVzBnCZ976vJ6u/dWht99WhOkcEzyjSHJxBgms3zO/1UnkGmyOQZZJrL\nE9hheojn18GpPHeZ4gDPXaZHeAIC08M8vy5O4fl6vdh1HUWmyOS59KtENYJd1xEA+77fivZ9n/RX\nLLnciJZlmcyzaRoC4DAMOtGyLKOi0nAvUkVReMlwzgWTs+R5miY/x6FFhZwuR6FxHDc90ZxKgkvP\nL8eg6Nrtcm4ax5G/zCWHQVGSuN/v4pGmqqro8j4AYO8cPUgUyAAAAABJRU5ErkJggg==\n\" transform=\"translate(1068, 1200)\"/\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1111.02 203.49,107.256 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,1037.23 222.387,1037.23 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,852.088 222.387,852.088 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,666.947 222.387,666.947 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,481.806 222.387,481.806 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,296.664 222.387,296.664 \"/\u003e\n\u003cpolyline clip-path=\"url(#clip700)\" style=\"stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none\" points=\"203.49,111.523 222.387,111.523 \"/\u003e\n\u003cpath clip-path=\"url(#clip700)\" d=\"M113.374 1037.68 L143.05 1037.68 L143.05 1041.62 L113.374 1041.62 L113.374 1037.68 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M157.17 1050.57 L173.49 1050.57 L173.49 1054.51 L151.545 1054.51 L151.545 1050.57 Q154.207 1047.82 158.791 1043.19 Q163.397 1038.54 164.578 1037.19 Q166.823 1034.67 167.703 1032.94 Q168.605 1031.18 168.605 1029.49 Q168.605 1026.73 166.661 1025 Q164.74 1023.26 161.638 1023.26 Q159.439 1023.26 156.985 1024.02 Q154.555 1024.79 151.777 1026.34 L151.777 1021.62 Q154.601 1020.48 157.055 1019.9 Q159.508 1019.32 161.545 1019.32 Q166.916 1019.32 170.11 1022.01 Q173.305 1024.69 173.305 1029.19 Q173.305 1031.32 172.494 1033.24 Q171.707 1035.13 169.601 1037.73 Q169.022 1038.4 165.92 1041.62 Q162.818 1044.81 157.17 1050.57 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M113.004 852.54 L142.68 852.54 L142.68 856.475 L113.004 856.475 L113.004 852.54 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M153.582 865.433 L161.221 865.433 L161.221 839.067 L152.911 840.734 L152.911 836.475 L161.175 834.808 L165.851 834.808 L165.851 865.433 L173.49 865.433 L173.49 869.368 L153.582 869.368 L153.582 865.433 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M161.545 652.746 Q157.934 652.746 156.106 656.31 Q154.3 659.852 154.3 666.982 Q154.3 674.088 156.106 677.653 Q157.934 681.195 161.545 681.195 Q165.18 681.195 166.985 677.653 Q168.814 674.088 168.814 666.982 Q168.814 659.852 166.985 656.31 Q165.18 652.746 161.545 652.746 M161.545 649.042 Q167.355 649.042 170.411 653.648 Q173.49 658.232 173.49 666.982 Q173.49 675.708 170.411 680.315 Q167.355 684.898 161.545 684.898 Q155.735 684.898 152.656 680.315 Q149.601 675.708 149.601 666.982 Q149.601 658.232 152.656 653.648 Q155.735 649.042 161.545 649.042 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M153.582 495.151 L161.221 495.151 L161.221 468.785 L152.911 470.452 L152.911 466.192 L161.175 464.526 L165.851 464.526 L165.851 495.151 L173.49 495.151 L173.49 499.086 L153.582 499.086 L153.582 495.151 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M157.17 310.009 L173.49 310.009 L173.49 313.944 L151.545 313.944 L151.545 310.009 Q154.207 307.255 158.791 302.625 Q163.397 297.972 164.578 296.63 Q166.823 294.107 167.703 292.37 Q168.605 290.611 168.605 288.921 Q168.605 286.167 166.661 284.431 Q164.74 282.695 161.638 282.695 Q159.439 282.695 156.985 283.458 Q154.555 284.222 151.777 285.773 L151.777 281.051 Q154.601 279.917 157.055 279.338 Q159.508 278.759 161.545 278.759 Q166.916 278.759 170.11 281.445 Q173.305 284.13 173.305 288.62 Q173.305 290.75 172.494 292.671 Q171.707 294.57 169.601 297.162 Q169.022 297.833 165.92 301.051 Q162.818 304.245 157.17 310.009 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cpath clip-path=\"url(#clip700)\" d=\"M166.36 110.169 Q169.717 110.887 171.592 113.155 Q173.49 115.424 173.49 118.757 Q173.49 123.873 169.971 126.674 Q166.453 129.474 159.971 129.474 Q157.795 129.474 155.481 129.035 Q153.189 128.618 150.735 127.762 L150.735 123.248 Q152.68 124.382 154.994 124.961 Q157.309 125.539 159.832 125.539 Q164.23 125.539 166.522 123.803 Q168.837 122.067 168.837 118.757 Q168.837 115.701 166.684 113.988 Q164.555 112.252 160.735 112.252 L156.707 112.252 L156.707 108.41 L160.92 108.41 Q164.369 108.41 166.198 107.044 Q168.027 105.655 168.027 103.063 Q168.027 100.401 166.129 98.9885 Q164.254 97.5533 160.735 97.5533 Q158.814 97.5533 156.615 97.97 Q154.416 98.3867 151.777 99.2663 L151.777 95.0996 Q154.439 94.3589 156.754 93.9885 Q159.092 93.6182 161.152 93.6182 Q166.476 93.6182 169.578 96.0487 Q172.68 98.4561 172.68 102.576 Q172.68 105.447 171.036 107.438 Q169.392 109.405 166.36 110.169 Z\" fill=\"#000000\" fill-rule=\"nonzero\" fill-opacity=\"1\" /\u003e\u003cg clip-path=\"url(#clip700)\"\u003e\n\u003cimage width=\"66\" height=\"98\" xlink:href=\"data:image/png;base64,\niVBORw0KGgoAAAANSUhEUgAAAEIAAABiCAYAAADk+AXeAAAFTUlEQVR4nO2d7XWzIBTHr88EpCPQ\nTmAcgXQCs4LdgK7gCKQjeDpBkhE4nUAzAskG9/kQSa3RKAq+tN5z/h+SqoGfF4QL13qICEPY+XxG\nKSUcj0c4nU43AQBcLhcghMDT0xNQSoEQAkEQAGMM1uu1N0gBEdG6kiRBxhgCgHVxzlEphbbLbOUi\nSilnFW+SEMIKlF4nh2E4SuXrJKXsDKXTSYSQ1oWjlGIYhiiEMCqoUgr3+z3GcYymwOM4NgZidDCl\n9GEBwjDsdVdMJITAphti0mxaHRRFUe3d3u/3g1S8SZzzWiBtOtdG93TZQblSVcft+/7DMtf+IY7j\nu4uNXUFTVXmyEYhyX+DiuT2kys2mqh+7JzOjJmCqR0+W2gPHLrQrFZs85/xWzzsIjLFfC6Hqpmuv\nB8TvAVKXgcicpWGkaYqw3+8RACYzHhha2gk8RIQsy/D5+XmY6e4EbbfbXUEsBvBv7AJMxRYQuS0g\ncltA5OYExGazQc/z5tULuxyo9L1OkiSDjXGcgug7a03T1FpMctYgyp4BAEgIcQJjFiC0hBDOYiRG\nFYPS1HVoEOXr22wqjQdUheyKqpqxugaB+B1Fs/UbRu7YRkVwrkN8euY4CIjiHTYVIcR5uK9tc7UC\nAvHac5uscA0FRq+CDQairDYrTUOA0Wsvo4Go8pimJUFXYCYFolwwXTHXYHTnPGkQxaeGraYUhiFy\nzu9WyGcDoiwbYLSiKJovCJtgrJR5KiC6gLE5AXMSxdZBGaUUrFYrK8sEh8MBPz4+AAAgCAJ4f3+3\nuvwwGxCuzUmozvd9AIDZQABw5BFztCWKndsCIrcFRG4LiNz+AQBkWfane8zdbvcdKh9qx+zUBHqk\nivgd+/ttu+jaQpBS3n/51zaT6Sh8tZtYmtFNUXrPGJSm77WkirR+i4qz2YcbTqtOgJ7T6SmovEhV\ntbpee3LVtv+5AamqQ92xDy9Ul6aQJMmkgVRl/HROU2i6MOQRojRNJwGlLrkGAFqV0ejHmkJnURQN\n1nzahPJMOvtOhTAJsjLGkHOOSZIYe4+UEoUQGEWRUWC3S1S7112ZWrpjn77LipsqpdD3/VEqb2Ml\n3BqIsoQQzsC4SqkcLGaZZRkej0f4+vq6JcgrpeByudyOIYQApRQopRAEAfi+D5vNZpAA8BK8zW2J\nUOW2gMhtAZHbAiK3BURuC4jcFhC5LSByaw3icDjgdrtFz/Naab1e4263m89orWkyBZbnCVMN99X+\nwdaOtzpRSicT3aoF4RJAnadMDkS5kJxzlFLeubRSCqWUGMextZdxEUJGazo/PhSTyfpcVEpp/O6o\nMpBRQeg7a/tHpJSdgDSF4J2BsOENVSp7WpqmRh4zxCr9jw86zcA1iLLapEu5bi4/BlRhGMIY9vb2\n5iGih4heHMeVx1wuF/A8D8/nMzopxJ2LOKDfpRMuZwEX5SJF+u4LPZCy+Wzv+zSqGtzZhlH9peV2\naeOxXDXctzkyrZx06XbqvF0a2Gq1uutDXl5e7P1AHaFyohqltDN9WwM1l15bOw3PsswjhNw+n04n\n8DwPt9vt6N4BAICIHsDVa63sE20iVZfCaNKZuvCIomfY8IpWBz16eyi06MFdghg8E/jRcx0K7bUK\niksQ2isGA6FlssqtN2z8ShCI/UJ4tiHovVOjgNAq7mLtIs55r0FRcQNZXxBWtgUcDgd8fX3tfR2A\na2IcYwyCILj9YwGAa8bg6XSC4/EIn5+fP86xkk1o002VUr3fGGAqW3MOqyCKKr4yyZVszjWcgShK\nSmn1vy242Pk7CIgqCSGQMdZq/yRjzHmG0X8dk2z/ab7RIQAAAABJRU5ErkJggg==\n\" transform=\"translate(22, 560)\"/\u003e\n\u003c/g\u003e\n\u003cg clip-path=\"url(#clip700)\"\u003e\n\u003ctext style=\"fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;\" transform=\"rotate(0, 1078.12, 57.6)\" x=\"1078.12\" y=\"57.6\"\u003ePendulum over [0,8]\u003c/text\u003e\n\u003c/g\u003e\n\u003cpolyline clip-path=\"url(#clip702)\" style=\"stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:8; stroke-opacity:1; fill:none\" points=\"252.997,204.094 269.5,195.857 286.002,188.318 302.505,181.433 319.007,175.163 335.51,169.469 352.012,164.318 368.515,159.676 385.017,155.515 401.52,151.809 418.022,148.533 434.525,145.666 451.027,143.189 467.53,141.086 484.032,139.343 500.535,137.946 517.037,136.887 533.54,136.157 550.042,135.751 566.545,135.664 583.047,135.896 599.55,136.446 616.052,137.316 632.555,138.51 649.058,140.035 665.56,141.898 682.063,144.11 698.565,146.682 715.068,149.629 731.57,152.966 748.073,156.713 764.575,160.89 781.078,165.52 797.58,170.627 814.083,176.24 830.585,182.388 847.088,189.104 863.59,196.422 880.093,204.378 896.595,213.012 913.098,222.364 929.6,232.476 946.103,243.392 962.605,255.156 979.108,267.811 995.61,281.402 1012.11,295.97 1028.62,311.553 1045.12,328.186 1061.62,345.895 1078.12,364.7 1094.63,384.61 1111.13,405.622 1127.63,427.718 1144.13,450.863 1160.64,475.003 1177.14,500.064 1193.64,525.952 1210.14,552.553 1226.65,579.733 1243.15,607.341 1259.65,635.213 1276.15,663.176 1292.66,691.051 1309.16,718.661 1325.66,745.835 1342.16,772.412 1358.67,798.245 1375.17,823.204 1391.67,847.181 1408.17,870.083 1424.68,891.842 1441.18,912.406 1457.68,931.74 1474.18,949.827 1490.69,966.659 1507.19,982.244 1523.69,996.594 1540.19,1009.73 1556.7,1021.68 1573.2,1032.46 1589.7,1042.12 1606.2,1050.68 1622.71,1058.16 1639.21,1064.6 1655.71,1070.03 1672.21,1074.46 1688.72,1077.92 1705.22,1080.42 1721.72,1081.98 1738.22,1082.61 1754.73,1082.31 1771.23,1081.09 1787.73,1078.94 1804.23,1075.87 1820.74,1071.85 1837.24,1066.89 1853.74,1060.96 1870.24,1054.06 1886.75,1046.15 1903.25,1037.23 \"/\u003e\n\u003c/svg\u003e\n","content_type":"image/svg+xml"}}}],"key":"eNJd52h2Ua"}],"key":"mcdpr5twii"},{"type":"paragraph","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"children":[{"type":"text","value":"This time, the pendulum is initially pushed toward the unstable equilibrium in the upright vertical position before gravity pulls it back down.","position":{"start":{"line":507,"column":1},"end":{"line":507,"column":1}},"key":"jCDsF68kXC"}],"key":"lxX6edqnX4"}],"label":"demo-nonlinear-pendulum-julia","identifier":"demo-nonlinear-pendulum-julia","html_id":"demo-nonlinear-pendulum-julia","key":"JHTACyp3Ot"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-mems","label":"demo-nonlinear-mems","kind":"proof:example","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":21}},"children":[{"type":"text","value":"Example ","key":"OkSgDgNJtN"},{"type":"text","value":"10.5.3","key":"LuORr9Li03"}],"template":"Example %s","enumerator":"10.5.3","resolved":true,"html_id":"demo-nonlinear-mems","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"q3uir8m50I"}],"key":"M86G0jTZBW"},{"type":"paragraph","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"children":[{"type":"text","value":"Here is the problem definition. We use a truncated domain to avoid division by zero at ","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"t5DC4Y6zkg"},{"type":"inlineMath","value":"r=0","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er=0\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wg2XD2HzAh"},{"type":"text","value":".","position":{"start":{"line":513,"column":1},"end":{"line":513,"column":1}},"key":"FdcNQmener"}],"key":"tfOd2BK7JP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"domain = [eps(), 1]\nλ = 0.5\nϕ = (r, w, dwdr) -\u003e λ / w^2 - dwdr / r\ng₁(w, dw) = dw\ng₂(w, dw) = w - 1;","key":"V3G4y9Hwip"},{"type":"output","id":"Xxwa_VwUT4OATicOm0RXt","data":[],"key":"GNuGAZVL26"}],"key":"PcOgAIV6Sn"},{"type":"paragraph","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"children":[{"type":"text","value":"First we try a constant function as the initialization.","position":{"start":{"line":523,"column":1},"end":{"line":523,"column":1}},"key":"BWlX731Oea"}],"key":"ebCjbXgBsH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"init = ones(301)\nr, w₁ = FNC.bvp(ϕ, domain, g₁, g₂, init)\n\nplot(r, w₁;\n    xaxis = (L\"r\"),  yaxis = (L\"w(r)\"), \n    title = \"Solution of the MEMS problem\")","key":"SeJG6WAcFS"},{"type":"output","id":"xx5hm5J47QDzJV9UEu_gT","data":[{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"15254c11d061b7fdcc11ad0af0ca3467","path":"/2025-06-04/build/15254c11d061b7fdcc11ad0af0ca3467.png"},"text/html":{"content_type":"text/html","hash":"47557050290b0c2bbaa2f42499387eab","path":"/2025-06-04/build/47557050290b0c2bbaa2f42499387eab.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"836b31012bceaf7a8d5ae7c321bcaf69","path":"/2025-06-04/build/836b31012bceaf7a8d5ae7c321bcaf69.svg"}}}],"key":"q0i9JRG9ya"}],"key":"fRQSUbFpgr"},{"type":"paragraph","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"children":[{"type":"text","value":"It’s not necessary that the initialization satisfy the boundary conditions. In fact, by choosing a different constant function as the initial guess, we arrive at another valid solution.","position":{"start":{"line":534,"column":1},"end":{"line":534,"column":1}},"key":"SaAZKcvnBl"}],"key":"BG9IpAMOb8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"init = 0.5 * ones(301)\nr, w₂ = FNC.bvp(ϕ, domain, g₁, g₂, init)\nplot!(r, w₂, title = \"Two solutions of the MEMS problem\")","key":"oHPd9W5hLe"},{"type":"output","id":"6wB2HnFglf1P0tsXL5lva","data":[{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e83e953aec8fb707dc3d972acedb69f6","path":"/2025-06-04/build/e83e953aec8fb707dc3d972acedb69f6.png"},"text/html":{"content_type":"text/html","hash":"7df4ff99f66891a363077d2fa30e07c3","path":"/2025-06-04/build/7df4ff99f66891a363077d2fa30e07c3.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"f9f46aaa50d33cef92646d397ede3357","path":"/2025-06-04/build/f9f46aaa50d33cef92646d397ede3357.svg"}}}],"key":"NUfzj9xbcL"}],"key":"BN1IggTWf1"}],"label":"demo-nonlinear-mems-julia","identifier":"demo-nonlinear-mems-julia","html_id":"demo-nonlinear-mems-julia","key":"cy3z7w5P7x"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-nonlinear-allencahn","label":"demo-nonlinear-allencahn","kind":"proof:example","position":{"start":{"line":544,"column":1},"end":{"line":544,"column":26}},"children":[{"type":"text","value":"Example ","key":"ze4bISwWna"},{"type":"text","value":"10.5.4","key":"VHTycvGp4B"}],"template":"Example %s","enumerator":"10.5.4","resolved":true,"html_id":"demo-nonlinear-allencahn","remote":true,"url":"/nonlinear","dataUrl":"/nonlinear.json","key":"kvFrl0K3z1"}],"key":"MXQxK32oFz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϕ = (x, u, dudx) -\u003e (u^3 - u) / ϵ;\ng₁(u, du) = du\ng₂(u, du) = u - 1;","key":"vnLg9t8pjL"},{"type":"output","id":"Hx_xE2_Gp5_V7hhsnNt_M","data":[],"key":"sfQGtcICOE"}],"key":"CnwOhV8fRq"},{"type":"paragraph","position":{"start":{"line":553,"column":1},"end":{"line":553,"column":1}},"children":[{"type":"text","value":"Finding a solution is easy at larger values of ","position":{"start":{"line":553,"column":1},"end":{"line":553,"column":1}},"key":"HSBjZoNP0G"},{"type":"text","value":"ε","position":{"start":{"line":553,"column":1},"end":{"line":553,"column":1}},"key":"KFlEn9NHgD"},{"type":"text","value":".","position":{"start":{"line":553,"column":1},"end":{"line":553,"column":1}},"key":"wanrCNQUXh"}],"key":"QjUw29UEBb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 0.05\ninit = collect(range(-1, 1, length = 141))\nx, u₁ = FNC.bvp(ϕ, [0, 1], g₁, g₂, init)\n\nplot(x, u₁;\n    label=L\"\\epsilon = 0.05\",  legend=:bottomright,\n    xaxis=(L\"x\"),  yaxis=(L\"u(x)\"),\n    title = \"Allen–Cahn solution\")","key":"l0x77GFuTb"},{"type":"output","id":"pbQLv7292n955VvgyjZPc","data":[{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f76b0da72a16e4e83e7ad948c53ab387","path":"/2025-06-04/build/f76b0da72a16e4e83e7ad948c53ab387.png"},"text/html":{"content_type":"text/html","hash":"4714b57ee56a9619ad6163ed87453c49","path":"/2025-06-04/build/4714b57ee56a9619ad6163ed87453c49.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"922d393be59bd55dbbda4af7ef9da571","path":"/2025-06-04/build/922d393be59bd55dbbda4af7ef9da571.svg"}}}],"key":"ASoDA2H018"}],"key":"pv7FNiUJjA"},{"type":"paragraph","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"children":[{"type":"text","value":"However, finding a good initialization is not trivial for smaller values of ","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"ovCLp25kVj"},{"type":"text","value":"ε","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"pwNCAYIKh5"},{"type":"text","value":". Note below that the iteration stops without converging to a solution.","position":{"start":{"line":566,"column":1},"end":{"line":566,"column":1}},"key":"YZDwmUblwZ"}],"key":"tSIm7NyrBK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 0.002;\nx, z = FNC.bvp(ϕ, [0, 1], g₁, g₂, init);","key":"djKewTDWW5"},{"type":"output","id":"Wdj4ZErZA5pLMq4Qk6u1D","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mMaximum number of iterations reached.\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ FNCFunctions ~/.julia/packages/FNCFunctions/Hk7fC/src/chapter04.jl:178\u001b[39m\n"}],"key":"JqZyMhlDR4"}],"key":"L6uQygpZL1"},{"type":"paragraph","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"children":[{"type":"text","value":"The iteration succeeds if we use the first solution instead as the initialization here.","position":{"start":{"line":573,"column":1},"end":{"line":573,"column":1}},"key":"fU3e7iAh8p"}],"key":"cyLzZCJ8BD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"x, u₂ = FNC.bvp(ϕ, [0, 1], g₁, g₂, u₁)\nplot!(x, u₂; label = L\"\\epsilon = 0.002\")","key":"OQzRTGan9y"},{"type":"output","id":"Vc91Lni8a4i6z9sgVPdCy","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mMaximum number of iterations reached.\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ FNCFunctions ~/.julia/packages/FNCFunctions/Hk7fC/src/chapter04.jl:178\u001b[39m\n"},{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"40297b900f865dc5b81e2a2896ff34de","path":"/2025-06-04/build/40297b900f865dc5b81e2a2896ff34de.png"},"text/html":{"content_type":"text/html","hash":"0155a3f59b8b7df9a6e9f454dd74eac4","path":"/2025-06-04/build/0155a3f59b8b7df9a6e9f454dd74eac4.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"574ba5dca25c26a11f42cd0c22baa328","path":"/2025-06-04/build/574ba5dca25c26a11f42cd0c22baa328.svg"}}}],"key":"L9M20VAAYC"}],"key":"Gy6U9UKUSW"},{"type":"paragraph","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"children":[{"type":"text","value":"In this case we can continue further.","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"key":"c4oUAjsSVt"}],"key":"GDg6r8iwHX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"ϵ = 0.0005\nx, u₃ = FNC.bvp(ϕ, [0, 1], g₁, g₂, u₂)\nplot!(x, u₃, label = L\"\\epsilon = 0.0005\")","key":"nhPb6Mljwm"},{"type":"output","id":"lhX3eRuiymJHOFeq2d4B4","data":[{"output_type":"stream","name":"stderr","text":"\u001b[33m\u001b[1m┌ \u001b[22m\u001b[39m\u001b[33m\u001b[1mWarning: \u001b[22m\u001b[39mMaximum number of iterations reached.\n\u001b[33m\u001b[1m└ \u001b[22m\u001b[39m\u001b[90m@ FNCFunctions ~/.julia/packages/FNCFunctions/Hk7fC/src/chapter04.jl:178\u001b[39m\n"},{"output_type":"execute_result","execution_count":46,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c0df2b329c27c057373c06f9744f8904","path":"/2025-06-04/build/c0df2b329c27c057373c06f9744f8904.png"},"text/html":{"content_type":"text/html","hash":"d5647139d67672554e7c755e502796be","path":"/2025-06-04/build/d5647139d67672554e7c755e502796be.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"a1f24c26f640fce1226aaed5f45392b9","path":"/2025-06-04/build/a1f24c26f640fce1226aaed5f45392b9.svg"}}}],"key":"Dz5FazckIS"}],"key":"kE2Nx2CV9X"}],"label":"demo-nonlinear-allencahn-julia","identifier":"demo-nonlinear-allencahn-julia","html_id":"demo-nonlinear-allencahn-julia","key":"B4wzx70MbE"},{"type":"heading","depth":3,"position":{"start":{"line":589,"column":1},"end":{"line":589,"column":1}},"children":[{"type":"text","value":"10.6 ","position":{"start":{"line":589,"column":1},"end":{"line":589,"column":1}},"key":"pFDeeHPdQI"},{"type":"link","identifier":"section-bvp-galerkin","label":"section-bvp-galerkin","kind":"narrative","position":{"start":{"line":589,"column":6},"end":{"line":589,"column":27}},"url":"/galerkin","internal":true,"dataUrl":"/galerkin.json","children":[{"type":"text","value":"The Galerkin method","key":"HOYJsiituD"}],"key":"u8ReIMAbj9"}],"identifier":"id-10-6","label":"10.6 ","html_id":"id-10-6","implicit":true,"key":"enk4lWvBNk"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-galerkin-fem","label":"demo-galerkin-fem","kind":"proof:example","position":{"start":{"line":591,"column":1},"end":{"line":591,"column":19}},"children":[{"type":"text","value":"Example ","key":"Zs7Svbr8t3"},{"type":"text","value":"10.6.2","key":"D99IIoyNZO"}],"template":"Example %s","enumerator":"10.6.2","resolved":true,"html_id":"demo-galerkin-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"JVqqsFdn2f"}],"key":"Err7FncRFK"},{"type":"paragraph","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"children":[{"type":"text","value":"Here are the coefficient function definitions. Even though ","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"key":"ppoY6RdfyA"},{"type":"inlineMath","value":"s","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003es\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003es\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003es\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"LdVr7W8G51"},{"type":"text","value":" is a constant, it has to be defined as a function for ","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"key":"j288LNIfWU"},{"type":"crossReference","kind":"proof:algorithm","identifier":"function-fem","label":"function-fem","children":[{"type":"text","value":"Function ","key":"AyBKYNMC9r"},{"type":"text","value":"10.6.1","key":"ySSNonHjIn"}],"template":"Algorithm %s","enumerator":"10.6.1","resolved":true,"html_id":"function-fem","remote":true,"url":"/galerkin","dataUrl":"/galerkin.json","key":"pNdeAGFx5k"},{"type":"text","value":" to use it.","position":{"start":{"line":594,"column":1},"end":{"line":594,"column":1}},"key":"pRIsVnWImG"}],"key":"uFNdRgdAP4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"c = x -\u003e x^2;\nq = x -\u003e 4;\nf = x -\u003e sin(π * x);","key":"qdvBBQ1ArG"},{"type":"output","id":"n4sOcBFW3so6bZ3k-j1YZ","data":[],"key":"NA9oAlu1Vx"}],"key":"fZX4Fsv2QP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"julia","executable":true,"value":"using Plots\nx, u = FNC.fem(c, q, f, 0, 1, 50)\nplot(x, u;\n    xaxis=(L\"x\"),  yaxis = (L\"u\"),\n    title = \"Solution by finite elements\", legend=:none)","key":"hU6q2gmpQF"},{"type":"output","id":"vUOttc75FjUTDWIWhS3P0","data":[{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"de50371b4fb951fa3df236994e665e5c","path":"/2025-06-04/build/de50371b4fb951fa3df236994e665e5c.png"},"text/html":{"content_type":"text/html","hash":"e0119814d31eb5e76b762068adf2f2d3","path":"/2025-06-04/build/e0119814d31eb5e76b762068adf2f2d3.html"},"image/svg+xml":{"content_type":"image/svg+xml","hash":"c33ed129da7ae44b5c666fab9c72e886","path":"/2025-06-04/build/c33ed129da7ae44b5c666fab9c72e886.svg"}}}],"key":"azgbJf3And"}],"key":"wJX8aXF3Tq"}],"label":"demo-galerkin-fem-julia","identifier":"demo-galerkin-fem-julia","html_id":"demo-galerkin-fem-julia","key":"rZfVpooAS3"}],"key":"ayPWqZHX3a"}],"key":"bennwspIt7"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 9","url":"/chapter9","group":"Julia codes"},"next":{"title":"Chapter 11","url":"/chapter11","group":"Julia codes"}}},"domain":"http://localhost:3000"},"project":{"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":false}},"math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"exports":[],"title":"Fundamentals of Numerical Computation","short_title":"FNC","description":"Online textbook for computational mathematics","authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","id":"a36af5d8-56ed-4bf2-92e6-5f7fdb82e8e1","toc":[{"file":"home.md"},{"file":"usage.md"},{"children":[{"file":"frontmatter/preface-original.md"},{"file":"frontmatter/preface.md"}],"title":"Preface"},{"file":"frontmatter/differences.md"},{"children":[{"file":"chapter1/floating-point.md"},{"file":"chapter1/conditioning.md"},{"file":"chapter1/algorithms.md"},{"file":"chapter1/stability.md"},{"file":"chapter1/next.md"}],"file":"chapter1/overview.md"},{"children":[{"file":"chapter2/polyinterp.md"},{"file":"chapter2/matrices.md"},{"file":"chapter2/linear-systems.md"},{"file":"chapter2/lu.md"},{"file":"chapter2/efficiency.md"},{"file":"chapter2/pivoting.md"},{"file":"chapter2/norms.md"},{"file":"chapter2/condition-number.md"},{"file":"chapter2/structure.md"},{"file":"chapter2/next.md"}],"file":"chapter2/overview.md"},{"children":[{"file":"chapter3/fitting.md"},{"file":"chapter3/normaleqns.md"},{"file":"chapter3/qr.md"},{"file":"chapter3/house.md"},{"file":"chapter3/next.md"}],"file":"chapter3/overview.md"},{"children":[{"file":"chapter4/rootproblem.md"},{"file":"chapter4/fixed-point.md"},{"file":"chapter4/newton.md"},{"file":"chapter4/secant.md"},{"file":"chapter4/newtonsys.md"},{"file":"chapter4/quasinewton.md"},{"file":"chapter4/nlsq.md"},{"file":"chapter4/next.md"}],"file":"chapter4/overview.md"},{"children":[{"file":"chapter5/interpolation.md"},{"file":"chapter5/pwlin.md"},{"file":"chapter5/splines.md"},{"file":"chapter5/finitediffs.md"},{"file":"chapter5/fd-converge.md"},{"file":"chapter5/integration.md"},{"file":"chapter5/adaptive.md"},{"file":"chapter5/next.md"}],"file":"chapter5/overview.md"},{"children":[{"file":"chapter6/basics.md"},{"file":"chapter6/euler.md"},{"file":"chapter6/systems.md"},{"file":"chapter6/rk.md"},{"file":"chapter6/adaptive-rk.md"},{"file":"chapter6/multistep.md"},{"file":"chapter6/implicit.md"},{"file":"chapter6/zerostability.md"},{"file":"chapter6/next.md"}],"file":"chapter6/overview.md"},{"children":[{"file":"chapter7/insight.md"},{"file":"chapter7/evd.md"},{"file":"chapter7/svd.md"},{"file":"chapter7/symm-eig.md"},{"file":"chapter7/dimreduce.md"},{"file":"chapter7/next.md"}],"file":"chapter7/overview.md"},{"children":[{"file":"chapter8/structure.md"},{"file":"chapter8/power.md"},{"file":"chapter8/inviter.md"},{"file":"chapter8/subspace.md"},{"file":"chapter8/gmres.md"},{"file":"chapter8/minrescg.md"},{"file":"chapter8/matrixfree.md"},{"file":"chapter8/precond.md"},{"file":"chapter8/next.md"}],"file":"chapter8/overview.md"},{"children":[{"file":"chapter9/polynomial.md"},{"file":"chapter9/barycentric.md"},{"file":"chapter9/stability.md"},{"file":"chapter9/orthogonal.md"},{"file":"chapter9/trig.md"},{"file":"chapter9/spectral-integration.md"},{"file":"chapter9/improper.md"},{"file":"chapter9/next.md"}],"file":"chapter9/overview.md"},{"children":[{"file":"chapter10/tpbvp.md"},{"file":"chapter10/shooting.md"},{"file":"chapter10/diffmats.md"},{"file":"chapter10/linear.md"},{"file":"chapter10/nonlinear.md"},{"file":"chapter10/galerkin.md"},{"file":"chapter10/next.md"}],"file":"chapter10/overview.md"},{"children":[{"file":"chapter11/blackscholes.md"},{"file":"chapter11/methodlines.md"},{"file":"chapter11/absstab-diffusion.md"},{"file":"chapter11/stiffness.md"},{"file":"chapter11/boundaries.md"},{"file":"chapter11/next.md"}],"file":"chapter11/overview.md"},{"children":[{"file":"chapter12/traffic.md"},{"file":"chapter12/upwind.md"},{"file":"chapter12/absstab-advection.md"},{"file":"chapter12/wave.md"},{"file":"chapter12/next.md"}],"file":"chapter12/overview.md"},{"children":[{"file":"chapter13/tensorprod.md"},{"file":"chapter13/diffadv.md"},{"file":"chapter13/laplace.md"},{"file":"chapter13/nonlinear.md"},{"file":"chapter13/next.md"}],"file":"chapter13/overview.md"},{"children":[{"file":"appendix/linear-algebra.md"},{"children":[{"file":"julia/setup.md"},{"file":"julia/chapter1.md"},{"file":"julia/chapter2.md"},{"file":"julia/chapter3.md"},{"file":"julia/chapter4.md"},{"file":"julia/chapter5.md"},{"file":"julia/chapter6.md"},{"file":"julia/chapter7.md"},{"file":"julia/chapter8.md"},{"file":"julia/chapter9.md"},{"file":"julia/chapter10.md"},{"file":"julia/chapter11.md"},{"file":"julia/chapter12.md"},{"file":"julia/chapter13.md"}],"title":"Julia codes"},{"children":[{"file":"matlab/setup.md"},{"file":"matlab/chapter1.md"},{"file":"matlab/chapter2.md"},{"file":"matlab/chapter3.md"},{"file":"matlab/chapter4.md"},{"file":"matlab/chapter5.md"},{"file":"matlab/chapter6.md"},{"file":"matlab/chapter7.md"},{"file":"matlab/chapter8.md"},{"file":"matlab/chapter9.md"},{"file":"matlab/chapter10.md"},{"file":"matlab/chapter11.md"},{"file":"matlab/chapter12.md"},{"file":"matlab/chapter13.md"}],"title":"MATLAB codes"},{"children":[{"file":"python/setup.md"},{"file":"python/chapter1.md"},{"file":"python/chapter2.md"},{"file":"python/chapter3.md"},{"file":"python/chapter4.md"},{"file":"python/chapter5.md"},{"file":"python/chapter6.md"},{"file":"python/chapter7.md"},{"file":"python/chapter8.md"},{"file":"python/chapter9.md"},{"file":"python/chapter10.md"},{"file":"python/chapter11.md"},{"file":"python/chapter12.md"},{"file":"python/chapter13.md"}],"title":"Python codes"}],"title":"Appendices"},{"file":"appendix/glossary.md"},{"file":"genindex.md"}],"thumbnail":"/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.png","thumbnailOptimized":"/2025-06-04/build/front_cover_julia-06f29a66ddc93be8cccb5611cf9ee9aa.webp","bibliography":[],"index":"index","pages":[{"slug":"usage","title":"How to use this book","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"level":1,"title":"Preface"},{"slug":"preface-original","title":"Preface to the original edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"preface","title":"Preface to the Julia edition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"differences","title":"Key language differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"overview","title":"1. Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"floating-point","title":"Floating-point numbers","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"conditioning","title":"Problems and conditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"algorithms","title":"Algorithms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability","title":"Stability","description":"","date":"","thumbnail":"/2025-06-04/build/backwarderror-55621e558c526e24b8fc1d61b00b65a3.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-1","title":"2. Linear systems of equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polyinterp","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrices","title":"Computing with matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear-systems","title":"Linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"lu","title":"LU factorization","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"efficiency","title":"Efficiency of matrix computations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pivoting","title":"Row pivoting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"norms","title":"Vector and matrix norms","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"condition-number","title":"Conditioning of linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"structure","title":"Exploiting matrix structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-1","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-2","title":"3. Overdetermined linear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"fitting","title":"Fitting functions to data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"normaleqns","title":"The normal equations","description":"","date":"","thumbnail":"/2025-06-04/build/normaleqns2d-642be59011d84c84d3baa16fc8b87698.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"qr","title":"The QR factorization","description":"","date":"","thumbnail":"/2025-06-04/build/nonorthogonal-ae7f2af9aa7443e77a54cabf4002110b.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"house","title":"Computing QR factorizations","description":"","date":"","thumbnail":"/2025-06-04/build/hhreflect-8e7676ada4b21a8eedad229c497e7e12.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-2","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-3","title":"4. Roots of nonlinear equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"rootproblem","title":"The rootfinding problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fixed-point","title":"Fixed-point iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newton","title":"Newton’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"secant","title":"Interpolation-based methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"newtonsys","title":"Newton for nonlinear systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"quasinewton","title":"Quasi-Newton methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nlsq","title":"Nonlinear least squares","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-3","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-4","title":"5. Piecewise interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"interpolation","title":"The interpolation problem","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"pwlin","title":"Piecewise linear interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"splines","title":"Cubic splines","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"finitediffs","title":"Finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"fd-converge","title":"Convergence of finite differences","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"integration","title":"Numerical integration","description":"","date":"","thumbnail":"/2025-06-04/build/trapezoid-ef8b8f521799da9fa523f9c42c68eca7.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive","title":"Adaptive integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-4","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-5","title":"6. Initial-value problems for ODEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"basics","title":"Basics of IVPs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"euler","title":"Euler’s method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"systems","title":"IVP systems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"rk","title":"Runge–Kutta methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"adaptive-rk","title":"Adaptive Runge–Kutta","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"multistep","title":"Multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"implicit","title":"Implementation of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"zerostability","title":"Zero-stability of multistep methods","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-5","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-6","title":"7. Matrix analysis","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"insight","title":"From matrix to insight","description":"","date":"","thumbnail":"/2025-06-04/build/littlegraph-9c05511710268b393ed760b1385973aa.png","thumbnailOptimized":"/2025-06-04/build/littlegraph-9c05511710268b393ed760b1385973aa.webp","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"evd","title":"Eigenvalue decomposition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"svd","title":"Singular value decomposition","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"symm-eig","title":"Symmetry and definiteness","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"dimreduce","title":"Dimension reduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-6","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-7","title":"8. Krylov methods in linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"structure-1","title":"Sparsity and structure","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"power","title":"Power iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"inviter","title":"Inverse iteration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"subspace","title":"Krylov subspaces","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"gmres","title":"GMRES","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"minrescg","title":"MINRES and conjugate gradients","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"matrixfree","title":"Matrix-free iterations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"precond","title":"Preconditioning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-7","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-8","title":"9. Global function approximation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"polynomial","title":"Polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"barycentric","title":"The barycentric formula","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stability-1","title":"Stability of polynomial interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"orthogonal","title":"Orthogonal polynomials","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"trig","title":"Trigonometric interpolation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"spectral-integration","title":"Spectrally accurate integration","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"improper","title":"Improper integrals","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-8","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-9","title":"10. Boundary-value problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tpbvp","title":"Two-point BVP","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"shooting","title":"Shooting","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"diffmats","title":"Differentiation matrices","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"linear","title":"Collocation for linear problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear","title":"Nonlinearity and boundary conditions","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"galerkin","title":"The Galerkin method","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-9","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-10","title":"11. Diffusion equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"blackscholes","title":"Black–Scholes equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"methodlines","title":"The method of lines","description":"","date":"","thumbnail":"/2025-06-04/build/periodicfun-92c161b142a3e94d789992429c5c7ae5.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"absstab-diffusion","title":"Absolute stability","description":"","date":"","thumbnail":"/2025-06-04/build/stabreg_ab_am-dd281f36807791ec496725bfecb3253a.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"stiffness","title":"Stiffness","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"boundaries","title":"Boundaries","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-10","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-11","title":"12. Advection equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"traffic","title":"Traffic flow","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"upwind","title":"Upwinding and stability","description":"","date":"","thumbnail":"/2025-06-04/build/cflpicture-fa914bf5e4a7f49a8026890658f0a2e6.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"absstab-advection","title":"Absolute stability","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"wave","title":"The wave equation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-11","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"overview-12","title":"13. Two-dimensional problems","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"tensorprod","title":"Tensor-product discretizations","description":"","date":"","thumbnail":"/2025-06-04/build/tensor-grid-e2430e350f5ae802ebc9e05e4e1752f0.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"diffadv","title":"Two-dimensional diffusion and advection","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"laplace","title":"Laplace and Poisson equations","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"nonlinear-1","title":"Nonlinear elliptic PDEs","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"next-12","title":"Next steps","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendices"},{"slug":"linear-algebra","title":"Review of linear algebra","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":2,"title":"Julia codes"},{"slug":"setup","title":"Julia setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"MATLAB codes"},{"slug":"setup-1","title":"MATLAB setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1-1","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-1","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-1","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-1","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-1","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-1","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7-1","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8-1","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9-1","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10-1","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11-1","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12-1","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13-1","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"level":2,"title":"Python codes"},{"slug":"setup-2","title":"Python setup","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter1-2","title":"Chapter 1","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter2-2","title":"Chapter 2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter3-2","title":"Chapter 3","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter4-2","title":"Chapter 4","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter5-2","title":"Chapter 5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter6-2","title":"Chapter 6","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter7-2","title":"Chapter 7","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter8-2","title":"Chapter 8","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter9-2","title":"Chapter 9","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter10-2","title":"Chapter 10","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter11-2","title":"Chapter 11","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter12-2","title":"Chapter 12","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"chapter13-2","title":"Chapter 13","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":3},{"slug":"glossary","title":"Glossary","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"genindex","title":"Index","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/2025-06-04/build/manifest-B4259127.js";
import * as route0 from "/2025-06-04/build/root-RPF4Y46X.js";
import * as route1 from "/2025-06-04/build/routes/$-B7OTHJKZ.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/2025-06-04/build/entry.client-UNPC4GT3.js");</script></body></html>