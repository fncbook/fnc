{"version":1,"kind":"Notebook","sha256":"ccdcb65c731aded606d9fcda833c5439c6302a7e5e70f40452032ace838b54d8","slug":"chapter8-1","location":"/matlab/chapter8.md","dependencies":[],"frontmatter":{"title":"Chapter 8","numbering":{"heading_1":{"enabled":false},"heading_2":{"enabled":false},"heading_3":{"enabled":false},"heading_4":{"enabled":false},"heading_5":{"enabled":false},"heading_6":{"enabled":false},"title":{"offset":2}},"kernelspec":{"name":"jupyter_matlab_kernel","display_name":"MATLAB","language":"matlab"},"content_includes_title":false,"authors":[{"nameParsed":{"literal":"Tobin A. Driscoll","given":"Tobin A.","family":"Driscoll"},"name":"Tobin A. Driscoll","email":"driscoll@udel.edu","id":"contributors-myst-generated-uid-0","corresponding":true},{"nameParsed":{"literal":"Richard J. Braun","given":"Richard J.","family":"Braun"},"name":"Richard J. Braun","id":"contributors-myst-generated-uid-1"}],"github":"https://github.com/fncbook/fnc","math":{"\\float":{"macro":"\\mathbb{F}"},"\\real":{"macro":"\\mathbb{R}"},"\\complex":{"macro":"\\mathbb{C}"},"\\nat":{"macro":"\\mathbb{N}"},"\\integer":{"macro":"\\mathbb{Z}"},"\\rmn":{"macro":"\\mathbb{R}^{#1 \\times #2}"},"\\dd":{"macro":"\\frac{d #1}{d #2}"},"\\ddd":{"macro":"\\frac{d^2 #1}{d #2^2}"},"\\pp":{"macro":"\\frac{\\partial #1}{\\partial #2}"},"\\ppp":{"macro":"\\frac{\\partial^2 #1}{\\partial #2^2}"},"\\ppdd":{"macro":"\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}"},"\\abs":{"macro":"\\left\\lvert #1 \\right\\rvert"},"\\norm":{"macro":"\\left\\lVert #1 \\right\\rVert"},"\\twonorm":{"macro":"\\norm{#1}_2"},"\\onenorm":{"macro":"\\norm{#1}_1"},"\\infnorm":{"macro":"\\norm{#1}_\\infty"},"\\anynorm":{"macro":"\\norm{#1}_#2"},"\\innerprod":{"macro":"\\langle #1,#2 \\rangle"},"\\pr":{"macro":"^{(#1)}"},"\\kron":{"macro":"#1 \\otimes #2"},"\\eye":{"macro":"\\mathbf{e}_#1"},"\\meye":{"macro":"\\mathbf{I}"},"\\Qhat":{"macro":"\\hat{\\mathbf{Q}}"},"\\Rhat":{"macro":"\\hat{\\mathbf{R}}"},"\\bfalpha":{"macro":"\\mathbf{alpha}"},"\\bfdelta":{"macro":"\\mathbf{delta}"},"\\bfzero":{"macro":"\\boldsymbol{0}"},"\\macheps":{"macro":"\\epsilon_\\text{mach}"},"\\fl":{"macro":"\\operatorname{fl}"},"\\diag":{"macro":"\\operatorname{diag}"},"\\ign":{"macro":"\\operatorname{sign}"},"\\Re":{"macro":"\\operatorname{Re}"},"\\Im":{"macro":"\\operatorname{Im}"},"\\ee":{"macro":"\\times 10^"},"\\lnorm":{"macro":"\\|"},"\\rnorm":{"macro":"\\|"},"\\floor":{"macro":"\\lfloor#1\\rfloor"},"\\cI":{"macro":"\\mathcal{I}"},"\\mtx":{"macro":"\\operatorname{mtx}"},"\\myvec":{"macro":"\\operatorname{vec}"},"\\argmin":{"macro":"\\operatorname{argmin}"}},"abbreviations":{"IVP":"initial-value problem","BVP":"boundary-value problem","TPBVP":"two-point boundary-value problem","ONC":"matrix with orthonormal columns","SVD":"singular value decomposition","EVD":"eigenvalue decomposition","SPD":"symmetric positive definite","HPD":"hermitian positive definite","PDE":"partial differential equation","ODE":"ordinary differential equation"},"edit_url":"https://github.com/fncbook/fnc/blob/master/matlab/chapter8.md","exports":[{"format":"md","filename":"chapter8.md","url":"/build/chapter8-0d3899187aba2ab70c91a787fa7473ac.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Functions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"VHsRXbyN89"}],"identifier":"functions","label":"Functions","html_id":"functions","implicit":true,"key":"iFwsi5eUFW"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Power iteration","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JP32NcM0Uh"}],"key":"pqc7p2U4ep"},{"type":"include","file":"FNC-matlab/poweriter.m","literal":true,"children":[{"type":"code","value":"function [beta, x] = poweriter(A, numiter)\r\n% POWERITER   Power iteration for the dominant eigenvalue.\r\n% Input:\r\n%   A         square matrix\r\n%   numiter   number of iterations\r\n% Output: \r\n%   beta      sequence of eigenvalue approximations (vector)\r\n%   x         final eigenvector approximation\r\n\r\nn = length(A);\r\nx = randn(n, 1);\r\nx = x / norm(x, inf);\r\nfor k = 1:numiter\r\n    y = A*x;\r\n    [normy, m] = max(abs(y));\r\n    beta(k) = y(m) / x(m);\r\n    x = y / y(m);\r\nend ","lang":"matlab","showLineNumbers":true,"filename":"poweriter.m","key":"sGK8DLv1Gr"}],"key":"h6wAfmCJEB"}],"label":"function-poweriter-matlab","identifier":"function-poweriter-matlab","html_id":"function-poweriter-matlab","key":"skwy1GdhsX"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Inverse iteration","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"UGAzWNWyDM"}],"key":"hqRabSjgJP"},{"type":"include","file":"FNC-matlab/inviter.m","literal":true,"children":[{"type":"code","value":"function [beta, x] = inviter(A, s, numiter)\r\n% INVITER   Shifted inverse iteration for the closest eigenvalue.\r\n% Input:\r\n%   A         square matrix\r\n%   s         value close to targeted eigenvalue (complex scalar)\r\n%   numiter   number of iterations\r\n% Output: \r\n%   beta      sequence of eigenvalue approximations (vector)\r\n%   x         final eigenvector approximation\r\n\r\nn = length(A);\r\nx = randn(n, 1);\r\nx = x / norm(x, inf);\r\nB = A - s*eye(n);\r\n[L,U] = lu(B);\r\nfor k = 1:numiter\r\n    y = U \\ (L\\x);\r\n    [normy, m] = max(abs(y));\r\n    beta(k) = (x(m) / y(m)) + s;\r\n    x = y / y(m);\r\nend ","lang":"matlab","showLineNumbers":true,"filename":"inviter.m","key":"a2R62eFcKg"}],"key":"ckHyC4xXdF"}],"label":"function-inviter-matlab","identifier":"function-inviter-matlab","html_id":"function-inviter-matlab","key":"WEAHemwfjn"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"Arnoldi iteration","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"x2f7M8UUvj"}],"key":"VLRCplqfpH"},{"type":"include","file":"FNC-matlab/arnoldi.m","literal":true,"children":[{"type":"code","value":"function [Q, H] = arnoldi(A, u, m)\r\n% ARNOLDI   Arnoldi iteration for Krylov subspaces.\r\n% Input:\r\n%   A    square matrix (n by n)\r\n%   u    initial vector\r\n%   m    number of iterations\r\n% Output: \r\n%   Q    orthonormal basis of Krylov space (n by m+1)\r\n%   H    upper Hessenberg matrix, A*Q(:,1:m)=Q*H (m+1 by m)\r\n\r\nn = length(A);\r\nQ = zeros(n, m+1);  \r\nH = zeros(m+1, m);\r\nQ(:, 1) = u / norm(u);\r\nfor j = 1:m\r\n  % Find the new direction that extends the Krylov subspace.\r\n  v = A * Q(:, j);\r\n  % Remove the projections onto the previous vectors.\r\n  for i = 1:j\r\n    H(i, j) = Q(:, i)' * v;\r\n    v = v - H(i,j) * Q(:,i);\r\n  end\r\n  % Normalize and store the new basis vector.\r\n  H(j+1, j) = norm(v);\r\n  Q(:, j+1) = v / H(j+1, j);\r\nend","lang":"matlab","showLineNumbers":true,"filename":"arnoldi.m","key":"wZi399Swjk"}],"key":"HAqyFqALmg"}],"label":"function-arnoldi-matlab","identifier":"function-arnoldi-matlab","html_id":"function-arnoldi-matlab","key":"kUODjQlUaq"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"text","value":"GMRES","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"EPbborNkXX"}],"key":"VoT554SYK1"},{"type":"include","file":"FNC-matlab/arngmres.m","literal":true,"children":[{"type":"code","value":"function [x, residual] = arngmres(A, b, m)\r\n% ARNGMRES   GMRES for a linear system (demo only).\r\n% Input:\r\n%   A       square matrix (n by n)\r\n%   b       right-hand side (n by 1)\r\n%   M       number of iterations\r\n% Output: \r\n%   x       approximate solution (n by 1)\r\n%   r       history of norms of the residuals\r\n\r\nn = length(A);\r\nQ = zeros(n, m+1);  \r\nQ(:, 1) = b / norm(b);\r\nH = zeros(m+1 ,m);\r\n\r\n% Initial \"solution\" is zero.\r\nresidual(1) = norm(b);\r\n\r\nfor j = 1:m\r\n  % Next step of Arnoldi iteration.\r\n  v = A * Q(:, j);\r\n  for i = 1:j\r\n      H(i, j) = Q(:, i)' * v;\r\n      v = v - H(i, j) * Q(:,i);\r\n  end\r\n  H(j+1, j) = norm(v);\r\n  Q(:, j+1) = v / H(j+1, j);\r\n  \r\n  % Solve the minimum residual problem.\r\n  r = norm(b) * eye(j+1, 1);\r\n  z = H(1:j+1, 1:j) \\ r;\r\n  x = Q(:, 1:j) * z;\r\n  residual(j+1) = norm( A*x - b );\r\nend","lang":"matlab","showLineNumbers":true,"filename":"arngmres.m","key":"UUHHmrDDbW"}],"key":"vperWXZvUS"}],"label":"function-gmres-matlab","identifier":"function-gmres-matlab","html_id":"function-gmres-matlab","key":"eaaouCGc97"},{"type":"heading","depth":2,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Examples","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"vXDDMHSTwI"}],"identifier":"examples","label":"Examples","html_id":"examples","implicit":true,"key":"ON7bUT0W5n"}],"key":"gRNKHaPyMM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"cd  /Users/driscoll/Documents/GitHub/fnc/matlab\nFNC_init;;","visibility":"show","key":"ZI9iO2s1DI"},{"type":"output","id":"oK6KmaH-C31-2pW3HQ-PJ","data":[{"output_type":"stream","name":"stdout","text":"Starting MATLAB ...\n"},{"output_type":"stream","name":"stdout","text":"Executing ..."}],"visibility":"show","key":"tgVF07VVSj"}],"data":{"tags":[]},"visibility":"remove","key":"o0MWwe6AFM"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"8.1 ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"REA4sJS4oU"},{"type":"link","identifier":"section-krylov-structure","label":"section-krylov-structure","kind":"narrative","position":{"start":{"line":57,"column":5},"end":{"line":57,"column":30}},"url":"/structure-1","internal":true,"dataUrl":"/structure-1.json","children":[{"type":"text","value":"Sparsity and structure","key":"HVZk8bXC5T"}],"key":"eIWhG25Bi1"}],"identifier":"id-8-1","label":"8.1 ","html_id":"id-8-1","implicit":true,"key":"Bo7qgAfRKB"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparse","label":"demo-structure-sparse","kind":"proof:example","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":23}},"children":[{"type":"text","value":"Example ","key":"Xr9OP435oE"},{"type":"text","value":"8.1.1","key":"THKAqa8PZ0"}],"template":"Example %s","enumerator":"8.1.1","resolved":true,"html_id":"demo-structure-sparse","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"M0Qggc171j"}],"key":"VrQh1OxNob"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"Here we load the adjacency matrix of a graph with 2790 nodes. Each node is a web page referring to Roswell, NM, and the edges represent links between web pages. (Credit goes to Panayiotis Tsaparas and the University of Toronto for making this data public.)","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"xZAmL0N1FT"}],"key":"rejrm1Inbg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"load roswelladj\na = whos('A')","key":"o2nNZezSsT"},{"type":"output","id":"lIC6Gw6mFqerJMbVoPau1","data":[{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>a = struct with fields:\n          name: 'A'\n          size: [2790 2790]\n         bytes: 158120\n         class: 'double'\n        global: 0\n        sparse: 1\n       complex: 0\n       nesting: [1x1 struct]\n    persistent: 0\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"a = struct with fields:\n          name: 'A'\n          size: [2790 2790]\n         bytes: 158120\n         class: 'double'\n        global: 0\n        sparse: 1\n       complex: 0\n       nesting: [1x1 struct]\n    persistent: 0\n","content_type":"text/plain"}}}],"key":"HvKMftQurk"}],"data":{},"key":"fmyeRv08Y9"},{"type":"paragraph","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"We may define the density of ","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"gF4srNfS5D"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"Pk8i6XCdcG"},{"type":"text","value":" as the number of nonzeros divided by the total number of entries.","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"xYNdxjf4eI"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"nnz","kind":"entry"},"emphasis":true}],"label":"index-U4rub6hvo6","identifier":"index-u4rub6hvo6","html_id":"index-u4rub6hvo6","key":"B7M5gTubld"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"EuIgRHO8WA"}],"key":"P90zRKvv5A"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Use ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"Sf1GM0fMiP"},{"type":"inlineCode","value":"nnz","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"mcAnOO4Gxt"},{"type":"text","value":" to count the number of nonzeros in a sparse matrix.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"MoydlvnFq3"}],"key":"gVjo6qWqE5"}],"class":"dropdown","key":"iHXdweJLDj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"sz = size(A);  n = sz(1);\ndensity = nnz(A) / prod(sz)","key":"ZCVZPBURKT"},{"type":"output","id":"_PYs9L-ZwoAUR2zHRafkb","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>density = \n   0.437500000000000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"density = \n   0.437500000000000\n","content_type":"text/plain"}}}],"key":"UTwW09iE9J"}],"data":{},"key":"xB91iIY3G9"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"The computer memory consumed by any variable can be discovered using ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"lFxascrLz6"},{"type":"inlineCode","value":"whos","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"ix65W83l9K"},{"type":"text","value":". We can use it to compare the space needed for the sparse representation to its dense counterpart, that is, the space needed to store all the elements, whether zero or not.","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"Qq4JQ5WA9S"}],"key":"g2nPOU8wBH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"F = full(A);\nf = whos('F');\nstorage_ratio = f.bytes / a.bytes","key":"P2Zn7j8oXr"},{"type":"output","id":"sjMxHz4tHrr88ed9Cg1CY","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>storage_ratio = \n     8.095117632178092e-04\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"storage_ratio = \n     8.095117632178092e-04\n","content_type":"text/plain"}}}],"key":"jOCfHsPbKp"}],"data":{},"key":"M5pgdkwGXe"},{"type":"paragraph","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"text","value":"Matrix-vector products are also much faster using the sparse form because operations with structural zeros are skipped.","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"FV16NQHGyx"}],"key":"glKmRoHJcq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = randn(n,1);\ntic, for i = 1:200, A*x; end\nsparse_time = toc","key":"gDedOOqT4d"},{"type":"output","id":"D8ktuspv0_1PkoKHoK0z0","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"Q9dpqchAlR"}],"data":{},"key":"lrfJqPaT43"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"tic, for i = 1:200, F*x; end\ndense_time = toc","key":"f2OjKWLvsJ"},{"type":"output","id":"IQgmSe9P6PUu329uJwbOz","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"we2R6zdkp0"}],"data":{},"key":"pAQs8OIB2P"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"However, the sparse storage format in MATLAB is column-oriented.  Operations on rows may take a lot longer than similar ones on columns.","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"cD71Rm0LBG"}],"key":"XmbJ4BuZAU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"v = A(:, 1000);\ntic, for i = 1:n, A(:, i) = v; end\ncolumn_time = toc\nr = v';\ntic, for i = 1:n, A(i, :) = r; end\nrow_time = toc","key":"hnShy6tJ1h"},{"type":"output","id":"YSKOMV2fvIoBvh_kUtR9F","data":[{"output_type":"stream","name":"stderr","text":"Index in position 2 exceeds array bounds. Index must not exceed 4."}],"key":"dLGRZOYfUO"}],"data":{},"key":"VUCoxYXtOA"}],"label":"demo-structure-sparse-matlab","identifier":"demo-structure-sparse-matlab","html_id":"demo-structure-sparse-matlab","key":"rnsmaPS86q"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-fill","label":"demo-structure-fill","kind":"proof:example","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":21}},"children":[{"type":"text","value":"Example ","key":"TlZscBu14A"},{"type":"text","value":"8.1.2","key":"xg9bu6fCr0"}],"template":"Example %s","enumerator":"8.1.2","resolved":true,"html_id":"demo-structure-fill","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"Y1PPnQcnSE"}],"key":"w3DkASOsRZ"},{"type":"paragraph","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"children":[{"type":"text","value":"Here is the adjacency matrix of a graph representing a small-world network, featuring connections to neighbors and a small number of distant contacts.","position":{"start":{"line":118,"column":1},"end":{"line":118,"column":1}},"key":"qDCMb1Hrv7"}],"key":"hroEKH3Bp9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"load smallworld.mat\nG = graph(A);\nplot(G, nodecolor='r')","key":"MkZ6Lt7E9C"},{"type":"output","id":"nl5-P2SSgaMqMRuYZxo7R","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1cd1f6a923e34d93b29d695d39e8a04f","path":"/build/1cd1f6a923e34d93b29d695d39e8a04f.png"}}}],"key":"HlzJ8LqUoM"}],"data":{},"key":"ab4alnrBVC"},{"type":"paragraph","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Because each node connects to relatively few others, the adjacency matrix is quite sparse.","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"BNOh8nzyso"}],"key":"rhZCGj9PRo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"spy(A)","key":"gQ8y7UTaYm"},{"type":"output","id":"fJ2Z_Xh2EnrU9hQk_P0O0","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7499aff9dc5141c04bb29b2f04f16394","path":"/build/7499aff9dc5141c04bb29b2f04f16394.png"}}}],"key":"zqDzkNqQrJ"}],"data":{},"key":"MD8xY30niC"},{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"By ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"QVeoVgznLF"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-insight-adjmat","label":"theorem-insight-adjmat","children":[{"type":"text","value":"Theorem ","key":"w2b2AwJedo"},{"type":"text","value":"7.1.1","key":"eSkLZlKhU0"}],"template":"Theorem %s","enumerator":"7.1.1","resolved":true,"html_id":"theorem-insight-adjmat","remote":true,"url":"/insight","dataUrl":"/insight.json","key":"IcBQRD4LYj"},{"type":"text","value":", the entries of ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"TCIRif9rYS"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"xdgIlCfMUf"},{"type":"text","value":" give the number of walks of length ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"mLoTU1bFlu"},{"type":"inlineMath","value":"k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"TCG4683EXs"},{"type":"text","value":" between pairs of nodes, as with “","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"dN0nZq0Y27"},{"type":"emphasis","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"bsiT0OlPck"}],"key":"TPwDLoiQCY"},{"type":"text","value":" degrees of separation” within a social network. As ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"pbDSfQBwS3"},{"type":"inlineMath","value":"k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span>","key":"xTKZFHosIp"},{"type":"text","value":" grows, the density of ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"jCGu8rhFXo"},{"type":"inlineMath","value":"\\mathbf{A}^k","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">A</mi><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}^k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">A</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span>","key":"AiFr1GX6MM"},{"type":"text","value":" also grows.","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"fI7qNo947E"}],"key":"XPTpAaZVt2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\ntiledlayout(2, 2)\nfor k = [2, 3, 4, 6]\n    nexttile\n    spy(A^k)\n    title(sprintf(\"A^{%d}\", k))\nend","key":"jVCiOCMtwG"},{"type":"output","id":"ybiheCnl9qR159HzVdhQV","data":[{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ca83bc6414569df3249d92bd0ad9c93","path":"/build/7ca83bc6414569df3249d92bd0ad9c93.png"}}}],"key":"qa0zU1AQwj"}],"data":{},"key":"P9O5RnPcZX"}],"label":"demo-structure-fill-matlab","identifier":"demo-structure-fill-matlab","html_id":"demo-structure-fill-matlab","key":"QTE6zGRifd"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-sparseband","label":"demo-structure-sparseband","kind":"proof:example","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":27}},"children":[{"type":"text","value":"Example ","key":"fr3bqTBbwW"},{"type":"text","value":"8.1.3","key":"ITWnXOAVHD"}],"template":"Example %s","enumerator":"8.1.3","resolved":true,"html_id":"demo-structure-sparseband","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"yYQ9A684HL"}],"key":"w7M7TpntLA"},{"type":"paragraph","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"uyXa2pKfJA"},{"type":"inlineCode","value":"spdiags","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"iTuGuA06QU"},{"type":"text","value":" function creates a sparse matrix given its diagonal elements. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"XdMBUZnB7s"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"spdiags","kind":"entry"},"emphasis":true}],"label":"index-aq3wrJzR98","identifier":"index-aq3wrjzr98","html_id":"index-aq3wrjzr98","key":"DMaXCcRFxQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 50;\nn = 50;\n% Put constant values on 3 diagonals\nA = spdiags([n, 1, 0.1], [-3, 0, 5], n, n);\n% Put other values on 1st superdiagonal\nA = spdiags(-(0:n-1)', 1, A);\nfull(A(1:7, 1:7))","key":"Ef3khqHZYI"},{"type":"output","id":"OW1a3jk04XqT8N4pxy4TJ","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 7×7 double\n    1.0000   -1.0000         0         0         0    0.1000         0\n         0    1.0000   -2.0000         0         0         0    0.1000\n         0         0    1.0000   -3.0000         0         0         0\n   50.0000         0         0    1.0000   -4.0000         0         0\n         0   50.0000         0         0    1.0000   -5.0000         0\n         0         0   50.0000         0         0    1.0000   -6.0000\n         0         0         0   50.0000         0         0    1.0000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 7×7 double\n    1.0000   -1.0000         0         0         0    0.1000         0\n         0    1.0000   -2.0000         0         0         0    0.1000\n         0         0    1.0000   -3.0000         0         0         0\n   50.0000         0         0    1.0000   -4.0000         0         0\n         0   50.0000         0         0    1.0000   -5.0000         0\n         0         0   50.0000         0         0    1.0000   -6.0000\n         0         0         0   50.0000         0         0    1.0000\n","content_type":"text/plain"}}}],"key":"li0fgE03oc"}],"data":{},"key":"CYNERhVmCp"},{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"Without pivoting, the LU factors have the same lower and upper bandwidth as the original matrix.","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"xrrLtPbUvL"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"sparse","kind":"entry"},"emphasis":true}],"label":"index-fS2EGyh5ga","identifier":"index-fs2egyh5ga","html_id":"index-fs2egyh5ga","key":"tbFH0Z1JLu"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"Axr7rRbcEB"}],"key":"drzXEoInXf"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"JdjyxueyOl"},{"type":"inlineCode","value":"sparse","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"wp7XjnYMCx"},{"type":"text","value":" function converts any matrix to sparse form. But it’s usually better to construct a sparse matrix directly, as the standard form might not fit in memory.","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"qeTWy8mSZ2"}],"key":"wuR7Igb44p"}],"class":"dropdown","key":"BOr8LHdD7b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = lufact(A);\nclf\nsubplot(1, 2, 1), spy(L), title('L')\nsubplot(1, 2, 2), spy(U), title(('U'));","key":"qbO9Lvywqi"},{"type":"output","id":"pDgb_Dp7TvtpRhyCgZsbI","data":[{"output_type":"stream","name":"stderr","text":"Unable to perform assignment because the size of the left side is 1-by-3 and the size of the right side is 1-by-5.\n\nError in lufact (line 15)\n    U(k, :) = A_k(k, :);"}],"key":"L3nlQsDnnM"}],"data":{},"key":"f4zl9mBYdG"},{"type":"paragraph","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"text","value":"However, if we introduce row pivoting, bandedness may be expanded or destroyed.","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"nyKHXcKyEd"}],"key":"fwnuOl8znn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U, p] = plufact(A);\nsubplot(1, 2, 1), spy(L(p, :)), title('L')\nsubplot(1, 2, 2), spy(U), title(('U'));","key":"V74ZKGm0Yf"},{"type":"output","id":"WeViC3xbcW0VAQS9Zn52i","data":[{"output_type":"stream","name":"stderr","text":"Unable to perform assignment because the size of the left side is 1-by-3 and the size of the right side is 1-by-5.\n\nError in plufact (line 18)\n    U(k, :) = A_k(p(k), :);"}],"key":"kwlHXwTElw"}],"data":{},"key":"uNQlDYsAbc"}],"label":"demo-structure-sparseband-matlab","identifier":"demo-structure-sparseband-matlab","html_id":"demo-structure-sparseband-matlab","key":"KNtr4HoO5u"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-structure-linalg","label":"demo-structure-linalg","kind":"proof:example","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":23}},"children":[{"type":"text","value":"Example ","key":"adEhycFuRm"},{"type":"text","value":"8.1.4","key":"roGEeJtuko"}],"template":"Example %s","enumerator":"8.1.4","resolved":true,"html_id":"demo-structure-linalg","remote":true,"url":"/structure-1","dataUrl":"/structure-1.json","key":"qyvKHdFGD7"}],"key":"xV9f98aYl4"},{"type":"paragraph","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"text","value":"The following generates a random sparse matrix with prescribed eigenvalues.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"Yjs38YIM7B"}],"key":"UrJvCTObW8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 4000;\ndensity = 4e-4;\nlambda = 1 ./ (1:n);\nA = sprandsym(n, density, lambda);\nclf,  spy(A)\ntitle('Sparse symmetric matrix')","key":"VYtEylTNaX"},{"type":"output","id":"5-blLUeKbIE7li3-wUy7E","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5ece6a3d41dfb2bd632c5cad525b0f6d","path":"/build/5ece6a3d41dfb2bd632c5cad525b0f6d.png"}}}],"key":"gyrvRyLiOK"}],"data":{},"key":"PC8sxhVFSt"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"TZ2gejSAWr"},{"type":"inlineCode","value":"eigs","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"w51FnLHR0L"},{"type":"text","value":" function finds a small number eigenvalues meeting some criterion. First, we ask for the 5 of largest (complex) magnitude.","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"wRiUNExegY"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"eigs","kind":"entry"},"emphasis":true}],"label":"index-EXqAPg8z3N","identifier":"index-exqapg8z3n","html_id":"index-exqapg8z3n","key":"mgSo0DAgp8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eigs(A, 5);    % largest magnitude\n1 ./ diag(D)            % should be 1, 2, 3, 4, 5","key":"z7YSQZkmWz"},{"type":"output","id":"9FhQzhaFIm16mClVIFy7p","data":[{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n    -1\n    -1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n    -1\n    -1\n","content_type":"text/plain"}}}],"key":"xYAhRKjf1A"}],"data":{},"key":"yNx7dD86kw"},{"type":"paragraph","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"text","value":"Now we find the 4 closest to the value 0.03 in the complex plane.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"ilqg5WGGVN"}],"key":"qS37XWf23r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[V, D] = eigs(A, 4, 0.03);    % closest to 0.03\ndiag(D)","key":"EcaHqcYVV4"},{"type":"output","id":"SQVWoKYWgngel_znOQdZ1","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 2×1 double\n    -1\n    -1\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 2×1 double\n    -1\n    -1\n","content_type":"text/plain"}}}],"key":"d37S8mAYH7"}],"data":{},"key":"KY870CchjO"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"The time needed to solve a sparse linear system is not easy to predict unless you have some more information about the matrix. But it will typically be orders of magnitude faster than the dense version of the same problem.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"aCxuzEWRqL"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"\\\\","kind":"entry"},"emphasis":false}],"label":"index-DfGifHwUYD","identifier":"index-dfgifhwuyd","html_id":"index-dfgifhwuyd","key":"smaI1kAIKM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = 1 ./ (1:n)';  \nb = A * x;\ntic, sparse_err = norm(x - A\\b), sparse_time = toc","key":"KsqrMUO36g"},{"type":"output","id":"1VH2IxANjpv9XjZmN6FVW","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"pqkgYoj4Ky"}],"data":{},"key":"Br8FrzJhC1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"F = full(A);\ntic, dense_err = norm(x - F\\b), dense_time = toc","key":"PcfxsJE5vs"},{"type":"output","id":"Q3Sd3erR9nwZqN8Tp41_u","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"ZQQPngtzFC"}],"data":{},"key":"vsFdNxrue4"}],"label":"demo-structure-linalg-matlab","identifier":"demo-structure-linalg-matlab","html_id":"demo-structure-linalg-matlab","key":"WLMlrcrCaH"},{"type":"heading","depth":3,"position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"children":[{"type":"text","value":"8.2 ","position":{"start":{"line":241,"column":1},"end":{"line":241,"column":1}},"key":"oIeRKg5YOb"},{"type":"link","identifier":"section-krylov-power","label":"section-krylov-power","kind":"narrative","position":{"start":{"line":241,"column":5},"end":{"line":241,"column":26}},"url":"/power","internal":true,"dataUrl":"/power.json","children":[{"type":"text","value":"Power iteration","key":"C3D1bhaO0j"}],"key":"IgZP9uKlzl"}],"identifier":"id-8-2","label":"8.2 ","html_id":"id-8-2","implicit":true,"key":"ko172hgoVF"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-power-one","label":"demo-power-one","kind":"proof:example","position":{"start":{"line":244,"column":1},"end":{"line":244,"column":16}},"children":[{"type":"text","value":"Example ","key":"P1zP4jPsip"},{"type":"text","value":"8.2.1","key":"pKT8BJZYcO"}],"template":"Example %s","enumerator":"8.2.1","resolved":true,"html_id":"demo-power-one","remote":true,"url":"/power","dataUrl":"/power.json","key":"Ktd22MOVqp"}],"key":"Q4Tl6hciLF"},{"type":"paragraph","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"children":[{"type":"text","value":"Here we choose a magic 5×5 matrix and a random 5-vector.","position":{"start":{"line":246,"column":1},"end":{"line":246,"column":1}},"key":"ykS5jzEGaK"}],"key":"WNRVIaukyy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = magic(5) / 65;\nx = randn(5, 1);","key":"bW5b9gyR08"},{"type":"output","id":"yDCYlwiyvkqreK8YLZrZz","data":[],"key":"BPEDiYj1I0"}],"data":{},"key":"YlqjlAOCch"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"Applying matrix-vector multiplication once doesn’t do anything recognizable.","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"yeJvOC7twn"}],"key":"lqUrMLWEdf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = A * x","key":"NE0jte8iEQ"},{"type":"output","id":"NkNGIvraLfoHScGnFU8jP","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>y = 5×5 double\n   2.6489e-01   3.7397e-01   1.5582e-02   1.2466e-01   2.3373e-01\n   3.5838e-01   7.7910e-02   1.0907e-01   2.1815e-01   2.4931e-01\n   6.2328e-02   9.3492e-02   2.0257e-01   3.1164e-01   3.4280e-01\n   1.5582e-01   1.8698e-01   2.9606e-01   3.2722e-01   4.6746e-02\n   1.7140e-01   2.8048e-01   3.8955e-01   3.1164e-02   1.4024e-01\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"y = 5×5 double\n   2.6489e-01   3.7397e-01   1.5582e-02   1.2466e-01   2.3373e-01\n   3.5838e-01   7.7910e-02   1.0907e-01   2.1815e-01   2.4931e-01\n   6.2328e-02   9.3492e-02   2.0257e-01   3.1164e-01   3.4280e-01\n   1.5582e-01   1.8698e-01   2.9606e-01   3.2722e-01   4.6746e-02\n   1.7140e-01   2.8048e-01   3.8955e-01   3.1164e-02   1.4024e-01\n","content_type":"text/plain"}}}],"key":"kmldGDS5xG"}],"data":{},"key":"P7eHSyW2nD"},{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"Repeating the multiplication still doesn’t do anything obvious.","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"pHynzKaHkh"}],"key":"GYTQLhrJDb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = A * y","key":"w1ccxChTGx"},{"type":"output","id":"rLfuJNQnbaI1eKQH9J6DE","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"j5ebPiauV8"}],"data":{},"key":"XicyOytGOu"},{"type":"paragraph","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"But if we keep repeating the matrix-vector multiplication, something remarkable happens: ","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"o0QvqNB8Es"},{"type":"inlineMath","value":"\\mathbf{A} \\mathbf{x} \\approx \\mathbf{x}","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi><mi mathvariant=\"bold\">x</mi><mo>≈</mo><mi mathvariant=\"bold\">x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A} \\mathbf{x} \\approx \\mathbf{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Ax</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span></span></span></span>","key":"tKsCzRgNfP"},{"type":"text","value":".","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"uJ2pYT0lHS"}],"key":"rstvWzbJPU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"for j = 1:8\n    x = A * x;\nend\n[x, A * x]","key":"VfSxjAVDcJ"},{"type":"output","id":"QJmYX62sG0Fk4EUyfCLbP","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"jICH73B6zS"}],"data":{},"key":"vVBQktISkv"},{"type":"paragraph","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"This phenomenon seems to occur regardless of the starting vector.","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"bP30pEQvTN"}],"key":"miEbMUGmny"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = randn(5, 1);\nfor j = 1:8\n    x = A * x;\nend\n[x, A * x]","key":"PvjPpVzIA4"},{"type":"output","id":"HnnBAzFrYjqMM9lGQJQuN","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"IWgSfAWfZE"}],"data":{},"key":"vQbFaMg1oM"}],"label":"demo-power-one-matlab","identifier":"demo-power-one-matlab","html_id":"demo-power-one-matlab","key":"PbBIARD3AA"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-power-iter","label":"demo-power-iter","kind":"proof:example","position":{"start":{"line":286,"column":1},"end":{"line":286,"column":17}},"children":[{"type":"text","value":"Example ","key":"sH4WhLQ9X7"},{"type":"text","value":"8.2.2","key":"cBrQnjX5HE"}],"template":"Example %s","enumerator":"8.2.2","resolved":true,"html_id":"demo-power-iter","remote":true,"url":"/power","dataUrl":"/power.json","key":"PP3bO4UaFk"}],"key":"addunML32e"},{"type":"paragraph","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"children":[{"type":"text","value":"We will experiment with the power iteration on a 5×5 matrix with prescribed eigenvalues and dominant eigenvalue at 1.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"h47PYoBaRn"}],"key":"WZyvxbnwLi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ev = [1, -0.75, 0.6, -0.4, 0];\n% Make a triangular matrix with eigenvalues on the diagonal.\nA = triu(ones(5, 5), 1) + diag(ev);","key":"TFmZENGIqF"},{"type":"output","id":"XBa0NriaF6DMKkhQsOIx5","data":[],"key":"vpzuTqrJkn"}],"data":{},"key":"vi48C7p047"},{"type":"paragraph","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"We run the power iteration 60 times. The best estimate of the dominant eigenvalue is the last entry of the first output.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"EXFukFLu7u"}],"key":"CqTlkwjpyh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[beta, x] = poweriter(A, 60);\nformat long\nbeta(1:12)","key":"k78UPbZtkA"},{"type":"output","id":"YlLOTvBUqHzy8JLbUp3pB","data":[{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×12 double\n   5.217290465164652   5.904253883214118  -6.407076926504878  -5.360849025359631  -6.764847163963915  -5.356246182433218  -6.651611432863737  -5.482097585796151  -6.491983185992799  -5.609259927522913  -6.356635519919755  -5.714262025145645\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×12 double\n   5.217290465164652   5.904253883214118  -6.407076926504878  -5.360849025359631  -6.764847163963915  -5.356246182433218  -6.651611432863737  -5.482097585796151  -6.491983185992799  -5.609259927522913  -6.356635519919755  -5.714262025145645\n","content_type":"text/plain"}}}],"key":"PEDE2T6sOt"}],"data":{},"key":"IKK5UY1HX2"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"We check for linear convergence using a log-linear plot of the error.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"p58Tazm2N3"}],"key":"UBGaJ96noI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = 1 - beta;\nclf,  semilogy(abs(err), '.-')\ntitle('Convergence of power iteration')\nxlabel('k'),  ylabel(('|\\lambda_1 - \\beta_k|'));","key":"NmynJIpvei"},{"type":"output","id":"3QCzkh2w_3gHdzbd6xG__","data":[{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"890265c8d05205cfa69ee56dbaea5084","path":"/build/890265c8d05205cfa69ee56dbaea5084.png"}}}],"key":"OyeIPnZFDy"}],"data":{},"key":"v2O90Bpu44"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"The asymptotic trend seems to be a straight line, consistent with linear convergence. To estimate the convergence rate, we look at the ratio of two consecutive errors in the linear part of the convergence curve. The ratio of the first two eigenvalues should match the observed rate.","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"NDlMx7h5qL"}],"key":"WefKwG7h9z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"theory = ev(2) / ev(1)\nobserved = err(40) / err(39)","key":"FvxsPY0HF4"},{"type":"output","id":"Cbd_UsrVWklNFU-irj-X3","data":[{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>theory = \n  -0.750000000000000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"theory = \n  -0.750000000000000\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>observed = \n   0.999400435658511\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"observed = \n   0.999400435658511\n","content_type":"text/plain"}}}],"key":"goMr3g3ovZ"}],"data":{},"key":"v3Yhujhn27"},{"type":"paragraph","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"Note that the error is supposed to change sign on each iteration. The effect of these alternating signs is that estimates oscillate around the exact value.","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"KBxkCSj9Og"}],"key":"BdpLa9Bcsg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"beta(26:29)","key":"SNXmI0NsAn"},{"type":"output","id":"bJyBPtfR5DewvIWxMIl0g","data":[{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×4 double\n   -5.9756   -6.0204   -5.9830   -6.0142\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×4 double\n   -5.9756   -6.0204   -5.9830   -6.0142\n","content_type":"text/plain"}}}],"key":"qLVc7O3yu4"}],"data":{},"key":"COwVFwHiDe"},{"type":"paragraph","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"text","value":"In practical situations, we don’t know the exact eigenvalue that the algorithm is supposed to find. In that case we would base errors on the final ","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"pB6Es1gW8o"},{"type":"text","value":"β","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"Ctgp3AR7L3"},{"type":"text","value":" that was found, as in the following plot.","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"Y0jXMqO35x"}],"key":"LujL6dbkpJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = beta(end) - beta(1:end-1);\nsemilogy(abs(err), '.-')\ntitle('Convergence of power iteration')\nxlabel('k'),  ylabel(('|\\beta_{60} - \\beta_k|'));","key":"B7BAG8T6R5"},{"type":"output","id":"m5YnmrOmoGCN3rgPlK5cI","data":[{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b3b43cb306e307e51e699444c199f860","path":"/build/b3b43cb306e307e51e699444c199f860.png"}}}],"key":"JGOCmPpCxT"}],"data":{},"key":"RQqAR4btgH"},{"type":"paragraph","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"children":[{"type":"text","value":"The results are very similar until the last few iterations, when the limited accuracy of the reference value begins to show. That is, while it is a good estimate of ","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"Xv1mu73sJZ"},{"type":"inlineMath","value":"\\lambda_1","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\lambda_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">λ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"pkEWPYnyj6"},{"type":"text","value":", it is less good as an estimate of the error in nearby estimates.","position":{"start":{"line":335,"column":1},"end":{"line":335,"column":1}},"key":"PRCUSXjhWH"}],"key":"GEdAaFgpTX"}],"label":"demo-power-iter-matlab","identifier":"demo-power-iter-matlab","html_id":"demo-power-iter-matlab","key":"dXAEY6173w"},{"type":"heading","depth":3,"position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"children":[{"type":"text","value":"8.3 ","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"srhwUl8Cqp"},{"type":"link","identifier":"section-krylov-inviter","label":"section-krylov-inviter","kind":"narrative","position":{"start":{"line":339,"column":5},"end":{"line":339,"column":28}},"url":"/inviter","internal":true,"dataUrl":"/inviter.json","children":[{"type":"text","value":"Inverse iteration","key":"kn64DClySt"}],"key":"dPzNRUC7QZ"}],"identifier":"id-8-3","label":"8.3 ","html_id":"id-8-3","implicit":true,"key":"k27nzumFzX"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-inviter-conv","label":"demo-inviter-conv","kind":"proof:example","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":19}},"children":[{"type":"text","value":"Example ","key":"fKH4q4b2zP"},{"type":"text","value":"8.3.1","key":"l0VVeZQ4l8"}],"template":"Example %s","enumerator":"8.3.1","resolved":true,"html_id":"demo-inviter-conv","remote":true,"url":"/inviter","dataUrl":"/inviter.json","key":"gM7GjinZAj"}],"key":"qmqkdfuB7k"},{"type":"paragraph","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"children":[{"type":"text","value":"We set up a ","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"WavR2SBo2y"},{"type":"inlineMath","value":"5\\times 5","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>5</mn><mo>×</mo><mn>5</mn></mrow><annotation encoding=\"application/x-tex\">5\\times 5</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">5</span></span></span></span>","key":"tUcgdG2Ldj"},{"type":"text","value":" triangular matrix with prescribed eigenvalues on its diagonal.","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"hR2UJ3oji1"}],"key":"XFbZwDsVjo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ev = [1, -0.75, 0.6, -0.4, 0];\nA = triu(ones(5, 5), 1) + diag(ev);","key":"qVPuifls3F"},{"type":"output","id":"yID-ymJP3fF4VAsocZmD4","data":[],"key":"PCVz09BBNA"}],"data":{},"key":"fjhMqWrkiQ"},{"type":"paragraph","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"children":[{"type":"text","value":"We run inverse iteration with the shift ","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"aTmHTMCM0v"},{"type":"inlineMath","value":"s=0.7","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding=\"application/x-tex\">s=0.7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.7</span></span></span></span>","key":"PNqJsQRi3w"},{"type":"text","value":". The result should converge to the eigenvalue closest to 0.7, which we know to be 0.6 here.","position":{"start":{"line":351,"column":1},"end":{"line":351,"column":1}},"key":"zl4wPSRzXn"}],"key":"cm3tgJcfS9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"s = 0.7;\n[beta, x] = inviter(A, s, 30);\nformat short\nbeta(1:10)","key":"HKBvXzAj40"},{"type":"output","id":"gVI0_y30q0NCy6Aepmw9O","data":[{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ans = 1×10 double\n    0.6985    0.5727    0.6101    0.5968    0.6011    0.5996    0.6001    0.6000    0.6000    0.6000\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ans = 1×10 double\n    0.6985    0.5727    0.6101    0.5968    0.6011    0.5996    0.6001    0.6000    0.6000    0.6000\n","content_type":"text/plain"}}}],"key":"kIwWXFUctV"}],"data":{},"key":"yD0ZtywLvv"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"The convergence is again linear.","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"q9XEHSgQXh"}],"key":"Yv5rEr3vK2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"err = abs(0.6 - beta);\nsemilogy(abs(err),'.-')\ntitle('Convergence of inverse iteration')\nxlabel('k'), ylabel(('|\\lambda_j - \\beta_k|'));","key":"z8Qoa6prcm"},{"type":"output","id":"jP37eaS8kh4eqK8zaVPPg","data":[{"output_type":"execute_result","execution_count":32,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"55782a6b5a0a5be311b97646ad30ffbe","path":"/build/55782a6b5a0a5be311b97646ad30ffbe.png"}}}],"key":"oKK6nVPkFi"}],"data":{},"key":"k81FzzhOsk"},{"type":"paragraph","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"children":[{"type":"text","value":"Let’s reorder the eigenvalues to enforce ","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"tO970GJtW2"},{"type":"crossReference","kind":"equation","identifier":"shiftorder","label":"shiftorder","children":[{"type":"text","value":"(","key":"F7hnyiFGsb"},{"type":"text","value":"8.3.3","key":"z3jcZWQ97j"},{"type":"text","value":")","key":"eYVYAZccMT"}],"template":"(%s)","enumerator":"8.3.3","resolved":true,"html_id":"shiftorder","remote":true,"url":"/inviter","dataUrl":"/inviter.json","key":"MjFtjNrvPJ"},{"type":"text","value":".","position":{"start":{"line":369,"column":1},"end":{"line":369,"column":1}},"key":"uPppuvGryq"}],"key":"fguWCFhjUG"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"uty2kMtyzz"}],"key":"A0gpkQDnhp"},{"type":"paragraph","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"children":[{"type":"text","value":"The second output of ","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"uJ0bzLhs20"},{"type":"inlineCode","value":"sort","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"ubWnt2ixug"},{"type":"text","value":" returns the index permutation needed to sort the given vector.","position":{"start":{"line":372,"column":1},"end":{"line":372,"column":1}},"key":"rZZFSd4Ow9"}],"key":"ywFqmSrAhm"}],"class":"dropdown","key":"bgBLE777cC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[~, idx] = sort(abs(ev - s));\nev = ev(idx)","key":"VdVKDyQDLj"},{"type":"output","id":"e7QZLyHKsFUFo63PyTIqJ","data":[{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>ev = 1×5 double\n    0.6000    1.0000         0   -0.4000   -0.7500\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"ev = 1×5 double\n    0.6000    1.0000         0   -0.4000   -0.7500\n","content_type":"text/plain"}}}],"key":"VDNTRBgFBD"}],"data":{},"key":"rhKyEWTliz"},{"type":"paragraph","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"Now it is easy to compare the theoretical and observed linear convergence rates.","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"ryBl7NNDun"}],"key":"Xe3f22Z63N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"theoretical_rate = (ev(1) - s) / (ev(2) - s)\nobserved_rate = err(26) / err(25)","key":"Ajljp7VVsC"},{"type":"output","id":"xmxGgRMQDKXw0E94KmIn6","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>theoretical_rate = -0.3333</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"theoretical_rate = -0.3333","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>observed_rate = 0.3333</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"observed_rate = 0.3333","content_type":"text/plain"}}}],"key":"vj5i6mLwzC"}],"data":{},"key":"aav7C80iAI"}],"label":"demo-inviter-conv-matlab","identifier":"demo-inviter-conv-matlab","html_id":"demo-inviter-conv-matlab","key":"Map8O1X58H"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-inviter-accel","label":"demo-inviter-accel","kind":"proof:example","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":20}},"children":[{"type":"text","value":"Example ","key":"jPpYybT3ba"},{"type":"text","value":"8.3.2","key":"gFGTQZMBnw"}],"template":"Example %s","enumerator":"8.3.2","resolved":true,"html_id":"demo-inviter-accel","remote":true,"url":"/inviter","dataUrl":"/inviter.json","key":"fkvpMuO5G3"}],"key":"tXpamHEtva"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"ev = [1, -0.75, 0.6, -0.4, 0];\nA = triu(ones(5, 5), 1) + diag(ev);","key":"cxRoOWuWTP"},{"type":"output","id":"SsKeXAQyzwYy4kbClfJVv","data":[],"key":"CtZfAHKw9S"}],"data":{},"key":"g2Bf5tjGwC"},{"type":"paragraph","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"text","value":"We begin with a shift ","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"Q1BWWHaPj0"},{"type":"inlineMath","value":"s=0.7","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding=\"application/x-tex\">s=0.7</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.7</span></span></span></span>","key":"r82J8e9VWM"},{"type":"text","value":", which is closest to the eigenvalue 0.6.","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"wEF3X8jhoz"}],"key":"X8lNEyR89k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"s = 0.7;\nx = ones(5, 1);\ny = (A - s * eye(5)) \\ x;\nbeta = x(1) / y(1) + s","key":"m3XDX7GS0d"},{"type":"output","id":"ggsjO4wJu9CFUq9k75f5s","data":[{"output_type":"stream","name":"stderr","text":"Error using -\nArrays have incompatible sizes for this operation."}],"key":"OvnFdgVqts"}],"data":{},"key":"CizK8VGOx1"},{"type":"paragraph","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"children":[{"type":"text","value":"Note that the result is not yet any closer to the targeted 0.6. But we proceed (without being too picky about normalization here).","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"NKJy9piUFH"}],"key":"MVTU3TVVHx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"s = beta;\nx = y / y(1);\ny = (A - s * eye(5)) \\ x;\nbeta = x(1) / y(1) + s","key":"MtStv2iXxs"},{"type":"output","id":"s72xgpIaCS2Q5bae_1lCf","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"A3TdHTf2wV"}],"data":{},"key":"Ad0fO0wjJW"},{"type":"paragraph","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"children":[{"type":"text","value":"Still not much apparent progress. However, in just a few more iterations the results are dramatically better.","position":{"start":{"line":414,"column":1},"end":{"line":414,"column":1}},"key":"pldnSgllJr"}],"key":"gBD7STTwQR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"format long\nfor k = 1:4\n    s = beta;\n    x = y / y(1);\n    y = (A - s * eye(5)) \\ x;\n    beta = x(1) / y(1) + s\nend","key":"J5ynUMILWx"},{"type":"output","id":"fuvZKMbNZGON_9_yvQUWK","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication."}],"key":"HycUKKGCdY"}],"data":{},"key":"VS6hLrXfjB"}],"label":"demo-inviter-accel-matlab","identifier":"demo-inviter-accel-matlab","html_id":"demo-inviter-accel-matlab","key":"IWIJ60XHI5"},{"type":"heading","depth":3,"position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"children":[{"type":"text","value":"8.4 ","position":{"start":{"line":427,"column":1},"end":{"line":427,"column":1}},"key":"vdsWkZdzKJ"},{"type":"link","identifier":"section-krylov-subspace","label":"section-krylov-subspace","kind":"narrative","position":{"start":{"line":427,"column":5},"end":{"line":427,"column":29}},"url":"/subspace","internal":true,"dataUrl":"/subspace.json","children":[{"type":"text","value":"Krylov subspaces","key":"UH3pP7a2zh"}],"key":"l51dr9cGnu"}],"identifier":"id-8-4","label":"8.4 ","html_id":"id-8-4","implicit":true,"key":"eD2bd0F0bz"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-subspace-unstable","label":"demo-subspace-unstable","kind":"proof:example","position":{"start":{"line":430,"column":1},"end":{"line":430,"column":24}},"children":[{"type":"text","value":"Example ","key":"D392j0NzkB"},{"type":"text","value":"8.4.1","key":"iaIjwVj3QK"}],"template":"Example %s","enumerator":"8.4.1","resolved":true,"html_id":"demo-subspace-unstable","remote":true,"url":"/subspace","dataUrl":"/subspace.json","key":"dF3x0wHeW0"}],"key":"zQdOYMsbdc"},{"type":"paragraph","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"children":[{"type":"text","value":"First we define a triangular matrix ","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"IPeXpuLP7T"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"jaj2S6hpeP"},{"type":"text","value":" with known eigenvalues and a random vector ","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"ENt6xZMua0"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"uV9PHBstmE"},{"type":"text","value":".","position":{"start":{"line":432,"column":1},"end":{"line":432,"column":1}},"key":"OQ7h4l5tsN"}],"key":"S0PbIkqenb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 10 + (1:100);\nA = diag(lambda) + triu(rand(100), 1); \nb = rand(100, 1);","key":"IYxotkAwDh"},{"type":"output","id":"K4Po4jXv2yYAPe_yQhUH0","data":[],"key":"QNQv7JTOA8"}],"data":{},"key":"MEfFs4YA54"},{"type":"paragraph","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"children":[{"type":"text","value":"Next, we build up the first ten Krylov matrices iteratively. In order to keep the columns from growing exponentially in norm, we normalize them as we go. This doesn’t affect the column space of the Krylov matrix, in principle at least.","position":{"start":{"line":440,"column":1},"end":{"line":440,"column":1}},"key":"lSxMvFqVMN"}],"key":"q9k1GAP3BE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Km = b;\nfor m = 1:29      \n    v = A * Km(:, m);\n    Km(:, m+1) = v / norm(v);\nend","key":"U5kemvh7ZI"},{"type":"output","id":"MVQjBohdY64RHKL_B05cC","data":[],"key":"rkm7Lfc0Iq"}],"data":{},"key":"xbgTNeLryf"},{"type":"paragraph","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":1}},"children":[{"type":"text","value":"Now we solve least-squares problems for Krylov matrices of increasing dimension, recording the residual in each case.","position":{"start":{"line":450,"column":1},"end":{"line":450,"column":1}},"key":"ScMmBSna16"}],"key":"ZR9s3I73Zj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"warning off  \nresid = zeros(30, 1);\nfor m = 1:30  \n    z = (A * Km(:, 1:m)) \\ b;\n    x = Km(:, 1:m) * z;\n    resid(m) = norm(b - A * x);\nend","key":"xdVgIvJwwW"},{"type":"output","id":"JYJDI-8acoxxMP_uRAdbJ","data":[],"key":"HmEHYRbm1I"}],"data":{},"key":"p5dTDWO32w"},{"type":"paragraph","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"children":[{"type":"text","value":"The linear system approximations show smooth linear convergence at first, but the convergence stagnates after only a few digits have been found.","position":{"start":{"line":462,"column":1},"end":{"line":462,"column":1}},"key":"vabmusrNR1"}],"key":"A1P1Yo4HdS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nsemilogy(resid, '.-')\nxlabel('m'),  ylabel('|| b-Ax_m ||')\nset(gca,'ytick',10.^(-6:2:0))\naxis tight, title('Residual for linear systems')","key":"Tg0FHS2gFU"},{"type":"output","id":"oAnc7iSZLJ8yZOeRz-Tn2","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"43f430d0daf5ddaa20e78cfb89346ab9","path":"/build/43f430d0daf5ddaa20e78cfb89346ab9.png"}}}],"key":"DbrGH6wfI1"}],"data":{},"key":"L5xUJWnTod"}],"label":"demo-subspace-unstable-matlab","identifier":"demo-subspace-unstable-matlab","html_id":"demo-subspace-unstable-matlab","key":"TqMbUqaQcw"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-subspace-arnoldi","label":"demo-subspace-arnoldi","kind":"proof:example","position":{"start":{"line":474,"column":1},"end":{"line":474,"column":23}},"children":[{"type":"text","value":"Example ","key":"a86FGAt2ci"},{"type":"text","value":"8.4.2","key":"MbfxlCCsGf"}],"template":"Example %s","enumerator":"8.4.2","resolved":true,"html_id":"demo-subspace-arnoldi","remote":true,"url":"/subspace","dataUrl":"/subspace.json","key":"GcLxWUlUzk"}],"key":"jmaTOEcIdQ"},{"type":"paragraph","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"children":[{"type":"text","value":"Here again is the linear system from ","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"slDSHAAeam"},{"type":"crossReference","identifier":"demo-subspace-unstable","label":"demo-subspace-unstable","kind":"proof:example","position":{"start":{"line":476,"column":38},"end":{"line":476,"column":61}},"children":[{"type":"text","value":"Example ","key":"nHaO5RaZ28"},{"type":"text","value":"8.4.1","key":"B2ASPL12Hf"}],"template":"Example %s","enumerator":"8.4.1","resolved":true,"html_id":"demo-subspace-unstable","remote":true,"url":"/subspace","dataUrl":"/subspace.json","key":"ub6tPuAlge"},{"type":"text","value":".","position":{"start":{"line":476,"column":1},"end":{"line":476,"column":1}},"key":"PY6JmHS16p"}],"key":"xO8OK6uuu1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 10 + (1:100);\nA = diag(lambda) + triu(rand(100), 1); \nb = rand(100, 1);","key":"tUQ1vLqGAa"},{"type":"output","id":"2GM3yaU_9cFAbjrHpt47E","data":[],"key":"uqEvUrfLK7"}],"data":{},"key":"DfSZqXNEO8"},{"type":"paragraph","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"children":[{"type":"text","value":"We can use ","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"QtHFumjiDJ"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"mlDkAJb2oO"},{"type":"text","value":" as the seed vector for the Arnoldi iteration.","position":{"start":{"line":484,"column":1},"end":{"line":484,"column":1}},"key":"HcwU5w8qrc"}],"key":"ZCqq1YhJ5K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q, H] = arnoldi(A, b, 30);\ndisp(sprintf(\"Q is %d by %d\", size(Q)))\ndisp(sprintf(\"H is %d by %d\", size(H)))","key":"GQuubZAQIa"},{"type":"output","id":"tl8du4jmoO57ywv7TMDLZ","data":[{"output_type":"stream","name":"stdout","text":"Q is 100 by 31"},{"output_type":"stream","name":"stdout","text":"\n"},{"output_type":"stream","name":"stdout","text":"H is 31 by 30"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"hAPT5HrbXr"}],"data":{},"key":"ngOhBk7jVK"},{"type":"paragraph","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"children":[{"type":"text","value":"Here’s one validation of the key identity ","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"uLwQ2u9RZ9"},{"type":"crossReference","identifier":"arnoldimat","label":"arnoldimat","kind":"equation","position":{"start":{"line":492,"column":43},"end":{"line":492,"column":54}},"children":[{"type":"text","value":"(","key":"Pk4fXBM1QS"},{"type":"text","value":"8.4.10","key":"xzao7W38lk"},{"type":"text","value":")","key":"EhA6plq7OR"}],"template":"(%s)","enumerator":"8.4.10","resolved":true,"html_id":"arnoldimat","remote":true,"url":"/subspace","dataUrl":"/subspace.json","key":"SP9ZJYAHZW"},{"type":"text","value":".","position":{"start":{"line":492,"column":1},"end":{"line":492,"column":1}},"key":"CGmsxdhwBb"}],"key":"RJi8TXa6Q6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"should_be_near_zero = norm(A * Q(:, 1:20) - Q(:, 1:21) * H(1:21, 1:20))","key":"mfBTLAB4uX"},{"type":"output","id":"Gtq7ibYAurA7ul78-DM7e","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>should_be_near_zero = \n   6.1784e-12\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"should_be_near_zero = \n   6.1784e-12\n","content_type":"text/plain"}}}],"key":"Xgxz2FoAtI"}],"data":{},"key":"exBVRHgvSc"},{"type":"paragraph","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"Using the Krylov matrix to project the linear system into a Kyrlov subspace in ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"Nga8uIeJJ9"},{"type":"crossReference","identifier":"demo-subspace-unstable","label":"demo-subspace-unstable","kind":"proof:example","position":{"start":{"line":497,"column":80},"end":{"line":497,"column":103}},"children":[{"type":"text","value":"Example ","key":"ODAefmywZi"},{"type":"text","value":"8.4.1","key":"bactPJgWaf"}],"template":"Example %s","enumerator":"8.4.1","resolved":true,"html_id":"demo-subspace-unstable","remote":true,"url":"/subspace","dataUrl":"/subspace.json","key":"nB6nJgBRit"},{"type":"text","value":" was unable to get the residual much smaller than about ","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"JmlyRko8AF"},{"type":"span","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"children":[{"type":"text","value":"10","key":"z54XBRspLW"},{"type":"superscript","children":[{"type":"text","value":"-4","key":"YfjUqxhd3P"}],"key":"ZqtjapGiHA"}],"key":"usvqra2RdY"},{"type":"text","value":". But the Arnoldi basis gives us a stable way to work in that subspace and get better results.","position":{"start":{"line":497,"column":1},"end":{"line":497,"column":1}},"key":"VxWx6cfzow"}],"key":"tGAAqAc0l0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"z = (A * Q) \\ b;\nx = Q * z;\nresid_norm = norm(b - A * x)","key":"NuxpC92Xih"},{"type":"output","id":"-SPISdKQTyC2tkdiHTCLZ","data":[{"output_type":"stream","name":"stderr","text":"Error using \\\nMatrix dimensions must agree."}],"key":"feQl4BXOb3"}],"data":{},"key":"NCfWpwVl4p"}],"label":"demo-subspace-arnoldi-matlab","identifier":"demo-subspace-arnoldi-matlab","html_id":"demo-subspace-arnoldi-matlab","key":"DLWjOchuht"},{"type":"heading","depth":3,"position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"children":[{"type":"text","value":"8.5 ","position":{"start":{"line":506,"column":1},"end":{"line":506,"column":1}},"key":"WY17pdX7FC"},{"type":"link","identifier":"section-krylov-gmres","label":"section-krylov-gmres","kind":"narrative","position":{"start":{"line":506,"column":5},"end":{"line":506,"column":26}},"url":"/gmres","internal":true,"dataUrl":"/gmres.json","children":[{"type":"text","value":"GMRES","key":"MQArI4cXql"}],"key":"Q4btIUIHIk"}],"identifier":"id-8-5","label":"8.5 ","html_id":"id-8-5","implicit":true,"key":"sBuyIcIcGG"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-gmres-intro","label":"demo-gmres-intro","kind":"proof:example","position":{"start":{"line":509,"column":1},"end":{"line":509,"column":18}},"children":[{"type":"text","value":"Example ","key":"GT2IJPgWzs"},{"type":"text","value":"8.5.1","key":"Vkk5zyTx9A"}],"template":"Example %s","enumerator":"8.5.1","resolved":true,"html_id":"demo-gmres-intro","remote":true,"url":"/gmres","dataUrl":"/gmres.json","key":"dAJQdCpxHn"}],"key":"JBa90OB7Ba"},{"type":"paragraph","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"children":[{"type":"text","value":"We define a triangular matrix with known eigenvalues and a random vector ","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"key":"UlLB5Qrqcf"},{"type":"inlineMath","value":"\\mathbf{b}","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">b</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\">b</span></span></span></span>","key":"Xhldw6HpZN"},{"type":"text","value":".","position":{"start":{"line":511,"column":1},"end":{"line":511,"column":1}},"key":"g3bK2WtL7e"}],"key":"tdWZF57mIh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"lambda = 10 + (1:100);\nA = diag(lambda) + triu(rand(100), 1); \nb = rand(100, 1);","key":"OBXOCrBTBo"},{"type":"output","id":"86xzqpzhF7Z85EA48d77a","data":[],"key":"IJMTcm9j9M"}],"data":{},"key":"KgHEoy3zgI"},{"type":"paragraph","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"children":[{"type":"text","value":"Instead of building the Krylov matrices, we use the Arnoldi iteration to generate equivalent orthonormal vectors.","position":{"start":{"line":519,"column":1},"end":{"line":519,"column":1}},"key":"dDsAX3kyg7"}],"key":"Om33h3Q1eI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[Q, H] = arnoldi(A, b, 60);","key":"PBObGdacsx"},{"type":"output","id":"exFdoaqFggz-8ddnQFw2t","data":[{"output_type":"stream","name":"stderr","text":"Unable to perform assignment because the size of the left side is 100-by-1 and the size of the right side is 5-by-1.\n\nError in arnoldi (line 14)\nQ(:, 1) = u / norm(u);"}],"key":"D8KuXAeLBF"}],"data":{},"key":"Y4VeJkpW8l"},{"type":"paragraph","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"children":[{"type":"text","value":"The Arnoldi bases are used to solve the least-squares problems defining the GMRES iterates.","position":{"start":{"line":525,"column":1},"end":{"line":525,"column":1}},"key":"wj7qxde5kv"}],"key":"GDraavqaSS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"resid = norm(b);\nfor m = 1:60\n    s = [norm(b); zeros(m, 1)];\n    z = H(1:m+1, 1:m) \\ s;\n    x = Q(:, 1:m) * z;\n    resid = [resid, norm(b - A * x)];\nend","key":"Iqc6byc1rp"},{"type":"output","id":"PBK4Iqpo-VEoDtqJJyyJV","data":[{"output_type":"stream","name":"stderr","text":"Index in position 1 exceeds array bounds. Index must not exceed 31."}],"key":"tOLzvJLF4W"}],"data":{},"key":"AID4w2EcIN"},{"type":"paragraph","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"children":[{"type":"text","value":"The approximations converge smoothly, practically all the way to machine epsilon.","position":{"start":{"line":537,"column":1},"end":{"line":537,"column":1}},"key":"Hjwch0gcvg"}],"key":"u33iZQg2Ic"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nsemilogy(resid,'.-')\nxlabel('m'),  ylabel('|| b - Ax_m ||')\naxis tight, title(('Residual for GMRES'));","key":"Hn2BVAkqfy"},{"type":"output","id":"DV9YlEkde1fDRu34aZK3W","data":[{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0cd3247033a6a53496ed250a69a9e3c6","path":"/build/0cd3247033a6a53496ed250a69a9e3c6.png"}}}],"key":"YbIEbT6O1z"}],"data":{},"key":"bphT7ivAYd"}],"label":"demo-gmres-intro-matlab","identifier":"demo-gmres-intro-matlab","html_id":"demo-gmres-intro-matlab","key":"ORCJOG3HXJ"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-gmres-restart","label":"demo-gmres-restart","kind":"proof:example","position":{"start":{"line":548,"column":1},"end":{"line":548,"column":20}},"children":[{"type":"text","value":"Example ","key":"acNbBn2MnO"},{"type":"text","value":"8.5.2","key":"KKz2DPGmv6"}],"template":"Example %s","enumerator":"8.5.2","resolved":true,"html_id":"demo-gmres-restart","remote":true,"url":"/gmres","dataUrl":"/gmres.json","key":"iyw9kNPxld"}],"key":"Mitne7Uoxd"},{"type":"paragraph","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"children":[{"type":"text","value":"The following experiments are based on a matrix resulting from discretization of a partial differential equation.","position":{"start":{"line":550,"column":1},"end":{"line":550,"column":1}},"key":"W4tklbP7DT"}],"key":"zGxtjSyaq3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"d = 50;\nA = d^2 * gallery('poisson', d);\nn = size(A, 1)\nb = ones(n, 1);\nclf,  spy(A)","key":"ismAH3RdLy"},{"type":"output","id":"r3ClIokzQUMUAzp201K9O","data":[{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/html":{"content":"<html><body><pre>n = \n        2500\n</pre></body></html>","content_type":"text/html"},"text/plain":{"content":"n = \n        2500\n","content_type":"text/plain"}}},{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fb694dbed780bc8f85e180679862cb06","path":"/build/fb694dbed780bc8f85e180679862cb06.png"}}}],"key":"ae9fDeZcn3"}],"data":{},"key":"wjVKTgTcqx"},{"type":"paragraph","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"children":[{"type":"text","value":"We compare unrestarted GMRES with three different thresholds for restarting. Here we are using the built-in ","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"fW4vShPRXG"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"JLkjvVliBd"},{"type":"text","value":", since our simple implementation does not offer restarting.","position":{"start":{"line":563,"column":1},"end":{"line":563,"column":1}},"key":"eF8EZDByj2"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"gmres","kind":"entry"},"emphasis":true}],"label":"index-sIhr2hJwiH","identifier":"index-sihr2hjwih","html_id":"index-sihr2hjwih","key":"Rucx07S8wk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf\nrestart = [120, 20, 40, 60];\nfor j = 1:4\n    [~,~,~,~,rv] = gmres(A, b, restart(j), 1e-9,120 / restart(j));\n    semilogy(0:length(rv) - 1, rv),  hold on\nend\ntitle('Convergence of restarted GMRES')\nxlabel('m'),  ylabel('residual norm')\nlegend('no restart','every 20','every 40','every 60','location','southwest');","key":"zGizvrWZN8"},{"type":"output","id":"bijI_rqRZkA6f-biy2Ddo","data":[{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4e17b14275746020f8d1a551e02b1fd3","path":"/build/4e17b14275746020f8d1a551e02b1fd3.png"}}}],"key":"kbhsNVxhpS"}],"data":{},"key":"pImI05Ruil"},{"type":"paragraph","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"children":[{"type":"text","value":"The “pure” GMRES curve is the lowest one. All of the other curves agree with it until the first restart. Decreasing the restart value makes the convergence per iteration generally worse, but the time required per iteration smaller as well.","position":{"start":{"line":577,"column":1},"end":{"line":577,"column":1}},"key":"Qtk9pYwsZC"}],"key":"BYvUKSyBBH"}],"label":"demo-gmres-restart-matlab","identifier":"demo-gmres-restart-matlab","html_id":"demo-gmres-restart-matlab","key":"q64nWBk6D7"},{"type":"heading","depth":3,"position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"children":[{"type":"text","value":"8.6 ","position":{"start":{"line":580,"column":1},"end":{"line":580,"column":1}},"key":"iamCJh3vkM"},{"type":"link","identifier":"section-krylov-minrescg","label":"section-krylov-minrescg","kind":"narrative","position":{"start":{"line":580,"column":5},"end":{"line":580,"column":29}},"url":"/minrescg","internal":true,"dataUrl":"/minrescg.json","children":[{"type":"text","value":"MINRES and conjugate gradients","key":"aDK4zzvuUX"}],"key":"VNKPkYoCiY"}],"identifier":"id-8-6","label":"8.6 ","html_id":"id-8-6","implicit":true,"key":"vb4wJJN5Lc"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-minrescg-indefinite","label":"demo-minrescg-indefinite","kind":"proof:example","position":{"start":{"line":583,"column":1},"end":{"line":583,"column":26}},"children":[{"type":"text","value":"Example ","key":"Tp2mhmY5PN"},{"type":"text","value":"8.6.2","key":"g7KU9tt4rB"}],"template":"Example %s","enumerator":"8.6.2","resolved":true,"html_id":"demo-minrescg-indefinite","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"cuXCqrJ57W"}],"key":"xWPVOkPw73"},{"type":"paragraph","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"children":[{"type":"text","value":"The following matrix is indefinite.","position":{"start":{"line":585,"column":1},"end":{"line":585,"column":1}},"key":"pkSaaYHido"}],"key":"Zrf9cZrLZ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = (11 / pi)^2 * gallery('poisson', 10);\nA = A - 20 * eye(100);\nlambda = eig(full(A));\nisneg = lambda < 0;\ndisp(sprintf(\"%d negative and %d positive eigenvalues\", sum(isneg), sum(~isneg)))","key":"Y51KdKP2pZ"},{"type":"output","id":"mCWpx_IGOUjUDUuP8-Yp_","data":[{"output_type":"stream","name":"stdout","text":"13 negative and 87 positive eigenvalues"},{"output_type":"stream","name":"stdout","text":"\n"}],"key":"zC2ShJVGQ8"}],"data":{},"key":"pghzhEcna8"},{"type":"paragraph","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"children":[{"type":"text","value":"We can compute the relevant quantities from ","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"qIyFRbZr8Z"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-minrescg-indefinite","label":"theorem-minrescg-indefinite","children":[{"type":"text","value":"Theorem ","key":"DRQkc5eZav"},{"type":"text","value":"8.6.1","key":"ziyaxBm9L9"}],"template":"Theorem %s","enumerator":"8.6.1","resolved":true,"html_id":"theorem-minrescg-indefinite","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"xjIgHDbMXf"},{"type":"text","value":".","position":{"start":{"line":595,"column":1},"end":{"line":595,"column":1}},"key":"bLxz7FNhaH"}],"key":"FtS6SvVXqP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"m = min(-lambda(isneg));\nM = max(-lambda(isneg));\nkappa_minus = M / m;\nm = min(lambda(~isneg));\nM = max(lambda(~isneg));\nkappa_plus = M / m;\nS = sqrt(kappa_minus * kappa_plus);\nrho = sqrt((S - 1) / (S + 1));\nfprintf(\"convergence rate: %.3f\", rho)","key":"kUwrO0tN2E"},{"type":"output","id":"alOiXrqitddwXNLp4wDbK","data":[{"output_type":"stream","name":"stdout","text":"convergence rate: "},{"output_type":"stream","name":"stdout","text":"0.950"}],"key":"mzuVOnw79s"}],"data":{},"key":"yQUmlgrWe6"},{"type":"paragraph","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"children":[{"type":"text","value":"Because the iteration number ","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"J3lL86p2gh"},{"type":"inlineMath","value":"m","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"tLsfkaOfB6"},{"type":"text","value":" is halved in ","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"eRHkwMNGOL"},{"type":"crossReference","kind":"equation","identifier":"minres-conv","label":"minres-conv","children":[{"type":"text","value":"(","key":"vMIwP5R048"},{"type":"text","value":"8.6.4","key":"VhlCw1Yv7S"},{"type":"text","value":")","key":"yf11V4Nj4O"}],"template":"(%s)","enumerator":"8.6.4","resolved":true,"html_id":"minres-conv","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"HgGueRe9ey"},{"type":"text","value":", the rate constant of linear convergence is the square root of this number, which makes it even closer to 1.","position":{"start":{"line":609,"column":1},"end":{"line":609,"column":1}},"key":"MLgkpx31oH"}],"key":"smdiCoVw1z"},{"type":"paragraph","position":{"start":{"line":611,"column":1},"end":{"line":611,"column":1}},"children":[{"type":"text","value":"Now we apply MINRES to a linear system with this matrix, and compare the observed convergence to the upper bound from the theorem.","position":{"start":{"line":611,"column":1},"end":{"line":611,"column":1}},"key":"N1ZDnAsSlP"}],"key":"sYnDAfCEaT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(100, 1);\n[xMR, ~,~ , ~, residMR] = minres(A, b, 1e-10, 100);\nrelres = residMR / norm(b);\nm = 0:length(relres) - 1;\nclf,  semilogy(m, relres, '.-')\nhold on\nsemilogy(m, rho .^ m, 'k--')\nxlabel('m'),  ylabel('relative residual') \ntitle('Convergence of MINRES') \nlegend('MINRES', 'upper bound', 'location', 'southwest');","key":"Jno0EKtK9y"},{"type":"output","id":"hx1Wk2eikF_YKrX-AvP11","data":[{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"24f28ba9d9dcf243911fb5c692a46fc9","path":"/build/24f28ba9d9dcf243911fb5c692a46fc9.png"}}}],"key":"Y6xzFf3V8M"}],"data":{},"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"minres","kind":"entry"},"emphasis":true}],"label":"index-jSeWkkoaRZ","identifier":"index-jsewkkoarz","html_id":"index-jsewkkoarz","key":"kxxCA0vFwp"},{"type":"paragraph","position":{"start":{"line":629,"column":1},"end":{"line":629,"column":1}},"children":[{"type":"text","value":"The upper bound turns out to be pessimistic here, especially in the later iterations. However, you can see a slow linear phase in the convergence that tracks the bound closely.","position":{"start":{"line":629,"column":1},"end":{"line":629,"column":1}},"key":"qkK9lZybIC"}],"key":"XGmQQd1I5N"}],"label":"demo-minrescg-indefinite-matlab","identifier":"demo-minrescg-indefinite-matlab","html_id":"demo-minrescg-indefinite-matlab","key":"pXhTY1CpEB"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-minrescg-converge","label":"demo-minrescg-converge","kind":"proof:example","position":{"start":{"line":633,"column":1},"end":{"line":633,"column":24}},"children":[{"type":"text","value":"Example ","key":"OboWHX7FTV"},{"type":"text","value":"8.6.3","key":"hTABu4Mx2l"}],"template":"Example %s","enumerator":"8.6.3","resolved":true,"html_id":"demo-minrescg-converge","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"qnQZhCwV1v"}],"key":"ccSCR2gYTq"},{"type":"paragraph","position":{"start":{"line":635,"column":1},"end":{"line":635,"column":1}},"children":[{"type":"text","value":"We will compare MINRES and CG on some quasi-random ","key":"USZLMlFyDI"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"P6YBwLjqPv"}],"key":"XB7p8gb6cy"},{"type":"text","value":" problems.  The first matrix has a condition number of 100.","key":"zpdcTuXMGU"}],"key":"B3gHU9s9d3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 5000;\ndensity = 0.001;\nA = sprandsym(n, density, 1e-2, 2);","key":"sMDu5yUEbU"},{"type":"output","id":"37_g0Q4UfQLzZA3Gfc_Lf","data":[],"key":"zn1gp2DzJZ"}],"data":{},"key":"zbUVmmLc52"},{"type":"paragraph","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"children":[{"type":"text","value":"We generate a system with a known solution.","position":{"start":{"line":643,"column":1},"end":{"line":643,"column":1}},"key":"m3BVPNGv2E"}],"key":"nt3X8S9Aue"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"x = (1:n)' / n;\nb = A * x;","key":"URzC46G6l3"},{"type":"output","id":"c9cVPXPHjlaDr-19r-P7o","data":[],"key":"Bp0obO6WAH"}],"data":{},"key":"I4vVrLq0B6"},{"type":"paragraph","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"children":[{"type":"text","value":"Now we apply both methods and compare the convergence of the system residuals.","position":{"start":{"line":653,"column":1},"end":{"line":653,"column":1}},"key":"k97STVlQpb"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"pcg","kind":"entry"},"emphasis":true}],"label":"index-rviaSnYbl8","identifier":"index-rviasnybl8","html_id":"index-rviasnybl8","key":"AlcHlGtlRZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[xMR, ~, ~, ~, residMR] = minres(A, b, 1e-7, 100);\n[xCG, ~, ~, ~, residCG] = pcg(A, b, 1e-7, 100);\nM = length(residMR) - 1;\nclf,  semilogy(0:M, residMR / norm(b), '.-')\nM = length(residCG) - 1;\nhold on,  semilogy(0:M, residCG / norm(b), '.-')\ntitle('Convergence of MINRES and CG')\nxlabel('Krylov dimension m')\nylabel('||r_m|| / ||b||')\nlegend('MINRES', 'CG');","key":"Enjpl56l2o"},{"type":"output","id":"xEhVAZbrV2iZBM0hKm-XP","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9af615843d393699d6de9b61824af8e3","path":"/build/9af615843d393699d6de9b61824af8e3.png"}}}],"key":"l5rwepigr5"}],"data":{},"key":"TTd5at5gJj"},{"type":"paragraph","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"children":[{"type":"text","value":"There is little difference between the two methods here. Next, we increase the condition number of the matrix by a factor of 25. The rule of thumb predicts that the number of iterations required should increase by a factor of about 5.","position":{"start":{"line":668,"column":1},"end":{"line":668,"column":1}},"key":"WcWyRkTz7C"}],"key":"TOxsfjArlA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = sprandsym(n, density, 1e-2 / 25, 2);\nb = A * x;","key":"R4tVJ7dZ8D"},{"type":"output","id":"ZYqtRVn5wsWw6WqS9CxC3","data":[{"output_type":"stream","name":"stderr","text":"Error using sprandsym (line 141)\nFirst argument must be a scalar"}],"key":"A7D1nv5DyX"}],"data":{},"key":"roKJyK3gFF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[xMR, ~, ~, ~, residMR] = minres(A, b, 1e-7, 400);\n[xCG, ~, ~, ~, residCG] = pcg(A, b, 1e-7, 400);\nM = length(residMR) - 1;\nclf,  semilogy(0:M, residMR / norm(b), '.-')\nM = length(residCG) - 1;\nhold on,  semilogy(0:M, residCG / norm(b), '.-')\ntitle('Convergence of MINRES and CG')\nxlabel('Krylov dimension m')\nylabel('||r_m|| / ||b||')\nlegend('MINRES', 'CG');","visibility":"hide","key":"gyhd0xLWTg"},{"type":"output","id":"LMdm7ASQn9ir9iG3pKk3D","data":[{"output_type":"execute_result","execution_count":60,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f5e6d3f67d43d930b56ccf3e14f1621d","path":"/build/f5e6d3f67d43d930b56ccf3e14f1621d.png"}}}],"visibility":"show","key":"aXLdDfeUE1"}],"data":{"tags":[]},"visibility":"show","key":"C0NAG2q403"},{"type":"paragraph","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"children":[{"type":"text","value":"Both methods have an early superlinear phase that allow them to finish slightly sooner than the factor of 5 predicted: ","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"z7oLLaC3SQ"},{"type":"crossReference","kind":"proof:theorem","identifier":"theorem-minrescg-converge","label":"theorem-minrescg-converge","children":[{"type":"text","value":"Theorem ","key":"BRehVsbzih"},{"type":"text","value":"8.6.2","key":"yvJZ2XEM2C"}],"template":"Theorem %s","enumerator":"8.6.2","resolved":true,"html_id":"theorem-minrescg-converge","remote":true,"url":"/minrescg","dataUrl":"/minrescg.json","key":"lUhor2GwY8"},{"type":"text","value":" is an upper bound, not necessarily an approximation. Both methods ultimately achieve the same reduction in the residual; MINRES stops earlier, but with a slightly larger error.","position":{"start":{"line":690,"column":1},"end":{"line":690,"column":1}},"key":"oB3Nl0kRVM"}],"key":"LJDXmWbTw5"}],"label":"demo-minrescg-converge-matlab","identifier":"demo-minrescg-converge-matlab","html_id":"demo-minrescg-converge-matlab","key":"PDKStKn6wC"},{"type":"heading","depth":3,"position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"children":[{"type":"text","value":"8.7 ","position":{"start":{"line":694,"column":1},"end":{"line":694,"column":1}},"key":"fMvVRGYtuH"},{"type":"link","identifier":"section-krylov-matrixfree","label":"section-krylov-matrixfree","kind":"narrative","position":{"start":{"line":694,"column":5},"end":{"line":694,"column":31}},"url":"/matrixfree","internal":true,"dataUrl":"/matrixfree.json","children":[{"type":"text","value":"Matrix-free iterations","key":"Hh5GUuFR0y"}],"key":"uobZnNTR95"}],"identifier":"id-8-7","label":"8.7 ","html_id":"id-8-7","implicit":true,"key":"nTzyvBVcwH"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-matrixfree-blur","label":"demo-matrixfree-blur","kind":"proof:example","position":{"start":{"line":697,"column":1},"end":{"line":697,"column":22}},"children":[{"type":"text","value":"Example ","key":"Dap1RsAjI5"},{"type":"text","value":"8.7.1","key":"OYhmkaOJf6"}],"template":"Example %s","enumerator":"8.7.1","resolved":true,"html_id":"demo-matrixfree-blur","remote":true,"url":"/matrixfree","dataUrl":"/matrixfree.json","key":"aQeqTjaf3V"}],"key":"BqzdoHjG53"},{"type":"paragraph","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"children":[{"type":"text","value":"We use a readily available test image.","position":{"start":{"line":699,"column":1},"end":{"line":699,"column":1}},"key":"lvNtkVvkFM"}],"key":"wIT9GQBeRo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"load mandrill\n[m, n] = size(X);\nclf\nimshow(X, [0, 255])\ntitle('Original image')    % ignore this","key":"LCr4J21Myk"},{"type":"output","id":"feD3eWu7-mBR7yKiYF-s9","data":[{"output_type":"execute_result","execution_count":61,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a3d46678f546bafce467eddce87e3f1a","path":"/build/a3d46678f546bafce467eddce87e3f1a.png"}}}],"key":"hoa2Vl7Zpy"}],"data":{},"key":"dtwAeZAbd9"},{"type":"paragraph","position":{"start":{"line":709,"column":1},"end":{"line":709,"column":1}},"children":[{"type":"text","value":"We define the one-dimensional tridiagonal blurring matrices.","position":{"start":{"line":709,"column":1},"end":{"line":709,"column":1}},"key":"uApc9PhYMQ"}],"key":"O2WzAb9p7y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"v = [1/4, 1/2, 1/4];\nB = spdiags(v, -1:1, m, m);\nC = spdiags(v, -1:1, n, n);","key":"grIFoxl7w5"},{"type":"output","id":"CPDsA4mGzvrYJfebhehFv","data":[{"output_type":"stream","name":"stderr","text":"Error using sparse\nUse sparse(m,n) to preallocate an m-by-n sparse matrix, or sparse(i,j,v) to specify the (i,j) locations of nonzero entries v.\n\nError in spdiags (line 72)\n        A = sparse(arg3, arg4);"}],"key":"PbLsxNM0ee"}],"data":{},"key":"Cmn4OTTnIb"},{"type":"paragraph","position":{"start":{"line":717,"column":1},"end":{"line":717,"column":1}},"children":[{"type":"text","value":"Finally, we show the results of using ","position":{"start":{"line":717,"column":1},"end":{"line":717,"column":1}},"key":"g2c2VEyieh"},{"type":"inlineMath","value":"k=12","position":{"start":{"line":717,"column":1},"end":{"line":717,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi><mo>=</mo><mn>12</mn></mrow><annotation encoding=\"application/x-tex\">k=12</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">12</span></span></span></span>","key":"hFsxSXpL23"},{"type":"text","value":" repetitions of the blur in each direction.","position":{"start":{"line":717,"column":1},"end":{"line":717,"column":1}},"key":"QmPmUzhj0v"}],"key":"VMen5V5daz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"blur = @(X) B^12 * X * C^12;\nimshow(blur(X), [0, 255])\ntitle(('Blurred image'));","key":"EwCEtNUnvY"},{"type":"output","id":"twwwLZpRYDfijhJLrxaxc","data":[{"output_type":"stream","name":"stderr","text":"Error using *\nIncorrect dimensions for matrix multiplication. Check that the number of columns in the first matrix matches the number of rows in the second matrix. To operate on each element of the matrix individually, use TIMES (.*) for elementwise multiplication.\n\nError in Notebook>@(X)B^12*X*C^12 (line 1)\nblur = @(X) B^12 * X * C^12;"}],"key":"CAb38U2nEe"}],"data":{},"key":"XcIRUDr1yA"}],"label":"demo-matrixfree-blur-matlab","identifier":"demo-matrixfree-blur-matlab","html_id":"demo-matrixfree-blur-matlab","key":"I6JFeCXygK"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-matrixfree-deblur","label":"demo-matrixfree-deblur","kind":"proof:example","position":{"start":{"line":727,"column":1},"end":{"line":727,"column":24}},"children":[{"type":"text","value":"Example ","key":"J0dcu9Pluo"},{"type":"text","value":"8.7.2","key":"mHMv03f9ch"}],"template":"Example %s","enumerator":"8.7.2","resolved":true,"html_id":"demo-matrixfree-deblur","remote":true,"url":"/matrixfree","dataUrl":"/matrixfree.json","key":"FpZdfmvNvR"}],"key":"RTy5ZWk2f0"},{"type":"paragraph","position":{"start":{"line":729,"column":1},"end":{"line":729,"column":1}},"children":[{"type":"text","value":"We repeat the earlier process to blur an original image ","position":{"start":{"line":729,"column":1},"end":{"line":729,"column":1}},"key":"VSn54JAZFv"},{"type":"inlineMath","value":"\\mathbf{X}","position":{"start":{"line":729,"column":1},"end":{"line":729,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span></span></span></span>","key":"MXteXRX9tG"},{"type":"text","value":" to get ","position":{"start":{"line":729,"column":1},"end":{"line":729,"column":1}},"key":"GJkWPOszCH"},{"type":"inlineMath","value":"\\mathbf{Z}","position":{"start":{"line":729,"column":1},"end":{"line":729,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Z</span></span></span></span>","key":"x1dJAguXQv"},{"type":"text","value":".","position":{"start":{"line":729,"column":1},"end":{"line":729,"column":1}},"key":"u994xoWHX5"}],"key":"D9lokWGa7E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"load mandrill\n[m, n] = size(X);\nv = [1/4, 1/2, 1/4];\nB = spdiags(v, -1:1, m, m);\nC = spdiags(v, -1:1, n, n);\nblur = @(X) B^12 * X * C^12;","visibility":"hide","key":"gBPhE0DDKb"},{"type":"output","id":"E6I1iJlUQvz6xIeESm1yA","data":[],"visibility":"show","key":"FOamO5EjBe"}],"data":{"tags":[]},"visibility":"show","key":"dp0n2nXCmW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"Z = blur(X);\nclf,  imshow(Z, [0, 255])\ntitle((\"Blurred image\"));","key":"BOqrDRTHrS"},{"type":"output","id":"iyxrUWAYc7d07txCyA1mf","data":[{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"972ef4b8cce39d20419a21e73fa542af","path":"/build/972ef4b8cce39d20419a21e73fa542af.png"}}}],"key":"xJqOoDPTxC"}],"data":{},"key":"OiO4utufyK"},{"type":"paragraph","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"children":[{"type":"text","value":"Now we imagine that ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"Xe9ILFlQdi"},{"type":"inlineMath","value":"\\mathbf{X}","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">X</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{X}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">X</span></span></span></span>","key":"QD6wHoXmo0"},{"type":"text","value":" is unknown and that we want to recover it from ","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"tySAUPdbOy"},{"type":"inlineMath","value":"\\mathbf{Z}","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">Z</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{Z}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">Z</span></span></span></span>","key":"IvIEK8jQfC"},{"type":"text","value":". We first need functions that translate between vector and matrix representations.","position":{"start":{"line":747,"column":1},"end":{"line":747,"column":1}},"key":"q8h2nERAEy"}],"key":"eNxPsYKb0N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"vec = @(X) reshape(X,m*n,1);\nunvec = @(x) reshape(x,m,n);\nT = @(x) vec( blur(unvec(x)) );","key":"wvdQbJ1lr4"},{"type":"output","id":"9TrZFnud72V--6ywANux4","data":[],"key":"Ey0dsE4nJ5"}],"data":{},"key":"ORIUqK5Qis"},{"type":"paragraph","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"children":[{"type":"text","value":"The blurring operators are symmetric, so we apply ","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"lVD9HCP6oE"},{"type":"inlineCode","value":"minres","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"v5xRtgD5j9"},{"type":"text","value":" to the composite blurring transformation ","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"Ou65AupGr1"},{"type":"inlineCode","value":"T","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"EnKz0iuXJ7"},{"type":"text","value":".","position":{"start":{"line":754,"column":1},"end":{"line":754,"column":1}},"key":"nBTgjTryDI"}],"key":"ZZ2OdDaUfU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"y = gmres(T, vec(Z), 50, 1e-5);\nY = unvec(y);\n\nsubplot(121)\nimshow(X, [0, 255])\ntitle(\"Original\")\nsubplot(122)\nimshow(Y, [0, 255])\ntitle((\"Deblurred\"));","key":"CoJbr3znSQ"},{"type":"output","id":"AwUpW5nCXzA0Z0iUn9wZd","data":[{"output_type":"stream","name":"stderr","text":"Error using reshape\nNumber of elements must not change. Use [] as one of the size inputs to automatically calculate the appropriate size for that dimension.\n\nError in Notebook>@(X)reshape(X,m*n,1) (line 1)\ny = gmres(T, vec(Z), 50, 1e-5);"}],"key":"HvsOEWOiAL"}],"data":{},"key":"r91zd7QYOZ"}],"label":"demo-matrixfree-deblur-matlab","identifier":"demo-matrixfree-deblur-matlab","html_id":"demo-matrixfree-deblur-matlab","key":"Dpe3JeRPXm"},{"type":"heading","depth":3,"position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"children":[{"type":"text","value":"8.8 ","position":{"start":{"line":769,"column":1},"end":{"line":769,"column":1}},"key":"fP0LzjpOnn"},{"type":"link","identifier":"section-krylov-precond","label":"section-krylov-precond","kind":"narrative","position":{"start":{"line":769,"column":5},"end":{"line":769,"column":28}},"url":"/precond","internal":true,"dataUrl":"/precond.json","children":[{"type":"text","value":"Preconditioning","key":"DvwOwxkokC"}],"key":"i9F1btnxwL"}],"identifier":"id-8-8","label":"8.8 ","html_id":"id-8-8","implicit":true,"key":"UtjIM8N11g"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-diagonal","label":"demo-precond-diagonal","kind":"proof:example","position":{"start":{"line":772,"column":1},"end":{"line":772,"column":23}},"children":[{"type":"text","value":"Example ","key":"C3CJim79q3"},{"type":"text","value":"8.8.1","key":"INYC6waQ91"}],"template":"Example %s","enumerator":"8.8.1","resolved":true,"html_id":"demo-precond-diagonal","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"WwfQfR9RWO"}],"key":"nnYYrBHkwm"},{"type":"paragraph","position":{"start":{"line":774,"column":1},"end":{"line":774,"column":1}},"children":[{"type":"text","value":"Here is an ","key":"kRsaVnub2I"},{"type":"abbreviation","title":"symmetric positive definite","children":[{"type":"text","value":"SPD","key":"BtrnQ44Fzo"}],"key":"KKwihciLVU"},{"type":"text","value":" matrix that arises from solving partial differential equations.","key":"Fbq0WGM9jf"}],"key":"VbCrXBGiJR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"A = gallery(\"wathen\", 60, 60);\nn = size(A, 1);\nclf,  spy(A)","key":"RBPGon6Hdg"},{"type":"output","id":"cN5hmlv8wxmdYJCcuNXmv","data":[{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2e40bfa6a1affd76cf43bc0a66f7aa59","path":"/build/2e40bfa6a1affd76cf43bc0a66f7aa59.png"}}}],"key":"CUx99oro8g"}],"data":{},"key":"WwBa2VR0Te"},{"type":"paragraph","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"children":[{"type":"text","value":"There is an easy way to use the diagonal elements of ","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"MjpaNG4XFO"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"wdMCJ4Lzps"},{"type":"text","value":", or any other vector, as a diagonal preconditioner.","position":{"start":{"line":782,"column":1},"end":{"line":782,"column":1}},"key":"jzKRT8gvWe"}],"key":"eec7LXLeZu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"M = spdiags(diag(A), 0, n, n);","key":"yCyWgIkSuu"},{"type":"output","id":"-uv2YJNDyu2UlTzhgIvPN","data":[{"output_type":"stream","name":"stderr","text":"Error using sparse\nUse sparse(m,n) to preallocate an m-by-n sparse matrix, or sparse(i,j,v) to specify the (i,j) locations of nonzero entries v.\n\nError in spdiags (line 72)\n        A = sparse(arg3, arg4);"}],"key":"Gpgfio0Zdw"}],"data":{},"key":"E47i5xMMqR"},{"type":"paragraph","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"children":[{"type":"text","value":"We now compare MINRES with and without the preconditioner.","position":{"start":{"line":788,"column":1},"end":{"line":788,"column":1}},"key":"nSBjBufbEZ"}],"key":"jwsvL3jLDQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = ones(n, 1);\n[x, ~, ~, ~, resid_plain] = minres(A, b, 1e-10, 400);\nclf,  semilogy(resid_plain)\nxlabel('iteration number'), ylabel('residual norm')\ntitle('Unpreconditioned MINRES')\n\n[x, ~, ~, ~, resid_prec] = minres(A, b, 1e-10, 400, M);\nhold on,  semilogy(resid_prec)\ntitle('Precondtioned MINRES')\nlegend('no prec.', 'with prec.');","visibility":"hide","key":"ht5DguytN1"},{"type":"output","id":"kUsRm0CIf0csUP9_vuq_X","data":[{"output_type":"stream","name":"stderr","text":"Error using ones\nSize inputs must be scalar."}],"visibility":"show","key":"IpBfmrnaRX"}],"data":{"tags":[]},"visibility":"show","key":"FBVPVyAHu6"},{"type":"paragraph","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"children":[{"type":"text","value":"The diagonal preconditioner cut down substantially on the number of iterations. The effect on the total time is less dramatic, but this is not a large version of the problem.","position":{"start":{"line":805,"column":1},"end":{"line":805,"column":1}},"key":"Wv9Y5pHON5"}],"key":"NSIl4r1cU6"}],"label":"demo-precond-diagonal-matlab","identifier":"demo-precond-diagonal-matlab","html_id":"demo-precond-diagonal-matlab","key":"TrFZjVcYn0"},{"type":"details","open":true,"children":[{"type":"summary","children":[{"type":"crossReference","identifier":"demo-precond-gmres","label":"demo-precond-gmres","kind":"proof:example","position":{"start":{"line":810,"column":1},"end":{"line":810,"column":20}},"children":[{"type":"text","value":"Example ","key":"WO5stqemIw"},{"type":"text","value":"8.8.2","key":"tG2T6qEYqh"}],"template":"Example %s","enumerator":"8.8.2","resolved":true,"html_id":"demo-precond-gmres","remote":true,"url":"/precond","dataUrl":"/precond.json","key":"syRR3Q1KGC"}],"key":"A7NK2UJQT0"},{"type":"paragraph","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"children":[{"type":"text","value":"Here is a random nonsymmetric matrix.","position":{"start":{"line":812,"column":1},"end":{"line":812,"column":1}},"key":"u6nXWwzD2y"}],"key":"i6irXAYldl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"n = 8000;\nA = speye(n) + sprand(n, n, 0.00035);","key":"i4IZpZGq1r"},{"type":"output","id":"tYIbcHSj5fGYN6njYHL_A","data":[],"key":"b1WMswzqRl"}],"data":{},"key":"O6uXTLz7Ps"},{"type":"paragraph","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"children":[{"type":"text","value":"Without a preconditioner, restarted GMRES makes slow progress.","position":{"start":{"line":819,"column":1},"end":{"line":819,"column":1}},"key":"rhOavmFOUE"}],"key":"deVUrUIUY8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"b = rand(n, 1);\n[x, ~, ~, ~, resid_plain] = gmres(A, b, 50, 1e-10, 3);  % restart at 50\nformat short e\nresid_plain(1:30:end)","key":"JcteHoEd7r"},{"type":"output","id":"a9CHul8It_INK4siDazAr","data":[{"output_type":"stream","name":"stderr","text":"Error using rand\nSize inputs must be scalar."}],"key":"a2h5NeK4Bn"}],"data":{},"key":"HE17KPL45y"},{"type":"paragraph","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"children":[{"type":"text","value":"This version of incomplete LU factorization simply prohibits fill-in for the factors, freezing the sparsity pattern of the approximate factors to match the original matrix.","position":{"start":{"line":831,"column":1},"end":{"line":831,"column":1}},"key":"p2fb0Ku2h9"}],"indexEntries":[{"entry":"MATLAB","subEntry":{"value":"ilu","kind":"entry"},"emphasis":true}],"label":"index-nvGVJ86H2L","identifier":"index-nvgvj86h2l","html_id":"index-nvgvj86h2l","key":"jEGuuOdaE1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[L, U] = ilu(A);\nclf\nsubplot(121), spy(L)\ntitle('L')\nsubplot(122), spy(U)\ntitle('U')\ndisp(sprintf(\"There are %d nonzeros in A\", nnz(A)))","key":"G1hBnd5MpJ"},{"type":"output","id":"3UWJlvTF2cgra96O-4RHV","data":[{"output_type":"stream","name":"stderr","text":"Error using ilu\nFirst argument must be sparse."}],"key":"vDBCyThprr"}],"data":{},"key":"TkQQONlsW9"},{"type":"paragraph","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"children":[{"type":"text","value":"It does ","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"Oi0qgTFTtu"},{"type":"emphasis","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"Uu98sKA43z"}],"key":"UX3SXm1ney"},{"type":"text","value":" produce a true factorization of ","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"P27PQIdApM"},{"type":"inlineMath","value":"\\mathbf{A}","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">A</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{A}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">A</span></span></span></span>","key":"j4z4yCKrPt"},{"type":"text","value":".","position":{"start":{"line":843,"column":1},"end":{"line":843,"column":1}},"key":"m46gltW5gA"}],"key":"WEjJnsgx2B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"norm( full(A - L * U) )","key":"kbqZIeMVFu"},{"type":"output","id":"VoBBU09-tYA73rAkRiv4i","data":[{"output_type":"stream","name":"stderr","text":"Error using -\nArrays have incompatible sizes for this operation."}],"key":"pF8wNeDmTU"}],"data":{},"key":"btUboQldFq"},{"type":"paragraph","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"children":[{"type":"text","value":"The actual preconditioning matrix is ","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"Ncv2SQcmx1"},{"type":"inlineMath","value":"\\mathbf{M}=\\mathbf{L}\\mathbf{U}","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">M</mi><mo>=</mo><mi mathvariant=\"bold\">L</mi><mi mathvariant=\"bold\">U</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}=\\mathbf{L}\\mathbf{U}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">M</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6861em;\"></span><span class=\"mord mathbf\">LU</span></span></span></span>","key":"DPi2oWChsP"},{"type":"text","value":". However, the ","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"kDJo5ocG7y"},{"type":"inlineCode","value":"gmres","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"oaqMMmVs2x"},{"type":"text","value":" function allows setting the preconditioner by giving the factors independently.","position":{"start":{"line":849,"column":1},"end":{"line":849,"column":1}},"key":"Qqcpy7NLwG"}],"key":"xBoLRT7Dm7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"[x, ~, ~, ~, resid_prec] = gmres(A, b, [], 1e-10, 300, L, U);","key":"ulFDDSdUwy"},{"type":"output","id":"4XyUq5CtFOr_pAYum3ASU","data":[{"output_type":"stream","name":"stderr","text":"Error using gmres (line 93)\nRight hand side must be a column vector of length 2400 to match the coefficient matrix."}],"key":"udBQmf1vfE"}],"data":{},"key":"shWVfxuOJ6"},{"type":"paragraph","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"children":[{"type":"text","value":"The preconditioner makes a significant difference in the number of iterations needed.","position":{"start":{"line":855,"column":1},"end":{"line":855,"column":1}},"key":"r93mZGR7Ws"}],"key":"dL9tmy1Udf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"matlab","executable":true,"value":"clf, semilogy(resid_plain)\nhold on, semilogy(resid_prec)\nxlabel('iteration number'), ylabel('residual norm')\ntitle('Precondtioned GMRES ')\nlegend('no preconditioner', 'with preconditioner');","key":"XkKgyHa1t1"},{"type":"output","id":"nh86hLw24VK0QqDUjoRkZ","data":[{"output_type":"stream","name":"stderr","text":"Unrecognized function or variable 'resid_plain'."}],"key":"sjZjsuiCG8"}],"data":{},"key":"wU1YMzo8e7"},{"type":"code","lang":"","value":"","position":{"start":{"line":864,"column":1},"end":{"line":864,"column":1}},"key":"VbORPxho0N"}],"label":"demo-precond-gmres-matlab","identifier":"demo-precond-gmres-matlab","html_id":"demo-precond-gmres-matlab","key":"wBM2jsYXXP"}],"key":"OoRpDGQFta"}],"key":"ftNueFmw1z"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Chapter 7","url":"/chapter7-1","group":"MATLAB codes"},"next":{"title":"Chapter 9","url":"/chapter9-1","group":"MATLAB codes"}}},"domain":"http://localhost:3000"}